var TIME_exstart = new Date().getTime(); 
var e=false,h=null,j=true;function k(a){throw a;}var o;var aa=aa||{},p=this;var ca=function(a,b,c){var d=a.split("."),f=c||p,g;!(d[0]in f)&&f.execScript&&f.execScript("var "+d[0]);while(d.length&&(g=d.shift()))if(!d.length&&ba(b))f[g]=b;else f=f[g]?f[g]:(f[g]={})},da=function(a,b){var c=a.split("."),d=b||p;for(var f;f=c.shift();)if(d[f])d=d[f];else return h;return d},fa=function(){},ga=function(a){a.Ga=function(){return a.VH||(a.VH=new a)}};
var ia=function(a){var b=typeof a;if(b=="object")if(a){if(typeof a.length=="number"&&typeof a.splice!="undefined"&&!ha(a,"length"))return"array";if(typeof a.call!="undefined")return"function"}else return"null";else if(b=="function"&&typeof a.call=="undefined")return"object";return b},ja=function(a,b){if(b in a)for(var c in a)if(c==b&&Object.prototype.hasOwnProperty.call(a,b))return j;return e};
if(Object.prototype.propertyIsEnumerable)var ha=function(a,b){return a instanceof Object?Object.prototype.propertyIsEnumerable.call(a,b):ja(a,b)};else ha=ja;var ba=function(a){return typeof a!="undefined"};
var ka=function(a){return ia(a)=="array"},la=function(a){var b=ia(a);return b=="array"||b=="object"&&typeof a.length=="number"},ma=function(a){return typeof a=="string"},na=function(a){return typeof a=="number"},oa=function(a){return ia(a)=="function"},pa=function(a){var b=ia(a);return b=="object"||b=="array"||b=="function"},s=function(a){if(a.hasOwnProperty&&a.hasOwnProperty(qa)){var b=a[qa];if(b)return b}a[qa]||(a[qa]=++ra);return a[qa]},sa=function(a){"removeAttribute"in a&&a.removeAttribute(qa);
try{delete a[qa]}catch(b){}},qa="closure_hashCode_",ra=0,u=function(a,b){var c=a.xC;if(arguments.length>2){var d=Array.prototype.slice.call(arguments,2);c&&d.unshift.apply(d,c);c=d}b=a.AC||b;a=a.yC||a;var f,g=b||p;f=c?function(){var i=Array.prototype.slice.call(arguments);i.unshift.apply(i,c);return a.apply(g,i)}:function(){return a.apply(g,arguments)};f.xC=c;f.AC=b;f.yC=a;return f},ta=function(a){var b=Array.prototype.slice.call(arguments,1);b.unshift(a,h);return u.apply(h,b)},ua=Date.now||function(){return(new Date).getTime()},
wa=function(a,b){var c=b||{};for(var d in c)a=a.replace(new RegExp("\\{\\$"+d+"\\}","gi"),c[d]);return a},w=function(a,b,c){ca(a,b,c)},y=function(a,b,c){a[b]=c},z=function(a,b){function c(){}c.prototype=b.prototype;a.d=b.prototype;a.prototype=new c;a.prototype.constructor=a};Function.prototype.bind=function(a){if(arguments.length>1){var b=Array.prototype.slice.call(arguments,1);b.unshift(this,a);return u.apply(h,b)}else return u(this,a)};Function.prototype.Ha=function(a){z(this,a)};var xa=function(a,b){var c=a.length-b.length;return c>=0&&a.lastIndexOf(b,c)==c},ya=function(a){return a.replace(/[\s\xa0]+/g," ").replace(/^\s+|\s+$/g,"")},za=function(a){return/^[\s\xa0]*$/.test(a)},Aa=function(a){return!/[^\t\n\r ]/.test(a)},Ba=function(a){return a.replace(/(\r\n|\r|\n)+/g," ")};
var Ca=function(a){return a.replace(/\xa0|\s/g," ")},Da=function(a){return a.replace(/\xa0|[ \t]+/g," ")},Ea=function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},Fa=function(a){return a.replace(/^[\s\xa0]+/,"")};var Ga=/^[a-zA-Z0-9\-_.!~*'()]*$/,Ha=function(a){a=String(a);if(!Ga.test(a))return encodeURIComponent(a);return a};
var Na=function(a,b){if(b)return a.replace(Ia,"&amp;").replace(Ja,"&lt;").replace(Ka,"&gt;").replace(La,"&quot;");else{if(!Ma.test(a))return a;if(a.indexOf("&")!=-1)a=a.replace(Ia,"&amp;");if(a.indexOf("<")!=-1)a=a.replace(Ja,"&lt;");if(a.indexOf(">")!=-1)a=a.replace(Ka,"&gt;");if(a.indexOf('"')!=-1)a=a.replace(La,"&quot;");return a}},Ia=/&/g,Ja=/</g,Ka=/>/g,La=/\"/g,Ma=/[&<>\"]/,Qa=function(a){if(a.indexOf("&")!=-1)return"document"in p&&!(a.indexOf("<")!=-1)?Oa(a):Pa(a);return a},Oa=function(a){var b=
p.document.createElement("a");b.innerHTML=a;b.normalize&&b.normalize();a=b.firstChild.nodeValue;b.innerHTML="";return a},Pa=function(a){return a.replace(/&([^;]+);/g,function(b,c){switch(c){case "amp":return"&";case "lt":return"<";case "gt":return">";case "quot":return'"';default:if(c.charAt(0)=="#"){var d=Number("0"+c.substr(1));if(!isNaN(d))return String.fromCharCode(d)}return b}})},Ra=function(a,b){var c=b.length;for(var d=0;d<c;d++){var f=c==1?b:b.charAt(d);if(a.charAt(0)==f&&a.charAt(a.length-
1)==f)return a.substring(1,a.length-1)}return a},Sa=function(a,b,c){if(c)a=Qa(a);if(a.length>b){var d=Math.floor(b/2),f=a.length-d;d+=b%2;a=a.substring(0,d)+"..."+a.substring(f)}if(c)a=Na(a);return a};
var Ta=function(a,b){return(new Array(b+1)).join(a)},Ua=function(a,b,c){var d=ba(c)?a.toFixed(c):String(a),f=d.indexOf(".");if(f==-1)f=d.length;return Ta("0",Math.max(0,b-f))+d},Va=function(){return Array.prototype.join.call(arguments,"")},Xa=function(){return Math.floor(Math.random()*2147483648).toString(36)+(Math.floor(Math.random()*2147483648)^(new Date).getTime()).toString(36)},Za=function(a,b){var c=0,d=Ea(String(a)).split("."),f=Ea(String(b)).split("."),g=Math.max(d.length,f.length);for(var i=
0;c==0&&i<g;i++){var l=d[i]||"",m=f[i]||"",n=new RegExp("(\\d*)(\\D*)","g"),q=new RegExp("(\\d*)(\\D*)","g");do{var r=n.exec(l)||["","",""],t=q.exec(m)||["","",""];if(r[0].length==0&&t[0].length==0)break;var v=r[1].length==0?0:parseInt(r[1],10),x=t[1].length==0?0:parseInt(t[1],10);c=Ya(v,x)||Ya(r[2].length==0,t[2].length==0)||Ya(r[2],t[2])}while(c==0)}return c},Ya=function(a,b){if(a<b)return-1;else if(a>b)return 1;return 0},$a=ua(),ab=function(){return"goog_"+$a++};var bb,cb,db,eb,fb,hb,ib,jb,kb,lb,nb,ob=function(){if(p.navigator)return p.navigator.userAgent;return h};
(function(){var a=e,b=e,c=e,d=e,f=e,g=e,i=e,l=e,m=e,n="",q=ob();if(q){var r=p.navigator;a=q.indexOf("Opera")==0;b=!a&&q.indexOf("MSIE")!=-1;c=!a&&q.indexOf("WebKit")!=-1;m=c&&q.indexOf("Mobile")!=-1;d=!a&&!c&&r.product=="Gecko";f=d&&r.vendor=="Camino";var t,v;if(p.opera&&typeof p.opera.version=="function")t=p.opera.version();else{if(d)v=/rv\:([^\);]+)(\)|;)/;else if(b)v=/MSIE\s+([^\);]+)(\)|;)/;else if(c)v=/WebKit\/(\S+)/;if(v){v.test(q);t=RegExp.$1}}n=r.platform||"";g=n.indexOf("Mac")!=-1;i=n.indexOf("Win")!=
-1;l=n.indexOf("Linux")!=-1}bb=a;cb=b;db=d;eb=f;fb=c;hb=m;ib=t;jb=n;kb=g;lb=i;nb=l})();var A=bb,B=cb,E=db,F=fb,pb=hb;var qb=function(a){return Za(ib,a)>=0};var rb=function(a){return a[a.length-1]},sb=function(a,b,c){if(a.indexOf)return a.indexOf(b,c);if(Array.indexOf)return Array.indexOf(a,b,c);var d=c==h?0:c<0?Math.max(0,a.length+c):c;for(var f=d;f<a.length;f++)if(f in a&&a[f]===b)return f;return-1},tb=function(a,b,c){if(a.forEach)a.forEach(b,c);else if(Array.forEach)Array.forEach(a,b,c);else{var d=a.length,f=ma(a)?a.split(""):a;for(var g=0;g<d;g++)g in f&&b.call(c,f[g],g,a)}},ub=function(a,b,c){var d=a.length,f=ma(a)?a.split(""):a;for(var g=d-1;g>=
0;--g)g in f&&b.call(c,f[g],g,a)},wb=function(a,b,c){if(a.map)return a.map(b,c);if(Array.map)return Array.map(a,b,c);var d=a.length,f=[],g=0,i=ma(a)?a.split(""):a;for(var l=0;l<d;l++)if(l in i)f[g++]=b.call(c,i[l],l,a);return f},yb=function(a,b,c){if(a.some)return a.some(b,c);if(Array.some)return Array.some(a,b,c);var d=a.length,f=ma(a)?a.split(""):a;for(var g=0;g<d;g++)if(g in f&&b.call(c,f[g],g,a))return j;return e},zb=function(a,b,c){if(a.every)return a.every(b,c);if(Array.every)return Array.every(a,
b,c);var d=a.length,f=ma(a)?a.split(""):a;for(var g=0;g<d;g++)if(g in f&&!b.call(c,f[g],g,a))return e;return j},Bb=function(a,b,c){var d=Ab(a,b,c);return d<0?h:ma(a)?a.charAt(d):a[d]},Ab=function(a,b,c){var d=a.length,f=ma(a)?a.split(""):a;for(var g=0;g<d;g++)if(g in f&&b.call(c,f[g],g,a))return g;return-1},Cb=function(a,b){if(a.contains)return a.contains(b);return sb(a,b)>-1};
var Db=function(a){if(!ka(a))for(var b=a.length-1;b>=0;b--)delete a[b];a.length=0},Fb=function(a,b,c){Eb(a,c,0,b)},Hb=function(a,b){var c=sb(a,b),d;if(d=c!=-1)Gb(a,c);return d},Gb=function(a,b){return Array.prototype.splice.call(a,b,1).length==1},Ib=function(a){if(ka(a))return a.concat();else{var b=[];for(var c=0,d=a.length;c<d;c++)b[c]=a[c];return b}},Jb=function(a){if(ka(a))return a.concat();return Ib(a)},Kb=function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];if(la(c)){c=Jb(c);a.push.apply(a,
c)}else a.push(c)}},Eb=function(a){return Array.prototype.splice.apply(a,Lb(arguments,1))},Lb=function(a,b,c){return arguments.length<=2?Array.prototype.slice.call(a,b):Array.prototype.slice.call(a,b,c)},Nb=function(a,b,c){var d=0,f=a.length-1,g=c||Mb;while(d<=f){var i=d+f>>1,l=g(b,a[i]);if(l>0)d=i+1;else if(l<0)f=i-1;else return i}return-(d+1)},Ob=function(a,b){Array.prototype.sort.call(a,b||Mb)},Qb=function(a,b,c){if(!la(a)||!la(b)||a.length!=b.length)return e;var d=a.length,f=c||Pb;for(var g=0;g<
d;g++)if(!f.call(h,a[g],b[g]))return e;return j},Mb=function(a,b){return a>b?1:a<b?-1:0},Pb=function(a,b){return a===b},Rb=function(a,b,c){var d=Nb(a,b,c);return d>=0?Gb(a,d):e};if("StopIteration"in p)var Sb=p.StopIteration;else Sb=Error("StopIteration");var Tb=function(){};Tb.prototype.next=function(){k(Sb)};Tb.prototype.Ld=function(){return this};
var Ub=function(a){if(a instanceof Tb)return a;if(typeof a.Ld=="function")return a.Ld(e);if(la(a)){var b=0,c=new Tb;c.next=function(){while(j){if(b>=a.length)k(Sb);if(!(b in a)){b++;continue}return a[b++]}};return c}k(Error("Not implemented"))},Vb=function(a,b,c){if(la(a))try{tb(a,b,c)}catch(d){if(d!==Sb)k(d)}else{a=Ub(a);try{while(j)b.call(c,a.next(),undefined,a)}catch(d){if(d!==Sb)k(d)}}},Wb=function(a,b,c){a=Ub(a);var d=new Tb;d.next=function(){while(j){var f=a.next();if(b.call(c,f,undefined,a))return f}};
return d},Xb=function(a,b,c){a=Ub(a);try{while(j)if(b.call(c,a.next(),undefined,a))return j}catch(d){if(d!==Sb)k(d)}return e};var Yb=function(a,b,c){for(var d in a)b.call(c,a[d],d,a)},Zb=function(a){var b=0;for(var c in a)b++;return b},$b=function(a){for(var b in a)return a[b]},ac=function(a){var b=[],c=0;for(var d in a)b[c++]=a[d];return b},bc=function(a){var b=[],c=0;for(var d in a)b[c++]=d;return b},cc=function(a,b){for(var c in a)if(a[c]==b)return j;return e},dc=function(a){for(var b in a)return e;return j},ec=function(a,b){var c;if(c=b in a)delete a[b];return c},gc=function(a,b,c){if(b in a)k(Error('The object already contains the key "'+
b+'"'));fc(a,b,c)},hc=function(a,b,c){if(b in a)return a[b];return c},fc=function(a,b,c){a[b]=c},ic=function(a){var b={},c=bc(a);for(var d=0,f=c.length;d<f;d++){var g=c[d];b[a[g]]=g}return b},jc=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],kc=function(a){var b,c;for(var d=1;d<arguments.length;d++){c=arguments[d];for(b in c)a[b]=c[b];for(var f=0;f<jc.length;f++){b=jc[f];if(Object.prototype.hasOwnProperty.call(c,b))a[b]=c[b]}}},lc=function(){var a=
arguments.length;if(a==1&&ka(arguments[0]))return lc.apply(h,arguments[0]);if(a%2)k(Error("Uneven number of arguments"));var b={};for(var c=0;c<a;c+=2)b[arguments[c]]=arguments[c+1];return b},mc=function(){var a=arguments.length;if(a==1&&ka(arguments[0]))return mc.apply(h,arguments[0]);var b={};for(var c=0;c<a;c++)b[arguments[c]]=j;return b};var nc=function(a){if(typeof a.Pa=="function")return a.Pa();if(la(a)||ma(a))return a.length;return Zb(a)},oc=function(a){if(typeof a.Ob=="function")return a.Ob();if(ma(a))return a.split("");if(la(a)){var b=[],c=a.length;for(var d=0;d<c;d++)b.push(a[d]);return b}return ac(a)},pc=function(a){if(typeof a.Lf=="function")return a.Lf();if(typeof a.Ob=="function")return undefined;if(la(a)||ma(a)){var b=[],c=a.length;for(var d=0;d<c;d++)b.push(d);return b}return bc(a)},qc=function(a,b){if(typeof a.contains==
"function")return a.contains(b);if(typeof a.So=="function")return a.So(b);if(la(a)||ma(a))return Cb(a,b);return cc(a,b)},rc=function(a,b,c){if(typeof a.forEach=="function")a.forEach(b,c);else if(la(a)||ma(a))tb(a,b,c);else{var d=pc(a),f=oc(a),g=f.length;for(var i=0;i<g;i++)b.call(c,f[i],d&&d[i],a)}},sc=function(a,b,c){if(typeof a.every=="function")return a.every(b,c);if(la(a)||ma(a))return zb(a,b,c);var d=pc(a),f=oc(a),g=f.length;for(var i=0;i<g;i++)if(!b.call(c,f[i],d&&d[i],a))return e;return j};var tc=function(a){this.Sa={};this.ba=[];var b=arguments.length;if(b>1){if(b%2)k(Error("Uneven number of arguments"));for(var c=0;c<b;c+=2)this.h(arguments[c],arguments[c+1])}else a&&this.Fk(a)};o=tc.prototype;o.aa=0;o.vk=0;o.Pa=function(){return this.aa};o.Ob=function(){this.si();var a=[];for(var b=0;b<this.ba.length;b++)a.push(this.Sa[this.ba[b]]);return a};o.Lf=function(){this.si();return this.ba.concat()};o.Lc=function(a){return uc(this.Sa,a)};
o.So=function(a){for(var b=0;b<this.ba.length;b++){var c=this.ba[b];if(uc(this.Sa,c)&&this.Sa[c]==a)return j}return e};o.yl=function(a,b){if(this===a)return j;if(this.aa!=a.Pa())return e;var c=b||vc;this.si();for(var d,f=0;d=this.ba[f];f++)if(!c(this.Ea(d),a.Ea(d)))return e;return j};var vc=function(a,b){return a===b};o=tc.prototype;o.ke=function(){return this.aa==0};o.clear=function(){this.Sa={};this.ba.length=0;this.aa=0;this.vk=0};
o.remove=function(a){if(uc(this.Sa,a)){delete this.Sa[a];this.aa--;this.vk++;this.ba.length>2*this.aa&&this.si();return j}return e};o.si=function(){if(this.aa!=this.ba.length){var a=0,b=0;while(a<this.ba.length){var c=this.ba[a];if(uc(this.Sa,c))this.ba[b++]=c;a++}this.ba.length=b}if(this.aa!=this.ba.length){var d={},a=0,b=0;while(a<this.ba.length){var c=this.ba[a];if(!uc(d,c)){this.ba[b++]=c;d[c]=1}a++}this.ba.length=b}};o.Ea=function(a,b){if(uc(this.Sa,a))return this.Sa[a];return b};
o.h=function(a,b){if(!uc(this.Sa,a)){this.aa++;this.ba.push(a);this.vk++}this.Sa[a]=b};o.Fk=function(a){var b,c;if(a instanceof tc){b=a.Lf();c=a.Ob()}else{b=bc(a);c=ac(a)}for(var d=0;d<b.length;d++)this.h(b[d],c[d])};o.za=function(){return new tc(this)};o.Ld=function(a){this.si();var b=0,c=this.ba,d=this.Sa,f=this.vk,g=this,i=new Tb;i.next=function(){while(j){if(f!=g.vk)k(Error("The map has changed since the iterator was created"));if(b>=c.length)k(Sb);var l=c[b++];return a?l:d[l]}};return i};
if(Object.prototype.hasOwnProperty)var uc=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};else uc=function(a,b){return b in a&&a[b]!==Object.prototype[b]};var wc=function(a,b,c){if(typeof a.h=="function")a.h(b,c);else a[b]=c};var xc=function(a){this.Sa=new tc;a&&this.Fk(a)},yc=function(a){var b=typeof a;return b=="object"?"o"+s(a):b.substr(0,1)+a};o=xc.prototype;o.Pa=function(){return this.Sa.Pa()};o.add=function(a){this.Sa.h(yc(a),a)};o.Fk=function(a){var b=oc(a),c=b.length;for(var d=0;d<c;d++)this.add(b[d])};o.Ya=function(a){var b=oc(a),c=b.length;for(var d=0;d<c;d++)this.remove(b[d])};o.remove=function(a){return this.Sa.remove(yc(a))};o.clear=function(){this.Sa.clear()};o.ke=function(){return this.Sa.ke()};
o.contains=function(a){return this.Sa.Lc(yc(a))};o.Ob=function(){return this.Sa.Ob()};o.za=function(){return new xc(this)};o.yl=function(a){return this.Pa()==nc(a)&&this.qI(a)};o.qI=function(a){var b=nc(a);if(this.Pa()>b)return e;if(!(a instanceof xc)&&b>5)a=new xc(a);return sc(this,function(c){return qc(a,c)})};o.Ld=function(){return this.Sa.Ld(e)};var zc={},Ac;var Bc=function(){};o=Bc.prototype;o.up=e;o.Sq=function(){return this.up};o.mF=Bc.prototype.Sq;o.k=function(){if(!this.up){this.l();this.up=j}};o.l=function(){};var G=function(a,b){this.type=a;this.target=b;this.currentTarget=this.target};z(G,Bc);o=G.prototype;o.l=function(){delete this.type;delete this.target;delete this.currentTarget};o.af=e;o.Fh=j;o.stopPropagation=function(){this.af=j};o.preventDefault=function(){this.Fh=e};var Cc=function(a,b){Bc.call(this);this.cg=b;this.Eb=[];this.zD(a)};z(Cc,Bc);o=Cc.prototype;o.ap=h;o.tp=h;o.Yj=function(a){this.ap=a};o.Oz=function(a){this.tp=a};o.Pc=function(){if(this.Eb.length)return this.Eb.pop();return this.zi()};o.bf=function(a){this.Eb.length<this.cg?this.Eb.push(a):this.xf(a)};o.zD=function(a){if(a>this.cg)k(Error("[goog.structs.SimplePool] Initial cannot be greater than max"));for(var b=0;b<a;b++)this.Eb.push(this.zi())};o.zi=function(){return this.ap?this.ap():{}};
o.xf=function(a){if(this.tp)this.tp(a);else if(oa(a.k))a.k();else for(var b in a)delete a[b]};o.l=function(){Cc.d.l.call(this);var a=this.Eb;while(a.length)this.xf(a.pop());delete this.Eb};var Dc=function(a,b){a&&this.om(a,b)};z(Dc,G);var Ec=[1,4,2];o=Dc.prototype;o.type=h;o.target=h;o.relatedTarget=h;o.offsetX=0;o.offsetY=0;o.clientX=0;o.clientY=0;o.screenX=0;o.screenY=0;o.button=0;o.keyCode=0;o.charCode=0;o.ctrlKey=e;o.altKey=e;o.shiftKey=e;o.metaKey=e;o.fb=h;
o.om=function(a,b){this.type=a.type;this.target=a.target||a.srcElement;this.currentTarget=b;this.relatedTarget=a.relatedTarget?a.relatedTarget:this.type==Fc?a.fromElement:this.type==Gc?a.toElement:h;this.offsetX=typeof a.layerX=="number"?a.layerX:a.offsetX;this.offsetY=typeof a.layerY=="number"?a.layerY:a.offsetY;this.clientX=typeof a.clientX=="number"?a.clientX:a.pageX;this.clientY=typeof a.clientY=="number"?a.clientY:a.pageY;this.screenX=a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;
this.keyCode=a.keyCode||0;this.charCode=a.charCode||(this.type==Hc?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.fb=a;delete this.Fh;delete this.af};o.Ex=function(a){return B?this.type==Ic?a==0:!!(this.fb.button&Ec[a]):F&&!qb("420")?this.fb.button==1&&a==0:this.fb.button==a};o.stopPropagation=function(){this.af=j;if(this.fb.stopPropagation)this.fb.stopPropagation();else this.fb.cancelBubble=j};
o.preventDefault=function(){this.Fh=e;if(this.fb.preventDefault)this.fb.preventDefault();else{this.fb.returnValue=e;try{this.fb.keyCode=-1}catch(a){}}};o.Tv=function(){return this.fb};o.l=function(){Dc.d.l.call(this);this.fb=h};var Jc=function(){},Kc=0;o=Jc.prototype;o.Wq=h;o.bg=h;o.cz=h;o.src=h;o.type=h;o.capture=h;o.pj=h;o.Qb=0;o.Eh=e;o.Eo=e;o.om=function(a,b,c,d,f,g){if(oa(a))this.Wq=j;else if(a&&a.handleEvent&&oa(a.handleEvent))this.Wq=e;else k(Error("Invalid listener argument"));this.bg=a;this.cz=b;this.src=c;this.type=d;this.capture=!!f;this.pj=g;this.Eo=e;this.Qb=++Kc;this.Eh=e};o.handleEvent=function(a){if(this.Wq)return this.bg.call(this.pj||this.src,a);return this.bg.handleEvent.call(this.bg,a)};var Lc={},Mc={},Nc={},Oc=new Cc(0,600);Oc.Yj(function(){return{aa:0}});Oc.Oz(function(a){a.aa=0});var Pc=new Cc(0,600);Pc.Yj(function(){return[]});Pc.Oz(function(a){a.length=0;delete a.vh;delete a.ur});var Qc=new Cc(0,600);Qc.Yj(function(){var a=function(b){return Rc.call(a.src,a.Qb,b)};return a});var Sc=function(){return new Jc},Uc=new Cc(0,600);Uc.Yj(Sc);
var Vc=function(){return new Dc},Wc=(function(){var a=h;if(B){a=new Cc(0,600);a.Yj(Vc)}return a})(),Xc="on",Yc={},H=function(a,b,c,d,f){if(b)if(ka(b)){for(var g=0;g<b.length;g++)H(a,b[g],c,d,f);return h}else{var i=!!d,l=Mc;b in l||(l[b]=Oc.Pc());l=l[b];if(!(i in l)){l[i]=Oc.Pc();l.aa++}l=l[i];var m=s(a),n,q;if(l[m]){n=l[m];for(var g=0;g<n.length;g++){q=n[g];if(q.bg==c&&q.pj==f){if(q.Eh)break;return n[g].Qb}}}else{n=l[m]=Pc.Pc();l.aa++}var r=Qc.Pc();r.src=a;q=Uc.Pc();q.om(c,r,a,b,i,f);var t=q.Qb;r.Qb=
t;n.push(q);Lc[t]=q;Nc[m]||(Nc[m]=Pc.Pc());Nc[m].push(q);if(a.addEventListener){if(a==p||!a.Mu)a.addEventListener(b,r,i)}else a.attachEvent(Zc(b),r);return t}else k(Error("Invalid event type"))},$c=function(a,b,c,d,f){if(ka(b)){for(var g=0;g<b.length;g++)$c(a,b[g],c,d,f);return h}var i=H(a,b,c,d,f);Lc[i].Eo=j;return i},ad=function(a,b,c,d,f){if(ka(b)){for(var g=0;g<b.length;g++)ad(a,b[g],c,d,f);return h}var i=!!d,l=bd(a,b,i);if(!l)return e;for(var g=0;g<l.length;g++)if(l[g].bg==c&&l[g].capture==i&&
l[g].pj==f)return cd(l[g].Qb);return e},cd=function(a){if(!Lc[a])return e;var b=Lc[a];if(b.Eh)return e;var c=b.src,d=b.type,f=b.cz,g=b.capture;if(c.removeEventListener){if(c==p||!c.Mu)c.removeEventListener(d,f,g)}else c.detachEvent&&c.detachEvent(Zc(d),f);var i=s(c),l=Mc[d][g][i];if(Nc[i]){var m=Nc[i];Hb(m,b);m.length==0&&delete Nc[i]}b.Eh=j;l.ur=j;dd(d,g,i,l);delete Lc[a];return j},dd=function(a,b,c,d){if(!d.vh)if(d.ur){for(var f=0,g=0;f<d.length;f++){if(d[f].Eh){Uc.bf(d[f]);continue}if(f!=g)d[g]=
d[f];g++}d.length=g;d.ur=e;if(g==0){Pc.bf(d);delete Mc[a][b][c];Mc[a][b].aa--;if(Mc[a][b].aa==0){Oc.bf(Mc[a][b]);delete Mc[a][b];Mc[a].aa--}if(Mc[a].aa==0){Oc.bf(Mc[a]);delete Mc[a]}}}},ed=function(a,b,c){var d=0,f=a==h,g=b==h,i=c==h;c=!!c;if(f)Yb(Nc,function(r){for(var t=r.length-1;t>=0;t--){var v=r[t];if((g||b==v.type)&&(i||c==v.capture)){cd(v.Qb);d++}}});else{var l=s(a);if(Nc[l]){var m=Nc[l];for(var n=m.length-1;n>=0;n--){var q=m[n];if((g||b==q.type)&&(i||c==q.capture)){cd(q.Qb);d++}}}}return d},
bd=function(a,b,c){var d=Mc;if(b in d){d=d[b];if(c in d){d=d[c];var f=s(a);if(d[f])return d[f]}}return h},fd=function(a,b,c,d,f){var g=!!d,i=bd(a,b,g);if(i)for(var l=0;l<i.length;l++)if(i[l].bg==c&&i[l].capture==g&&i[l].pj==f)return i[l];return h},Ic="click",gd="mousedown",hd="mouseup",Fc="mouseover",Gc="mouseout",id="mousemove",Hc="keypress",jd="keydown",kd="focus",ld=B?"focusin":"DOMFocusIn",md="select",nd="resize",od="readystatechange",pd="contextmenu",Zc=function(a){if(a in Yc)return Yc[a];return Yc[a]=
Xc+a},rd=function(a,b,c,d){var f=1,g=Mc;if(b in g){g=g[b];if(c in g){g=g[c];var i=s(a);if(g[i]){var l=g[i];if(l.vh)l.vh++;else l.vh=1;try{var m=l.length;for(var n=0;n<m;n++){var q=l[n];if(q&&!q.Eh)f&=qd(q,d)!==e}}finally{l.vh--;dd(b,c,i,l)}}}}return Boolean(f)},qd=function(a,b){var c=a.handleEvent(b);a.Eo&&cd(a.Qb);return c},sd=function(a,b){if(ma(b))b=new G(b,a);else if(b instanceof G)b.target=b.target||a;else{var c=b;b=new G(b.type,a);kc(b,c)}var d=1,f,g=b.type,i=Mc;if(!(g in i))return j;i=i[g];
var l=j in i,m=e in i;if(l){f=[];for(var n=a;n;n=n.$i())f.push(n);for(var q=f.length-1;!b.af&&q>=0;q--){b.currentTarget=f[q];d&=rd(f[q],b.type,j,b)&&b.Fh!=e}}if(m)if(l)for(var q=0;!b.af&&q<f.length;q++){b.currentTarget=f[q];d&=rd(f[q],b.type,e,b)&&b.Fh!=e}else for(var r=a;!b.af&&r;r=r.$i()){b.currentTarget=r;d&=rd(r,b.type,e,b)&&b.Fh!=e}return Boolean(d)},Rc=function(a,b){if(!Lc[a])return j;var c=Lc[a],d=c.type,f=Mc;if(!(d in f))return j;f=f[d];var g;if(B){var i=b||da("window.event"),l=j in f;if(l){if(i.keyCode<
0||i.returnValue!=undefined)return j;td(i)}s(c.src);var m=Wc.Pc();m.om(i,this);g=j;try{if(l){var n=Pc.Pc();for(var q=m.currentTarget;q;q=q.parentNode)n.push(q);for(var r=n.length-1;!m.af&&r>=0;r--){m.currentTarget=n[r];g&=rd(n[r],d,j,m)}for(var r=0;!m.af&&r<n.length;r++){m.currentTarget=n[r];g&=rd(n[r],d,e,m)}}else g=qd(c,m)}finally{if(n){n.length=0;Pc.bf(n)}m.k();Wc.bf(m)}return g}var t=new Dc(b,this);try{g=qd(c,t)}finally{t.k()}return g},td=function(a){var b=e;if(a.keyCode==0)try{a.keyCode=-1;return}catch(c){b=
j}if(b||a.returnValue==undefined)a.returnValue=j};var I=function(){};z(I,Bc);o=I.prototype;o.Mu=j;o.Fr=h;o.$i=function(){return this.Fr};o.Uz=function(a){this.Fr=a};o.addEventListener=function(a,b,c,d){H(this,a,b,c,d)};o.removeEventListener=function(a,b,c,d){ad(this,a,b,c,d)};o.dispatchEvent=function(a){return sd(this,a)};o.l=function(){I.d.l.call(this);ed(this);this.Fr=h};var ud=function(a){return function(){return a}},vd=ud(e);var K={Cg:"+undo",Ag:"+redo",dd:"+link",ci:"+formatBlock",io:"+indent",ko:"+outdent",ii:"+removeFormat",lo:"+strikeThrough",ho:"+insertHorizontalRule",Dk:"+subscript",Ek:"+superscript",Bg:"+underline",Ft:"+unlink",xg:"+bold",zg:"+italic",fo:"+fontSize",eo:"+fontName",bi:"+foreColor",tt:"+emoticon",zk:"+backColor",hi:"+insertOrderedList",ki:"+insertUnorderedList",vB:"+table",di:"+justifyCenter",ei:"+justifyFull",gi:"+justifyRight",fi:"+justifyLeft",qt:"+BLOCKQUOTE",Ak:"ltr",ai:"rtl",ye:"clearlorem",
li:"updatelorem",Ht:"usinglorem"},wd={dB:"image",oB:"spChar",Bk:"editHtml",st:"editImage",dd:"link",eB:"insertModule"};var xd=function(){I.call(this);this.Xb=this.no()};z(xd,I);xd.prototype.p=h;xd.prototype.Fb=function(){return this.p&&this.p.Cb};xd.prototype.kC=j;o=xd.prototype;o.ig=function(a){this.p=a};o.sk=function(){if(this.p){this.wf(this.p);this.p=h}};o.Vg=function(a){if(this.p==a)this.Xb=j};o.wf=function(a){if(this.p==a)this.Xb=e};o.J=function(a){return this.p==a?this.Xb:e};o.no=vd;o.Px=vd;o.l=function(){this.p&&this.sk(this.p);xd.d.l.call(this)};
o.execCommand=function(a){var b=this.Px(a);if(!b){E&&this.p.ve(j,j);this.p.kd()}try{var c=this.Kp.apply(this,arguments)}finally{if(!b){this.p.ra();a!=K.dd&&this.p.Sg()}}return c};o.Yf=function(){return e};var yd=function(a,b){this.x=ba(a)?a:0;this.y=ba(b)?b:0};yd.prototype.za=function(){return new yd(this.x,this.y)};yd.prototype.toString=function(){return"("+this.x+", "+this.y+")"};var zd=function(a,b){var c=a.x-b.x,d=a.y-b.y;return c*c+d*d};var Bd=function(a,b){I.call(this);this.ie=a||1;this.nk=b||Ad;this.Bo=u(this.XL,this);this.ir=ua()};z(Bd,I);Bd.prototype.enabled=e;var Ad=p.window;o=Bd.prototype;o.ab=h;o.setInterval=function(a){this.ie=a;if(this.ab&&this.enabled){this.stop();this.start()}else this.ab&&this.stop()};o.XL=function(){if(this.enabled){var a=ua()-this.ir;if(a>0&&a<this.ie*0.8){this.ab=this.nk.setTimeout(this.Bo,this.ie-a);return}this.fE();if(this.enabled){this.ab=this.nk.setTimeout(this.Bo,this.ie);this.ir=ua()}}};
o.fE=function(){this.dispatchEvent("tick")};o.start=function(){this.enabled=j;if(!this.ab){this.ab=this.nk.setTimeout(this.Bo,this.ie);this.ir=ua()}};o.stop=function(){this.enabled=e;if(this.ab){this.nk.clearTimeout(this.ab);this.ab=h}};o.l=function(){Bd.d.l.call(this);this.stop();delete this.nk};var Cd=function(a,b,c){if(oa(a)){if(c)a=u(a,c)}else if(a&&typeof a.handleEvent=="function")a=u(a.handleEvent,a);else k(Error("Invalid listener argument"));return Ad.setTimeout(a,b||0)},Dd=function(a){Ad.clearTimeout(a)};var Ed=function(a,b,c){this.Cj=a;this.ie=b||0;this.C=c;this.Bc=u(this.Xd,this)};z(Ed,Bc);o=Ed.prototype;o.Ib=0;o.l=function(){Ed.d.l.call(this);this.stop();delete this.Cj;delete this.C};o.start=function(a){this.stop();this.Ib=Cd(this.Bc,ba(a)?a:this.ie)};o.stop=function(){this.td()&&Dd(this.Ib);this.Ib=0};o.Np=function(){this.stop();this.Xd()};o.Mi=function(){this.td()&&this.Np()};o.td=function(){return this.Ib!=0};o.Xd=function(){this.Ib=0;this.Cj&&this.Cj.call(this.C)};var Fd=function(a,b){this.width=a;this.height=b},Gd=function(a,b){if(a==b)return j;if(!a||!b)return e;return a.width==b.width&&a.height==b.height};o=Fd.prototype;o.za=function(){return new Fd(this.width,this.height)};o.toString=function(){return"("+this.width+" x "+this.height+")"};o.$B=function(){return this.width*this.height};o.ke=function(){return!this.$B()};o.ceil=function(){this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};
o.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};o.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};var Hd,Id=function(a,b){a.className=b},Jd=function(a){var b=a.className;return b&&typeof b.split=="function"?b.split(" "):[]},Kd=function(a){var b=Jd(a),c=1;for(var d=1;d<arguments.length;d++)if(Cb(b,arguments[d]))c&=0;else{b.push(arguments[d]);c&=1}a.className=b.join(" ");return Boolean(c)},Ld=function(a){var b=Jd(a),c=Lb(arguments,1),d=0;for(var f=0;f<b.length;f++)if(Cb(c,b[f])){Eb(b,f--,1);d++}a.className=b.join(" ");return d==c.length},Md=function(a,b,c){var d=Jd(a),f=e;for(var g=0;g<d.length;g++)if(d[g]==
b){Eb(d,g--,1);f=j}if(f){d.push(c);a.className=d.join(" ")}return f},Nd=function(a,b){return Cb(Jd(a),b)},Od=function(a,b,c){c?Kd(a,b):Ld(a,b)};var Qd=function(){Hd||(Hd=new Pd);return Hd},N=function(a){return a?new Pd(M(a)):Qd()};
var O=function(a){return ma(a)?document.getElementById(a):a},Rd=function(a,b,c){return Qd().eh(a,b,c)},Td=function(a,b){Yb(b,function(c,d){if(d=="style")a.style.cssText=c;else if(d=="class")a.className=c;else if(d=="for")a.htmlFor=c;else if(d in Sd)a.setAttribute(Sd[d],c);else a[d]=c})},Sd={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder"},Ud=function(a){var b=a||p||window,
c=b.document;if(F&&!qb("500")&&!pb){if(typeof b.innerHeight=="undefined")b=window;var d=b.innerHeight,f=b.document.documentElement.scrollHeight;if(b==b.top)if(f<d)d-=15;return new Fd(b.innerWidth,d)}var g=N(c).Zp()=="CSS1Compat"&&(!A||A&&qb("9.50"))?c.documentElement:c.body;return new Fd(g.clientWidth,g.clientHeight)},Vd=function(a){return N((a||p||window).document).od()},Wd=function(a){return N(a).$()},Xd=function(){var a=Qd();return a.f.apply(a,arguments)},Yd=Xd;
var Zd=function(a){if(a.nodeType!=1)return e;if("canHaveChildren"in a)return a.canHaveChildren;switch(a.tagName){case "APPLET":case "AREA":case "BR":case "COL":case "FRAME":case "HR":case "IMG":case "INPUT":case "IFRAME":case "ISINDEX":case "LINK":case "NOFRAMES":case "NOSCRIPT":case "META":case "OBJECT":case "PARAM":case "SCRIPT":case "STYLE":return e}return j},P=function(a,b){a.appendChild(b)},$d=function(a){var b;while(b=a.firstChild)a.removeChild(b)},ae=function(a,b){b.parentNode&&b.parentNode.insertBefore(a,
b)},be=function(a,b){b.parentNode&&b.parentNode.insertBefore(a,b.nextSibling)},Q=function(a){return a&&a.parentNode?a.parentNode.removeChild(a):h},ce=function(a,b){var c=b.parentNode;c&&c.replaceChild(a,b)},ee=function(a){var b,c=a.parentNode;if(c&&c.nodeType!=11)if(a.removeNode)return a.removeNode(e);else{while(b=a.firstChild)c.insertBefore(b,a);return Q(a)}},ge=function(a){return fe(a.firstChild,j)};var fe=function(a,b){while(a&&a.nodeType!=1)a=b?a.nextSibling:a.previousSibling;return a};
var he=F&&Za(ib,"521")<=0,ie=function(a,b){if(typeof a.contains!="undefined"&&!he&&b.nodeType==1)return a==b||a.contains(b);if(typeof a.compareDocumentPosition!="undefined")return a==b||Boolean(a.compareDocumentPosition(b)&16);while(b&&a!=b)b=b.parentNode;return b==a},le=function(a,b){if(a==b)return 0;if(a.compareDocumentPosition)return a.compareDocumentPosition(b)&2?1:-1;if("sourceIndex"in a||a.parentNode&&"sourceIndex"in a.parentNode){var c=a.nodeType==1,d=b.nodeType==1;if(c&&d)return a.sourceIndex-
b.sourceIndex;else{var f=a.parentNode,g=b.parentNode;if(f==g)return je(a,b);if(!c&&ie(f,b))return-1*ke(a,b);if(!d&&ie(g,a))return ke(b,a);return(c?a.sourceIndex:f.sourceIndex)-(d?b.sourceIndex:g.sourceIndex)}}var i=M(a),l,m;l=i.createRange();l.selectNode(a);l.collapse(j);m=i.createRange();m.selectNode(b);m.collapse(j);return l.compareBoundaryPoints(p.Range.START_TO_END,m)},ke=function(a,b){var c=a.parentNode;if(c==b)return-1;var d=b;while(d.parentNode!=c)d=d.parentNode;return je(d,a)},je=function(a,
b){var c=b;while(c=c.previousSibling)if(c==a)return-1;return 1},me=function(){var a,b=arguments.length;if(!b)return h;else if(b==1)return arguments[0];var c=[],d=Infinity;for(a=0;a<b;a++){var f=[],g=arguments[a];while(g){f.unshift(g);g=g.parentNode}c.push(f);d=Math.min(d,f.length)}var i=h;for(a=0;a<d;a++){var l=c[0][a];for(var m=1;m<b;m++)if(l!=c[m][a])return i;i=l}return i},M=function(a){return a.nodeType==9?a:a.ownerDocument||a.document},ne=function(a){var b;b=F?a.document||a.contentWindow.document:
a.contentDocument||a.contentWindow.document;return b},oe=function(a,b){if("textContent"in a)a.textContent=b;else if(a.firstChild&&a.firstChild.nodeType==3){while(a.lastChild!=a.firstChild)a.removeChild(a.lastChild);a.firstChild.data=b}else{$d(a);var c=M(a);a.appendChild(c.createTextNode(b))}},pe=function(a){if("outerHTML"in a)return a.outerHTML;else{var b=M(a).createElement("div");b.appendChild(a.cloneNode(j));return b.innerHTML}},re=function(a,b){var c=[];qe(a,b,c,j);return c.length?c[0]:undefined},
qe=function(a,b,c,d){if(a!=h)for(var f=0,g;g=a.childNodes[f];f++){if(b(g)){c.push(g);if(d)return}qe(g,b,c,d)}},se={SCRIPT:1,STYLE:1,HEAD:1,IFRAME:1,OBJECT:1},te={IMG:" ",BR:"\n"},ue=function(a){var b=a.getAttributeNode("tabindex");if(b&&b.specified){var c=a.tabIndex;return na(c)&&c>=0}return e},ve=function(a,b){if(b)a.tabIndex=0;else a.removeAttribute("tabIndex")},xe=function(a){var b;if(B&&"innerText"in a)b=a.innerText.replace(/(\r\n|\r|\n)/g,"\n");else{var c=[];we(a,c,j);b=c.join("")}b=b.replace(/\xAD/g,
"");b=b.replace(/ +/g," ");if(b!=" ")b=b.replace(/^\s*/,"");return b},ye=function(a){var b=[];we(a,b,e);return b.join("")},we=function(a,b,c){if(!(a.nodeName in se))if(a.nodeType==3)c?b.push(String(a.nodeValue).replace(/(\r\n|\r|\n)/g,"")):b.push(a.nodeValue);else if(a.nodeName in te)b.push(te[a.nodeName]);else{var d=a.firstChild;while(d){we(d,b,c);d=d.nextSibling}}},ze=function(a){if(a&&typeof a.length=="number")if(pa(a))return typeof a.item=="function"||typeof a.item=="string";else if(oa(a))return typeof a.item==
"function";return e},Be=function(a,b,c){return Ae(a,function(d){return(!b||d.nodeName==b)&&(!c||Nd(d,c))},j)},Ae=function(a,b,c){if(!c)a=a.parentNode;while(a){if(b(a))return a;a=a.parentNode}return h},Pd=function(a){this.mb=a||p.document||document};o=Pd.prototype;o.s=function(){return this.mb};o.b=function(a){return ma(a)?this.mb.getElementById(a):a};o.ot=Pd.prototype.b;
o.eh=function(a,b,c){var d=c||this.mb,f=a&&a!="*"?a.toLowerCase():"";if(d.querySelectorAll&&(f||b)&&(!F||this.Zp()=="CSS1Compat"||qb("528")))return d.querySelectorAll(f+(b?"."+b:""));if(b&&d.getElementsByClassName){var g=d.getElementsByClassName(b);if(f){var i=[];for(var l=0,m;m=g[l];l++)f==m.nodeName.toLowerCase()&&i.push(m);return i}else return g}var g=d.getElementsByTagName(f||"*");if(b){var i=[];for(var l=0,m;m=g[l];l++){var n=m.className;typeof n.split=="function"&&Cb(n.split(" "),b)&&i.push(m)}return i}else return g};
o.$n=Pd.prototype.eh;o.f=function(a,b){if(B&&b&&b.name)a="<"+a+' name="'+Na(b.name)+'">';var c=this.createElement(a);b&&Td(c,b);if(arguments.length>2){function d(i){if(i)this.appendChild(c,ma(i)?this.createTextNode(i):i)}for(var f=2;f<arguments.length;f++){var g=arguments[f];la(g)&&!(pa(g)&&g.nodeType>0)?tb(ze(g)?Ib(g):g,d,this):d.call(this,g)}}return c};o.createElement=function(a){return this.mb.createElement(a)};o.createTextNode=function(a){return this.mb.createTextNode(a)};
o.Zp=function(){if(this.mb.compatMode)return this.mb.compatMode;if(F)return this.mb.compatMode=this.f("div",{style:"position:absolute;width:0;height:0;width:1"}).style.width=="1px"?"BackCompat":"CSS1Compat";return"BackCompat"};o.$=function(){var a=this.mb;if(a.parentWindow)return a.parentWindow;if(F&&!qb("500")&&!pb){var b=a.createElement("script");b.innerHTML="document.parentWindow=window";var c=a.documentElement;c.appendChild(b);c.removeChild(b);return a.parentWindow}return a.defaultView};
o.od=function(){var a=this.mb,b,c;if(!F&&a.compatMode=="CSS1Compat"){b=a.documentElement.scrollLeft;c=a.documentElement.scrollTop}else{b=a.body.scrollLeft;c=a.body.scrollTop}return new yd(b,c)};o.appendChild=P;o.removeNode=Q;o.replaceNode=ce;o.CE=ee;o.hw=ge;o.contains=ie;o.qw=M;o.tL=oe;var Ce=function(){Bc.call(this)};z(Ce,Bc);Ce.prototype.restore=function(a){this.Sq();var b=this.en();a||this.k();return b};var De=function(a){Ce.call(this);this.oA=ab();this.rv=ab();this.g=N(a.s());a.mk(this.Eu(j),this.Eu(e))};z(De,Ce);o=De.prototype;o.bh=function(a){return this.g.ot(a?this.oA:this.rv)};o.kz=function(){Q(this.bh(j));Q(this.bh(e))};o.en=function(){var a=this.bh(j),b=this.bh(e);a&&b&&Ee(a,0,b,0).select();this.kz()};o.l=function(){this.kz();this.g=h};o.Eu=function(a){return this.g.f("SPAN",{id:a?this.oA:this.rv})};var Fe=function(a,b,c,d,f){this.Wc=!!b;a&&this.setPosition(a,d);this.Mc=f!=undefined?f:this.mc||0;if(this.Wc)this.Mc*=-1;this.cl=!c};z(Fe,Tb);o=Fe.prototype;o.M=h;o.mc=h;o.Ms=e;o.setPosition=function(a,b,c){this.M=a;if(a)this.mc=na(b)?b:this.M.nodeType!=1?0:this.Wc?-1:1;if(na(c))this.Mc=c};o.Sd=function(a){this.M=a.M;this.mc=a.mc;this.Mc=a.Mc;this.Wc=a.Wc;this.cl=a.cl};o.za=function(){return new Fe(this.M,this.Wc,!this.cl,this.mc,this.Mc)};
o.NL=function(){var a=this.Wc?-1:1;if(this.mc==a){this.mc=a*-1;this.Mc+=this.mc*(this.Wc?-1:1)}};o.next=function(){var a;if(this.Ms){if(!this.M||this.cl&&this.Mc==0)k(Sb);a=this.M;var b=this.Wc?-1:1;if(this.mc==b){var c=this.Wc?a.lastChild:a.firstChild;c?this.setPosition(c):this.setPosition(a,b*-1)}else{var d=this.Wc?a.previousSibling:a.nextSibling;d?this.setPosition(d):this.setPosition(a.parentNode,b*-1)}this.Mc+=this.mc*(this.Wc?-1:1)}else this.Ms=j;a=this.M;if(!this.M)k(Sb);return a};
o.Ix=function(){return this.mc==-1};o.yl=function(a){return a.M==this.M&&(!this.M||a.mc==this.mc)};var Ge=function(){},He=function(a){if(a.getSelection)return a.getSelection();else{var b=a.document;return b.selection||b.getSelection&&b.getSelection()}};o=Ge.prototype;o.Tj=function(){return e};o.Oe=function(){var a=[];for(var b=0,c=this.Pf();b<c;b++)a.push(this.$b(b));return a};o.$p=function(){var a=this.sc();return a.nodeType==1?a:a.parentNode};o.Oi=function(){return this.ne()?this.ha():this.Q()};o.Jl=function(){return this.ne()?this.Fa():this.ta()};o.Vi=function(){return this.ne()?this.Q():this.ha()};
o.Wi=function(){return this.ne()?this.ta():this.Fa()};o.ne=function(){return e};o.s=function(){return M(this.Q())};o.$=function(){return Wd(this.s())};o.containsNode=function(a,b){return this.Rd(Ie(a),b)};o.yK=function(){return this.Q()&&this.ha()?new De(this):h};var Je=function(a,b){Fe.call(this,a,b,j)};z(Je,Fe);var Ke=function(){};z(Ke,Ge);Ke.prototype.Rd=function(a,b){var c=this.Oe(),d=a.Oe();return(b?yb:zb)(d,function(f){return yb(c,function(g){return g.Rd(f,b)})})};Ke.prototype.insertNode=function(a,b){b?ae(a,this.Q()):be(a,this.ha())};Ke.prototype.mk=function(a,b){this.insertNode(a,j);this.insertNode(b,e)};var Le=function(a,b,c,d,f){var g;if(a){this.m=a;this.v=b;this.q=c;this.F=d;if(a.nodeType==1&&a.tagName!="BR"){var i=a.childNodes,l=i[b];if(l){this.m=l;this.v=0}else{if(i.length)this.m=rb(i);g=j}}if(c.nodeType==1){this.q=c.childNodes[d];if(this.q)this.F=0;else this.q=c}}Je.call(this,f?this.q:this.m,f);if(g)try{this.next()}catch(m){if(m!=Sb)k(m)}};z(Le,Je);o=Le.prototype;o.m=h;o.q=h;o.v=0;o.F=0;o.Zl=function(){return this.M.nodeType!=3?-1:this.M==this.m?this.v:0};
o.Nl=function(){return this.M.nodeType!=3?-1:this.M==this.q?this.F:this.M.nodeValue.length};o.Q=function(){return this.m};o.ha=function(){return this.q};o.vj=function(){return this.Ms&&this.M==this.q};o.next=function(){if(this.vj())k(Sb);return Le.d.next.call(this)};o.Sd=function(a){this.m=a.m;this.q=a.q;this.v=a.v;this.F=a.F;this.Sc=a.Sc;Le.d.Sd.call(this,a)};o.za=function(){var a=new Le(this.m,this.v,this.q,this.F,this.Sc);a.Sd(this);return a};var Me,Ne;(function(){var a=e,b="0";if("ScriptEngine"in p){a=p.ScriptEngine()=="JScript";if(a)b=p.ScriptEngineMajorVersion()+"."+p.ScriptEngineMinorVersion()+"."+p.ScriptEngineBuildVersion()}Me=a;Ne=b})();var Oe=function(a){this.hd=Me?[]:"";a!=h&&this.Y.apply(this,arguments)};Oe.prototype.h=function(a){this.clear();this.Y(a)};if(Me){Oe.prototype.Co=0;Oe.prototype.Y=function(a,b){if(b==h)this.hd[this.Co++]=a;else{this.hd.push.apply(this.hd,arguments);this.Co=this.hd.length}return this}}else Oe.prototype.Y=function(a,b){this.hd+=a;if(b!=h)for(var c=1;c<arguments.length;c++)this.hd+=arguments[c];return this};Oe.prototype.clear=function(){if(Me){this.hd.length=0;this.Co=0}else this.hd=""};
Oe.prototype.toString=function(){if(Me){var a=this.hd.join("");this.clear();a&&this.Y(a);return a}else return this.hd};var Pe=function(){};o=Pe.prototype;o.Rd=function(a,b){return this.Ro(a.t,b)};o.Ro=function(a,b){try{return b?this.Pg(a,0,1)>=0&&this.Pg(a,1,0)<=0:this.Pg(a,0,0)>=0&&this.Pg(a,1,1)<=0}catch(c){if(!B)k(c);return e}};o.containsNode=function(a,b){return this.Rd(Qe(a),b)};
o.fh=function(){var a=new Oe;Vb(this,function(b,c,d){if(b.nodeType==3)a.Y(Na(b.nodeValue.substring(d.Zl(),d.Nl())));else if(b.nodeType==1)if(d.Ix())Zd(b)&&a.Y("</"+b.tagName+">");else{var f=b.cloneNode(e),g=pe(f);if(B&&b.tagName=="LI")a.Y(g);else{var i=g.lastIndexOf("<");a.Y(i?g.substr(0,i):g)}}},this);return a.toString()};o.Ld=function(){return new Le(this.Q(),this.ta(),this.ha(),this.Fa())};var Re=function(a){this.t=a};z(Re,Pe);var Se=function(a){var b=M(a).createRange();if(a.nodeType==3){b.setStart(a,0);b.setEnd(a,a.length)}else{var c,d=a;while(c=d.firstChild)d=c;b.setStart(d,0);d=a;while(c=d.lastChild)d=c;b.setEnd(d,d.nodeType==1?d.childNodes.length:d.length)}return b},Te=function(a,b,c,d){var f=M(a).createRange();f.setStart(a,b);f.setEnd(c,d);return f};o=Re.prototype;o.za=function(){return new this.constructor(this.t.cloneRange())};o.sc=function(){return this.t.commonAncestorContainer};
o.Q=function(){return this.t.startContainer};o.ta=function(){return this.t.startOffset};o.ha=function(){return this.t.endContainer};o.Fa=function(){return this.t.endOffset};o.Pg=function(a,b,c){return this.t.compareBoundaryPoints(c==1?b==1?p.Range.START_TO_START:p.Range.START_TO_END:b==1?p.Range.END_TO_START:p.Range.END_TO_END,a)};o.isCollapsed=function(){return this.t.collapsed};o.nb=function(){return this.t.toString()};
o.Qf=function(){var a=N(this.t.startContainer).f("div");a.appendChild(this.t.cloneContents());var b=a.innerHTML;if(b.indexOf("<")==0||!this.isCollapsed()&&this.Q()==this.ha())return b;var c=this.sc();c=c.nodeType==1?c:c.parentNode;return pe(c.cloneNode(e)).replace(">",">"+b)};o.select=function(a){this.bs(Wd(M(this.Q())).getSelection(),a)};o.bs=function(a){a.addRange(this.t)};
o.df=function(){var a=this.t;a.extractContents();if(a.startContainer.hasChildNodes()){var b=a.startContainer.childNodes[a.startOffset];if(b){var c=b.previousSibling;xe(b)==""&&Q(b);c&&xe(c)==""&&Q(c)}}};o.surroundContents=function(a){this.t.surroundContents(a);return a};o.insertNode=function(a,b){var c=this.t.cloneRange();c.collapse(b);c.insertNode(a);c.detach();return a};
o.mk=function(a,b){var c=Wd(M(this.Q())),d=Ue(c);if(d){var f=d.Q(),g=d.ha(),i=d.ta(),l=d.Fa()}var m=this.t.cloneRange(),n=this.t.cloneRange();m.collapse(e);n.collapse(j);m.insertNode(b);n.insertNode(a);m.detach();n.detach();if(d){var q=function(r){return r==a||r==b};if(f.nodeType==3)while(i>f.length){i-=f.length;do{f=f.nextSibling}while(q(f))}if(g.nodeType==3)while(l>g.length){l-=g.length;do{g=g.nextSibling}while(q(g))}Ee(f,i,g,l).select()}};o.collapse=function(a){this.t.collapse(a)};var Ve=function(a){Re.call(this,a)};z(Ve,Re);Ve.prototype.bs=function(a,b){var c=b?this.ha():this.Q(),d=b?this.Fa():this.ta(),f=b?this.Q():this.ha(),g=b?this.ta():this.Fa();a.collapse(c,d);if(c!=f||d!=g)a.extend(f,g)};var We=function(a,b,c,d){Fe.call(this,a,b,c,h,d)};z(We,Fe);We.prototype.next=function(){do{We.d.next.call(this)}while(this.Ix());return this.M};var Xe=function(a,b){this.t=a;this.Yd=b};z(Xe,Pe);
var Ye=function(a){var b=M(a).body.createTextRange();if(a.nodeType==1)b.moveToElementText(a);else{var c=0,d=a;while(d=d.previousSibling){var f=d.nodeType;if(f==3)c+=d.length;else if(f==1){b.moveToElementText(d);break}}d||b.moveToElementText(a.parentNode);b.collapse(!d);c&&b.move("character",c);b.moveEnd("character",a.length)}return b},Ze=function(a,b,c,d){var f,g=e;if(a.nodeType==1){f=a.childNodes[b];g=!f;a=f||a;b=0}var i=Ye(a);b&&i.move("character",b);g&&i.collapse(e);g=e;if(c.nodeType==1){f=c.childNodes[d];
c=f||c;if(c.tagName=="BR")d=1;else{d=0;g=!f}}var l=Ye(c);l.collapse(!g);d&&l.moveEnd("character",d);i.setEndPoint("EndToEnd",l);return i},$e=function(a){var b=new Xe(Ye(a),M(a));b.eg=a;return b};o=Xe.prototype;o.eg=h;o.m=h;o.q=h;o.za=function(){var a=new Xe(this.t.duplicate());a.eg=this.eg;a.m=this.m;a.q=this.q;return a};o.Nb=function(){this.eg=this.m=this.q=h};
o.sc=function(){if(!this.eg){var a=this.t.text;for(var b=1;a.charAt(a.length-b)==" ";b++)this.t.moveEnd("character",-1);var c=this.t.parentElement(),d=Ba(this.t.htmlText);while(d.length>Ba(c.outerHTML).length)c=c.parentNode;while(c.childNodes.length==1&&c.innerText==(c.firstChild.nodeType==3?c.firstChild.nodeValue:c.firstChild.innerText)){if(c.firstChild.tagName=="IMG")break;c=c.firstChild}if(a.length==0)c=this.Dv(c);this.eg=c}return this.eg};
o.Dv=function(a){var b=a.childNodes;for(var c=0,d=b.length;c<d;c++){var f=b[c];if(f.nodeType==1)if(this.t.inRange(Ye(f)))return this.Dv(f)}return a};o.Q=function(){return this.m||(this.m=this.bq(1))};o.ta=function(){return this.Tl(1)};o.ha=function(){return this.q||(this.q=this.bq(0))};o.Fa=function(){return this.Tl(0)};o.Rd=function(a,b){return this.Ro(a.t,b)};o.Pg=function(a,b,c){return this.t.compareEndPoints((b==1?"Start":"End")+"To"+(c==1?"Start":"End"),a)};
o.bq=function(a,b){var c=b||this.sc();if(!c||!c.firstChild){if(a==0&&c.previousSibling&&c.previousSibling.tagName=="BR"&&this.Tl(a,c)==0)c=c.previousSibling;return c.tagName=="BR"?c.parentNode:c}var d=a==1?c.firstChild:c.lastChild;while(d){if(this.containsNode(d,j))return this.bq(a,d);d=a==1?d.nextSibling:d.previousSibling}return c};
o.Tl=function(a,b){var c=b||(a==1?this.Q():this.ha());if(c.nodeType==1){var d=c.childNodes,f=d.length,g=a==1?0:f-1;while(g>=0&&g<f){var i=d[g];if(this.containsNode(i,j)){a==0&&i.previousSibling&&i.previousSibling.tagName=="BR"&&this.Tl(a,i)==0&&g--;break}g+=a==1?1:-1}return g==-1?0:g}else{var l=this.t.duplicate(),m=Ye(c);l.setEndPoint(a==1?"EndToEnd":"StartToStart",m);var n=l.text.length;return a==0?n:c.length-n}};o=Xe.prototype;
o.sh=function(){var a=this.Yd.body.createTextRange();a.moveToElementText(this.Yd.body);return this.Ro(a,j)};o.isCollapsed=function(){return this.t.text==""};o.nb=function(){return this.t.text};o.Qf=function(){return this.t.htmlText};o.select=function(){this.t.select()};
o.df=function(){if(this.t.htmlText){var a=this.Q(),b=this.ha(),c=this.t.text,d=this.t.duplicate();d.moveStart("character",1);d.moveStart("character",-1);if(d.text!=c){var f=new We(a,e,j),g=[];Vb(f,function(q){if(q.nodeType!=3&&this.containsNode(q)){g.push(q);f.NL()}if(q==b)k(Sb)});this.collapse(j);tb(Q,g);this.Nb();return}this.t=d;this.t.text="";this.Nb();var i=this.Q(),l=this.ta();try{var m=a.nextSibling;if(a==b&&a.parentNode&&a.nodeType==3&&m&&m.nodeType==3){a.nodeValue+=m.nodeValue;Q(m);this.t=
Ye(i);this.t.move("character",l);this.Nb()}}catch(n){}}};var af=function(a,b,c){c=c||N(a.parentElement());var d,f=d=b.id;if(!d)d=b.id=ab();a.pasteHTML(b.outerHTML);b=c.ot(d);if(b)f||b.removeAttribute("id");return b};Xe.prototype.surroundContents=function(a){Q(a);a.innerHTML=this.t.htmlText;a=af(this.t,a);a&&this.t.moveToElementText(a);this.Nb();return a};var bf=function(a,b,c,d){d=d||N(a.parentElement());var f;if(b.nodeType!=1){f=b;b=d.f("DIV",h,b)}a.collapse(c);b=af(a,b,d);if(f){d.CE(b);b=f}return b};
Xe.prototype.insertNode=function(a,b){var c=bf(this.t.duplicate(),a,b);this.Nb();return c};Xe.prototype.mk=function(a,b){var c=this.t.duplicate(),d=this.t.duplicate();bf(c,a,j);bf(d,b,e);this.Nb()};Xe.prototype.collapse=function(a){this.t.collapse(a);if(a)this.q=this.m;else this.m=this.q};var cf=function(a){Re.call(this,a)};z(cf,Re);cf.prototype.Pg=function(a,b,c){return this.t.compareBoundaryPoints(c==1?b==1?p.Range.START_TO_START:p.Range.END_TO_START:b==1?p.Range.START_TO_END:p.Range.END_TO_END,a)};cf.prototype.bs=function(a,b){a.removeAllRanges();b?a.setBaseAndExtent(this.ha(),this.Fa(),this.Q(),this.ta()):a.setBaseAndExtent(this.Q(),this.ta(),this.ha(),this.Fa())};var df=function(a){return B?new Xe(a,M(a.parentElement())):F?new cf(a):E?new Ve(a):new Re(a)},Qe=function(a){return B?$e(a):F?new cf(Se(a)):E?new Ve(Se(a)):new Re(Se(a))};var ef=function(){};z(ef,Ge);var ff=function(a,b){var c=new ef;c.Ce=a;c.Sc=!!b;return c},gf=function(a,b){return ff(Qe(a),b)},Ee=function(a,b,c,d){var f=new ef;f.Sc=hf(a,b,c,d);if(a.tagName=="BR"){var g=a.parentNode;b=sb(g.childNodes,a);a=g}if(c.tagName=="BR"){var g=c.parentNode;d=sb(g.childNodes,c);c=g}if(f.Sc){f.m=c;f.v=d;f.q=a;f.F=b}else{f.m=a;f.v=b;f.q=c;f.F=d}return f};o=ef.prototype;o.Ce=h;o.m=h;o.v=h;o.q=h;o.F=h;o.Sc=e;
o.za=function(){var a=new ef;a.Ce=this.Ce;a.m=this.m;a.v=this.v;a.q=this.q;a.F=this.F;a.Sc=this.Sc;return a};o.fj=function(){return"text"};o.gc=function(){return this.wb().t};o.Tj=function(a){if(!!a.addElement)return e;this.Ce=df(a);this.Nb();return j};o.Nb=function(){this.m=this.v=this.q=this.F=h};o.Pf=function(){return 1};o.$b=function(){return this};
o.wb=function(){return this.Ce||(this.Ce=B?new Xe(Ze(this.m,this.v,this.q,this.F),M(this.m)):F?new cf(Te(this.m,this.v,this.q,this.F)):E?new Ve(Te(this.m,this.v,this.q,this.F)):new Re(Te(this.m,this.v,this.q,this.F)))};o.sc=function(){return this.wb().sc()};o.Q=function(){return this.m||(this.m=this.wb().Q())};o.ta=function(){return this.v!=h?this.v:(this.v=this.wb().ta())};o.ha=function(){return this.q||(this.q=this.wb().ha())};o.Fa=function(){return this.F!=h?this.F:(this.F=this.wb().Fa())};
o.ne=function(){return this.Sc};o.Rd=function(a,b){var c=a.fj();if(c=="text")return this.wb().Rd(a.wb(),b);else if(c=="control"){var d=a.dh();return(b?yb:zb)(d,function(f){return this.containsNode(f,b)},this)}};var jf=function(a){if(B){var b=e;try{b=a.parentNode}catch(c){}return!!b}else return ie(a.ownerDocument.body,a)};o=ef.prototype;o.sh=function(){return(!this.m||jf(this.m))&&(!this.q||jf(this.q))&&(!B||this.wb().sh())};o.isCollapsed=function(){return this.wb().isCollapsed()};o.nb=function(){return this.wb().nb()};
o.fh=function(){return this.wb().fh()};o.Qf=function(){return this.wb().Qf()};o.Ld=function(){return new Le(this.Q(),this.ta(),this.ha(),this.Fa())};o.select=function(){this.wb().select(this.Sc)};o.df=function(){this.wb().df();this.Nb()};o.surroundContents=function(a){var b=this.wb().surroundContents(a);this.Nb();return b};o.insertNode=function(a,b){var c=this.wb().insertNode(a,b);this.Nb();return c};o.mk=function(a,b){this.wb().mk(a,b);this.Nb()};o.gn=function(){return new kf(this)};
o.collapse=function(a){var b=this.ne()?!a:a;this.Ce&&this.Ce.collapse(b);if(b){this.q=this.m;this.F=this.v}else{this.m=this.q;this.v=this.F}this.Sc=e};var kf=function(a){this.QB=a.Oi();this.RB=a.Jl();this.FE=a.Vi();this.GE=a.Wi()};z(kf,Ce);kf.prototype.en=function(){return Ee(this.QB,this.RB,this.FE,this.GE)};kf.prototype.l=function(){kf.d.l.call(this);delete this.m;delete this.q};var lf=function(){};z(lf,Ke);var mf=function(a){var b=new lf;b.t=a;return b},nf=function(){var a=M(arguments[0]).body.createControlRange();for(var b=0,c=arguments.length;b<c;b++)a.addElement(arguments[b]);return mf(a)};o=lf.prototype;o.t=h;o.sa=h;o.gk=h;o.Nb=function(){this.sa=h;this.gk=h};o.za=function(){return nf.apply(this,this.dh())};o.fj=function(){return"control"};o.gc=function(){return this.t||document.body.createControlRange()};o.Tj=function(a){if(!!!a.addElement)return e;this.t=a};
o.Pf=function(){return this.t?this.t.length:0};o.$b=function(a){return gf(this.t.item(a))};o.sc=function(){return me.apply(h,this.dh())};o.Q=function(){return this.Yl()[0]};o.ta=function(){return 0};o.ha=function(){var a=this.Yl(),b=rb(a);return Bb(a,function(c){return ie(c,b)})};o.Fa=function(){return this.ha().childNodes.length};o.dh=function(){if(!this.sa){this.sa=[];if(this.t)for(var a=0;a<this.t.length;a++)this.sa.push(this.t.item(a))}return this.sa};
o.Yl=function(){if(!this.gk){this.gk=this.dh().concat();this.gk.sort(function(a,b){return a.sourceIndex-b.sourceIndex})}return this.gk};o.sh=function(){var a=e;try{a=zb(this.dh(),function(c){return B?c.parentNode:ie(c.ownerDocument.body,c)})}catch(b){}return a};o.isCollapsed=function(){return!this.t||!this.t.length};o.nb=function(){return""};o.fh=function(){return wb(this.Yl(),pe).join("")};o.Qf=function(){return this.fh()};o.Ld=function(){return new of(this)};o.select=function(){this.t&&this.t.select()};
o.df=function(){if(this.t){var a=[];for(var b=0,c=this.t.length;b<c;b++)a.push(this.t.item(b));tb(a,Q);this.collapse()}};o.gn=function(){return new pf(this)};o.collapse=function(){this.t=h;this.Nb()};var pf=function(a){this.sa=a.dh()};z(pf,Ce);pf.prototype.en=function(){var a=(this.sa.length?M(this.sa[0]):document).body.createControlRange();for(var b=0,c=this.sa.length;b<c;b++)a.addElement(this.sa[b]);return mf(a)};pf.prototype.l=function(){pf.d.l.call(this);delete this.sa};
var of=function(a){if(a){this.sa=a.Yl();this.m=this.sa.shift();this.q=rb(this.sa)||this.m}Je.call(this,this.m,e)};z(of,Je);o=of.prototype;o.m=h;o.q=h;o.sa=h;o.Zl=function(){return 0};o.Nl=function(){return 0};o.Q=function(){return this.m};o.ha=function(){return this.q};o.vj=function(){return!this.Mc&&!this.sa.length};o.next=function(){if(this.vj())k(Sb);else if(!this.Mc){var a=this.sa.shift();this.setPosition(a,1,1);return a}return of.d.next.call(this)};
o.Sd=function(a){this.sa=a.sa;this.m=a.m;this.q=a.q;of.d.Sd.call(this,a)};o.za=function(){var a=new of(h);a.Sd(this);return a};var qf=function(){this.fd=[];this.Ta=[];this.Vh=h;this.dl=h};z(qf,Ke);var rf=function(a){var b=new qf;for(var c=0,d=a.rangeCount;c<d;c++)b.fd.push(a.getRangeAt(c));return b},sf=function(a){var b=new qf;b.fd=Ib(a);return b},tf=function(a){var b=new qf;b.Ta=a;b.fd=wb(a,function(c){return c.gc()});return b};o=qf.prototype;o.Nb=function(){this.Ta=[];this.Vh=h;this.dl=h};o.za=function(){return sf(this.fd)};o.fj=function(){return"mutli"};o.gc=function(){return this.fd[0]};o.Tj=function(){return e};
o.Pf=function(){return this.fd.length};o.$b=function(a){this.Ta[a]||(this.Ta[a]=ff(df(this.fd[a]),undefined));return this.Ta[a]};o.sc=function(){if(!this.dl){var a=[];for(var b=0,c=this.Pf();b<c;b++)a.push(this.$b(b).sc());this.dl=me.apply(h,a)}return this.dl};o.cj=function(){if(!this.Vh){this.Vh=this.Oe();this.Vh.sort(function(a,b){var c=a.Q(),d=a.ta(),f=b.Q(),g=b.ta();if(c==f&&d==g)return 0;return hf(c,d,f,g)?1:-1})}return this.Vh};o.Q=function(){return this.cj()[0].Q()};o.ta=function(){return this.cj()[0].ta()};
o.ha=function(){return rb(this.cj()).ha()};o.Fa=function(){return rb(this.cj()).Fa()};o.sh=function(){return zb(this.Oe(),function(a){return a.sh()})};o.isCollapsed=function(){return this.fd.length==0||this.fd.length==1&&this.$b(0).isCollapsed()};o.nb=function(){return wb(this.Oe(),function(a){return a.nb()}).join("")};o.fh=function(){return this.Qf()};o.Qf=function(){return wb(this.Oe(),function(a){return a.Qf()}).join("")};o.Ld=function(){return new uf(this)};
o.select=function(){var a=He(this.$());a.removeAllRanges();for(var b=0,c=this.Pf();b<c;b++)a.addRange(this.$b(b).gc())};o.df=function(){tb(this.Oe(),function(a){a.df()})};o.gn=function(){return new vf(this)};o.collapse=function(a){if(!this.isCollapsed()){var b=a?this.$b(0):this.$b(this.Pf()-1);this.Nb();b.collapse(a);this.Ta=[b];this.Vh=[b];this.fd=[b.gc()]}};var vf=function(a){this.Zr=wb(a.Oe(),function(b){return b.gn()})};z(vf,Ce);
vf.prototype.en=function(){var a=wb(this.Zr,function(b){return b.restore()});return tf(a)};vf.prototype.l=function(){vf.d.l.call(this);tb(this.Zr,function(a){a.k()});delete this.Zr};var uf=function(a){if(a){this.Ta=a.cj();if(this.Ta.length){this.m=this.Ta[0].Q();this.q=rb(this.Ta[0]).ha()}}Je.call(this,this.m,e)};z(uf,Je);o=uf.prototype;o.m=h;o.q=h;o.Ta=h;o.Zl=function(){return this.Ta[0].Zl()};o.Nl=function(){return this.Ta[0].Nl()};o.Q=function(){return this.m};o.ha=function(){return this.q};
o.vj=function(){return this.Ta.length==1&&this.Ta[0].vj()};o.next=function(){do{try{this.Ta[0].next();break}catch(a){if(a!=Sb)k(a);this.Ta.shift()}}while(this.Ta.length);if(this.Ta.length){var b=this.Ta[0];this.setPosition(b.M,b.mc,b.Mc);return b.M}else k(Sb)};o.Sd=function(a){this.m=a.m;this.q=a.q;this.Ta=Ib(a.Ta);uf.d.Sd.call(this,a)};o.za=function(){var a=new uf(h);a.Sd(this);return a};var Ue=function(a){var b=He(a||window);return b&&wf(b)},wf=function(a){var b,c=e;if(a.createRange)try{b=a.createRange()}catch(d){return h}else if(a.rangeCount)if(a.rangeCount>1)return new rf(a);else{b=a.getRangeAt(0);c=hf(a.anchorNode,a.anchorOffset,a.focusNode,a.focusOffset)}else return h;return!!b.addElement?mf(b):ff(df(b),c)};var Ie=function(a,b){return ff(Qe(a),b)};
var xf=function(a,b,c,d){return Ee(a,b,c,d)},yf=function(a){var b=He(a||window);if(b.empty)try{b.empty()}catch(c){}else b.removeAllRanges()},hf=function(a,b,c,d){try{if(a==c)return d<b;var f,g,i;if(a.nodeType==1&&b){f=a.childNodes[b];if(!f){f=g=M(a).createElement("SPAN");a.appendChild(f)}a=f;b=0}if(c.nodeType==1&&d){f=c.childNodes[d];if(!f){f=i=M(c).createElement("SPAN");c.appendChild(f)}c=f;d=0}return(le(a,c)||b-d)>0}finally{Q(g);Q(i)}};var zf=function(a){this.C=a};z(zf,Bc);var Af=new Cc(0,100);o=zf.prototype;o.e=function(a,b,c,d,f){if(ka(b)){for(var g=0;g<b.length;g++)this.e(a,b[g],c,d,f);return}this.UJ(H(a,b,c||this,d||e,f||this.C||this))};o.UJ=function(a){if(this.ba)this.ba[a]=j;else if(this.We){this.ba=Af.Pc();this.ba[this.We]=j;this.We=h;this.ba[a]=j}else this.We=a};
o.W=function(a,b,c,d,f){if(!this.We&&!this.ba)return;if(ka(b)){for(var g=0;g<b.length;g++)this.W(a,b[g],c,d,f);return}var i=fd(a,b,c||this,d||e,f||this.C||this);if(i){var l=i.Qb;cd(l);if(this.ba)ec(this.ba,l);else if(this.We==l)this.We=h}};o.Ya=function(){if(this.ba){for(var a in this.ba){cd(a);delete this.ba[a]}Af.bf(this.ba);this.ba=h}else this.We&&cd(this.We)};o.l=function(){zf.d.l.call(this);this.Ya()};o.handleEvent=function(){k(Error("EventHandler.handleEvent not implemented"))};var Bf=function(){xd.call(this)};z(Bf,xd);o=Bf.prototype;o.ig=function(){Bf.d.ig.apply(this,arguments)};o.sk=function(){Bf.d.ig.apply(this,arguments)};o.Vg=function(){this.qm()};o.wf=function(){this.Zs()};o.ac=function(){return"PasteInterceptor"};o.b=function(){return this.p.b()};o.s=function(){return M(this.b())};o.$=function(){return Wd(this.s())};
o.dv=function(a){var b=this.p.execCommand("userpaste",a);if(b==="")return;b||(b=a);B?Ue(this.$()).$b(0).gc().pasteHTML(b):this.s().execCommand("inserthtml",h,b)};var Cf=function(){Bf.call(this);this.ga=new zf(this)};z(Cf,Bf);Cf.prototype.vf=h;Cf.prototype.Nj=h;Cf.prototype.Tm="display:none";Cf.prototype.Gr="";var Df="goog_paste_interceptor";o=Cf.prototype;o.qm=function(){var a=this.ga,b=this.b();a.e(b,"paste",this.Zw)};o.Zs=function(){this.Li();this.ga.Ya()};o.Zw=function(){this.Li();this.RH();this.Qg(this.Dx)};o.Dx=function(){var a=this.rw();this.rf();this.dv(a)};o.Or=function(){var a=this.tc();if(a){a.parentNode.removeChild(a);this.p.ng()}};
o.jK=function(){this.jg();this.Or()};o.tc=function(){return this.s().getElementById(Df)};o.AD=function(){var a=this.s().createElement("DIV");a.id=Df;a.style.cssText=this.Tm;a.innerHTML=this.Gr;return a};o.Nq=function(){this.p.ve(j,j);var a=this.AD();this.b().insertBefore(a,this.b().firstChild)};o.cs=function(){this.Mj();this.Pj()};o.Pj=function(){Ie(this.tc()).select()};o.RH=function(){this.Nq();this.cs()};o.Mj=function(){this.Nj=Ue(this.$())};o.jg=function(){this.Nj.select()};o.rw=function(){return this.tc().innerHTML};
o.rf=function(){this.Jo();this.jK()};o.Qg=function(a,b){this.Jo();this.vf=new Ed(a,b||0,this);this.vf.start()};o.Li=function(){if(this.vf){this.vf.Mi();this.Jo()}};o.Jo=function(){if(this.vf){this.vf.k();this.vf=h}};o.l=function(){this.Zs();this.ga.k();Cf.d.l.apply(this,arguments)};var Ef=function(){Cf.call(this)};z(Ef,Cf);Ef.prototype.Tm="display:-moz-deck;width:100%;font-size:0;visibility:hidden;line-height:0;position:fixed";Ef.prototype.Pj=function(){var a=this.tc().style,b=this.gF();a.bottom=b.y+"px";a.right=b.x+"px";Ef.d.Pj.apply(this,arguments)};Ef.prototype.gF=function(){var a=this.p.jb.getBoundingClientRect(),b=new yd(Math.max(-a.left,0),Math.max(-a.top,0)),c=this.$(),d=new yd(c.innerWidth,c.innerHeight);return new yd(d.x-b.x,d.y-b.y)};var Ff=function(){Cf.call(this)};z(Ff,Cf);Cf.prototype.el=e;Cf.prototype.Tm="width:0;height:0;overflow:hidden;zoom:0.01;float:right";Cf.prototype.Gr="<span>**</span>";o=Ff.prototype;o.Or=function(){this.ga.W(this.tc(),"selectstart",this.$w);Ff.d.Or.apply(this,arguments)};
o.qm=function(){Ff.d.qm.apply(this,arguments);var a=this.b(),b=this.ga;b.e(a,"contextmenu",this.qG);b.e(a,"beforepaste",this.eG);b.e(a,["cut","copy"],this.rG);b.e(a,"losecapture",this.OG);this.s().execCommand("respectvisibilityindesign",e,j);this.MJ()};o.$w=function(){this.rf();this.Qg(function(){document.execCommand("selectall",e,j)})};o.rG=function(){this.rf()};o.qG=function(){this.Li();this.el=j};o.eG=function(){this.Li();if(this.el)this.Qg(this.UK);else{this.Nq();this.cs();this.Qg(this.kE,250)}};
o.Zw=function(){if(this.tc()){this.Qg(this.Dx);$d(this.tc())}else this.Li()};o.OG=function(){if(this.el){this.el=e;this.Nq();this.cs();this.Qg(this.QD)}};o.kE=function(){this.rf()};o.QD=function(){var a=this.tc();this.rf();a.innerText=="*"&&this.s().execCommand("delete",e,j)};o.Dz=function(a,b){if(b.x!=a.scrollLeft)a.scrollLeft=b.x;if(b.y!=a.scrollTop)a.scrollTop=b.y};o.Pj=function(){var a=this.tc().firstChild.firstChild;Ee(a,0,a,1).select();this.ga.e(this.tc(),"selectstart",this.$w);this.p.fa().Kj()};
o.jg=function(){if(!this.Nj)return;var a=this.Nj,b=this.tc(),c=Ue(this.$()),d=c.sc(),f=d.nodeType==3?d.parentNode:d;if(b&&b.contains(f)||a.Rd(c)){var g=(new Pd(this.s())).od(),i=this.b(),l=new yd(i.scrollLeft,i.scrollTop);Ff.d.jg.apply(this,arguments);this.Dz(this.s().body,g);this.Dz(this.b(),l)}this.Nj=h};o.rf=function(){this.YJ();Ff.d.rf.apply(this,arguments)};o.UK=function(){this.b().setCapture()};o.YJ=function(){this.b().releaseCapture()};
o.MJ=function(){var a=fd(this.b(),"paste",this.p.ra,e,this.p);a&&cd(a.Qb)};var Gf=function(){Bf.call(this)};z(Gf,Bf);Gf.prototype.qm=function(){H(this.b(),"paste",this.Cx,e,this)};Gf.prototype.Zs=function(){ad(this.b(),"paste",this.Cx,e,this)};Gf.prototype.Cx=function(a){if(!a.clipboardData)return;this.dv(a.clipboardData.getData("text/html"));a.preventDefault();a.stopPropagation()};var Hf=function(){Cf.call(this)};z(Hf,Cf);Hf.prototype.Tm="position:fixed;bottom:0;right:100%;opacity:0";Hf.prototype.Gr='<div>&nbsp;<br class="temp_br"></div><br class="temp_br">';Hf.prototype.Pj=function(){var a=this.tc().firstChild.firstChild;Ie(a).select()};
Hf.prototype.rw=function(){var a=this.tc(),b;b=a.getElementsByClassName?a.getElementsByClassName("temp_br"):a.getElementsByTagName("BR");Vb(Jb(b),function(c){c.className=="temp_br"&&Q(c)});if(a.childNodes.length==1)return a.firstChild.innerHTML;return a.innerHTML};var If=function(){xd.call(this);this.ed=F&&!kb?new Hf:E&&qb("1.9")?new Ef:B&&!qb("8")?new Ff:new Gf};z(If,xd);o=If.prototype;o.ig=function(){return this.ed.ig.apply(this.ed,arguments)};o.sk=function(){return this.ed.sk.apply(this.ed,arguments)};o.Vg=function(){return this.ed.Vg.apply(this.ed,arguments)};o.wf=function(){return this.ed.wf.apply(this.ed,arguments)};o.ac=function(){return this.ed.ac.apply(this.ed,arguments)};var Jf=function(a,b,c,d){this.top=ba(a)?Number(a):undefined;this.right=ba(b)?Number(b):undefined;this.bottom=ba(c)?Number(c):undefined;this.left=ba(d)?Number(d):undefined};Jf.prototype.za=function(){return new Jf(this.top,this.right,this.bottom,this.left)};Jf.prototype.toString=function(){return"("+this.top+"t, "+this.right+"r, "+this.bottom+"b, "+this.left+"l)"};Jf.prototype.contains=function(a){return Kf(this,a)};
Jf.prototype.expand=function(a,b,c,d){if(pa(a)){this.top-=a.top;this.right+=a.right;this.bottom+=a.bottom;this.left-=a.left}else{this.top-=a;this.right+=b;this.bottom+=c;this.left-=d}return this};var Kf=function(a,b){if(!a||!b)return e;return b.x>=a.left&&b.x<=a.right&&b.y>=a.top&&b.y<=a.bottom};var Lf=function(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d};Lf.prototype.za=function(){return new Lf(this.left,this.top,this.width,this.height)};Lf.prototype.toString=function(){return"("+this.left+", "+this.top+" - "+this.width+"w x "+this.height+"h)"};Lf.prototype.contains=function(a){return this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height};var Mf,Of=function(a,b,c){ma(b)?Nf(a,c,b):Yb(b,ta(Nf,a))},Nf=function(a,b,c){a.style[Pf(c)]=b};
var Qf=function(a,b){var c=M(a);if(c.defaultView&&c.defaultView.getComputedStyle){var d=c.defaultView.getComputedStyle(a,"");if(d)return d[b]}return h},Rf=function(a,b){return a.currentStyle?a.currentStyle[b]:h},Sf=function(a,b){return Qf(a,b)||Rf(a,b)||a.style[b]},Tf=function(a){return Sf(a,"position")},Uf=function(a,b,c){var d,f;if(b instanceof yd){d=b.x;f=b.y}else{d=b;f=c}a.style.left=typeof d=="number"?Math.round(d)+"px":d;a.style.top=typeof f=="number"?Math.round(f)+"px":f},Vf=function(a){var b;
b=a?a.nodeType==9?a:M(a):Qd().s();if(B&&b.compatMode!="CSS1Compat")return b.body;return b.documentElement},Wf=function(a){var b=M(a),c=E&&b.getBoxObjectFor&&Tf(a)=="absolute"&&(a.style.top==""||a.style.left=="");if(typeof Mf=="undefined")Mf=eb&&!qb("1.8.0.11");var d=new yd(0,0),f=Vf(b);if(a==f)return d;var g=h,i;if(a.getBoundingClientRect&&!c){i=a.getBoundingClientRect();var l=N(b).od();d.x=i.left+l.x;d.y=i.top+l.y}else if(b.getBoxObjectFor&&!c&&!Mf){i=b.getBoxObjectFor(a);var m=b.getBoxObjectFor(f);
d.x=i.screenX-m.screenX;d.y=i.screenY-m.screenY}else{g=a;do{d.x+=g.offsetLeft;d.y+=g.offsetTop;if(g!=a){d.x+=g.clientLeft||0;d.y+=g.clientTop||0}if(F&&Tf(g)=="fixed"){d.x+=b.body.scrollLeft;d.y+=b.body.scrollTop;break}g=g.offsetParent}while(g&&g!=a);if(A||F&&Tf(a)=="absolute")d.y-=b.body.offsetTop;g=a.offsetParent;while(g&&g!=b.body){d.x-=g.scrollLeft;if(!A||g.tagName!="TR")d.y-=g.scrollTop;g=g.offsetParent}}if(E&&a.getBoundingClientRect){var n=Tf(a);if(n=="static"||n=="relative"){d.x=Math.floor(d.x);
d.y=Math.floor(d.y)}}return d};
var Xf=function(a){var b=new yd;if(a.nodeType==1)if(a.getBoundingClientRect){var c=a.getBoundingClientRect();b.x=c.left;b.y=c.top}else{var d=N(a).od(),f=Wf(a);b.x=f.x-d.x;b.y=f.y-d.y}else{b.x=a.clientX;b.y=a.clientY}return b},Yf=function(a,b,c){var d=Wf(a);if(b instanceof yd){c=b.y;b=b.x}Uf(a,a.offsetLeft+(b-d.x),a.offsetTop+(c-d.y))},Zf=function(a,b,c){var d;if(b instanceof Fd){d=b.height;b=b.width}else{if(c==undefined)k(Error("missing height argument"));d=c}a.style.width=typeof b=="number"?Math.round(b)+
"px":b;a.style.height=typeof d=="number"?Math.round(d)+"px":d},$f=function(a){if(Sf(a,"display")!="none")return new Fd(a.offsetWidth,a.offsetHeight);var b=a.style,c=b.display,d=b.visibility,f=b.position;b.visibility="hidden";b.position="absolute";b.display="";var g=a.offsetWidth,i=a.offsetHeight;b.display=c;b.position=f;b.visibility=d;return new Fd(g,i)},Pf=function(a){return String(a).replace(/\-([a-z])/g,function(b,c){return c.toUpperCase()})},ag=function(a,b){var c=a.style;if("opacity"in c)c.opacity=
b;else if("MozOpacity"in c)c.MozOpacity=b;else if("filter"in c){var d=M(a).documentMode>=8?"'":"";c.filter=d+"alpha(opacity="+b*100+")"+d}},bg=function(a,b){a.style.display=b?"":"none"},dg=function(a,b){var c=N(b),d=h;if(B)d=c.s().createStyleSheet();else{var f=c.$n("head")[0];if(!f){var g=c.$n("body")[0];f=c.f("head");g.parentNode.insertBefore(f,g)}d=c.f("style");c.appendChild(f,d)}cg(d,a);return d},cg=function(a,b){if(B)a.cssText=b;else a[F?"innerText":"innerHTML"]=b};
var eg=function(a){return a?ma(a)||a.nodeType==3?j:yb(a,eg):e},fg=E&&!qb("1.9"),gg=function(a){return"rtl"==Sf(a,"direction")},hg=E?"MozUserSelect":F?"WebkitUserSelect":h,ig=function(a){if(hg)return a.style[hg].toLowerCase()=="none";else if(B||A)return a.getAttribute("unselectable")=="on";return e},jg=function(a,b,c){var d=!c?a.getElementsByTagName("*"):h;if(hg){var f=b?"none":"";a.style[hg]=f;if(d)for(var g=0,i;i=d[g];g++)i.style[hg]=f}else if(B||A){var f=b?"on":"";a.setAttribute("unselectable",
f);if(d)for(var g=0,i;i=d[g];g++)i.setAttribute("unselectable",f)}},kg=function(a,b,c,d){if(/^\d+px?$/.test(b))return parseInt(b,10);else{var f=a.style[c],g=a.runtimeStyle[c];a.runtimeStyle[c]=a.currentStyle[c];a.style[c]=b;var i=a.style[d];a.style[c]=f;a.runtimeStyle[c]=g;return i}},lg=function(a,b){return kg(a,Rf(a,b),"left","pixelLeft")},mg=function(a,b){if(B){var c=lg(a,b+"Left"),d=lg(a,b+"Right"),f=lg(a,b+"Top"),g=lg(a,b+"Bottom");return new Jf(f,d,g,c)}else{var c=Qf(a,b+"Left"),d=Qf(a,b+"Right"),
f=Qf(a,b+"Top"),g=Qf(a,b+"Bottom");return new Jf(parseFloat(f),parseFloat(d),parseFloat(g),parseFloat(c))}};
var ng={thin:2,medium:4,thick:6},og=function(a,b){if(Rf(a,b+"Style")=="none")return 0;var c=Rf(a,b+"Width");if(c in ng)return ng[c];return kg(a,c,"left","pixelLeft")},pg=function(a){if(B){var b=og(a,"borderLeft"),c=og(a,"borderRight"),d=og(a,"borderTop"),f=og(a,"borderBottom");return new Jf(d,c,f,b)}else{var b=Qf(a,"borderLeftWidth"),c=Qf(a,"borderRightWidth"),d=Qf(a,"borderTopWidth"),f=Qf(a,"borderBottomWidth");return new Jf(parseFloat(d),parseFloat(c),parseFloat(f),parseFloat(b))}};var qg=function(){};ga(qg);qg.prototype.VI=0;qg.prototype.IF=function(){return":"+(this.VI++).toString(36)};var sg=function(a){I.call(this);this.g=a||N();this.Lj=rg};z(sg,I);sg.prototype.FH=qg.Ga();var rg=h,tg="highlight",ug="unhighlight",vg="action",wg="Component already rendered",xg="Unable to set parent component",yg=function(a,b){switch(a){case 1:return b?"disable":"enable";case 2:return b?tg:ug;case 4:return b?"activate":"deactivate";case 8:return b?"select":"unselect";case 16:return b?"check":"uncheck";case 32:return b?"focus":"blur";case 64:return b?"open":"close";default:}k(Error("Invalid component state"))};
o=sg.prototype;o.Ib=h;o.g=h;o.X=e;o.n=h;o.Lj=h;o.Ej=h;o.Ja=h;o.ub=h;o.Kc=h;o.SA=h;o.Gb=function(){return this.Ib||(this.Ib=this.FH.IF())};o.Oh=function(a){if(this.Ja&&this.Ja.Kc){ec(this.Ja.Kc,this.Ib);gc(this.Ja.Kc,a,this)}this.Ib=a};o.b=function(){return this.n};o.Nh=function(a){this.n=a};o.Zj=function(a){if(this==a)k(Error(xg));if(a&&this.Ja&&this.Ib&&this.Ja.j(this.Ib)&&this.Ja!=a)k(Error(xg));this.Ja=a};o.$i=function(){return this.Ja};o.Uz=function(){k(Error("Method not supported"))};
o.f=function(){this.n=this.g.createElement("div")};o.zb=function(a){this.rz(a)};o.rz=function(a,b){if(this.X)k(Error(wg));this.n||this.f();a?a.insertBefore(this.n,b||h):this.g.s().body.appendChild(this.n);if(!this.Ja||this.Ja.X)this.Oa()};o.ja=function(a){if(this.X)k(Error(wg));else if(a&&this.fc(a)){this.SA=j;if(!this.g||this.g.s()!=M(a))this.g=N(a);this.Ud(a);this.Oa()}else k(Error("Invalid element to decorate"))};o.fc=function(){return j};o.Ud=function(a){this.n=a};
o.Oa=function(){this.X=j;this.Je(function(a){!a.X&&a.b()&&a.Oa()})};o.xa=function(){this.Je(function(a){a.X&&a.xa()});this.X=e};o.l=function(){sg.d.l.call(this);this.X&&this.xa();this.Je(function(a){a.k()});!this.SA&&this.n&&Q(this.n);this.ub=h;this.Kc=h;this.n=h;this.Ej=h;this.Ja=h};o.lL=function(a){this.Ej=a};o.Nt=function(a,b){this.Ae(a,this.Ke(),b)};
o.Ae=function(a,b,c){if(a.X&&(c||!this.X))k(Error(wg));if(b<0||b>this.Ke())k(Error("Child component index out of bounds"));if(!this.Kc||!this.ub){this.Kc={};this.ub=[]}if(a.Ja==this){fc(this.Kc,a.Gb());Hb(this.ub,a)}else gc(this.Kc,a.Gb(),a);a.Zj(this);Fb(this.ub,a,b);if(a.X&&this.X&&a.Ja==this){var d=this.Ba();d.insertBefore(a.b(),d.childNodes[b+1]||h)}else if(c){this.n||this.f();var f=this.Ff(b+1);a.rz(this.Ba(),f?f.n:h)}else this.X&&!a.X&&a.n&&a.Oa()};o.Ba=function(){return this.n};
o.Xf=function(){if(this.Lj==h)this.Lj=gg(this.X?this.n:this.g.s().body);return this.Lj};o.Qh=function(a){if(this.X)k(Error(wg));this.Lj=a};o.cH=function(){return!!this.ub&&this.ub.length!=0};o.Ke=function(){return this.ub?this.ub.length:0};o.Xv=function(){var a=[];this.Je(function(b){a.push(b.Gb())});return a};o.j=function(a){return this.Kc&&a?hc(this.Kc,a)||h:h};o.Ff=function(a){return this.ub?this.ub[a]||h:h};o.Je=function(a,b){this.ub&&tb(this.ub,a,b)};
o.nm=function(a){return this.ub&&a?sb(this.ub,a):-1};o.removeChild=function(a,b){if(a){var c=ma(a)?a:a.Gb();a=this.j(c);if(c&&a){ec(this.Kc,c);Hb(this.ub,a);if(b){a.xa();a.n&&Q(a.n)}a.Zj(h)}}if(!a)k(Error("Child is not in parent component"));return a};o.bK=function(a,b){return this.removeChild(this.Ff(a),b)};var zg=function(a,b,c){if(!B&&!(F&&qb("525")))return j;if(B&&!c&&(b==17||b==18))return e;if(a>=48&&a<=57)return j;if(a>=96&&a<=106)return j;if(a>=65&&a<=90)return j;if(a==27&&F)return e;switch(a){case 13:case 27:case 32:case 63:case 107:case 109:case 110:case 111:case 186:case 189:case 187:case 188:case 190:case 191:case 192:case 222:case 219:case 220:case 221:return j;default:return e}},Ag=function(a){if(a>=48&&a<=57)return j;if(a>=96&&a<=106)return j;if(a>=65&&a<=90)return j;switch(a){case 32:case 63:case 107:case 109:case 110:case 111:case 186:case 189:case 187:case 188:case 190:case 191:case 192:case 222:case 219:case 220:case 221:return j;
default:return e}};var Bg=function(a){I.call(this);a&&this.mi(a)};z(Bg,I);o=Bg.prototype;o.n=h;o.ym=h;o.br=h;o.zm=h;o.zj=-1;o.xj=-1;o.Ux=0;
var Cg={"3":13,"12":144,"63232":38,"63233":40,"63234":37,"63235":39,"63236":112,"63237":113,"63238":114,"63239":115,"63240":116,"63241":117,"63242":118,"63243":119,"63244":120,"63245":121,"63246":122,"63247":123,"63248":44,"63272":46,"63273":36,"63275":35,"63276":33,"63277":34,"63289":144,"63302":45},Dg={Up:38,Down:40,Left:37,Right:39,Enter:13,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,"U+007F":46,Home:36,End:35,PageUp:33,PageDown:34,Insert:45},Eg={61:187,
59:186},Fg=B||F&&qb("525");o=Bg.prototype;o.uq=function(a){if(Fg&&!zg(a.keyCode,this.zj,a.shiftKey))this.handleEvent(a);else this.xj=E&&a.keyCode in Eg?Eg[a.keyCode]:a.keyCode};o.NG=function(){this.zj=-1};
o.handleEvent=function(a){var b=a.fb,c,d;if(B&&a.type==Hc){c=this.xj;d=c!=13&&c!=27?b.keyCode:0}else if(F&&a.type==Hc){c=this.xj;d=b.charCode>=0&&b.charCode<63232&&Ag(c)?b.charCode:0}else if(A){c=this.xj;d=Ag(c)?b.keyCode:0}else{c=b.keyCode||this.xj;d=b.charCode||0;if(kb&&d==63&&!c)c=191}var f=c,g=b.keyIdentifier;if(c)if(c>=63232&&c in Cg)f=Cg[c];else{if(c==25&&a.shiftKey)f=9}else if(g&&g in Dg)f=Dg[g];var i=f==this.zj;this.zj=f;if(F){if(i&&b.timeStamp-this.Ux<50)return;this.Ux=b.timeStamp}var l=
new Gg(f,d,i,b);try{this.dispatchEvent(l)}finally{l.k()}};o.mi=function(a){this.zm&&this.detach();this.n=a;this.ym=H(this.n,Hc,this);this.br=H(this.n,jd,this.uq,e,this);this.zm=H(this.n,"keyup",this.NG,e,this)};o.detach=function(){if(this.ym){cd(this.ym);cd(this.br);cd(this.zm);this.ym=h;this.br=h;this.zm=h}this.n=h;this.zj=-1};o.l=function(){Bg.d.l.call(this);this.detach()};var Gg=function(a,b,c,d){Dc.call(this,d);this.type="key";this.keyCode=a;this.charCode=b;this.repeat=c};z(Gg,Dc);var Hg,Ig="activedescendant",Jg=function(a,b){if(E||Hg){a.setAttribute("role",b);a.aO=b}},Kg=function(a,b,c){if(E||Hg)a.setAttribute("aria-"+b,c)};var Lg=function(){},Mg;ga(Lg);o=Lg.prototype;o.nd=function(){return undefined};o.f=function(a){return a.g.f("div",{className:this.Gf(a).join(" ")},a.pa)};o.Ba=function(a){return a};o.vl=function(a,b,c){var d=a.b?a.b():a;if(d)if(B&&!qb("7")){var f=this.Vp(Jd(d),b);f.push(b);ta(c?Kd:Ld,d).apply(h,f)}else Od(d,b,c)};o.ov=function(a,b,c){this.vl(a,b,c)};o.fc=function(){return j};
o.ja=function(a,b){b.id&&a.Oh(b.id);var c=this.Ba(b);c&&c.firstChild?a.Mh(c.firstChild.nextSibling?Ib(c.childNodes):c.firstChild):a.Mh(h);var d=0,f=this.U(),g=this.dj(),i=e,l=e,m=e,n=Jd(b);tb(n,function(t){if(!i&&t==f){i=j;if(g==f)l=j}else if(!l&&t==g)l=j;else d|=this.jq(t)},this);a.Wz(d);if(!i){n.push(f);if(g==f)l=j}l||n.push(g);var q=a.Oc;q&&n.push.apply(n,q);if(B&&!qb("7")){var r=this.Vp(n);if(r.length>0){n.push.apply(n,r);m=j}}if(!i||!l||q||m)Id(b,n.join(" "));return b};
o.Ec=function(a){a.Xf()&&this.Qh(a.b(),j);a.J()&&this.ec(a,a.oa())};o.Kz=function(a){if(E){var b=this.nd();b&&Jg(a,b)}};o.Sj=function(a,b){jg(a,!b,!B&&!A)};o.Qh=function(a,b){this.vl(a,this.dj()+"-rtl",b)};o.le=function(a){var b;if(a.Fc(32)&&(b=a.Qa()))return ue(b);return e};o.ec=function(a,b){var c;if(a.Fc(32)&&(c=a.Qa())){if(!b&&a.Kx()){try{c.blur()}catch(d){}a.Kx()&&a.Dc(h)}ue(c)!=b&&ve(c,b)}};o.o=function(a,b){bg(a,b)};
o.qb=function(a,b,c){var d=a.b();if(d){var f=this.Pi(b);f&&this.vl(a,f,c);this.HA(d,b,c)}};o.HA=function(a,b,c){if(E){Mg||(Mg=lc(1,"disabled",4,"pressed",8,"selected",16,"checked",64,"expanded"));var d=Mg[b];d&&Kg(a,d,c)}};o.Sb=function(a,b){var c=this.Ba(a);if(c){$d(c);if(b)if(ma(b))oe(c,b);else{function d(f){if(f){var g=M(c);c.appendChild(ma(f)?g.createTextNode(f):f)}}ka(b)?tb(b,d):d(b)}}};o.Qa=function(a){return a.b()};o.U=function(){return"goog-control"};o.dj=function(){return this.U()};
o.Gf=function(a){var b=this.U(),c=[b],d=this.dj();d!=b&&c.push(d);var f=this.hF(a.$l());f&&c.push.apply(c,f);var g=a.Oc;g&&c.push.apply(c,g);B&&!qb("7")&&c.push.apply(c,this.Vp(c));return c};o.Vp=function(a,b){var c=[];if(b)a=a.concat([b]);tb([],function(d){if(zb(d,ta(Cb,a))&&(!b||Cb(d,b)))c.push(d.join("_"))});return c};o.hF=function(a){if(a){var b=[];for(var c=1;a;c<<=1)if(a&c){b.push(this.Pi(c));a&=~c}return b}return h};o.Pi=function(a){this.Xk||this.Fu();return this.Xk[a]};
o.jq=function(a){this.sA||this.CD();var b=parseInt(this.sA[a],10);return isNaN(b)?0:b};o.Fu=function(){var a=this.dj();this.Xk=lc(1,a+"-disabled",2,a+"-hover",4,a+"-active",8,a+"-selected",16,a+"-checked",32,a+"-focused",64,a+"-open")};o.CD=function(){this.Xk||this.Fu();this.sA=ic(this.Xk)};var Og=function(a){var b,c;while(a){b=s(a);if(c=Ng[b])break;a=a.d?a.d.constructor:h}if(c)return oa(c.Ga)?c.Ga():new c;return h},Pg=function(a,b){if(!oa(a))k(Error("Invalid component class "+a));if(!oa(b))k(Error("Invalid renderer class "+b));var c=s(a);Ng[c]=b};var Rg=function(a,b){if(!a)k(Error("Invalid class name "+a));if(!oa(b))k(Error("Invalid decorator function "+b));Qg[a]=b},Sg=function(a){var b,c=Jd(a);for(var d=0,f=c.length;d<f;d++)if(b=c[d]in Qg?Qg[c[d]]():h)return b;return h},Ng={},Qg={};var Tg=function(a){var b=Sg(a);b&&b.ja(a);return b};var Ug=function(a,b,c){sg.call(this,c);this.D=b||Og(this.constructor);this.Mh(a)};z(Ug,sg);var Vg=Tg;o=Ug.prototype;o.pa=h;o.Ua=0;o.lk=39;o.Pk=255;o.Dn=0;o.tb=j;o.Oc=h;o.xq=j;o.Jk=e;o.xb=function(){return this.C||(this.C=new zf(this))};o.rs=function(a){this.X&&a!=this.xq&&this.qv(a);this.xq=a};o.Qa=function(){return this.D.Qa(this)};o.Ql=function(){return this.Ia||(this.Ia=new Bg)};o.Ot=function(a){if(a){if(this.Oc)Cb(this.Oc,a)||this.Oc.push(a);else this.Oc=[a];this.D.ov(this,a,j)}};
o.cK=function(a){if(a&&this.Oc){Hb(this.Oc,a);if(this.Oc.length==0)this.Oc=h;this.D.ov(this,a,e)}};o.vl=function(a,b){b?this.Ot(a):this.cK(a)};o.f=function(){var a=this.D.f(this);this.Nh(a);this.D.Kz(a);this.Jk||this.D.Sj(a,e);this.oa()||this.D.o(a,e)};o.Ba=function(){return this.D.Ba(this.b())};o.fc=function(a){return this.D.fc(a)};o.Ud=function(a){a=this.D.ja(this,a);this.Nh(a);this.D.Kz(a);this.Jk||this.D.Sj(a,e);this.tb=a.style.display!="none"};
o.Oa=function(){Ug.d.Oa.call(this);this.D.Ec(this);if(this.lk&-2){this.xq&&this.qv(j);if(this.Fc(32)){var a=this.Qa();if(a){var b=this.xb(),c=this.Ql();c.mi(a);b.e(c,"key",this.Pb);b.e(a,kd,this.cm);b.e(a,"blur",this.Dc)}}}};o.qv=function(a){var b=this.xb(),c=this.b();if(a){b.e(c,Fc,this.Tf);b.e(c,gd,this.ee);b.e(c,hd,this.nj);b.e(c,Gc,this.mj);B&&b.e(c,"dblclick",this.Kw)}else{b.W(c,Fc,this.Tf);b.W(c,gd,this.ee);b.W(c,hd,this.nj);b.W(c,Gc,this.mj);B&&b.W(c,"dblclick",this.Kw)}};
o.xa=function(){Ug.d.xa.call(this);this.C&&this.C.Ya();this.Ia&&this.Ia.detach();this.oa()&&this.J()&&this.D.ec(this,e)};o.l=function(){Ug.d.l.call(this);if(this.C){this.C.k();delete this.C}if(this.Ia){this.Ia.k();delete this.Ia}delete this.D;this.pa=h;this.Oc=h};o.Sb=function(a){this.D.Sb(this.b(),a);this.Mh(a)};o.Mh=function(a){this.pa=a};o.ah=function(){var a=this.pa;if(!a||ma(a))return a;var b=ka(a)?wb(a,xe).join(""):xe(a);return b&&Ea(b)};o.Rb=function(a){this.Sb(a)};
o.Qh=function(a){Ug.d.Qh.call(this,a);var b=this.b();b&&this.D.Qh(b,a)};o.Sj=function(a){this.Jk=a;var b=this.b();b&&this.D.Sj(b,a)};o.oa=function(){return this.tb};o.o=function(a,b){if(b||this.tb!=a&&this.dispatchEvent(a?"show":"hide")){var c=this.b();c&&this.D.o(c,a);this.J()&&this.D.ec(this,a);this.tb=a;return j}return e};o.J=function(){return!this.fe(1)};o.jI=function(){var a=this.Ja;return!!a&&typeof a.J=="function"&&!a.J()};
o.u=function(a){if(!this.jI()&&this.Zf(1,!a)){if(!a){this.setActive(e);this.wc(e)}this.oa()&&this.D.ec(this,a);this.qb(1,!a)}};o.wc=function(a){this.Zf(2,a)&&this.qb(2,a)};o.td=function(){return this.fe(4)};o.setActive=function(a){this.Zf(4,a)&&this.qb(4,a)};o.ak=function(a){this.Zf(8,a)&&this.qb(8,a)};o.je=function(){return this.fe(16)};o.Za=function(a){this.Zf(16,a)&&this.qb(16,a)};o.Kx=function(){return this.fe(32)};o.Qz=function(a){this.Zf(32,a)&&this.qb(32,a)};o.isOpen=function(){return this.fe(64)};
o.Da=function(a){this.Zf(64,a)&&this.qb(64,a)};o.$l=function(){return this.Ua};o.fe=function(a){return!!(this.Ua&a)};o.qb=function(a,b){if(this.Fc(a)&&b!=this.fe(a)){this.D.qb(this,a,b);this.Ua=b?this.Ua|a:this.Ua&~a}};o.Wz=function(a){this.Ua=a};o.Fc=function(a){return!!(this.lk&a)};o.Ed=function(a,b){if(this.X&&this.fe(a)!=b)k(Error(wg));!b&&this.fe(a)&&this.qb(a,e);this.lk=b?this.lk|a:this.lk&~a};o.uc=function(a){return!!(this.Pk&a)&&this.Fc(a)};o.SK=function(a,b){this.Pk=b?this.Pk|a:this.Pk&~a};
o.Nz=function(a,b){this.Dn=b?this.Dn|a:this.Dn&~a};o.Zf=function(a,b){return this.Fc(a)&&this.fe(a)!=b&&(!(this.Dn&a)||this.dispatchEvent(yg(a,b)))&&!this.Sq()};o.Tf=function(a){a.relatedTarget&&!ie(this.b(),a.relatedTarget)&&this.dispatchEvent("enter")&&this.J()&&this.uc(2)&&this.wc(j)};o.mj=function(a){if(a.relatedTarget&&!ie(this.b(),a.relatedTarget)&&this.dispatchEvent("leave")){this.uc(4)&&this.setActive(e);this.uc(2)&&this.wc(e)}};
o.ee=function(a){if(this.J()){this.uc(2)&&this.wc(j);if(a.Ex(0)){this.uc(4)&&this.setActive(j);this.D.le(this)&&this.Qa().focus()}}!this.Jk&&a.Ex(0)&&a.preventDefault()};o.nj=function(a){if(this.J()){this.uc(2)&&this.wc(j);this.td()&&this.yd(a)&&this.uc(4)&&this.setActive(e)}};o.Kw=function(a){this.J()&&this.yd(a)};o.yd=function(){this.uc(16)&&this.Za(!this.je());this.uc(8)&&this.ak(j);this.uc(64)&&this.Da(!this.isOpen());return this.dispatchEvent(vg)};o.cm=function(){this.uc(32)&&this.Qz(j)};
o.Dc=function(){this.uc(4)&&this.setActive(e);this.uc(32)&&this.Qz(e)};o.Pb=function(a){if(this.oa()&&this.J()&&this.lh(a)){a.preventDefault();a.stopPropagation();return j}return e};o.lh=function(a){return a.keyCode==13&&this.yd(a)};Pg(Ug,Lg);Rg("goog-control",function(){return new Ug(h)});var Wg=function(){Lg.call(this);var a=this.dj();this.Mg={su:a+"-checkbox",content:a+"-content",lx:a+"-highlight"}};z(Wg,Lg);ga(Wg);o=Wg.prototype;o.nd=function(){return"menuitem"};o.f=function(a){var b=a.g.f("div",{"class":this.Gf(a).join(" ")},this.Gu(a.pa,a.g));this.qs(a,b,a.Fc(8)||a.Fc(16));return b};o.Ba=function(a){return a&&a.firstChild};o.ja=function(a,b){this.dH(b)||b.appendChild(this.Gu(b.childNodes,a.g));if(Nd(b,"goog-option")){a.Vj(j);this.Vj(a,b,j)}return Wg.d.ja.call(this,a,b)};
o.Sb=function(a,b){var c=this.Ba(a),d=this.Aq(a)?c.firstChild:h;Wg.d.Sb.call(this,a,b);if(d&&!this.Aq(a))c.insertBefore(d,c.firstChild||h)};o.dH=function(a){var b=ge(a);return!!b&&b.className.indexOf(this.Mg.content)!=-1};o.Gu=function(a,b){return b.f("div",{"class":this.Mg.content},a)};o.un=function(a,b,c){if(b){Jg(b,c?"menuitemradio":this.nd());this.qs(a,b,c)}};o.Vj=function(a,b,c){if(b){Jg(b,c?"menuitemcheckbox":this.nd());this.qs(a,b,c)}};
o.Aq=function(a){var b=this.Ba(a);if(b){var c=b.firstChild;return!!c&&!!c.className&&c.className.indexOf(this.Mg.su)!=-1}return e};o.qs=function(a,b,c){if(c!=this.Aq(b)){Od(b,"goog-option",c);var d=this.Ba(b);c?d.insertBefore(a.g.f("div",{"class":this.Mg.su}),d.firstChild||h):d.removeChild(d.firstChild)}};o.Pi=function(a){switch(a){case 2:return this.Mg.lx;case 16:case 8:return"goog-option-selected";default:return Wg.d.Pi.call(this,a)}};
o.jq=function(a){switch(a){case "goog-option-selected":return 16;case this.Mg.lx:return 2;default:return Wg.d.jq.call(this,a)}};o.U=function(){return"goog-menuitem"};var Xg=function(a,b,c,d){Ug.call(this,a,d||Wg.Ga(),c);this.va(b)};z(Xg,Ug);Xg.prototype.Ra=function(){var a=this.Ej;return a!=h?a:this.ah()};Xg.prototype.va=function(a){this.lL(a)};Xg.prototype.un=function(a){this.Ed(8,a);this.je()&&!a&&this.Za(e);var b=this.b();b&&this.D.un(this,b,a)};Xg.prototype.Vj=function(a){this.Ed(16,a);var b=this.b();b&&this.D.Vj(this,b,a)};Rg("goog-menuitem",function(){return new Xg(h)});var $g=function(a,b,c,d,f,g){Xg.call(this,a,d,f,g||Yg||(Yg=new Zg));this.ox=b;this.kx=c};z($g,Xg);$g.prototype.l=function(){$g.d.l.call(this);this.ox=h;this.kx=h};var Zg=function(){Wg.call(this)};z(Zg,Wg);var Yg=h;Zg.prototype.f=function(a){var b=Zg.d.f.call(this,a),c=a.g,d=a.ox,f=c.f("span",d?{"class":[d,"goog-menuitem-icon","apps-share-sprite"].join(" ")}:h),g=a.kx,i=h;if(g)i=c.f("span",{"class":"share-menu-hint"}," "+g);this.Sb(b,[f,a.pa,i]);return b};var ah=function(a,b,c,d){this.uN=a;this.vN=b;this.hO=c;this.QC=d},ch=function(a){var b=a.access;return ba(b)&&!(b===h)?bh(b,!!a.canPublishOut):new ah(!!a.canShareIn,!!a.canShareOut,!!a.showShareOutWarning,!!a.canPublishOut)},bh=function(a,b){switch(a){case 0:return new ah(j,j,e,b);case 1:return new ah(j,j,j,b);case 2:return new ah(j,e,j,b);case 3:return new ah(e,e,j,b)}};var dh=function(a,b,c,d,f){this.Fj=a;this.Ib=String(b);this.bO=c||"user";this.VN=!!d;this.KN=f},eh=new tc;dh.prototype.Gb=function(){return this.Ib};var fh=function(a,b){eh.h(a,b)};var gh=function(a,b,c,d,f){dh.call(this,a,b,"domain",d,f);this.EL=c};z(gh,dh);var hh=function(a){return new gh(a.name,a.id,ch(a.sharingPolicy),a.me,a.iconUrl)};fh("domain",hh);var ih=new gh("","DEFAULT",bh(0,j),j);var jh=function(){return Lg.call(this)};z(jh,Lg);ga(jh);var kh="goog-menuseparator";jh.prototype.f=function(a){return a.g.f("div",{"class":this.U()})};jh.prototype.ja=function(a,b){if(b.tagName=="HR"){var c=b;b=this.f(a);ae(b,c);Q(c)}else Kd(b,this.U());return b};jh.prototype.Sb=function(){};jh.prototype.U=function(){return kh};var lh=function(a,b){Ug.call(this,h,a||jh.Ga(),b);this.Ed(1,e);this.Ed(2,e);this.Ed(4,e);this.Ed(32,e);this.Wz(1)};z(lh,Ug);lh.prototype.Oa=function(){lh.d.Oa.call(this);Jg(this.b(),"separator")};Rg(kh,function(){return new lh});var mh=function(){};ga(mh);o=mh.prototype;o.nd=function(){return undefined};o.mH=function(a){if(a){var b=a.getAttributeNode("tabindex");if(b&&b.specified){var c=a.tabIndex;return na(c)&&c>=0}}return e};o.Dp=function(a,b){if(a)a.tabIndex=b?0:-1};o.f=function(a){return a.g.f("div",{"class":this.Gf(a).join(" ")})};o.Ba=function(a){return a};o.fc=function(a){return a.tagName=="DIV"};
o.ja=function(a,b){b.id&&a.Oh(b.id);var c=this.U(),d=e,f=Jd(b);f&&tb(f,function(g){if(g==c)d=j;else g&&this.qL(a,g,c)},this);d||Kd(b,c);this.ID(a,b);return b};o.qL=function(a,b,c){if(b==c+"-disabled")a.u(e);else if(b==c+"-horizontal")a.Tz(nh);else b==c+"-vertical"&&a.Tz(oh)};
o.ID=function(a,b){if(b){var c=b.firstChild,d;while(c&&c.parentNode==b){d=c.nextSibling;if(c.nodeType==1){var f=this.Ri(c);if(f){f.Nh(c);a.J()||f.u(e);a.Nt(f);f.ja(c)}}else if(!c.nodeValue||Ea(c.nodeValue)=="")b.removeChild(c);c=d}}};o.Ri=function(a){return Sg(a)};o.Ec=function(a){var b=a.b();jg(b,j,E);if(B)b.hideFocus=j;var c=this.nd();c&&Jg(b,c);if(a.vd==nh&&E&&!qb("1.9a")&&a.Xf()){var d=this.Ba(b);a.Je(function(f){var g=f.b();g&&g.parentNode==d&&ph(f)})}};o.Qa=function(a){return a.b()};o.U=function(){return"goog-container"};
o.Gf=function(a){var b=this.U(),c=[b,b+(a.vd==nh?"-horizontal":"-vertical")];a.J()||c.push(this.U()+"-disabled");return c};o.dw=function(){return oh};var ph=function(a){var b=a.b();if(b){var c=b.nextSibling;b.parentNode.insertBefore(a.g.f("div",{style:a instanceof lh?"display:-moz-box;position:relative;top:4px":"display:-moz-box;position:relative"},b),c)}},qh=function(a){var b=a.b();if(b){var c=b.parentNode;c.parentNode.insertBefore(b,c);Q(c)}};var rh=function(a,b,c){sg.call(this,c);this.D=b||mh.Ga();this.vd=a||this.D.dw()};z(rh,sg);var nh="horizontal",oh="vertical";o=rh.prototype;o.C=h;o.vI=h;o.Ia=h;o.D=h;o.vd=h;o.tb=j;o.Xb=j;o.Pp=j;o.hb=-1;o.ob=h;o.sr=e;o.NB=e;o.De=h;o.xb=function(){return this.C||(this.C=new zf(this))};o.Qa=function(){return this.vI||this.D.Qa(this)};o.Ql=function(){return this.Ia||(this.Ia=new Bg(this.Qa()))};o.f=function(){this.Nh(this.D.f(this))};o.Ba=function(){return this.D.Ba(this.b())};o.fc=function(a){return this.D.fc(a)};
o.Ud=function(a){this.Nh(this.D.ja(this,a));if(a.style.display=="none")this.tb=e};o.Oa=function(){rh.d.Oa.call(this);var a=this.b();this.D.Ec(this);this.o(this.tb,j);var b=this.xb();b.e(this,"enter",this.sq);b.e(this,tg,this.tq);b.e(this,ug,this.zq);b.e(this,"open",this.UG);b.e(this,"close",this.pG);b.e(a,gd,this.ee);b.e(M(a),hd,this.yG);b.e(a,[gd,hd,Fc,Gc],this.oG);this.le()&&this.pv(j)};
o.pv=function(a){var b=this.xb(),c=this.Qa();if(a){b.e(c,kd,this.cm);b.e(c,"blur",this.Dc);b.e(this.Ql(),"key",this.Pb)}else{b.W(c,kd,this.cm);b.W(c,"blur",this.Dc);b.W(this.Ql(),"key",this.Pb)}};o.xa=function(){rh.d.xa.call(this);this.Tb(-1);this.C&&this.C.Ya();this.ob&&this.ob.Da(e);this.sr=e};o.l=function(){rh.d.l.call(this);if(this.C){this.C.k();this.C=h}if(this.Ia){this.Ia.k();this.Ia=h}this.De=h;this.ob=h;this.D=h};o.sq=function(){return j};
o.tq=function(a){var b=this.nm(a.target);if(b>-1&&b!=this.hb){var c=this.Jf();c&&c.wc(e);this.hb=b;c=this.Jf();this.sr&&c.setActive(j);if(this.ob&&c!=this.ob)c.Fc(64)?c.Da(j):this.ob.Da(e)}Kg(this.b(),Ig,a.target.b().id)};o.zq=function(a){if(a.target==this.Jf())this.hb=-1;Kg(this.b(),Ig,h)};o.UG=function(a){var b=a.target;if(b&&b!=this.ob&&b.Ja==this){this.ob&&this.ob.Da(e);this.ob=b}};o.pG=function(a){if(a.target==this.ob)this.ob=h};
o.ee=function(a){this.Xb&&this.ff(j);var b=this.Qa();this.D.mH(b)?b.focus():a.preventDefault()};o.yG=function(){this.ff(e)};o.oG=function(a){var b=this.JF(a.target);if(b)switch(a.type){case gd:b.ee(a);break;case hd:b.nj(a);break;case Fc:b.Tf(a);break;case Gc:b.mj(a);break}};o.JF=function(a){if(this.De){var b=this.b();while(a&&a.parentNode&&a!=b){var c=a.id;if(c in this.De)return this.De[c];a=a.parentNode}}return h};o.cm=function(){};o.Dc=function(){this.Tb(-1);this.ff(e);this.ob&&this.ob.Da(e)};
o.Pb=function(a){if(this.J()&&this.Ke()!=0&&this.lh(a)){a.preventDefault();a.stopPropagation();return j}return e};
o.lh=function(a){var b=this.Jf();if(b&&typeof b.Pb=="function"&&b.Pb(a))return j;if(this.ob&&this.ob!=b&&typeof this.ob.Pb=="function"&&this.ob.Pb(a))return j;switch(a.keyCode){case 27:if(this.le())this.Qa().blur();else return e;break;case 36:this.ix();break;case 35:this.BH();break;case 38:if(this.vd==oh)this.Eq();else return e;break;case 37:if(this.vd==nh)this.Xf()?this.Dq():this.Eq();else return e;break;case 40:if(this.vd==oh)this.Dq();else return e;break;case 39:if(this.vd==nh)this.Xf()?this.Eq():
this.Dq();else return e;break;default:return e}return j};o.Ae=function(a,b,c){a.Nz(2,j);a.Nz(64,j);if(this.le()||!this.NB)a.Ed(32,e);a.rs(e);rh.d.Ae.call(this,a,b,c);var d=a.b();if(d){if(!d.id)d.id=a.Gb();if(!this.De)this.De={};fc(this.De,d.id,a)}c&&this.X&&this.Xf()&&this.vd==nh&&E&&!qb("1.9a")&&ph(a);b<=this.hb&&this.hb++};
o.removeChild=function(a,b){var c=this.nm(a);if(c!=-1)if(c==this.hb)a.wc(e);else c<this.hb&&this.hb--;b&&this.X&&this.Xf()&&this.vd==nh&&E&&!qb("1.9a")&&qh(a);var d=a.b();d&&d.id&&ec(this.De,d.id);a=rh.d.removeChild.call(this,a,b);a.rs(j);return a};o.Tz=function(a){if(this.b())k(Error(wg));this.vd=a};o.oa=function(){return this.tb};o.o=function(a,b){if(b||this.tb!=a&&this.dispatchEvent(a?"show":"hide")){this.tb=a;var c=this.b();if(c){bg(c,a);this.le()&&this.D.Dp(this.Qa(),this.Xb&&this.tb)}return j}return e};
o.J=function(){return this.Xb};o.u=function(a){if(this.Xb!=a&&this.dispatchEvent(a?"enable":"disable")){if(a){this.Xb=j;this.Je(function(b){if(b.TA)delete b.TA;else b.u(j)})}else{this.Je(function(b){if(b.J())b.u(e);else b.TA=j});this.Xb=e;this.ff(e)}this.le()&&this.D.Dp(this.Qa(),a&&this.tb)}};o.le=function(){return this.Pp};o.ec=function(a){a!=this.Pp&&this.X&&this.pv(a);this.Pp=a;this.Xb&&this.tb&&this.D.Dp(this.Qa(),a)};o.Tb=function(a){var b=this.Ff(a);if(b)b.wc(j);else this.hb>-1&&this.Jf().wc(e)};
o.wc=function(a){this.Tb(this.nm(a))};o.Jf=function(){return this.Ff(this.hb)};o.ix=function(){this.jm(function(a,b){return(a+1)%b},this.Ke()-1)};o.BH=function(){this.jm(function(a,b){a--;return a<0?b-1:a},0)};o.Dq=function(){this.jm(function(a,b){return(a+1)%b},this.hb)};o.Eq=function(){this.jm(function(a,b){a--;return a<0?b-1:a},this.hb)};o.jm=function(a,b){var c=b<0?this.nm(this.ob):b,d=this.Ke();c=a(c,d);var f=0;while(f<=d){var g=this.Ff(c);if(g&&this.ku(g)){this.cL(c);return j}f++;c=a(c,d)}return e};
o.ku=function(a){return a.oa()&&a.J()&&a.Fc(2)};o.cL=function(a){this.Tb(a)};o.ff=function(a){this.sr=a};var sh=function(){mh.call(this)};z(sh,mh);ga(sh);o=sh.prototype;o.nd=function(){return"menu"};o.fc=function(a){return a.tagName=="UL"||sh.d.fc.call(this,a)};o.Ri=function(a){return a.tagName=="HR"?new lh:sh.d.Ri.call(this,a)};o.jd=function(a,b){return ie(a.b(),b)};o.U=function(){return"goog-menu"};o.Ec=function(a){sh.d.Ec.call(this,a);var b=a.b();Jg(b,"menu");Kg(b,"haspopup","true")};var th=function(a){lh.call(this,jh.Ga(),a)};z(th,lh);Rg(kh,function(){return new lh});var uh=function(a,b){rh.call(this,oh,b||sh.Ga(),a);this.ec(e)};z(uh,rh);o=uh.prototype;o.so=j;o.OB=e;o.U=function(){return this.D.U()};o.jd=function(a){return this.D.jd(this,a)||this.cH()&&yb(this.ub,function(b){return typeof b.jd=="function"&&b.jd(a)})};o.Z=function(a){this.Nt(a,j)};o.Md=function(a,b){this.Ae(a,b,j)};o.Me=function(a){return this.Ff(a)};o.gh=function(){return this.Ke()};o.Ne=function(){return this.ub||[]};
o.setPosition=function(a,b){var c=this.oa();c||bg(this.b(),j);Yf(this.b(),a,b);c||bg(this.b(),e)};o.ce=function(){return this.oa()?Wf(this.b()):h};o.Jh=function(a){this.so=a;a&&this.ec(j)};o.o=function(a,b){var c=uh.d.o.call(this,a,b);c&&a&&this.X&&this.so&&this.Qa().focus();return c};o.sq=function(a){this.so&&this.Qa().focus();return uh.d.sq.call(this,a)};o.ku=function(a){return(this.OB||a.J())&&a.oa()&&a.Fc(2)};var vh=function(a,b){this.C=new zf(this);this.ZK(a||h);b&&this.vL(b)};z(vh,I);var wh="toggle_display";o=vh.prototype;o.n=h;o.lC=j;o.Yt=h;o.$f=e;o.FL=e;o.Tx=-1;o.Rx=-1;o.AH=e;o.yc=wh;o.fj=function(){return this.yc};o.vL=function(a){this.yc=a};o.b=function(){return this.n};o.ZK=function(a){this.pE();this.n=a};o.pE=function(){if(this.$f)k(Error("Can not change this state of the popup while showing."))};o.oa=function(){return this.$f};
o.o=function(a){if(a){if(!this.n)k(Error("Caller must call setElement before trying to show thepopup"));this.fk()}else this.nh()};o.ua=function(){};
o.fk=function(){if(this.$f)return;if(!this.$I())return;this.ua();var a=M(this.n);this.AH&&this.C.e(a,jd,this.hJ,j);if(this.lC){this.C.e(a,gd,this.yy,j);if(B){var b=a.activeElement;while(b&&b.nodeName=="IFRAME"){try{var c=ne(b)}catch(d){break}a=c;b=a.activeElement}this.C.e(a,gd,this.yy,j);this.C.e(a,"deactivate",this.xy)}else this.C.e(a,"blur",this.xy)}if(this.yc==wh)this.LL();else this.yc=="move_offscreen"&&this.ua();this.$f=j;this.Sm()};
o.nh=function(a){if(!this.$f||!this.ZI(a))return e;this.C&&this.C.Ya();if(this.yc==wh)this.FL?Cd(this.gx,0,this):this.gx();else this.yc=="move_offscreen"&&this.RI();this.$f=e;this.kJ(a);return j};o.LL=function(){this.n.style.visibility="visible";bg(this.n,j)};o.gx=function(){this.n.style.visibility="hidden";bg(this.n,e)};o.RI=function(){this.n.style.left="-200px";this.n.style.top="-200px"};o.$I=function(){return this.dispatchEvent("beforeshow")};o.Sm=function(){this.Tx=ua();this.Rx=-1;this.dispatchEvent("show")};
o.ZI=function(a){return this.dispatchEvent({type:"beforehide",target:a})};o.kJ=function(a){this.Rx=ua();this.dispatchEvent({type:"hide",target:a})};o.yy=function(a){var b=a.target;if(!ie(this.n,b)&&(!this.Yt||ie(this.Yt,b))&&!this.gA())this.nh(b)};o.hJ=function(a){if(a.keyCode==27)if(this.nh(a.target)){a.preventDefault();a.stopPropagation()}};o.xy=function(a){var b=M(this.n);if(B||A){var c=b.activeElement;if(c&&ie(this.n,c))return}else if(a.target!=b)return;if(this.gA())return;this.nh()};
o.gA=function(){return ua()-this.Tx<150};o.l=function(){vh.d.l.call(this);this.C.k();delete this.n;delete this.C};var zh=function(a,b,c,d,f,g,i){var l=Wf(c),m=Wf(a),n=new yd(m.x-l.x+c.offsetLeft,m.y-l.y+c.offsetTop),q=1,r=1,t=$f(a);switch(xh(a,b)){case 1:break;case 2:n.x+=t.width;q=-1;break;case 3:n.y+=t.height;r=-1;break;case 4:n.x+=t.width;n.y+=t.height;q=-1;r=-1;break}if(f){n.x+=q*f.x;n.y+=r*f.y}return yh(n,c,d,g,i)},yh=function(a,b,c,d,f){var g=a.x,i=a.y,l=xh(b,c);if(d||l!=1){var m=$f(b);switch(l){case 1:g+=d.left;i+=d.top;break;case 2:g-=m.width;if(d){g-=d.right;i+=d.top}break;case 3:i-=m.height;if(d){g+=
d.left;i-=d.bottom}break;case 4:g-=m.width;i-=m.height;if(d){g-=d.right;i-=d.bottom}break}}var n=j,q=f||0;if(q!=0){var r=N(b),t=$f(b),v=Ud(r.$()),x=r.od(),C=new Fd(0,0);Ah(C,g,i,v,x);var J=q&48,D=J&&Bh(t,q,v,d),L=e;if(t.width>C.width)if(q&1){g-=t.width-C.width;L=j}else if(q&2)n=e;if(t.height>C.height)if(q&4){i-=t.height-C.height;L=j}else if(q&8)n=e;if(g-x.x<0)if(q&1){g=x.x;L=j}else if(q&2)n=e;if(i-x.y<0)if(q&4){i=x.y;L=j}else if(q&8)n=e;if(n&&J){L&&Ah(C,g,i,v,x);D=Bh(t,q,C,d)||D;D&&Zf(b,t)}}n&&Uf(b,
g,i);return n},Ah=function(a,b,c,d,f){a.width=d.width-(b-f.x);a.height=d.height-(c-f.y)},Bh=function(a,b,c,d){var f=e;if(b&16){var g=d?d.right+d.left:0;if(a.width+g>c.width){a.width=c.width-g;f=j}}if(b&32){var i=d?d.top+d.bottom:0;if(a.height+i>c.height){a.height=c.height-i;f=j}}return f},xh=function(a,b){var c=gg(a);switch(b){case 1:case 2:case 3:case 4:return b;case 5:return c?2:1;case 6:return c?1:2;case 7:return c?4:3;case 8:return c?3:4}},Ch=function(a){switch(a){case 1:return 2;case 2:return 1;
case 3:return 4;case 4:return 3;case 5:return 6;case 6:return 5;case 7:return 8;case 8:return 7}},Dh=function(a){switch(a){case 1:return 3;case 2:return 4;case 3:return 1;case 4:return 2;case 5:return 7;case 6:return 8;case 7:return 5;case 8:return 6}};var Eh=function(){};Eh.prototype.ua=function(){};var Fh=function(a,b){this.$d=a;this.xi=b};z(Fh,Eh);Fh.prototype.ua=function(a,b,c){zh(this.$d,this.xi,a,b,h,c)};var Gh=function(a,b,c){Fh.call(this,a,b);this.MB=c||e};z(Gh,Fh);
Gh.prototype.ua=function(a,b,c){var d=zh(this.$d,this.xi,a,b,h,c,10);if(!d){d=zh(this.$d,b,a,this.xi,h,c,10);d||(this.MB?zh(this.$d,this.xi,a,b,h,c,5):zh(this.$d,this.xi,a,b,h,c,0))}};var Hh=function(a,b){this.wi=a instanceof yd?a:new yd(a,b)};z(Hh,Eh);Hh.prototype.ua=function(a,b,c){yh(this.wi,a,b,c)};var Ih=function(a,b){Hh.call(this,a,b)};z(Ih,Hh);Ih.prototype.ua=function(a,b,c){var d=Vf(a),f=new yd(this.wi.x+d.scrollLeft,this.wi.y+d.scrollTop);zh(d,1,a,b,f,c)};
var Jh=function(a,b){Ih.call(this,a,b)};z(Jh,Ih);Jh.prototype.ua=function(a,b,c){var d=Vf(a),f=N(d).od(),g=new yd(this.wi.x+f.x,this.wi.y+f.y);if(zh(d,1,a,b,g,c,10))return;if(zh(d,1,a,Dh(b),g,c,10))return;if(zh(d,1,a,Ch(b),g,c,10))return;if(zh(d,1,a,Dh(Ch(b)),g,c,10))return;zh(d,1,a,b,g,c)};var Kh=function(a){uh.call(this,a);this.Jh(j);this.Ic=new tc};z(Kh,uh);o=Kh.prototype;o.tb=e;o.bM=e;o.Sx=0;o.Ku=h;o.Ud=function(a){Kh.d.Ud.call(this,a);var b=a.getAttribute("for")||a.htmlFor;b&&this.mi(this.g.b(b),3)};o.Oa=function(){Kh.d.Oa.call(this);rc(this.Ic,this.Xt,this);this.C.e(this,vg,this.vy);this.C.e(this.g.s(),gd,this.Pm,j);F&&this.C.e(this.g.s(),pd,this.Pm,j)};
o.xa=function(){Kh.d.xa.call(this);rc(this.Ic,this.Qu,this);this.C.W(this,vg,this.vy);this.C.W(this.g.s(),gd,this.Pm,j);F&&this.C.W(this.g.s(),pd,this.Pm,j)};o.mi=function(a,b,c,d,f){var g=s(a);if(this.Ic.Lc(g))return;var i={n:a,vA:b,hy:c,xv:d?pd:gd,II:f};this.Ic.h(g,i);this.X&&this.Xt(i)};o.Xt=function(a){this.C.e(a.n,a.xv,this.My)};o.detach=function(a){var b=s(a);if(!this.Ic.Lc(b))k(Error("Menu not attached to provided element, unable to detach."));this.X&&this.Qu(this.Ic.Ea(b));this.Ic.remove(b)};
o.Qu=function(a){this.C.W(a.n,a.xv,this.My)};o.Cs=function(a,b,c){var d=this.oa();if((d||this.MM())&&this.bM){this.hide();return}if(!this.dispatchEvent("beforeshow"))return;var f=a.vA?new Gh(a.n,a.vA):new Jh(b,c),g=a.hy||5;if(!d)this.b().style.visibility="hidden";bg(this.b(),j);f.ua(this.b(),g,a.II);if(!d)this.b().style.visibility="visible";this.Ku=a.n;this.Tb(-1);this.o(j)};o.zs=function(a,b,c){this.Cs({hy:c},a,b)};o.hide=function(){this.o(e);if(!this.oa()){this.Sx=ua();this.Ku=h}};
o.MM=function(){return ua()-this.Sx<150};o.vy=function(){this.hide()};o.My=function(a){var b=this.Ic.Lf();for(var c=0;c<b.length;c++){var d=this.Ic.Ea(b[c]);if(d.n==a.currentTarget){this.Cs(d,a.clientX,a.clientY);a.preventDefault();a.stopPropagation();return}}};o.Pm=function(a){this.oa()&&!this.jd(a.target)&&this.hide()};o.Dc=function(a){Kh.d.Dc.call(this,a);this.hide()};o.l=function(){Kh.d.l.call(this);if(this.Ic){this.Ic.clear();delete this.Ic}};var Oh=function(a,b,c,d,f,g){Lh(a);var i=Mh(d,f,g);ub(i,function(l){a.Ae(l,0,j)});if(b==40||b==30&&c)Nh(a,j,j,j,j);else b==30?Nh(a,e,j,e,e):Nh(a,e,e,e,e)},Lh=function(a){var b=a.Xv();for(var c=0;c<b.length;c++){var d=a.j(b[c]);switch(d.Ej){case "invite":case "access":case "domain":case "public":a.removeChild(d,j);break}}},Nh=function(a,b,c,d,f){a.Je(function(g){switch(g.Ej){case "invite":ba(b)&&g.u(b);break;case "access":ba(c)&&g.u(c);break;case "domain":ba(d)&&g.u(d);break;case "public":ba(f)&&g.u(f);
break}})},Mh=function(a,b,c){b=ka(b)?b:[b];var d=[],f=new $g("\u9080\u8bf7\u4ed6\u4eba...","share-menu-invite-icon",undefined,"invite",c);d.push(f);var g=new $g("\u67e5\u770b\u53ef\u4ee5\u8bbf\u95ee\u7684\u4eba\u5458","share-menu-view-icon",undefined,"access",c);d.push(g);if(a.Gb()!="DEFAULT"){var i=new $g("\u4e0e "+((a.Fj||"\u60a8\u7684\u57df\u4e2d\u7684\u6bcf\u4e2a\u4eba")+" \u5171\u4eab"),"share-menu-domain-icon",undefined,"domain",c);d.push(i)}if(zb(b,function(m){return m.EL.QC||m.Gb()=="DEFAULT"})){var l=
new $g("\u4e0e\u6240\u6709\u4eba\u5171\u4eab","share-menu-world-icon",undefined,"public",c);d.push(l)}return d};var Ph=function(a){I.call(this);this.n=a;var b=B?"focusout":"blur";this.CI=H(this.n,B?"focusin":"focus",this,!B);this.DI=H(this.n,b,this,!B)};z(Ph,I);Ph.prototype.handleEvent=function(a){var b=new Dc(a.fb);b.type=a.type=="focusin"||a.type=="focus"?"focusin":"focusout";try{this.dispatchEvent(b)}finally{b.k()}};Ph.prototype.l=function(){Ph.d.l.call(this);cd(this.CI);cd(this.DI);delete this.n};var Qh=function(a,b,c){this.target=a;this.bm=b||a;this.Cm=c||new Lf;this.mb=a.ownerDocument||a.document;H(this.bm,gd,this.pA,e,this)};z(Qh,I);o=Qh.prototype;o.screenX=0;o.screenY=0;o.qA=0;o.rA=0;o.Di=0;o.Ei=0;o.Xb=j;o.He=e;o.nx=0;o.QI=0;o.jL=function(a){this.Cm=a||new Lf};o.u=function(a){this.Xb=a};o.l=function(){Qh.d.l.call(this);ad(this.bm,gd,this.pA,e,this);ad(this.mb,id,this.tr,e,this);ad(this.mb,hd,this.wl,e,this);this.Oj&&ad(this.Oj,"scroll",this.Br,e,this);delete this.target;delete this.bm};
o.pA=function(a){if(this.Xb&&!this.He){if(this.nx==0){this.wx(a);if(this.He)a.preventDefault();else return}else a.preventDefault();H(this.mb,id,this.tr,e,this);H(this.mb,hd,this.wl,e,this);this.Oj&&H(this.Oj,"scroll",this.Br,e,this);this.screenX=this.qA=a.screenX;this.screenY=this.rA=a.screenY;this.Di=this.target.offsetLeft;this.Ei=this.target.offsetTop;this.Hj=N(this.mb).od();this.QI=ua()}};o.wx=function(a){if(this.dispatchEvent(new Rh("start",this,a.clientX,a.clientY,a))!==e)this.He=j};
o.wl=function(a){ad(this.mb,id,this.tr,e,this);ad(this.mb,hd,this.wl,e,this);this.Oj&&ad(this.Oj,"scroll",this.Br,e,this);if(this.He){this.He=e;var b=this.Vx(this.Di),c=this.Wx(this.Ei);this.dispatchEvent(new Rh("end",this,a.clientX,a.clientY,a,b,c))}};
o.tr=function(a){if(this.Xb){var b=a.screenX-this.screenX,c=a.screenY-this.screenY;this.screenX=a.screenX;this.screenY=a.screenY;if(!this.He){var d=this.qA-this.screenX,f=this.rA-this.screenY;if(d*d+f*f>this.nx){this.wx(a);if(!this.He){this.wl(a);return}}}var g=this.Sk(b,c),i=g.x,l=g.y;if(this.He)if(this.dispatchEvent(new Rh("beforedrag",this,a.clientX,a.clientY,a,i,l))!==e){this.fv(a,i,l);a.preventDefault()}}};
o.Sk=function(a,b){var c=N(this.mb).od();a+=c.x-this.Hj.x;b+=c.y-this.Hj.y;this.Hj=c;this.Di+=a;this.Ei+=b;var d=this.Vx(this.Di),f=this.Wx(this.Ei);return new yd(d,f)};o.Br=function(a){var b=this.Sk(0,0);a.clientX=this.Hj.x-this.screenX;a.clientY=this.Hj.x-this.screenY;this.fv(a,b.x,b.y)};o.fv=function(a,b,c){this.JD(b,c);this.dispatchEvent(new Rh("drag",this,a.clientX,a.clientY,a,b,c))};
o.Vx=function(a){var b=this.Cm,c=typeof b.left!="undefined"?b.left:h,d=typeof b.width!="undefined"?b.width:0;return Math.min(c!=h?c+d:Infinity,Math.max(c!=h?c:-Infinity,a))};o.Wx=function(a){var b=this.Cm,c=typeof b.top!="undefined"?b.top:h,d=typeof b.height!="undefined"?b.height:0;return Math.min(c!=h?c+d:Infinity,Math.max(c!=h?c:-Infinity,a))};o.JD=function(a,b){this.target.style.left=a+"px";this.target.style.top=b+"px"};
var Rh=function(a,b,c,d,f,g,i){G.call(this,a);this.type=a;this.clientX=c;this.clientY=d;this.eu=f;this.left=ba(g)?g:b.Di;this.top=ba(i)?i:b.Ei;this.wN=b};z(Rh,G);var Th=function(a,b,c){sg.call(this,c);this.Mb=a||"modal-dialog";this.jt=!!b;this.Ab=Sh;this.r=new zf(this);this.Ni=new Ph(this.g.s())};z(Th,sg);o=Th.prototype;o.Mb=h;o.jt=e;o.Im=j;o.hv=j;o.mC=0.3;o.Kn="";o.pa="";o.Ab=h;o.Tg=h;o.tb=e;o.gE=e;o.bb=h;o.cb=h;o.xc=h;o.$c=h;o.Ts=h;o.xe=h;o.qc=h;o.Kb=h;o.r=h;o.xb=function(){return this.r};o.rb=function(a){this.Kn=a;this.$c&&oe(this.$c,a)};o.Sb=function(a){this.pa=a;if(this.qc)this.qc.innerHTML=a};o.Ba=function(){this.qc||this.zb();return this.qc};
o.YF=function(){this.X||this.zb();return this.xc};o.ZF=function(){this.X||this.zb();return this.$c};o.XF=function(){this.X||this.zb();return this.xe};o.Xp=function(){this.X||this.zb();return this.Kb};o.dF=function(){this.X||this.zb();return this.bb};o.uD=function(){var a=new Qh(this.b(),this.xc);Kd(this.xc,this.Mb+"-title-draggable");return a};
o.f=function(){this.cy();this.Nh(this.g.f("div",{className:this.Mb,tabIndex:0},this.xc=this.g.f("div",{className:this.Mb+"-title",id:this.Gb()},this.$c=this.g.f("span",{className:this.Mb+"-title-text"},this.Kn),this.xe=this.g.f("span",{className:this.Mb+"-title-close"})),this.qc=this.g.f("div",{className:this.Mb+"-content"}),this.Kb=this.g.f("div",{className:this.Mb+"-buttons"}),this.tA=this.g.f("span",{tabIndex:0})));this.Ts=this.xc.id;Jg(this.b(),"dialog");Kg(this.b(),"labelledby",this.Ts);if(this.pa)this.qc.innerHTML=
this.pa;bg(this.b(),e);this.Ab&&this.Ab.vo(this.Kb)};o.cy=function(){if(this.jt&&this.Im&&!this.cb){this.cb=this.g.f("iframe",{frameborder:0,style:"border: 0; vertical-align: bottom",src:'javascript:""'});this.cb.className=this.Mb+"-bg";bg(this.cb,e);ag(this.cb,0)}else if((!this.jt||!this.Im)&&this.cb){Q(this.cb);this.cb=h}if(this.Im&&!this.bb){this.bb=this.g.f("div",{className:this.Mb+"-bg"});ag(this.bb,this.mC);bg(this.bb,e)}else if(!this.Im&&this.bb){Q(this.bb);this.bb=h}};
o.zb=function(a){if(this.X)k(Error(wg));this.b()||this.f();var b=a||this.g.s().body;this.qz(b);Th.d.zb.call(this,b)};o.qz=function(a){this.cb&&a.appendChild(this.cb);this.bb&&a.appendChild(this.bb)};o.fc=function(a){return a&&a.tagName&&a.tagName=="DIV"&&Th.d.fc.call(this,a)};
o.Ud=function(a){Th.d.Ud.call(this,a);Kd(this.b(),this.Mb);var b=this.Mb+"-content";this.qc=re(this.b(),function(i){return i.nodeType==1&&Nd(i,b)});if(this.qc)this.pa=this.qc.innerHTML;else{this.qc=this.g.f("div",{className:b});if(this.pa)this.qc.innerHTML=this.pa;this.b().appendChild(this.qc)}var c=this.Mb+"-title",d=this.Mb+"-title-text",f=this.Mb+"-title-close";this.xc=re(this.b(),function(i){return i.nodeType==1&&Nd(i,c)});if(this.xc){this.$c=re(this.xc,function(i){return i.nodeType==1&&Nd(i,
d)});this.xe=re(this.xc,function(i){return i.nodeType==1&&Nd(i,f)})}else{this.xc=this.g.f("div",{className:c});this.b().insertBefore(this.xc,this.qc)}if(this.$c)this.Kn=xe(this.$c);else{this.$c=this.g.f("span",{className:d},this.Kn);this.xc.appendChild(this.$c)}Kg(this.b(),"labelledby",this.Ts);if(!this.xe){this.xe=this.g.f("span",{className:f});this.xc.appendChild(this.xe)}var g=this.Mb+"-buttons";this.Kb=re(this.b(),function(i){return i.nodeType==1&&Nd(i,g)});if(this.Kb){this.Ab=new Uh(this.g);
this.Ab.ja(this.Kb)}else{this.Kb=this.g.f("div",{className:g});this.b().appendChild(this.Kb);this.Ab&&this.Ab.vo(this.Kb)}this.cy();this.qz(M(this.b()).body);bg(this.b(),e)};o.Oa=function(){Th.d.Oa.call(this);if(this.hv&&!this.Tg)this.Tg=this.uD();this.r.e(this.xe,Ic,this.Oy);this.r.e(this.Ni,"focusin",this.Ey);Jg(this.b(),"dialog");this.$c.id!==""&&Kg(this.b(),"labelledby",this.$c.id)};
o.xa=function(){this.r.W(this.xe,Ic,this.Oy);this.r.W(this.Ni,"focusin",this.Ey);this.oa()&&this.o(e);if(this.Tg){this.Tg.k();this.Tg=h}Th.d.xa.call(this)};
o.o=function(a){if(a==this.tb)return;var b=this.g.s(),c=Wd(b)||window;this.X||this.zb(b.body);if(a){this.vz();this.ua();this.r.e(this.b(),jd,this.Gy,j);this.r.e(c,nd,this.Ky,j)}else{this.r.W(this.b(),jd,this.Gy,j);this.r.W(c,nd,this.Ky,j)}this.cb&&bg(this.cb,a);this.bb&&bg(this.bb,a);bg(this.b(),a);if(a){E&&this.b().focus();if(this.Ab){var d=this.Ab.kl;if(d){var f=this.Kb.getElementsByTagName("button");for(var g=0,i;i=f[g];g++)if(i.name==d){try{if(F||A){var l=b.createElement("input");l.style.cssText=
"position:fixed;width:0;height:0";this.b().appendChild(l);l.focus();this.b().removeChild(l)}i.focus()}catch(m){}break}}}}this.tb=a;if(a)this.r.e(this.Kb,Ic,this.wy);else{this.r.W(this.Kb,Ic,this.wy);this.dispatchEvent("afterhide");this.gE&&this.k()}};o.oa=function(){return this.tb};
o.vz=function(){this.cb&&bg(this.cb,e);this.bb&&bg(this.bb,e);var a=this.g.s(),b=Wd(a)||window,c=Ud(b),d=a.body.scrollWidth,f=Math.max(a.body.scrollHeight,c.height);if(this.cb){bg(this.cb,j);Zf(this.cb,d,f)}if(this.bb){bg(this.bb,j);Zf(this.bb,d,f)}if(this.hv){var g=$f(this.b());this.Tg.Cm=new Lf(0,0,d-g.width,f-g.height)}};
o.ua=function(){var a=this.g.s(),b=Wd(a)||window;if(Tf(this.b())=="fixed"){var c=0,d=0}else{var f=this.g.od(),c=f.x,d=f.y}var g=$f(this.b()),i=Ud(b),l=Math.max(c+i.width/2-g.width/2,0),m=Math.max(d+i.height/2-g.height/2,0);Uf(this.b(),l,m)};o.Oy=function(){var a=this.Ab,b=a&&a.Go;if(b){var c=a.Ea(b);this.dispatchEvent(new Vh(b,c))&&this.o(e)}else this.o(e)};
o.l=function(){Th.d.l.call(this);if(this.r){this.r.k();this.r=h}if(this.Ni){this.Ni.k();this.Ni=h}if(this.bb){Q(this.bb);this.bb=h}if(this.cb){Q(this.cb);this.cb=h}this.xe=h;this.Kb=h;this.tA=h};o.ef=function(a){this.Ab=a;this.Kb&&this.Ab.vo(this.Kb)};o.wy=function(a){var b=this.uE(a.target);if(b){var c=b.name,d=this.Ab.Ea(c);this.dispatchEvent(new Vh(c,d))&&this.o(e)}};o.uE=function(a){var b=a;while(b!=h&&b!=this.Kb){if(b.tagName=="BUTTON")return b;b=b.parentNode}return h};
o.Gy=function(a){var b=this.Ab;if(a.keyCode==27){var c=b&&b.Go;if(c){var d=b.Ea(c);this.dispatchEvent(new Vh(c,d))&&this.o(e)}else this.o(e);a.stopPropagation()}else if(a.keyCode==13){var f=a.target&&a.target.tagName=="BUTTON"?a.target.name:b&&b.kl;if(f&&this.dispatchEvent(new Vh(f,String(b.Ea(f))))){this.o(e);a.preventDefault()}a.stopPropagation()}else if(a.keyCode==9&&a.shiftKey&&a.target==this.b()){a.preventDefault();a.stopPropagation()}};o.Ky=function(){this.vz()};
o.Ey=function(a){this.tA==a.target&&Cd(this.EE,0,this)};o.EE=function(){B&&this.g.s().body.focus();this.b().focus()};var Vh=function(a,b){this.type="dialogselect";this.Qb=a;this.caption=b};z(Vh,G);var Uh=function(a){this.g=a||N();tc.call(this)},Sh;z(Uh,tc);o=Uh.prototype;o.kl=h;o.n=h;o.Go=h;o.h=function(a,b,c,d){tc.prototype.h.call(this,a,b);if(c)this.kl=a;if(d)this.Go=a;return this};o.vo=function(a){this.n=a;this.zb()};
o.zb=function(){if(this.n){this.n.innerHTML="";var a=N(this.n);rc(this,function(b,c){this.n.appendChild(a.f("button",{name:c},b))},this)}};o.ja=function(a){if(!a||a.nodeType!=1)return;this.n=a;var b=this.n.getElementsByTagName("button");for(var c=0,d,f,g;d=b[c];c++){f=d.name||d.id;g=xe(d)||d.value;f&&this.h(f,g,c==0,d.name==Wh)}};o.Lz=function(a){this.kl=a};var Wh="cancel";(function(){Sh=(new Uh).h("ok","\u786e\u5b9a",j).h(Wh,"\u53d6\u6d88",e,j)})();var Xh=function(a,b){var c;if(a instanceof Xh){this.Ph(b==h?a.rd:b);this.tn(a.Ad);this.wn(a.wg);this.nn(a.yf);this.sn(a.$e);this.$j(a.xd);this.mg(a.Jb.za());this.qn(a.Ef)}else if(a&&(c=String(a).match(Yh()))){this.Ph(!!b);this.tn(c[1],j);this.wn(c[2],j);this.nn(c[3],j);this.sn(c[4]);this.$j(c[5],j);this.mg(c[6]);this.qn(c[7],j)}else{this.Ph(!!b);this.Jb=new Zh(h,this,this.rd)}};o=Xh.prototype;o.Ad="";o.wg="";o.yf="";o.$e=h;o.xd="";o.Ef="";o.oI=e;o.rd=e;
o.toString=function(){if(this.Wb)return this.Wb;var a=[];this.Ad&&a.push($h(this.Ad,ai),":");if(this.yf){a.push("//");this.wg&&a.push($h(this.wg,ai),"@");a.push(bi(this.yf));this.$e!=h&&a.push(":",String(this.$e))}this.xd&&a.push($h(this.xd,ci));var b=String(this.Jb);b&&a.push("?",b);this.Ef&&a.push("#",$h(this.Ef,di));return this.Wb=a.join("")};
o.Rr=function(a){var b=this.za(),c=a.lH();if(c)b.tn(a.Ad);else c=a.oH();if(c)b.wn(a.wg);else c=a.dx();if(c)b.nn(a.yf);else c=a.hH();var d=a.xd;if(c)b.sn(a.$e);else{c=a.fx();if(c){if(d.charAt(0)!="/")if(this.dx()&&!this.fx())d="/"+d;else{var f=b.xd.lastIndexOf("/");if(f!=-1)d=b.xd.substr(0,f+1)+d}d=ei(d)}}if(c)b.$j(d);else c=a.jH();if(c)b.mg(a.MF());else c=a.fH();c&&b.qn(a.Ef);return b};o.za=function(){return fi(this.Ad,this.wg,this.yf,this.$e,this.xd,this.Jb.za(),this.Ef,this.rd)};
o.tn=function(a,b){this.ae();delete this.Wb;this.Ad=b?a?decodeURIComponent(a):"":a;if(this.Ad)this.Ad=this.Ad.replace(/:$/,"");return this};o.lH=function(){return!!this.Ad};o.wn=function(a,b){this.ae();delete this.Wb;this.wg=b?a?decodeURIComponent(a):"":a;return this};o.oH=function(){return!!this.wg};o.nn=function(a,b){this.ae();delete this.Wb;this.yf=b?a?decodeURIComponent(a):"":a;return this};o.dx=function(){return!!this.yf};
o.sn=function(a){this.ae();delete this.Wb;if(a){a=Number(a);if(isNaN(a)||a<0)k(Error("Bad port number "+a));this.$e=a}else this.$e=h;return this};o.hH=function(){return this.$e!=h};o.$j=function(a,b){this.ae();delete this.Wb;this.xd=b?a?decodeURIComponent(a):"":a;return this};o.fx=function(){return!!this.xd};o.jH=function(){return this.Jb.toString()!==""};
o.mg=function(a){this.ae();delete this.Wb;if(a instanceof Zh){this.Jb=a;this.Jb.ht=this;this.Jb.Ph(this.rd)}else this.Jb=new Zh(a,this,this.rd);return this};o.MF=function(){return this.Jb.toString()};o.ea=function(a,b){this.ae();delete this.Wb;this.Jb.h(a,b);return this};o.qd=function(a){return this.Jb.Ea(a)};o.qn=function(a,b){this.ae();delete this.Wb;this.Ef=b?a?decodeURIComponent(a):"":a;return this};o.fH=function(){return!!this.Ef};o.ay=function(){this.ae();this.ea("zx",Xa());return this};
o.ae=function(){if(this.oI)k(Error("Tried to modify a read-only Uri"))};o.Ph=function(a){this.rd=a;this.Jb&&this.Jb.Ph(a)};
var fi=function(a,b,c,d,f,g,i,l){var m=new Xh(h,l);a&&m.tn(a);b&&m.wn(b);c&&m.nn(c);d&&m.sn(d);f&&m.$j(f);g&&m.mg(g);i&&m.qn(i);return m},ei=function(a){if(a==".."||a==".")return"";else if(!(a.indexOf("./")!=-1)&&!(a.indexOf("/.")!=-1))return a;else{var b=a.indexOf("/")==0,c=a.split("/"),d=[];for(var f=0;f<c.length;){var g=c[f++];if(g==".")b&&f==c.length&&d.push("");else if(g==".."){if(d.length>1||d.length==1&&d[0]!="")d.pop();b&&f==c.length&&d.push("")}else{d.push(g);b=j}}return d.join("/")}};
var bi=function(a){if(ma(a))return encodeURIComponent(a);return h},gi=/^[a-zA-Z0-9\-_.!~*'():\/;?]*$/,$h=function(a,b){var c=h;if(ma(a)){c=a;gi.test(c)||(c=encodeURI(a));if(c.search(b)>=0)c=c.replace(b,hi)}return c},hi=function(a){var b=a.charCodeAt(0);return"%"+(b>>4&15).toString(16)+(b&15).toString(16)},ii=h,Yh=function(){ii||(ii=/^(?:([^:\/?#]+):)?(?:\/\/(?:([^\/?#]*)@)?([^\/?#:@]*)(?::([0-9]+))?)?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/);return ii},ai=/[#\/\?@]/g,ci=/[\#\?]/g,di=/#/g,Zh=function(a,
b,c){this.ib=new tc;this.ht=b||h;this.rd=!!c;if(a){var d=a.split("&");for(var f=0;f<d.length;f++){var g=d[f].indexOf("="),i=h,l=h;if(g>=0){i=d[f].substring(0,g);l=d[f].substring(g+1)}else i=d[f];i=decodeURIComponent(i.replace(/\+/g," "));i=this.Kf(i);this.add(i,l?decodeURIComponent(l.replace(/\+/g," ")):"")}}};var ji=function(a,b,c,d){if(a.length!=b.length)k(Error("Mismatched lengths for keys/values"));var f=new Zh(h,c,d);for(var g=0;g<a.length;g++)f.add(a[g],b[g]);return f};o=Zh.prototype;o.aa=0;
o.Pa=function(){return this.aa};o.add=function(a,b){this.uj();a=this.Kf(a);if(this.Lc(a)){var c=this.ib.Ea(a);ka(c)?c.push(b):this.ib.h(a,[c,b])}else this.ib.h(a,b);this.aa++;return this};o.remove=function(a){a=this.Kf(a);if(this.ib.Lc(a)){this.uj();var b=this.ib.Ea(a);if(ka(b))this.aa-=b.length;else this.aa--;return this.ib.remove(a)}return e};o.clear=function(){this.uj();this.ib.clear();this.aa=0};o.ke=function(){return this.aa==0};o.Lc=function(a){a=this.Kf(a);return this.ib.Lc(a)};
o.So=function(a){var b=this.Ob();return Cb(b,a)};o.Lf=function(){var a=this.ib.Ob(),b=this.ib.Lf(),c=[];for(var d=0;d<b.length;d++){var f=a[d];if(ka(f))for(var g=0;g<f.length;g++)c.push(b[d]);else c.push(b[d])}return c};o.Ob=function(a){var b;if(a){var c=this.Kf(a);if(this.Lc(c)){var d=this.ib.Ea(c);if(ka(d))return d;else{b=[];b.push(d)}}else b=[]}else{var f=this.ib.Ob();b=[];for(var g=0;g<f.length;g++){var i=f[g];ka(i)?Kb(b,i):b.push(i)}}return b};
o.h=function(a,b){this.uj();a=this.Kf(a);if(this.Lc(a)){var c=this.ib.Ea(a);if(ka(c))this.aa-=c.length;else this.aa--}this.ib.h(a,b);this.aa++;return this};o.Ea=function(a,b){a=this.Kf(a);if(this.Lc(a)){var c=this.ib.Ea(a);return ka(c)?c[0]:c}else return b};
o.toString=function(){if(this.Wb)return this.Wb;var a=[],b=0,c=this.ib.Lf();for(var d=0;d<c.length;d++){var f=c[d],g=Ha(f),i=this.ib.Ea(f);if(ka(i))for(var l=0;l<i.length;l++){b>0&&a.push("&");a.push(g,"=",Ha(i[l]));b++}else{b>0&&a.push("&");a.push(g,"=",Ha(i));b++}}return this.Wb=a.join("")};o.uj=function(){delete this.Wb;this.ht&&delete this.ht.Wb};o.za=function(){var a=new Zh;a.ib=this.ib.za();return a};o.Kf=function(a){var b=String(a);if(this.rd)b=b.toLowerCase();return b};
o.Ph=function(a){if(a&&!this.rd){this.uj();rc(this.ib,function(b,c){var d=c.toLowerCase();if(c!=d){this.remove(c);this.add(d,b)}},this)}this.rd=a};o.extend=function(){for(var a=0;a<arguments.length;a++)rc(arguments[a],function(b,c){this.add(c,b)},this)};var ki=function(a,b,c){I.call(this);var d=c;if(d)d.Ke>0&&d.Ae(new th,0,j);else d=new uh(this.pl);this.Sh=d;this.OI=!!c;(this.Em=new Xg(this.hB)).u(e);var f=new Th(undefined,undefined,b);f.ef(h);this.Na=f;this.gN=a;this.kt=ih;this.ar=[];this.pl=b;window.SC_setTitle=u(this.Zz,this);window.SC_resize=u(this.Qr,this);window.SC_setVisible=u(this.ps,this);window.SC_setAclInfo=u(this.QK,this);window.SC_dispatchEvent=u(this.dE,this)};z(ki,I);o=ki.prototype;o.$t=new Xh("share");o.r=h;o.th=h;o.Tu=e;o.PA=0;
o.kv=e;o.Lu=h;o.Hm=e;o.wr=0;o.hB="\u6b63\u5728\u8f7d\u5165...";o.hL=function(a){var b=ka(a)?a:[a];Ob(b);if(Qb(b,this.th))return;this.th=b;this.OI&&!this.Hm&&this.HJ()};o.QK=function(a,b,c,d){if(ba(a))this.PA=a;if(ba(b))this.kv=b;if(ba(c))this.kt=c?hh(c):ih;if(ba(d)){var f=ka(d)?d:[d];f=wb(f,function(g){return g?hh(g):ih});this.ar=f}this.BM()};o.Zz=function(a){this.Na.rb(a)};
o.HJ=function(){var a=this.Sh;for(var b=0;b<this.wr;b++)a.bK(0,j);this.wr=0;if(this.th&&!(this.th.length==0)){a.Ae(this.Em,0,j);this.Hm=j;this.yv("init")}};o.rF=function(){return this.r||(this.r=new zf(this))};o.lF=function(a){return Va('<iframe frameborder=0 src="',this.$F(a),'"></iframe>')};o.$F=function(a){var b=this.$t.za();b.ea("id",this.th);b.ea("command",a);return b.toString()};o.yv=function(a){this.Lu=a;this.Na.Sb(this.lF(a));this.ps(j,j)};
o.ZG=function(a){var b;switch(a.target.Ra()){case "access":b="access";break;case "invite":b="invite";break;case "domain":b="share_domain";break;case "public":b="share_world";break}b&&this.yv(b)};o.BM=function(){var a=this.Sh,b=this.kt,c=this.ar,d=this.PA,f=this.kv;if(this.Hm){a.removeChild(this.Em,j);var g=Mh(b,c,this.pl);ub(g,function(i){a.Ae(i,0,j)});this.wr=g.length;this.rF().e(this.Sh,vg,this.ZG);this.Lu=="init"&&this.ps(e);this.Hm=e}Oh(this.Sh,d,f,b,c,this.pl)};
o.Qr=function(a,b){var c=this.Na.Ba();c.style.width=a+"px";c.style.height=b+"px";if(B)this.Na.b().style.width=a+18+"px"};o.ps=function(a,b){this.LH();var c=this.Na,d=b?"hidden":"visible";c.b().style.visibility=d;c.dF().style.visibility=d;a&&c.o(!a);c.o(a)};o.dE=function(a){this.dispatchEvent(new G(a))};o.LH=function(){if(this.Tu)return;var a=this.Na;a.X||a.zb();Kd(a.b(),"share-client-dialog");this.Tu=j};
o.l=function(){ki.d.l.call(this);this.Sh.k();this.Sh=h;this.Em.k();this.Em=h;this.pl=h;this.Na.k();this.Na=h;if(this.r){this.r.k();this.r=h}this.th=h;this.ar=h;this.kt=h;this.$t=h};var li=function(a,b,c){this.py=a;this.uK=!!c;a&&!b&&this.next()};z(li,Tb);li.prototype.next=function(){var a=this.py;if(!a)k(Sb);this.py=this.uK?a.previousSibling:a.nextSibling;return a};var mi=function(a,b,c){ba(c)||(c=b&&a.childNodes.length?a.childNodes.length-1:0);li.call(this,a.childNodes[c],j,b)};z(mi,li);var ni=mc("ADDRESS","BLOCKQUOTE","BODY","CAPTION","CENTER","COL","COLGROUP","DIR","DIV","DL","DD","DT","FIELDSET","FORM","H1","H2","H3","H4","H5","H6","HR","ISINDEX","OL","LI","MAP","MENU","OPTGROUP","OPTION","P","PRE","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","TL","UL"),oi=function(a){return N(a).Zp()=="CSS1Compat"},qi=function(a){var b;while(b=pi(a))a=b;return a},si=function(a){var b;while(b=ri(a))a=b;return a},ri=function(a){return ti(a,e)},pi=function(a){return ti(a,j)},wi=function(a){return ui(Wb(new li(a,
e,j),vi))},xi=function(a){return ui(Wb(new li(a),vi))},ti=function(a,b){return!a||a.nodeType!=1?h:ui(Wb(new mi(a,b),vi))},ui=function(a){try{return a.next()}catch(b){return h}},vi=function(a){return a.nodeType==1||a.nodeType==3&&!Aa(a.nodeValue)};var yi=function(a){var b=ye(a);if(a.getElementsByTagName)var c=a.getElementsByTagName("IMG").length>0||a.getElementsByTagName("IFRAME").length>0||a.getElementsByTagName("embed").length>0;return!c&&(b==""||b=="\u00a0"||Aa(b))},zi=function(a){try{return a.activeElement}catch(b){}return h};
var Ai=function(a,b){for(var c=0,d=a.childNodes.length;c<d;c++)if(b(a.childNodes[c]))return c;return h},Bi=function(a){return!!ni[a.tagName]};var Ci=function(a){this.YL=a&&a>0?a:0},Di=/(?:<!--.*?--\>|<!.*?>|<(\/?)(\w+)[^>]*>|[^<]+|<)/g,Ei=mc("script","style","pre","xmp"),Fi=mc("address","applet","area","base","basefont","blockquote","body","caption","center","col","colgroup","dir","div","dl","fieldset","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","hr","html","iframe","isindex","legend","link","menu","meta","noframes","noscript","ol","optgroup","option","p","param","table","tbody","td","tfoot","th","thead","title","tr",
"ul"),Gi=mc("br","dd","dt","br","li","noframes"),Hi=mc("br","hr","isindex");
Ci.prototype.Il=function(a){var b=this.YL,c=b?ua():0,d=new Ii,f=0,g=[],i;while(i=Di.exec(a)){var l=i[0];if(i.length==3){var m=i[2];if(m)m=m.toLowerCase();if(Ei.hasOwnProperty(m))if(i[1]=="/"){var n=g.length;if((n?g[n-1]:h)==m){g.pop();d.zd(e,l,!g.length)}else d.zd(e,l,e)}else{d.zd(!g.length,l,e);g.push(m)}else if(g.length)d.zd(e,l,e);else if(Fi.hasOwnProperty(m)){var q=Hi.hasOwnProperty(m),r=i[1]=="/";d.zd(q||!r,l,q||r)}else if(Gi.hasOwnProperty(m)){var q=Hi.hasOwnProperty(m),r=i[1]=="/";d.zd(e,l,
r||q)}else d.zd(e,l,e)}else d.zd(e,l,e);var t=Di.lastIndex;if(!l||t<=f)k(Error("Regex failed to make progress through source html."));f=t;if(b)if(ua()-c>b){d.zd(e,a.substring(Di.lastIndex),e);Di.lastIndex=0;break}}d.zd(e,"",e);var v=String(d);if(v.length!=a.length+d.cu)k(Error("Lost data pretty printing html."));return v};var Ii=function(){this.Uy=new Oe};o=Ii.prototype;o.cu=0;o.Pq=j;o.oy=e;
o.zd=function(a,b,c){var d=this.Uy;if((this.oy||a)&&!this.Pq&&!/^\r?\n/.test(b)){d.Y("\n");++this.cu}d.Y(b);this.Pq=/\r?\n$/.test(b);this.oy=c&&!this.Pq};o.toString=function(){return this.Uy.toString()};var Ji=function(a){return 1-Math.pow(1-a,3)},Ki=function(a,b,c,d){I.call(this);if(!ka(a)||!ka(b))k(Error("Start and end parameters must be arrays"));if(a.length!=b.length)k(Error("Start and end points must be the same length"));this.jk=a;this.nE=b;this.zp=c;this.Jt=d;this.tf=[]};z(Ki,I);
var Li={},Mi=h,Ni=function(){Ad.clearTimeout(Mi);var a=ua();for(var b in Li)Li[b].Nu(a);Mi=dc(Li)?h:Ad.setTimeout(Ni,20)},Oi=function(a){var b=s(a);b in Li||(Li[b]=a);Mi||(Mi=Ad.setTimeout(Ni,20))},Pi=function(a){var b=s(a);delete Li[b];if(Mi&&dc(Li)){Ad.clearTimeout(Mi);Mi=h}};o=Ki.prototype;o.Ua=0;o.Mv=0;o.Gc=0;o.og=h;o.sv=h;o.gr=h;
o.play=function(a){if(a||this.Ua==0){this.Gc=0;this.tf=this.jk}else if(this.Ua==1)return e;Pi(this);this.og=ua();if(this.Ua==-1)this.og-=this.zp*this.Gc;this.sv=this.og+this.zp;this.gr=this.og;this.Gc||this.Wd("begin");this.Wd("play");this.Ua==-1&&this.Wd("resume");this.Ua=1;Oi(this);this.Nu(this.og);return j};o.stop=function(a){Pi(this);this.Ua=0;if(a)this.Gc=1;this.ct(this.Gc);this.Wd("stop");this.Wd("end")};o.l=function(){this.Ua!=0&&this.stop();this.Wd("destroy");Ki.d.l.call(this)};o.Pu=function(){this.k()};
o.Nu=function(a){this.Gc=(a-this.og)/(this.sv-this.og);if(this.Gc>=1)this.Gc=1;this.Mv=1000/(a-this.gr);this.gr=a;oa(this.Jt)?this.ct(this.Jt(this.Gc)):this.ct(this.Gc);if(this.Gc==1){this.Ua=0;Pi(this);this.Wd("finish");this.Wd("end")}else this.Ua==1&&this.Wd("animate")};o.ct=function(a){this.tf=new Array(this.jk.length);for(var b=0;b<this.jk.length;b++)this.tf[b]=(this.nE[b]-this.jk[b])*a+this.jk[b]};o.Wd=function(a){this.dispatchEvent(new Qi(a,this))};
var Qi=function(a,b){G.call(this,a);this.coords=b.tf;this.x=b.tf[0];this.y=b.tf[1];this.mO=b.tf[2];this.Ie=b.zp;this.ZN=b.Gc;this.DN=b.Mv;this.kc=b.Ua;this.fN=b};z(Qi,G);var Ri={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",
darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",
ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",
lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",
moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",
seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};var Wi=function(a){var b={};a=String(a);var c=a.charAt(0)=="#"?a:"#"+a;if(Si.test(c)){b.im=Ti(c);b.type="hex";return b}else{var d=Ui(a);if(d.length){b.im=Vi(d[0],d[1],d[2]);b.type="rgb";return b}else if(Ri){var f=Ri[a.toLowerCase()];if(f){b.im=f;b.type="named";return b}}}k(Error(a+" is not a valid color string"))},Xi=/#(.)(.)(.)/,Ti=function(a){if(!Si.test(a))k(Error("'"+a+"' is not a valid hex color"));if(a.length==4)a=a.replace(Xi,"#$1$1$2$2$3$3");return a.toLowerCase()},Yi=function(a){a=Ti(a);
var b=parseInt(a.substr(1,2),16),c=parseInt(a.substr(3,2),16),d=parseInt(a.substr(5,2),16);return[b,c,d]},Vi=function(a,b,c){a=Number(a);b=Number(b);c=Number(c);if(isNaN(a)||a<0||a>255||isNaN(b)||b<0||b>255||isNaN(c)||c<0||c>255)k(Error('"('+a+","+b+","+c+'") is not a valid RGB color'));var d=Zi(a.toString(16)),f=Zi(b.toString(16)),g=Zi(c.toString(16));return"#"+d+f+g};var Si=/^#(?:[0-9a-f]{3}){1,2}$/i;
var $i=/^(?:rgb)?\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2})\)$/i,Ui=function(a){var b=a.match($i);if(b){var c=Number(b[1]),d=Number(b[2]),f=Number(b[3]);if(c>=0&&c<=255&&d>=0&&d<=255&&f>=0&&f<=255)return[c,d,f]}return[]},Zi=function(a){return a.length==1?"0"+a:a};var aj=function(a,b,c,d,f){Ki.call(this,b,c,d,f);this.$d=a};z(aj,Ki);var bj=function(a,b,c){aj.apply(this,arguments);if(b.length!=2||c.length!=2)k(Error("Start and end points must be 2D"));H(this,["begin","animate","end"],this.BK,e,this)};z(bj,aj);bj.prototype.BK=function(a){this.$d.scrollLeft=Math.round(a.x);this.$d.scrollTop=Math.round(a.y)};var cj=function(a){if(/^\s*$/.test(a))return e;return/^[\],:{}\s\u2028\u2029]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r\u2028\u2029\x00-\x1f\x7f-\x9f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,""))},dj=function(a){String(a);if(cj(a))try{return eval("("+a+")")}catch(b){}k(Error("Invalid JSON string: "+a))},ej=function(a){return eval("("+a+")")},fj=h,hj=function(a){fj||(fj=new gj);return fj.ln(a)},gj=function(){};
gj.prototype.ln=function(a){var b=[];this.hs(a,b);return b.join("")};gj.prototype.hs=function(a,b){switch(typeof a){case "string":this.Jz(a,b);break;case "number":this.NK(a,b);break;case "boolean":b.push(a);break;case "undefined":b.push("null");break;case "object":if(a==h){b.push("null");break}if(ka(a)){this.LK(a,b);break}this.OK(a,b);break;case "function":break;default:k(Error("Unknown type: "+typeof a))}};
var ij={'"':'\\"',"\\":"\\\\","/":"\\/","\u0008":"\\b","\u000c":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\u000b":"\\u000b"};gj.prototype.Jz=function(a,b){b.push('"',a.replace(/[\\\"\x00-\x1f\x80-\uffff]/g,function(c){if(c in ij)return ij[c];var d=c.charCodeAt(0),f="\\u";if(d<16)f+="000";else if(d<256)f+="00";else if(d<4096)f+="0";return ij[c]=f+d.toString(16)}),'"')};gj.prototype.NK=function(a,b){b.push(isFinite(a)&&!isNaN(a)?a:"null")};
gj.prototype.LK=function(a,b){var c=a.length;b.push("[");var d="";for(var f=0;f<c;f++){b.push(d);this.hs(a[f],b);d=","}b.push("]")};gj.prototype.OK=function(a,b){b.push("{");var c="";for(var d in a)if(a.hasOwnProperty(d)){var f=a[d];if(typeof f!="function"){b.push(c);this.Jz(d,b);b.push(":");this.hs(f,b);c=","}}b.push("}")};var jj;var kj=function(){if(jj==h)jj="en";return jj},mj=function(a,b,c){lj[b]||(lj[b]={});lj[b][c]=a;if(jj==h)jj=c},lj={},nj=function(a,b){var c=b?b:kj();if(!(a in lj))return undefined;return lj[a][c]},oj=function(a,b){mj(a,"DateTimeConstants",b)};var pj=function(){},rj=function(a){if(typeof a=="number")return qj(a);var b=new pj;b.BA=a.id;b.nA=-a.std_offset;b.Ws=a.names;b.Ln=a.transitions;return b},qj=function(a){var b=new pj;b.nA=a;b.BA=sj(a);var c=tj(a);b.Ws=[c,c];b.Ln=[];return b},uj=function(a){var b=["GMT"];b.push(a<=0?"+":"-");a=Math.abs(a);b.push(Ua(Math.floor(a/60)%100,2),":",Ua(a%60,2));return b.join("")},sj=function(a){if(a==0)return"Etc/GMT";var b=["Etc/GMT",a<0?"-":"+"];a=Math.abs(a);b.push(Math.floor(a/60)%100);a=a%60;a!=0&&b.push(":",
Ua(a,2));return b.join("")},tj=function(a){if(a==0)return"UTC";var b=["UTC",a<0?"+":"-"];a=Math.abs(a);b.push(Math.floor(a/60)%100);a=a%60;a!=0&&b.push(":",a);return b.join("")};o=pj.prototype;o.bw=function(a){var b=Date.UTC(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes())/3600000,c=0;while(c<this.Ln.length&&b>=this.Ln[c])c+=2;return c==0?0:this.Ln[c-1]};o.zF=function(a){return uj(this.eq(a))};o.GF=function(a){return this.Ws[this.Gx(a)?3:1]};
o.eq=function(a){return this.nA-this.bw(a)};o.NF=function(a){var b=-this.eq(a),c=[b<0?"-":"+"];b=Math.abs(b);c.push(Ua(Math.floor(b/60)%100,2),Ua(b%60,2));return c.join("")};o.SF=function(a){return this.Ws[this.Gx(a)?2:0]};o.Gx=function(a){return this.bw(a)>0};var vj=function(){this.kb=nj("DateTimeConstants",kj());this.Vm=[]},wj=[/^\'(?:[^\']|\'\')*\'/,/^(?:G+|y+|M+|k+|S+|E+|a+|h+|K+|H+|c+|L+|Q+|d+|m+|s+|v+|z+|Z+)/,/^[^\'GyMkSEahKHcLQdmsvzZ]+/];o=vj.prototype;o.YB=function(a){while(a)for(var b=0;b<wj.length;++b){var c=a.match(wj[b]);if(c){var d=c[0];a=a.substring(d.length);if(b==0)if(d=="''")d="'";else{d=d.substring(1,d.length-1);d=d.replace(/\'\'/,"'")}this.Vm.push({text:d,type:b});break}}};
o.Il=function(a,b){b||(b=rj(a.getTimezoneOffset()));var c=(a.getTimezoneOffset()-b.eq(a))*60000,d=c?new Date(a.getTime()+c):a,f=d;if(d.getTimezoneOffset()!=a.getTimezoneOffset()){c+=c>0?-86400000:86400000;f=new Date(a.getTime()+c)}var g=[];for(var i=0;i<this.Vm.length;++i){var l=this.Vm[i].text;1==this.Vm[i].type?g.push(this.QE(l,a,d,f,b)):g.push(l)}return g.join("")};
o.Wt=function(a){var b;if(a<4)b=this.kb.rt[a];else if(a<8)b=this.kb.Dt[a-4];else if(a<12)b=this.kb.rt[a-8]+" "+this.kb.Dt[a-8];else this.Wt(10);this.YB(b)};o.PE=function(a,b){var c=b.getFullYear()>0?1:0;return a>=4?this.kb.$A[c]:this.kb.aB[c]};o.$E=function(a,b){var c=b.getFullYear();if(c<0)c=-c;return a==2?Ua(c%100,2):String(c)};o.TE=function(a,b){var c=b.getMonth();switch(a){case 5:return this.kb.At[c];case 4:return this.kb.gB[c];case 3:return this.kb.mB[c];default:return Ua(c+1,a)}};
o.LE=function(a,b){return Ua(b.getHours()||24,a)};o.RE=function(a,b){return(b.getTime()%1000/1000).toFixed(Math.min(3,a)).substr(2)+(a>3?Ua(0,a-3):"")};o.OE=function(a,b){var c=b.getDay();return a>=4?this.kb.It[c]:this.kb.Bt[c]};o.ME=function(a,b){var c=b.getHours();return this.kb.UA[c>=12&&c<24?1:0]};o.KE=function(a,b){return Ua(b.getHours()%12||12,a)};o.IE=function(a,b){return Ua(b.getHours()%12,a)};o.JE=function(a,b){return Ua(b.getHours(),a)};
o.WE=function(a,b){var c=b.getDay();switch(a){case 5:return this.kb.rB[c];case 4:return this.kb.uB[c];case 3:return this.kb.tB[c];default:return Ua(c,1)}};o.XE=function(a,b){var c=b.getMonth();switch(a){case 5:return this.kb.qB[c];case 4:return this.kb.pB[c];case 3:return this.kb.sB[c];default:return Ua(c+1,a)}};o.UE=function(a,b){var c=Math.floor(b.getMonth()/3);return a<4?this.kb.nB[c]:this.kb.kB[c]};o.NE=function(a,b){return Ua(b.getDate(),a)};o.SE=function(a,b){return Ua(b.getMinutes(),a)};
o.VE=function(a,b){return Ua(b.getSeconds(),a)};o.YE=function(a,b,c){return a<4?c.NF(b):c.zF(b)};o.ZE=function(a,b,c){return a<4?c.SF(b):c.GF(b)};
o.QE=function(a,b,c,d,f){var g=a.length;switch(a.charAt(0)){case "G":return this.PE(g,c);case "y":return this.$E(g,c);case "M":return this.TE(g,c);case "k":return this.LE(g,d);case "S":return this.RE(g,d);case "E":return this.OE(g,c);case "a":return this.ME(g,d);case "h":return this.KE(g,d);case "K":return this.IE(g,d);case "H":return this.JE(g,d);case "c":return this.WE(g,c);case "L":return this.XE(g,c);case "Q":return this.UE(g,c);case "d":return this.NE(g,c);case "m":return this.SE(g,d);case "s":return this.VE(g,
d);case "v":return f.BA;case "z":return this.ZE(g,b,f);case "Z":return this.YE(g,b,f);default:return""}};var xj="complete",yj="success",zj="error",Aj="timeout";var Bj=function(){if(!E)return;this.Fe={};this.Zn={};this.An=[]},Cj=function(a){return ma(a)?a:pa(a)?s(a):""};o=Bj.prototype;o.$m=function(a){if(!E)return;this.An.push(Cj(a))};o.Ym=function(){if(!E)return;this.rM(this.An.pop())};o.ZH=function(a){if(!E)return j;return!this.Fe[Cj(a)]};o.KI=function(a){if(!E)return;var b=s(a);for(var c=0;c<this.An.length;c++){var d=this.An[c];this.Hk(this.Fe,d,b);this.Hk(this.Zn,b,d)}};
o.JI=function(a){if(!E)return;var b=s(a);delete this.Zn[b];for(var c in this.Fe){Hb(this.Fe[c],b);this.Fe[c].length==0&&delete this.Fe[c]}};o.rM=function(a){var b=this.Zn[a],c=this.Fe[a];b&&c&&tb(b,function(d){tb(c,function(f){this.Hk(this.Fe,d,f);this.Hk(this.Zn,f,d)},this)},this)};o.Hk=function(a,b,c){a[b]||(a[b]=[]);Cb(a[b],c)||a[b].push(c)};var Dj=new Bj;var Fj=function(){return Ej()};var Ej=h,Gj=h,Hj=h;(function(a,b){Ej=a;Gj=b;Hj=h})(function(){var a=Ij();return a?new ActiveXObject(a):new XMLHttpRequest},function(){var a={};if(Ij()){a[0]=j;a[1]=j}return a});var Jj=h,Ij=function(){if(!Jj&&typeof XMLHttpRequest=="undefined"&&typeof ActiveXObject!="undefined"){var a=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"];for(var b=0;b<a.length;b++){var c=a[b];try{new ActiveXObject(c);Jj=c;return c}catch(d){}}k(Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed"))}return Jj};var Kj=function(){I.call(this);this.headers=new tc};z(Kj,I);o=Kj.prototype;o.lb=e;o.na=h;o.Yn=h;o.Aj="";o.xI="";o.Tc=0;o.Bm="";o.Ip=e;o.mm=e;o.Iq=e;o.Wf=e;o.Yh=0;o.lf=h;o.dk=function(a){this.Yh=Math.max(0,a)};
o.send=function(a,b,c,d){if(this.lb)k(Error("[goog.net.XhrIo] Object is active with another request"));var f=b||"GET";this.Aj=a;this.Bm="";this.Tc=0;this.xI=f;this.Ip=e;this.lb=j;this.na=new Fj;this.Yn=Hj||(Hj=Gj());Dj.KI(this.na);this.na.onreadystatechange=u(this.Jy,this);try{this.Iq=j;this.na.open(f,a,j);this.Iq=e}catch(g){this.wv(5,g);return}var i=c?String(c):"",l=this.headers.za();d&&rc(d,function(m,n){l.h(n,m)});f=="POST"&&!l.Lc("Content-Type")&&l.h("Content-Type","application/x-www-form-urlencoded;charset=utf-8");
rc(l,function(m,n){this.na.setRequestHeader(n,m)},this);try{if(this.lf){Ad.clearTimeout(this.lf);this.lf=h}if(this.Yh>0)this.lf=Ad.setTimeout(u(this.ZL,this),this.Yh);this.mm=j;this.na.send(i);this.mm=e}catch(g){this.wv(5,g)}};o.dispatchEvent=function(a){if(this.na){Dj.$m(this.na);try{Kj.d.dispatchEvent.call(this,a)}finally{Dj.Ym()}}else Kj.d.dispatchEvent.call(this,a)};
o.ZL=function(){if(!(typeof aa=="undefined"))if(this.na){this.Bm="Timed out after "+this.Yh+"ms, aborting";this.Tc=8;this.dispatchEvent(Aj);this.abort(8)}};o.wv=function(a,b){this.lb=e;if(this.na){this.Wf=j;this.na.abort();this.Wf=e}this.Bm=b;this.Tc=a;this.av();this.Yk()};o.av=function(){if(!this.Ip){this.Ip=j;this.dispatchEvent(xj);this.dispatchEvent(zj)}};
o.abort=function(a){if(this.na){this.lb=e;this.Wf=j;this.na.abort();this.Wf=e;this.Tc=a||7;this.dispatchEvent(xj);this.dispatchEvent("abort");this.Yk()}};o.l=function(){if(this.na){this.lb=e;this.Wf=j;this.na.abort();this.Wf=e;this.Yk(j)}Kj.d.l.call(this)};o.Jy=function(){!this.Iq&&!this.mm&&!this.Wf?this.nJ():this.Iy()};o.nJ=function(){this.Iy()};
o.Iy=function(){if(!this.lb)return;if(!(typeof aa=="undefined"))if(!(this.Yn[1]&&this.aj()==4&&this.am()==2)){if(this.mm&&this.aj()==4){Cd(this.Jy,0,this);return}this.dispatchEvent("readystatechange");if(this.Qq()){this.lb=e;if(this.Qx()){this.dispatchEvent(xj);this.dispatchEvent(yj)}else{this.Tc=6;this.Bm=this.TF()+" ["+this.am()+"]";this.av()}this.Yk()}}};
o.Yk=function(a){if(this.na){this.na.onreadystatechange=this.Yn[0]?fa:h;var b=this.na;this.na=h;this.Yn=h;if(this.lf){Ad.clearTimeout(this.lf);this.lf=h}if(!a){Dj.$m(b);this.dispatchEvent("ready");Dj.Ym()}Dj.JI(b)}};o.td=function(){return this.lb};o.Qq=function(){return this.aj()==4};o.Qx=function(){switch(this.am()){case 0:case 200:case 204:case 304:return j;default:return e}};o.aj=function(){return this.na?this.na.readyState:0};o.am=function(){try{return this.aj()>2?this.na.status:-1}catch(a){return-1}};
o.TF=function(){try{return this.aj()>2?this.na.statusText:""}catch(a){return""}};o.gq=function(){return this.na?this.na.responseText:""};o.tw=function(){return this.na?dj(this.na.responseText):undefined};o.getResponseHeader=function(a){return this.na&&this.Qq()?this.na.getResponseHeader(a):undefined};var Lj=function(a,b,c){Bc.call(this);this.Cj=a;this.ie=b;this.C=c;this.Bc=u(this.tJ,this)};z(Lj,Bc);o=Lj.prototype;o.xn=e;o.Xy=0;o.ab=h;o.Np=function(){if(!this.ab&&!this.Xy)this.Xd();else this.xn=j};o.stop=function(){if(this.ab){Dd(this.ab);this.ab=h;this.xn=e}};o.l=function(){Lj.d.l.call(this);this.stop()};o.tJ=function(){this.ab=h;if(this.xn&&!this.Xy){this.xn=e;this.Xd()}};o.Xd=function(){this.ab=Cd(this.Bc,this.ie);this.Cj.call(this.C)};var Mj=function(a,b,c){Xg.call(this,a,b,c);this.un(j)};z(Mj,Xg);Mj.prototype.yd=function(){return this.dispatchEvent(vg)};Rg("goog-option",function(){return new Mj(h)});var Nj=function(){Wg.call(this)};z(Nj,Wg);ga(Nj);Nj.prototype.f=function(a){var b=Nj.d.f.call(this,a);Kd(b,"goog-submenu");this.Kt(a,b);return b};Nj.prototype.ja=function(a,b){b=Nj.d.ja.call(this,a,b);Kd(b,"goog-submenu");this.Kt(a,b);var c=Rd("div","goog-menu",b);if(c.length){var d=new uh(a.g),f=c[0];bg(f,e);a.g.s().body.appendChild(f);d.ja(f);a.te(d,j)}return b};Nj.prototype.Ec=function(a){Nj.d.Ec.call(this,a);var b=a.Ba(),c=a.g.$n("span","goog-submenu-arrow",b)[0];Oj(a,c);c!=b.lastChild&&b.appendChild(c)};
Nj.prototype.Kt=function(a,b){var c=a.g.f("span");c.className="goog-submenu-arrow";Oj(a,c);this.Ba(b).appendChild(c)};var Oj=function(a,b){var c="\u25c4",d="\u25ba";if(a.Xf()){Kd(b,"goog-submenu-arrow-rtl");oe(b,a.Ik?c:d)}else{Ld(b,"goog-submenu-arrow-rtl");oe(b,a.Ik?d:c)}};var Pj=function(a,b,c,d){Xg.call(this,a,b,c,d||Nj.Ga())};z(Pj,Xg);o=Pj.prototype;o.Fi=h;o.Hs=h;o.ex=e;o.$a=h;o.zl=e;o.Ik=j;o.Oa=function(){Pj.d.Oa.call(this);this.xb().e(this.Ja,"hide",this.Hy);this.$a&&this.rn(this.$a,j)};o.xa=function(){this.xb().W(this.Ja,"hide",this.Hy);if(this.$a){this.rn(this.$a,e);if(!this.zl){this.$a.xa();Q(this.$a.b())}}Pj.d.xa.call(this)};o.l=function(){this.$a&&!this.zl&&this.$a.k();this.$a=h;Pj.d.l.call(this)};
o.wc=function(a,b){Pj.d.wc.call(this,a,b);b&&this.K().ff(j);if(!a){this.Fi&&Dd(this.Fi);this.Fi=Cd(this.Vd,350,this)}};o.Fs=function(){if(this.Ja.Jf()==this){this.Xz(j);this.Xu();this.SN=e}};o.Vd=function(){if(this.$a&&this.$a.Ja==this){this.Xz(e);var a=this.$a.Ne();for(var b=0;b<a.length;b++)typeof a[b].Vd=="function"&&a[b].Vd()}};o.Ng=function(){this.Fi&&Dd(this.Fi);this.Hs&&Dd(this.Hs)};o.o=function(a,b){var c=Pj.d.o.call(this,a,b);c&&!this.oa()&&this.Vd();return c};
o.Xu=function(){var a=this.Ja.Ne();for(var b=0;b<a.length;b++)if(a[b]!=this&&typeof a[b].Vd=="function"){a[b].Vd();a[b].Ng()}};o.Pb=function(a){var b=a.keyCode;if(!this.ex)if(this.J()&&b==39){this.Fs();this.K().ix();this.Ng()}else return e;else if(!this.K().Pb(a))if(b==37)this.Vd();else return e;a.preventDefault();return j};o.bJ=function(){if(this.$a.Ja==this){this.Ng();this.$i().wc(this);this.Xu()}};o.Hy=function(a){if(a.target==this.$i()){this.Vd();this.Ng()}};
o.Tf=function(a){if(this.J()){this.Ng();this.Hs=Cd(this.Fs,350,this)}Pj.d.Tf.call(this,a)};o.yd=function(){this.Ng();this.Fs();return j};o.Xz=function(a){this.dispatchEvent(yg(64,a));var b=this.K();if(a!=b.oa()){if(a){b.X||b.zb();this.KJ();b.Tb(-1)}this.ex=a;Od(this.b(),"goog-submenu-open",a);b.o(a)}};o.rn=function(a,b){var c=this.xb();(b?c.e:c.W).call(c,a,tg,this.bJ)};
o.KJ=function(){var a=new Gh(this.b(),this.Ik?6:5),b=this.K(),c=b.b();if(!b.oa()){c.style.visibility="hidden";bg(c,j)}a.ua(c,this.Ik?5:6,new Jf(0,0,0,0));if(!b.oa()){bg(c,e);c.style.visibility="visible"}};o.Z=function(a){this.K().Z(a)};o.Md=function(a,b){this.K().Md(a,b)};o.Me=function(a){return this.K().Me(a)};o.gh=function(){return this.K().gh()};o.Ne=function(){return this.K().Ne()};
o.K=function(){if(this.$a)this.zl&&this.$a.Ja!=this&&this.$a.Zj(this);else this.te(new uh(this.g),j);this.$a.b()||this.$a.f();return this.$a};o.te=function(a,b){var c=this.$a;if(a!=c){if(c){this.Vd();this.X&&this.rn(c,e)}this.$a=a;this.zl=!b;if(a){a.Zj(this);a.o(e,j);a.Jh(e);a.ec(e);this.X&&this.rn(a,j)}}};o.jd=function(a){return this.K().jd(a)};Rg("goog-submenu",function(){return new Pj});var Qj=function(){return jh.call(this)};z(Qj,jh);ga(Qj);var Rj="goog-toolbar-separator";Qj.prototype.f=function(a){return a.g.f("div",{"class":this.U()+" goog-inline-block"},"\u00a0")};Qj.prototype.ja=function(a,b){b=Qj.d.ja.call(this,a,b);Kd(b,"goog-inline-block");return b};Qj.prototype.U=function(){return Rj};var Sj=function(){mh.call(this)};z(Sj,mh);ga(Sj);Sj.prototype.nd=function(){return"toolbar"};Sj.prototype.Ri=function(a){return a.tagName=="HR"?new lh(Qj.Ga()):Sj.d.Ri.call(this,a)};Sj.prototype.U=function(){return"goog-toolbar"};Sj.prototype.dw=function(){return nh};var Tj=function(a,b,c){rh.call(this,b,a||Sj.Ga(),c)};z(Tj,rh);var Uj=function(){Lg.call(this)};z(Uj,Lg);ga(Uj);o=Uj.prototype;o.nd=function(){return"button"};o.f=function(a){var b=Uj.d.f.call(this,a),c=a.ej();c&&this.xs(b,c);var d=a.Ra();d&&this.va(b,d);return b};o.ja=function(a,b){b=Uj.d.ja.call(this,a,b);a.yL(this.Ra(b));a.uL(this.ej(b));return b};o.Ra=fa;o.va=fa;o.ej=function(a){return a.title};o.xs=function(a,b){if(a)a.title=b||""};o.U=function(){return"goog-button"};var Vj=function(){Uj.call(this)};z(Vj,Uj);ga(Vj);o=Vj.prototype;o.nd=function(){return undefined};o.f=function(a){this.aA(a);return a.g.f("button",{"class":this.Gf(a).join(" "),disabled:!a.J(),title:a.ej()||"",value:a.Ra()||""},a.ah()||"")};o.fc=function(a){return a.tagName=="BUTTON"||a.tagName=="INPUT"&&(a.type=="button"||a.type=="submit"||a.type=="reset")};o.ja=function(a,b){this.aA(a);b.disabled&&Kd(b,this.Pi(1));return Vj.d.ja.call(this,a,b)};o.Ec=function(a){a.xb().e(a.b(),Ic,a.yd)};o.Sj=fa;
o.Qh=fa;o.le=function(a){return a.J()};o.ec=fa;o.qb=function(a,b,c){Vj.d.qb.call(this,a,b,c);var d=a.b();if(d&&b==1)d.disabled=c};o.Ra=function(a){return a.value};o.va=function(a,b){if(a)a.value=b};o.HA=fa;o.aA=function(a){a.rs(e);a.SK(255,e);a.Ed(32,e)};var Wj=function(a,b,c){Ug.call(this,a,b||Vj.Ga(),c)};z(Wj,Ug);o=Wj.prototype;o.Ra=function(){return this.lt};o.va=function(a){this.lt=a;this.D.va(this.b(),a)};o.yL=function(a){this.lt=a};o.ej=function(){return this.Vs};o.xs=function(a){this.Vs=a;this.D.xs(this.b(),a)};o.uL=function(a){this.Vs=a};o.l=function(){Wj.d.l.call(this);delete this.lt;delete this.Vs};o.Oa=function(){Wj.d.Oa.call(this);if(this.Fc(32)){var a=this.Qa();a&&this.xb().e(a,"keyup",this.lh)}};
o.lh=function(a){return(a.keyCode==13&&a.type=="key"||a.keyCode==32&&a.type=="keyup")&&this.yd(a)};Rg("goog-button",function(){return new Wj(h)});var Xj=function(){Uj.call(this)};z(Xj,Uj);ga(Xj);o=Xj.prototype;o.f=function(a){var b={"class":"goog-inline-block "+this.Gf(a).join(" "),title:a.ej()||""};return a.g.f("div",b,this.fl(a.pa,a.g))};o.Ba=function(a){return a&&a.firstChild.firstChild};o.fl=function(a,b){var c="goog-inline-block "+this.U();return b.f("div",{"class":c+"-outer-box"},b.f("div",{"class":c+"-inner-box"},a))};o.fc=function(a){return a.tagName=="DIV"};
o.bH=function(a,b){var c=a.g.hw(b);if(c&&c.className.indexOf(this.U()+"-outer-box")!=-1){var d=a.g.hw(c);if(d&&d.className.indexOf(this.U()+"-inner-box")!=-1)return j}return e};o.ja=function(a,b){Yj(b,j);Yj(b,e);this.bH(a,b)||b.appendChild(this.fl(b.childNodes,a.g));Kd(b,"goog-inline-block",this.U());return Xj.d.ja.call(this,a,b)};o.U=function(){return"goog-custom-button"};
var Yj=function(a,b){if(a){var c=b?a.firstChild:a.lastChild,d;while(c&&c.parentNode==a){d=b?c.nextSibling:c.previousSibling;if(c.nodeType==3){var f=c.nodeValue;if(Ea(f)=="")a.removeChild(c);else{c.nodeValue=b?Fa(f):f.replace(/[\s\xa0]+$/,"");break}}else break;c=d}}};var Zj=function(){Xj.call(this)};z(Zj,Xj);ga(Zj);var $j="goog-toolbar-button";Zj.prototype.U=function(){return $j};var ak=function(a,b,c){Wj.call(this,a,b||Zj.Ga(),c)};z(ak,Wj);Rg($j,function(){return new ak(h)});var bk=function(){Xj.call(this)};z(bk,Xj);ga(bk);var ck="__goog_wrapper_div";if(E)bk.prototype.Sb=function(a,b){var c=bk.d.Ba.call(this,a&&a.firstChild);c&&ce(this.createCaption(b,N(a)),c)};o=bk.prototype;o.Ba=function(a){var b=bk.d.Ba.call(this,a&&a.firstChild);if(E&&b&&b[ck])b=b.firstChild;return b};o.ja=function(a,b){var c=Rd("*","goog-menu",b)[0];if(c){bg(c,e);P(M(c).body,c);var d=new uh;d.ja(c);a.te(d)}return bk.d.ja.call(this,a,b)};
o.fl=function(a,b){return bk.d.fl.call(this,[this.createCaption(a,b),this.vD(b)],b)};o.createCaption=function(a,b){var c={"class":"goog-inline-block "+this.U()+"-caption"};if(fg&&eg(a)){c[ck]=j;return b.f("div",c,Xd("div",h,a))}else return b.f("div",c,a)};o.vD=function(a){return a.f("div",{"class":"goog-inline-block "+this.U()+"-dropdown"},"\u00a0")};o.U=function(){return"goog-menu-button"};var dk=function(){bk.call(this)};z(dk,bk);ga(dk);var ek="goog-color-menu-button";dk.prototype.createCaption=function(a,b){var c=b.f("div",{"class":ek+"-indicator"},a);return dk.d.createCaption(c,b)};dk.prototype.va=function(a,b){if(a){var c=this.Ba(a);if(c&&c.firstChild){var d;try{d=Wi(b).im}catch(f){d=h}c.firstChild.style.borderBottomColor=d||(B?"":"transparent")}}};dk.prototype.Ec=function(a){this.va(a.b(),a.Ra());Kd(a.b(),ek);dk.d.Ec.call(this,a)};var fk=function(){Lg.call(this)};z(fk,Lg);ga(fk);var gk=0;o=fk.prototype;o.f=function(a){var b=this.Gf(a);return a.g.f("div",b?{"class":b.join(" ")}:h,this.wD(a.pa,a.ww(),a.g))};o.wD=function(a,b,c){var d=[];for(var f=0,g=0;f<b.height;f++){var i=[];for(var l=0;l<b.width;l++){var m=a&&a[g++];i.push(this.Vo(m,c))}d.push(this.cp(i,c))}return this.Iu(d,c)};
o.Iu=function(a,b){var c=b.f("table",{"class":this.U()+"-table"},b.f("tbody",{"class":this.U()+"-body"},a));c.cellSpacing=0;c.cellPadding=0;Jg(c,"grid");return c};o.cp=function(a,b){return b.f("tr",{"class":this.U()+"-row"},a)};o.Vo=function(a,b){var c=b.f("td",{"class":this.U()+"-cell",id:this.U()+"-cell-"+gk++},a);Jg(c,"gridcell");return c};o.fc=function(){return e};o.ja=function(){return h};
o.Sb=function(a,b){if(a){var c=Rd("tbody",this.U()+"-body",a)[0];if(c){var d=0;tb(c.rows,function(n){tb(n.cells,function(q){$d(q);if(b){var r=b[d++];r&&P(q,r)}})});if(d<b.length){var f=[],g=N(a),i=c.rows[0].cells.length;while(d<b.length){var l=b[d++];f.push(this.Vo(l,g));if(f.length==i){var m=this.cp(f,g);P(c,m);f.length=0}}if(f.length>0){while(f.length<i)f.push(this.Vo("",g));var m=this.cp(f,g);P(c,m)}}}jg(a,j,E)}};
o.aq=function(a,b){var c=a.b();while(b&&b.nodeType==1&&b!=c){if(b.tagName=="TD"&&Nd(b,this.U()+"-cell"))return b.firstChild;b=b.parentNode}return h};o.hx=function(a,b,c){if(b){var d=b.parentNode;Od(d,this.U()+"-cell-hover",c);var f=a.b().firstChild;Kg(f,"activedescendent",d.id)}};o.FK=function(a,b,c){b&&Od(b.parentNode,this.U()+"-cell-selected",c)};o.U=function(){return"goog-palette"};var hk=function(a){I.call(this);this.Ve=[];this.po(a)};z(hk,I);o=hk.prototype;o.Ve=h;o.lg=h;o.fs=h;o.oL=function(a){this.fs=a};o.gh=function(){return this.Ve.length};o.IH=function(a){return a?sb(this.Ve,a):-1};o.Me=function(a){return this.Ve[a]||h};o.po=function(a){if(a){tb(a,function(b){this.Gh(b,e)},this);Kb(this.Ve,a)}};o.Z=function(a){this.Md(a,this.gh())};o.Md=function(a,b){if(a){this.Gh(a,e);Fb(this.Ve,a,b)}};o.Mf=function(){return this.lg};
o.Dd=function(a){if(a!=this.lg){this.Gh(this.lg,e);this.lg=a;this.Gh(a,j)}this.dispatchEvent(md)};o.hh=function(){return this.IH(this.lg)};o.bk=function(a){this.Dd(this.Me(a))};o.clear=function(){Db(this.Ve);this.lg=h};o.l=function(){hk.d.l.call(this);this.Ve=h;this.lg=h};o.Gh=function(a,b){if(a)if(typeof this.fs=="function")this.fs(a,b);else typeof a.ak=="function"&&a.ak(b)};var ik=function(a,b,c){Ug.call(this,a,b||fk.Ga(),c)};z(ik,Ug);o=ik.prototype;o.sb=h;o.hb=-1;o.T=h;o.l=function(){ik.d.l.call(this);if(this.T){this.T.k();this.T=h}this.sb=h};o.Mh=function(a){ik.d.Mh.call(this,a);this.St();if(this.T){this.T.clear();this.T.po(a)}else{this.T=new hk(a);this.T.oL(u(this.Gh,this));this.xb().e(this.T,md,this.oj)}this.hb=-1};o.ah=function(){return h};o.Rb=function(){};
o.Tf=function(a){ik.d.Tf.call(this,a);var b=this.D.aq(this,a.target);if(b&&a.relatedTarget&&ie(b,a.relatedTarget))return;b!=this.Ol()&&this.Rz(b)};o.mj=function(a){ik.d.mj.call(this,a);var b=this.D.aq(this,a.target);if(b&&a.relatedTarget&&ie(b,a.relatedTarget))return;b==this.Ol()&&this.D.hx(this,b,e)};o.ee=function(a){ik.d.ee.call(this,a);if(this.td()){var b=this.D.aq(this,a.target);b!=this.Ol()&&this.Rz(b)}};o.yd=function(){var a=this.Ol();if(a){this.Dd(a);return this.dispatchEvent(vg)}return e};
o.Pb=function(a){var b=this.pa,c=b?b.length:0,d=this.sb.width;if(c==0||!this.J())return e;if(a.keyCode==13||a.keyCode==32)return this.yd(a);if(a.keyCode==36){this.Tb(0);return j}else if(a.keyCode==35){this.Tb(c-1);return j}var f=this.hb<0?this.hh():this.hb;switch(a.keyCode){case 37:if(f==-1)f=c;if(f>0){this.Tb(f-1);a.preventDefault();return j}break;case 39:if(f<c-1){this.Tb(f+1);a.preventDefault();return j}break;case 38:if(f==-1)f=c+d-1;if(f>=d){this.Tb(f-d);a.preventDefault();return j}break;case 40:if(f==
-1)f=-d;if(f<c-d){this.Tb(f+d);a.preventDefault();return j}break}return e};o.oj=function(){};o.ww=function(){return this.sb};o.pL=function(a,b){if(this.b())k(Error(wg));this.sb=na(a)?new Fd(a,b):a;this.St()};o.Ol=function(){var a=this.pa;return a&&a[this.hb]};o.Tb=function(a){if(a!=this.hb){this.jx(this.hb,e);this.hb=a;this.jx(a,j)}};o.Rz=function(a){var b=this.pa;this.Tb(b?sb(b,a):-1)};o.hh=function(){return this.T?this.T.hh():-1};o.Mf=function(){return this.T?this.T.Mf():h};
o.bk=function(a){this.T&&this.T.bk(a)};o.Dd=function(a){this.T&&this.T.Dd(a)};o.jx=function(a,b){if(this.b()){var c=this.pa;c&&a>=0&&a<c.length&&this.D.hx(this,c[a],b)}};o.Gh=function(a,b){this.b()&&this.D.FK(this,a,b)};o.St=function(){var a=this.pa;if(a)if(this.sb&&this.sb.width){var b=Math.ceil(a.length/this.sb.width);if(!na(this.sb.height)||this.sb.height<b)this.sb.height=b}else{var c=Math.ceil(Math.sqrt(a.length));this.sb=new Fd(c,c)}else this.sb=new Fd(0,0)};var jk=function(a,b,c){this.al=a||[];ik.call(this,h,b||fk.Ga(),c);this.XK(this.al)};z(jk,ik);o=jk.prototype;o.Nm=h;o.XK=function(a){this.al=a;this.Nm=h;this.Sb(this.sD())};o.iq=function(){var a=this.Mf();if(a){var b=a.style[Pf("background-color")];return kk(b)}else return h};o.ws=function(a){var b=kk(a);if(!this.Nm)this.Nm=wb(this.al,function(c){return kk(c)});this.bk(b?sb(this.Nm,b):-1)};
o.sD=function(){return wb(this.al,function(a){var b=this.g.f("div",{"class":this.D.U()+"-colorswatch",style:"background-color:"+a});b.title=a.charAt(0)=="#"?"RGB ("+Yi(a).join(", ")+")":a;return b},this)};var kk=function(a){if(a)try{return Wi(a).im}catch(b){}return h};var lk=function(a,b,c,d){Wj.call(this,a,c||bk.Ga(),d);this.Ed(64,j);b&&this.te(b);this.ab=new Bd(500)};z(lk,Wj);o=lk.prototype;o.Ut=j;o.Vq=e;o.Oa=function(){lk.d.Oa.call(this);this.V&&this.Mk(this.V,j);Kg(this.b(),"haspopup","true")};o.xa=function(){lk.d.xa.call(this);if(this.V){this.Da(e);this.V.xa();this.Mk(this.V,e);var a=this.V.b();a&&Q(a)}};o.l=function(){lk.d.l.call(this);if(this.V){this.V.k();delete this.V}this.ab.k()};
o.ee=function(a){lk.d.ee.call(this,a);if(this.td()){this.Da(!this.isOpen());this.V&&this.V.ff(this.isOpen())}};o.nj=function(a){lk.d.nj.call(this,a);this.V&&!this.td()&&this.V.ff(e)};o.yd=function(){this.setActive(e);return j};o.xG=function(a){this.V&&this.V.oa()&&!this.jd(a.target)&&this.Da(e)};o.jd=function(a){return a&&ie(this.b(),a)||this.V&&this.V.jd(a)};
o.lh=function(a){if(a.type!=(a.keyCode==32?"keyup":"key"))return e;if(this.V&&this.V.oa()){var b=this.V.Pb(a);if(a.keyCode==27){this.Da(e);return j}return b}if(a.keyCode==40||a.keyCode==38||a.keyCode==32){this.Da(j);return j}return e};o.kj=function(){this.Da(e)};o.RG=function(){this.td()||this.Da(e)};o.Dc=function(a){this.Vq||this.Da(e);lk.d.Dc.call(this,a)};o.K=function(){this.V||this.te(new uh(this.g));return this.V||h};
o.te=function(a){var b=this.V;if(a!=b){if(b){this.Da(e);this.X&&this.Mk(b,e);delete this.V}if(a){this.V=a;a.Zj(this);a.o(e);a.Jh(this.Vq);this.X&&this.Mk(a,j)}}return b};o.Z=function(a){this.K().Z(a)};o.Md=function(a,b){this.K().Md(a,b)};o.Me=function(a){return this.V?this.V.Ff(a):h};o.gh=function(){return this.V?this.V.Ke():0};o.o=function(a,b){var c=lk.d.o.call(this,a,b);c&&!this.oa()&&this.Da(e);return c};o.u=function(a){lk.d.u.call(this,a);this.J()||this.Da(e)};o.Cs=function(){this.Da(j)};
o.Da=function(a){lk.d.Da.call(this,a);if(this.V){if(a){this.V.X||this.V.zb();this.$y();this.V.Tb(-1)}else{this.setActive(e);this.V.ff(e)}this.V.o(a);this.gC(a)}};o.$y=function(){var a=this.Ut?7:8,b=new Gh(this.b(),a,j),c=this.V.b();if(!this.V.oa()){c.style.visibility="hidden";bg(c,j)}b.ua(c,this.Ut?5:6,new Jf(0,0,0,0));if(!this.V.oa()){bg(c,e);c.style.visibility="visible"}};o.sJ=function(){this.$y()};
o.Mk=function(a,b){var c=this.xb(),d=b?c.e:c.W;d.call(c,a,vg,this.kj);d.call(c,a,tg,this.tq);d.call(c,a,ug,this.zq)};o.tq=function(a){Kg(this.b(),Ig,a.target.b().id)};o.zq=function(){this.V.Jf()||Kg(this.b(),Ig,h)};o.gC=function(a){var b=this.xb(),c=a?b.e:b.W;c.call(b,this.g.s(),gd,this.xG,j);this.Vq&&c.call(b,this.V,"blur",this.RG);c.call(b,this.ab,"tick",this.sJ);a?this.ab.start():this.ab.stop()};Rg("goog-menu-button",function(){return new lk(h)});var mk=function(a,b,c,d){lk.call(this,a,b,c||dk.Ga(),d)};z(mk,lk);
var nk={WM:["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],aN:["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],XM:["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc","#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd","#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0","#cc0000","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79","#990000","#b45f06","#bf9000","#38761d","#134f5c",
"#0b5394","#351c75","#741b47","#660000","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]},ok=function(a,b){var c=new uh(b);a&&tb(a,c.Z,c);Yb(nk,function(d){var f=new jk(d,h,b);f.pL(8);c.Z(f)});return c};o=mk.prototype;o.iq=function(){return this.Ra()};o.ws=function(a){this.va(a)};o.va=function(a){for(var b=0,c;c=this.Me(b);b++)typeof c.ws=="function"&&c.ws(a);mk.d.va.call(this,a)};
o.kj=function(a){if(typeof a.target.iq=="function")this.va(a.target.iq());else a.target.Ra()=="none"&&this.va(h);mk.d.kj.call(this,a);a.stopPropagation();this.dispatchEvent(vg)};o.Da=function(a){if(a&&this.gh()==0){this.te(ok(h,this.g));this.va(this.Ra())}mk.d.Da.call(this,a)};Rg(ek,function(){return new mk(h)});var pk=function(){bk.call(this)};z(pk,bk);ga(pk);var qk="goog-toolbar-menu-button";pk.prototype.U=function(){return qk};var rk=function(){pk.call(this)};z(rk,pk);ga(rk);rk.prototype.createCaption=function(a,b){return dk.prototype.createCaption.call(this,a,b)};rk.prototype.va=function(a,b){dk.prototype.va.call(this,a,b)};rk.prototype.Ec=function(a){this.va(a.b(),a.Ra());Kd(a.b(),"goog-toolbar-color-menu-button");rk.d.Ec.call(this,a)};var sk=function(a,b,c,d){mk.call(this,a,b,c||rk.Ga(),d)};z(sk,mk);Rg("goog-toolbar-color-menu-button",function(){return new sk(h)});var tk=function(a,b,c,d){lk.call(this,a,b,c||pk.Ga(),d)};z(tk,lk);Rg(qk,function(){return new tk(h)});var uk=function(a,b,c,d){lk.call(this,a,b,c,d);this.Mz(a)};z(uk,lk);o=uk.prototype;o.T=h;o.jp=h;o.Oa=function(){uk.d.Oa.call(this);this.bt()};o.Ud=function(a){uk.d.Ud.call(this,a);var b=this.ah();b?this.Mz(b):this.bk(0)};o.l=function(){uk.d.l.call(this);if(this.T){this.T.k();this.T=h}this.jp=h};o.kj=function(a){this.Dd(a.target);uk.d.kj.call(this,a);a.stopPropagation();this.dispatchEvent(vg)};o.oj=function(){var a=this.Mf();uk.d.va.call(this,a&&a.Ra());this.bt()};
o.te=function(a){var b=uk.d.te.call(this,a);if(a!=b){this.T&&this.T.clear();if(a)this.T?this.T.po(a.Ne()):this.dp(a.Ne())}return b};o.Mz=function(a){this.jp=a;this.bt()};o.Z=function(a){uk.d.Z.call(this,a);this.T?this.T.Z(a):this.dp(this.K().Ne())};o.Md=function(a,b){uk.d.Md.call(this,a,b);this.T?this.T.Md(a,b):this.dp(this.K().Ne())};o.Dd=function(a){this.T&&this.T.Dd(a)};o.bk=function(a){this.T&&this.Dd(this.T.Me(a))};
o.va=function(a){if(ba(a)&&!(a===h)&&this.T)for(var b=0,c;c=this.T.Me(b);b++)if(c&&typeof c.Ra=="function"&&c.Ra()==a){this.Dd(c);return}this.Dd(h)};o.Mf=function(){return this.T?this.T.Mf():h};o.hh=function(){return this.T?this.T.hh():-1};o.dp=function(a){this.T=new hk(a);this.xb().e(this.T,md,this.oj)};o.bt=function(){var a=this.Mf();this.Sb(a?a.ah():this.jp)};o.Da=function(a){uk.d.Da.call(this,a);this.isOpen()&&this.K().Tb(this.hh())};Rg("goog-select",function(){return new uk(h)});var vk=function(a,b,c,d){uk.call(this,a,b,c||pk.Ga(),d)};z(vk,uk);Rg("goog-toolbar-select",function(){return new vk(h)});var wk=function(a,b){lh.call(this,a||Qj.Ga(),b)};z(wk,lh);Rg(Rj,function(){return new wk});var xk=function(a,b,c){Wj.call(this,a,b||Xj.Ga(),c);this.Ed(16,j)};z(xk,Wj);Rg("goog-toggle-button",function(){return new xk(h)});var yk=function(a,b,c){xk.call(this,a,b||Zj.Ga(),c)};z(yk,xk);Rg("goog-toolbar-toggle-button",function(){return new yk(h)});var zk="/ui/";p.HtmlUtil_setServerBase=function(a){zk=a};var Ak,Bk,Ck,Dk=function(a,b){var c=307,d;if(B)c+=5;if(a){d=Wf(a);var f=$f(a);d.y+=f.height}else d=new yd(0,0);var g=f.width>c?f.width:c;if(b){d.x+=b.screenX-b.clientX;d.y+=b.screenY-b.clientY}if(d.x+313>screen.width)d.x=screen.width-313;if(d.y+600>screen.height)d.y=screen.height-600;return new Lf(d.x,d.y,g,554)},Fk=function(a,b,c,d){var f;if(b){b=O(b);var f=b.getAttribute("id")}else f=h;var g;g=!F&&b?Wd(M(b))||window:window;var i=Dk(b,c),l="toolbar=no,location=no,menubar=no,scrollbars=no,resizable=yes,status=no,width="+
i.width+",height="+i.height+",top="+i.top+",left="+i.left,m=Ek(a,f,d);m.ea("width",i.width);m.ea("height",i.height);if(!Ak||Ak.closed)Ak=g.open(m.toString(),"_picker",l);Ak.focus()},Ek=function(a,b,c){var d=a.Rr(new Xh("ui/ContactPicker"));b&&d.ea("inputId",b);if(c){c.serviceName&&d.ea("service",c.serviceName);c.hl&&d.ea("hl",c.hl)}return d},Hk=function(a,b,c){Bk&&Gk();var d=Dk(a,h),f=Ek(a,c);window.iframeDone=Gk;f.ea("done","iframeDone");var g=O("picker-iframe-div");if(g==h){var g=Xd("div",{id:"picker-iframe-div",
style:"position: absolute; background-color; #FFF",zIndex:10});document.body.appendChild(g);g.innerHTML='<iframe id="picker-iframe" style="display:none; background-color; #FFF; border: 0"></iframe>'}var i=O("picker-iframe");i.style.display="block";Yf(g,d.left,d.top);Zf(i,d.width,d.height);i.src=f;Ck=g;Bk=i},Gk=function(){Q(Ck);Ck=h;Bk=h};w("goog.focus.PickerLauncher.popPicker",function(a,b){var c=new Xh(zk.replace(/ui\/?$/,""));Fk(c,a,b)});w("goog.focus.PickerLauncher.popIframe",Hk);var Ik,Jk,Kk,Lk=function(a,b){var c;if(a){c=Wf(a);var d=$f(a);c.y+=d.height}else c=new yd(0,0);var f=d.width>307?d.width:307;if(b){c.x+=b.screenX-b.clientX;c.y+=b.screenY-b.clientY}if(c.x+313>screen.width)c.x=screen.width-313;if(c.y+600>screen.height)c.y=screen.height-600;return new Lf(c.x,c.y,f,554)},Nk=function(a,b,c,d){var f;if(b){b=O(b);f=b.getAttribute("id")}else f=h;var g;g=!F&&b?Wd(M(b))||window:window;var i=Lk(b,c),l="toolbar=no,location=no,menubar=no,scrollbars=no,resizable=yes,status=no,width="+
i.width+",height="+i.height+",top="+i.top+",left="+i.left,m=Mk(a,f,d);if(!Ik||Ik.closed)Ik=g.open(m.toString(),"_chooser",l);Ik.focus()},Mk=function(a,b,c){var d=a.Rr(new Xh("widgets/ContactChooser"));b&&d.ea("inputId",b);if(c){c.serviceName&&d.ea("service",c.serviceName);c.hl&&d.ea("hl",c.hl);c.tempTitle&&d.ea("tempTitle",c.tempTitle)}return d},Pk=function(a,b,c){Jk&&Ok();var d=Lk(a,h),f=Mk(a,c);window.iframeDone=Ok;f.ea("done","iframeDone");var g=O("chooser-iframe-div");if(g==h){g=Xd("div",{id:"chooser-iframe-div",
style:"position: absolute; background-color; #FFF",zIndex:10});document.body.appendChild(g);g.innerHTML='<iframe id="chooser-iframe" style="display:none;background-color; #FFF; border: 0"></iframe>'}var i=O("chooser-iframe");i.style.display="block";Yf(g,d.left,d.top);Zf(i,d.width,d.height);i.src=f;Kk=g;Jk=i},Ok=function(){Q(Kk);Kk=h;Jk=h};w("goog.focus.ChooserLauncher.popChooser",function(a,b,c){var d=new Xh(zk.replace(/ui\/?$/,""));Nk(d,a,b,c)});w("goog.focus.ChooserLauncher.popIframe",Pk);var Qk=function(a,b){this.xN=[];this.Rj=ma(a)?new Xh(a):a;if(this.Rj.xd.charAt(0)!="/")k(Error());this.is=b;this.Po={};this.pm=h;this.Dg={};this.uy={};this.Ax={};this.Gl=h};Qk.prototype.ts=function(a){this.Fm=a};var Rk=function(a){this.BJ=a;this.Xm=new xc;this.Af=h};Rk.prototype.EB=function(a){this.Af?this.Af.addInput(a):this.Xm.add(a)};Rk.prototype.rL=function(a){this.Af&&this.Af.setTarget(a)};var Sk=function(a){var b="";for(var c in a)b+=c+"="+a[c]+";";return b};o=Qk.prototype;
o.Jq=function(a){if(this.mv)k(Error("Email autcomplete was already initialized. To attach it to an input field, please use attachAutocomplete()"));this.mv=j;this.Po=a||{};var b=this;this.qF().rE(function(c){var d=(c.contentWindow||c.contentDocument.defaultView)._EmailAc_create;if(d){b.pm=d;for(var f in b.Dg)b.ux(b.Dg[f]);if(b.Gl){var g=s(b.Gl),i=b.Ax[g];i&&i.rL(b.Gl)}for(var f in b.Dg){var i=b.Dg[f],l=i.Xm.Ob();for(var m=1;m<l.length;m++)ad(l[m],kd,b.Ny,e,b)}}})};
o.ux=function(a){if(!this.pm)return;var b=a.BJ;b.serverBase=this.Rj;b.onComplete=u(this.eJ,this);for(var c in this.Po)b[c]=this.Po[c];var d=a.Xm.Ob();a.Af=this.pm(d[0],b);for(var f=1;f<d.length;f++)a.Af.addInput(d[f]);a.Xm.clear()};o.to=function(a,b,c){a=O(a);var d=b||{},f=s(a);this.uy[f]=c;var g=Sk(d),i=this.Dg[g];if(!i){i=new Rk(d);this.Dg[g]=i}i.EB(a);this.Ax[f]=i;i.Af||(this.pm?this.ux(i):H(a,kd,this.Ny,e,this))};o.Ny=function(a){this.Gl=a.target;this.mv||this.Jq()};
o.eJ=function(a){var b=this.uy[s(a)];b&&b(a)};o.uo=function(a,b){this.Jq();this.to(a,b)};o.cC=function(a){this.to(a)};o.jr=function(a,b){Fk(this.Rj,a,b,{serviceName:this.is,hl:this.Fm})};o.zI=function(a,b){Nk(this.Rj,a,b,{serviceName:this.is,hl:this.Fm})};o.qF=function(){if(!this.lv){var a=this.Rj.Rr(new Xh("ui/EmailAc"));a.ea("service",this.is);this.Fm&&a.ea("hl",this.Fm);this.lv=this.SI(a.toString())}return this.lv};o.SI=function(a){return new Tk(a)};w("goog.ContactTools",Qk);
y(Qk.prototype,"setLocale",Qk.prototype.ts);y(Qk.prototype,"attachAutocompleteTo",Qk.prototype.uo);y(Qk.prototype,"attachAutocompleteAlsoTo",Qk.prototype.cC);y(Qk.prototype,"initAutocomplete",Qk.prototype.Jq);y(Qk.prototype,"attachAutocomplete",Qk.prototype.to);y(Qk.prototype,"launchPicker",Qk.prototype.jr);y(Qk.prototype,"launchChooser",Qk.prototype.zI);
var Tk=function(a){this.Tk=[];this.fg=this.Yo();document.body.appendChild(this.fg);B?H(this.fg,od,this.Gj,e,this):H(this.fg,"load",this.Fy,e,this);this.fg.src=a};Tk.prototype.rE=function(a){this.ia?a(this.ia):this.Tk.push(a)};Tk.prototype.Yo=function(){var a=Xd("iframe");a.src='javascript:""';var b=a.style;b.visibility="hidden";b.width=b.height="10px";if(F)b.marginTop=b.marginLeft="-99px";else{b.position="absolute";b.top=b.left="-10px"}return a};
Tk.prototype.Gj=function(){this.fg.readyState=="complete"&&this.Fy()};Tk.prototype.Fy=function(){this.ia=this.fg;delete this.fg;for(var a=0;this.Tk[a];++a)this.Tk[a](this.ia);delete this.Tk};var Uk=B,Vk=E||F||A,Wk=B||F||A,Xk=E,Yk=E,Zk=B||F||A,$k=E||F,al=B,bl=E||A,cl=B,dl=E||F||A,el=E||A,fl=B&&!qb("7.0"),gl=E,hl=F,il=E||F,jl=B||A,kl=B||A,ll=F,ml=A,nl=A,ol=B||E||F,pl=B||F&&qb("525"),ql=F,rl=F,sl=B||E,tl=E||F&&!qb("526"),ul=B||A,vl=!B&&!A;var wl=e,xl=function(){},yl=function(){},zl=function(){},Al=function(){},Bl=function(){},Cl,Dl;var El=e;var Fl=function(a){El=a};var Gl=function(a,b){if(a.nodeType!=1)return h;return B?Rf(a,b):Qf(a,b)},Hl=function(a){var b=mg(a,"padding");return b.top+b.bottom},Il=function(a){var b=mg(a,"padding");return b.left+b.right},Jl=function(a){var b=pg(a);return b.top+b.bottom};var Kl=function(a){while(a&&a.nodeType==3&&!a.nodeValue)a=a.nextSibling;return a},Ll=function(a){var b=M(a);return Wd(b)},Ml=function(a,b){if(a.nodeType==3||a.nodeType==4)return b?a.nodeType==3||a.nodeType==4?/^[\s\u00a0]*$/.test(a.nodeValue):e:Aa(a.nodeValue);if(a.nodeName=="IMG")return e;if(!a.childNodes)return e;for(var c=0;c<a.childNodes.length;c++)if(!Ml(a.childNodes[c],b))return e;return j},Ol=function(a,b,c){Nl(function(d){a.appendChild(d)},j,b,c)},Nl=function(a,b,c,d){var f=c,g=b?"nextSibling":
"previousSibling";while(f&&f!=d){var i=f[g];a(f);f=i}f&&a(f)},Ql=function(a,b){var c=h,d=a;while(d&&!Pl(d)){if(b(d))c=d;d=d.parentNode}return c},Rl=function(a,b,c){return Ae(a,function(d){return d.getAttribute&&d.getAttribute(b)==c},j)};
var Sl=function(a){return!!(a&&(Gl(a,"display")=="block"||a.nodeName.toLowerCase()=="td"||a.nodeName.toLowerCase()=="table"||a.nodeName.toLowerCase()=="li"))},Tl=function(a){return Ae(a,Sl,j)},Ul=function(a,b){var c=b.childNodes.length;for(var d=0;d<c;d++)P(a,b.firstChild)},Vl=function(a,b){for(var c=0;c<b.length;++c)a.removeAttribute(b[c])},Wl=function(a,b){for(var c in b)a.style[c]=b[c]},Xl=function(a){for(var b=1;b<arguments.length;++b)P(a,arguments[b])},Yl=function(a){if(a.data)return a.data;
else if(a.hasChildNodes()){var b="";for(var c=0;c<a.childNodes.length;c++)b+=Yl(a.childNodes[c]);return b}else return""},Zl=function(a,b){var c=a.ownerDocument.createTextNode(b);P(a,c);return c},$l=function(a,b,c,d,f){var g,i=N(a);if(typeof b=="string"){g=i.f("A",{href:b});if(f)g.target="_blank"}else{g=i.f("SPAN",{className:"tr_pseudo-link"});c.e(g,"click",b)}P(a,g);d&&Zl(g,d);return g},am=function(a,b,c,d){var f=ma(a)?parseInt(a,10):a,g=ma(b)?parseInt(b,10):b,i=c.createElement("table");for(var l=
0;l<f;l++){var m=i.insertRow(0);for(var n=0;n<g;n++){var q=m.insertCell(0);d||P(q,c.createTextNode("\u00a0"))}}return i},Pl=function(a){if(!a.getAttribute)return e;return a.getAttribute("g_editable")=="true"};var bm=function(a,b){this.ia=a;this.eH=!!b;this.Yq=this.Mx();if(!this.Yq){var c=B&&!qb("7")?od:"load";this.Vc=H(this.ia,c,this.jj,e,this);this.Oq=window.setInterval(u(this.jj,this),100)}};z(bm,I);o=bm.prototype;o.Vc=h;o.Te=function(){return this.Yq};o.gy=function(){if(this.Oq){window.clearInterval(this.Oq);this.Oq=h}};o.Zi=function(){return this.ia};o.l=function(){delete this.ia;this.gy();cd(this.Vc);bm.d.l.call(this)};
o.Mx=function(){var a=e;try{a=B?this.ia.readyState=="complete":!!ne(this.ia).body&&(!this.eH||!!ne(this.ia).body.firstChild)}catch(b){}return a};o.jj=function(){if(this.Mx()){this.gy();cd(this.Vc);this.Vc=h;this.Yq=j;this.dispatchEvent("ifload")}};var cm=function(a,b){if(a instanceof G){a.preventDefault();a.stopPropagation();if(a.Tv)a.fb.returnValue=b}else{a.preventDefault&&a.preventDefault();a.stopPropagation&&a.stopPropagation();a.cancelBubble=j;a.returnValue=b}return b},dm=function(a){if(a.target){var b=a.target;if(b.nodeName=="IFRAME"&&b.target)if(b.className!="igm")b=b.target;return b}else if(a.srcElement)return a.srcElement;else if(a.currentTarget)return a.currentTarget},em=function(a,b){b.target=a;a.dispatchEvent(b)},fm=function(a,b){a.dispatchEvent?
a.dispatchEvent(b):a.fireEvent("on"+b.type,b)},im=function(a,b,c,d){b=b.fb;var f;if(a.createEvent)f=gm(a,b,c,d);else if(a.createEventObject)f=hm(a,b,c,d);return f},gm=function(a,b,c,d){var f=a.createEvent("MouseEvents");f.initMouseEvent(b.type,b.bubbles,b.cancelable,b.view,b.detail,b.screenX,b.screenY,ba(c)?b.screenX-c:b.clientX,ba(d)?b.screenY-d:b.clientY,b.ctrlKey,b.altKey,b.shiftKey,b.metaKey,b.button,b.relatedTarget);return f},hm=function(a,b,c,d){var f=a.createEventObject(b);if(ba(c))f.clientX=
b.screenX-c;if(ba(d))f.clientY=b.screenY-d;return f};var jm=function(a,b){this.Om=[];this.Jm=[];while(a&&a.nodeName!="BODY"&&a!=b){var c=0,d=a.previousSibling;while(d){d=d.previousSibling;++c}this.Om.unshift(c);this.Jm.unshift(a.nodeName);a=a.parentNode}};z(jm,Bc);jm.prototype.toString=function(){var a=[],b;for(var c=0;b=this.Jm[c];c++)a.push(this.Om[c]+","+b);return a.join("\n")};jm.prototype.Ev=function(a){var b,c=a;for(var d=0;b=this.Jm[d];++d){c=c.childNodes[this.Om[d]];if(!c||c.nodeName!=b)return h}return c};
jm.prototype.l=function(){delete this.Om;delete this.Jm};var km=function(a,b){this.wj=e;if(!a)return;var c=a.Oi(),d=a.Vi();if(!c||!d)return;var f=a.Jl(),g=new jm(c,b),i=a.Wi(),l=new jm(d,b);if(a.ne()){this.v=l;this.hk=i;this.F=g;this.Ki=f}else{this.v=g;this.hk=f;this.F=l;this.Ki=i}this.wj=j};km.prototype.collapse=function(a){if(a){this.F=this.v;this.Ki=this.hk}else{this.v=this.F;this.hk=this.Ki}};km.prototype.xm=function(){return this.wj};km.prototype.toString=function(){return"MOZ:"+this.v.toString()+"\n"+this.hk+":"+this.F.toString()+"\n"+this.Ki};
km.prototype.Hb=function(a){var b=this.v.Ev(a),c=this.F.Ev(a);if(!b||!c)return h;return Ee(b,this.hk,c,this.Ki).gc()};var mm=function(a,b){this.wj=e;if(!a||!ie(b,a.parentElement()))return;var c=b.ownerDocument.body.createTextRange();c.moveToElementText(b);var d=a.duplicate();d.collapse(j);d.setEndPoint("StartToStart",c);this.v=lm(d);var f=a.duplicate();f.setEndPoint("StartToStart",c);this.F=lm(f);this.wj=j};mm.prototype.xm=function(){return this.wj};
mm.prototype.toString=function(){return"IE:"+this.v+","+this.F};var lm=function(a){var b=a.duplicate(),c=a.text,d=c.length;b.collapse(j);b.moveEnd("character",d);var f,g=10;while(f=b.compareEndPoints("EndToEnd",a)){d-=f;b.moveEnd("character",-f);--g;if(0==g)break}var i=0,l=c.indexOf("\n\r");while(l!=-1){++i;l=c.indexOf("\n\r",l+1)}return d+i};
mm.prototype.Hb=function(a){var b=a.ownerDocument.body.createTextRange();b.moveToElementText(a);b.collapse(j);b.moveEnd("character",this.F);b.moveStart("character",this.v);return b};var nm=function(a){this.nf=a||window;this.Yd=this.nf.document;var b=this.getSelection();this.La=b&&wf(b)};o=nm.prototype;o.$H=function(){return this.Aa().fj()=="control"};o.getSelection=function(){return He(this.nf)};o.Kj=function(){var a;if(this.La)a=this.WF();if(!this.La||!a||!this.La.Tj(a))this.La=Ue(this.nf)};o.de=function(){var a=this.Aa();return a&&a.Q()};o.If=function(){var a=this.Aa();return a&&a.ha()};o.ta=function(){var a=this.Aa();return a&&a.ta()};
o.Fa=function(){var a=this.Aa();return a&&a.Fa()};o.Zb=function(){var a=this.Aa();return a&&a.$p()};o.Ue=function(){var a=this.Aa();return!a||a.isCollapsed()};o.Rq=function(a){var b=this.Zb();return!!b&&ie(a,b)};o.empty=function(){yf(this.nf);this.Kj()};
o.OD=function(){var a=this.Aa();if(a&&!a.isCollapsed()){var b=this.Zb(),c=this.Hf(b),d=this.eI(),f=!d&&this.kI(),g=this.Hf(b);a.df();g.collapse(j);this.as(g,b);if(d){var i=Tl(a.Q());if(Ml(i,e)){i.innerHTML="&nbsp;";this.Gz(i.firstChild);c=h}}if(f){var l=Tl(a.Q()),m=xi(l);if(m){Ul(l,m);Q(m)}}if(c){c.collapse(j);this.as(c,b)}}return a.gc()};o.eI=function(){var a=this.de();if(Sl(a))a=a.childNodes[this.ta()]||h;a=Tl(a);var b=this.If();if(Sl(b))b=b.childNodes[this.Fa()]||h;b=Tl(b);return a==b};
o.kI=function(){var a=this.If(),b=this.Fa(),c=a;if(Sl(c)){var d=c.childNodes[b];if(!d||d.nodeType==1&&Sl(d))return e}var f=Tl(c);while(f!=c){if(xi(c))return j;c=c.parentNode}return b!=(a.length||a.childNodes.length)};o.containsNode=function(a,b){if(!a)return e;var c=this.Aa();try{return c?c.containsNode(a,!b):e}catch(d){return e}};o.zu=function(a){a=a.toUpperCase();var b=this.Aa();if(b)return Xb(b,function(c){return c.tagName==a});return e};
o.fF=function(a){var b=this.de(),c=this.If();c=Tl(c);var d=this.Zb(),f=[];if(d){var g=Tl(d),i=Tl(b);if(i==g)this.containsNode(i,a)&&f.push(i);else while(i&&this.containsNode(i)){while(Tl(i.parentNode)!=g)i=Tl(i.parentNode);this.containsNode(i,a)&&f.push(i);var l=xi(i);if(l)i=l;else{i=xi(i.parentNode);if(i)i=ri(i)}}}return f};o.GK=function(a){this.La=Ie(a);this.La.select()};o.Fl=function(){this.nf.focus()};
o.HK=function(a){if(!this.La||!this.La.Tj(a))this.La=!!a.addElement?mf(a):ff(df(a),undefined);this.La.select()};o.selectNodes=function(a,b,c,d){this.La=Ee(a,b,c,d);this.La.select()};o.Gz=function(a){a=si(a);a=a.nodeName=="BR"?a.parentNode:a;this.La=Ee(a,0,a,0);this.La.select()};o=nm.prototype;o.Mj=function(){if(Uk)this.hn=this.Aa().za();else if(Vk){var a=this.Aa();if(a&&a.Oi()){this.Kk={M:a.Oi(),Ye:a.Jl()};this.Op={M:a.Vi(),Ye:a.Wi()}}}};
o.jg=function(){if(Uk&&this.hn)this.hn.select();else if(Vk&&this.Kk&&this.Kk.M.ownerDocument&&this.Op.M.ownerDocument){this.selectNodes(this.Kk.M,this.Kk.Ye,this.Op.M,this.Op.Ye);this.nf.focus()}this.Kj()};o.Hf=function(a){var b=h;if(Vk)b=new km(this.Aa(),a);else if(Uk)b=new mm(this.$b(),a);b.xm()||(b=h);return b};o.as=function(a,b){var c=a.Hb(b);if(c){Uk&&b.focus();this.HK(c)}};o.collapse=function(a){if(Uk)this.cD(a);else Vk&&this.dD(a);this.Kj()};o.cD=function(a){this.hn&&this.hn.collapse(a)};
o.dD=function(a){if(!this.Ue()){this.Aa().collapse(a);this.Aa().select()}};o.s=function(){return this.Yd};o.aw=function(a){var b=this.Aa(),c=a?b.Oi():b.Vi(),d=a?b.Jl():b.Wi();while(c.hasChildNodes){var f=c.childNodes[d];if(!f&&!c.lastChild)break;if(f){c=f;d=0}else{c=c.lastChild;d=c.length||c.childNodes.length}}return{M:c,Ye:d}};o.ow=function(a){var b=this.Zb(),c=[];if(!a)for(var d=b;d&&!Pl(d);d=d.parentNode)d.nodeType==1&&c.push(d);return this.pw(b,c,a)};
o.pw=function(a,b,c){var d=ri(a);if(c&&!d)return[a];var f=e;while(d){if(this.containsNode(d)){f=j;if(c||d.nodeType==1){b.push(d);c||this.pw(d,b)}}else if(f)break;d=xi(d)}return b};o.pe=function(a){this.La=Uk?om(a,e):pm(a,e)};o.Hr=function(a){this.La=Uk?om(a,j):pm(a,j)};var om=function(a,b){var c=Ie(a);c.collapse(b);c.select();return c},pm=function(a,b){var c=N(a).createTextNode("");a.parentNode.insertBefore(c,b?a:a.nextSibling);var d=Ee(c,0,c,0);d.select();return d};o=nm.prototype;
o.$b=function(){var a=this.Aa();return a&&a.$b(0).gc()};o.WF=function(){var a=Ue(this.nf);return a&&a.gc()};o.Aa=function(){if(!this.La||!this.La.sh())this.La=Ue(this.nf);return this.La};o.Lq=function(a){var b=this.Aa(),c=this.$H();c&&b.insertNode(a,j);b.isCollapsed()||b.df();c||b.insertNode(a,j)};o.EK=function(a,b){this.La=Ee(a,0,b,b.childNodes.length);this.La.select()};var qm=top;var rm=new RegExp("^((https?|ftp):\\/\\/(\\w+(:\\w+)?@)?[\\w\\.-]+|([\\w-]+\\.)*[\\w-]+\\.(com|org|net|edu|gov|[a-z]{2}(\\.[a-z]{2})?)|(\\d{1,3}\\.){3}\\d{1,3})(:\\d+)?([\\?\\/]\\S*)?$","i");var sm=/^[\w-]+(\.[\w-]+)*\@([\w-]+\.)+(\d+|\w\w+)$/i;var tm=function(a){this.zJ=a};o=tm.prototype;o.$=function(){return this.zJ};o.s=function(){if(!this.Yd)this.Yd=this.$().document;return this.Yd};o.PF=function(){return Vd(this.$())};o.Sv=function(){if(!this.bu)this.bu=this.s().body;return this.bu};o.AF=function(){if(!this.mx)this.mx=this.Sv().parentNode;return this.mx};o.pF=function(a){return this.s().getElementById(a)};o.jh=function(){return this.Sl().clientWidth};o.Yi=function(){return this.Sl().clientHeight};o.QF=function(){return this.Sl().scrollWidth};
o.uw=function(){return this.Sl().scrollHeight};o.Sl=function(){if(!this.ry)this.ry=oi(this.s())?this.s().documentElement:this.Sv();return this.ry};o.Ry=function(a,b){var c=this.Yi()-50,d="resizable=yes,scrollbars=yes,toolbar=yes,location=yes,directories=yes,status=no,menubar=yes,width="+(this.jh()-50)+",height="+c,f=this.$().open(a,b,d,j);f&&f.focus();return f};o.us=function(a){try{this.$().location=a}catch(b){}};o.Fl=function(){this.$().focus()};o.fa=function(){return new nm(this.$())};o.Hb=function(){return Ue(this.$())};
var um=function(){qm.status="";return j};var vm=function(a,b){this.km=new bm(a,b);this.Cr=[];try{var c=a.contentWindow}catch(d){}finally{c?this.eA():this.load()}};z(vm,tm);vm.prototype.Pu=function(){if(this.Vc){cd(this.Vc);this.Vc=h}this.km.k()};vm.prototype.eA=function(){tm.call(this,this.Zi().contentWindow);this.tI=j};vm.prototype.load=function(a){a&&this.Cr.push(a);if(!this.Vc)this.Vc=H(this.km,"ifload",this.gv,j,this);this.km.Te()&&this.gv()};
vm.prototype.gv=function(){this.tI||this.eA();while(this.Cr.length)this.Cr.pop()();cd(this.Vc);this.Vc=h};var wm=function(a){return a.frameElement};vm.prototype.Zi=function(){return this.km.Zi()};vm.prototype.qw=function(){return this.Zi().ownerDocument};vm.prototype.Jr=function(a,b){a.e(this.qw(),Fc,u(this.TJ,this),j);var c=u(this.RJ,this),d=this.s(),f=!!b;for(var g=0;g<xm.length;g++)a.e(d,xm[g],c,f)};vm.prototype.TJ=function(a){this.zK=a.screenX-a.clientX;this.AK=a.screenY-a.clientY};
var ym=["target","originalTarget"],xm=[gd,hd,id,Fc,Gc,Ic];vm.prototype.RJ=function(a){var b=this.Zi();if(!b||!b.parentNode)return;var c=im(this.s(),a,this.zK,this.AK);for(var d=0;d<ym.length;d++){var f=ym[d];b[f]=a[f]}fm(b,c)};var zm=function(a,b,c){var d=b,f=c||qm,g=new yd(0,0);do{var i=d&&d!=f?Xf(a):Wf(a);g=new yd(i.x+g.x,i.y+g.y)}while(d&&d!=f&&(a=d.frameElement)&&(d=d.parent));return g},Am=function(a){var b=a.offsetHeight;if(B&&oi(a))b+=Hl(a);return b};var Bm=function(){xd.call(this)};z(Bm,xd);Bm.prototype.ac=function(){return"EnterHandler"};Bm.prototype.cG=function(a,b){var c=this.p.b(),d=b.de();if(c.firstChild==d&&yi(d)){a.preventDefault();a.stopPropagation()}};Bm.prototype.QJ=function(a,b){if(B)this.uv("DIV");else if(!b&&F){var c=this.p.fa();if(!Cm(c.Zb()))return;var d=this.Fb(),f=d.createElement("BR");c.Aa().insertNode(f,j);if(Bi(f.parentNode))Kl(f.nextSibling)||ae(d.createElement("BR"),f);c.pe(f);a.preventDefault()}};
var Cm=function(a){for(var b=a;b;b=b.parentNode)if(Bi(b))return b.tagName=="BLOCKQUOTE";return e};o=Bm.prototype;o.uG=function(a){this.KD(a)};o.KD=function(a){var b=this.p.Hb();if(b.isCollapsed()){var c=b.ha();if(c.nodeType==1){var d=c.childNodes[b.Fa()];if(d.tagName=="BR"){c.removeChild(d);a.preventDefault()}}}};
o.vq=function(a){if(E&&El)return;if(a.keyCode==8)this.cG(a,this.p.fa());else if(a.keyCode==13)if(E)a.shiftKey||this.EG(a);else{this.p.kd();this.hz(this.Ou());this.QJ(a,e);this.p.ra()}else E&&a.keyCode==46&&this.uG(a)};o.Sw=function(a){if(E&&El)return;this.LG(a)};o.LG=function(a){B&&a.keyCode==13&&this.uv("DIV",j)};o.EG=function(){this.p.fa().Ue();this.hz(this.Ou())};var Dm={LI:1,DIV:1,H1:1,H2:1,H3:1,H4:1,H5:1,H6:1};o=Bm.prototype;
o.uv=function(a,b){var c=this.p.Hb().gc(),d=c.parentElement(),f=this.p.b();while(d&&d!=f){var g=d.nodeName;if(g==a||Dm[g]&&(!b||!(yi(d)&&d.getElementsByTagName("BR").length==1)))return;d=d.parentNode}var i=e,l=c.duplicate();l.moveEnd("character",1);if(l.text.length){var m=l.parentElement(),n=l.duplicate();n.collapse(e);var q=n.parentElement();if(i=m!=q&&q!=c.parentElement()){c.move("character",-1);c.select()}}this.p.Cb.s().execCommand("FormatBlock",e,"<"+a+">");if(i){c.move("character",1);c.select()}};
o.Ou=function(){return Vk?this.MD():this.LD()};o.hz=function(a){Vk||a.removeNode(j)};o.LD=function(){var a=this.Fb().s(),b=a.selection.createRange(),c=ab();b.pasteHTML('<span id="'+c+'"></span>');var d=a.getElementById(c);d.id="";return d};o.MD=function(){var a=this.p.fa();a.Ue()||a.OD();return a.aw(j)};var Em={Ok:"dir",ep:"direction",OA:e},Fm={Ok:"align",ep:"textAlign",OA:j},Gm=/^[^<]*<DIV\s+DIR\s*=\s*.?(LTR|RTL).?>([\s\S]*)<\/DIV>[^>]*$/i,Hm=0,Im=!!Date.now,Jm=function(a){var b=a.style;if(!b)return 0;var c=parseInt(b.marginLeft,10),d=parseInt(b.marginRight,10);return a.tagName=="BLOCKQUOTE"?(d==0)-(c==0):!d-!c},Km=function(a){var b=a.tagName;return b=="UL"||b=="OL"},Mm=function(a,b){return Bi(a)&&ri(a)||a!=b&&xi(a)||Lm(a,b)},Lm=function(a,b){if(a!=b)while((a=a.parentNode)&&a!=b){var c=xi(a);if(c)return c}return h},
Nm=function(a,b){var c=a.parentNode,d,f;if(Pl(c)||E&&c.tagName=="BLOCKQUOTE"){f=a;d=N(c).createElement("DIV")}else{f=c;d=c.cloneNode(e)}Ol(d,b?c.firstChild:a.nextSibling,b?a.previousSibling:c.lastChild);b?ae(d,f):be(d,f);return d},Om=function(a,b,c,d){if(Pl(a))return a;var f=b?wi:xi;if(c){var g=Ql(a,Km);if(g)return g}if(E&&d){var i=b?pi:ri,l=a;do{if(l.tagName=="BR"){if(b)l=a;do{a=l;f(l)&&Nm(l,b)}while((l=l.parentNode)&&!Bi(l))}else{a=l;if((l=f(l))&&!Bi(l))for(var m=i(l);m;m=i(l))l=m;else l=a.parentNode}}while(l&&
!Bi(l))}else if(!Bi(a)){var n=2;while(n){var l=n==2?a.parentNode:f(a);if(!l||Bi(l))n--;else a=l}}return a};
Al=function(a,b){if(!Pm(a))return;a.Mj();var c=a.de(),d=a.If(),f;if(c==d){var g=a.aw(j).M;if(E&&a.Ue()&&g.tagName=="BR"){f=g;var i=g.previousSibling;c=i&&i.nodeType==3?i:g;d=g}else if(Pl(c)){if(!c.firstChild){var l=Xd("DIV",{innerHTML:"&nbsp;"});c.appendChild(l);Qm(l,b);Ee(c,0,c,0).select();return}c=ri(c);d=pi(d)}}var m=[Om(c,j,j,j),Om(d,e,j,j)],n=me(m[0],m[1]);if(!n)return;if(!Bi(n))n=n.parentNode;var q=new Array(2),r=!Pl(n);for(var t=0;t<2;t++){if(ie(m[1-t],m[t]))m[t]=m[1-t];var v=t?wi:xi,x=t?xi:
wi,C=h,J=h,D=h,L=m[t]==n;for(var g=m[t];!Pl(g);g=g.parentNode){if(g.parentNode==n){L=j;q[t]=J?v(g):g}if(J){if(Jm(g)){C=g;D=!L&&g}}else if(x(g)){J=g;D=!L&&g}if(g.parentNode==n)r=r&&!J}if(C)for(var g=J;g&&g!=C;g=g.parentNode)Nm(g,!t);for(var g=D;g&&g.parentNode!=n;g=g.parentNode){if(g==D){var ea=t?ri(g.parentNode):g,va=t?g:pi(g.parentNode)}else{var ea=t?ri(g.parentNode):v(g),va=t?v(g):pi(g.parentNode)}ea&&va&&Rm(ea,va,b)}}if(r)Qm(n,b);else ui(Wb(new li(q[0],e,j),vi))!=q[1]&&Rm(q[0],q[1],b);Sm(si(m[0]),
qi(m[1]),b);if(f){var vb=f.parentNode;for(var mb=0;vb.childNodes[mb]!=f;mb++);Ee(vb,mb,vb,mb).select()}else a.jg()};
var Sm=function(a,b,c){var d=a;if(!Pl(d))while((d=d.parentNode)&&!Pl(d))Tm(d,c);do{Tm(a,c)}while(a!=b&&(a=Mm(a)))},Tm=function(a,b){var b,c=a.style;if(c)if(Jm(a)*(b=="rtl"?1:-1)>0){var d=a.style.marginLeft;c.marginLeft=c.marginRight;c.marginRight=d}},Rm=function(a,b,c){var d,f;do{if(Bi(a)){if(d){Um(d,f,c);d=h}Qm(a,c)}else{d=d||a;f=a}}while(a!=b&&(a=xi(a)));d&&Um(d,f,c)},Um=function(a,b,c){if(Vm(a.parentNode,Em,j)!=c){var d=N(a).createElement("DIV");ae(d,a);Ol(d,a,b);Qm(d,c)}},Vm=function(a,b,c){var d=
b.ep,f;if(c)if(E)f=Qf(a,d);else if(B)f=Rf(a,d);f=f||a.style[d]||a[b.Ok];if(!E&&c&&(!f||f=="inherit")){var g=a.parentNode;if(g&&g.nodeType==1)f=Vm(g,b,j)}if(E&&b==Fm)switch(f){case "start":return Wm(a,b);case "-moz-left":return"left";case "-moz-right":return"right";case "-moz-center":return"center"}return f||(c?Wm(a,b):h)},Xm=function(a,b,c,d){if(!d&&c&&!Pl(a)&&Vm(a.parentNode,b,j)==c)c="";if(b.OA||!c)a.removeAttribute(b.Ok);else{a.setAttribute(b.Ok,c);c=""}Of(a,b.ep,c)},Wm=function(a,b){switch(b){case Fm:return Vm(a,
Em,j)=="rtl"?"right":"left";case Em:return"ltr"}return""},Qm=function(a,b){var c=b=="ltr"?"left":"right",d=b=="ltr"?"right":"left";for(var f=a;f;f=Mm(f,a))if(Bi(f)){Xm(f,Em,b);b="";Vm(f,Fm,f==a)==d&&Xm(f,Fm,c,j)}},$m=function(a,b,c){var d=h,f=me(a,b);if(!f)return h;if(a==b)a=ri(a)||a;var g;Ym();do{if(!Bi(a)&&g!=a.parentNode){g=a.parentNode;var i=Vm(g,c,j);if(d&&i!=d)return h;d=i}}while(a!=b&&(a=Mm(a,f))&&!Zm());return d};zl=function(a){return!Pm(a)?h:$m(a.de(),a.If(),Em)};
Bl=function(a){return!Pm(a)?h:$m(a.de(),a.If(),Fm)};xl=function(a,b,c){var d=b&&Gm.exec(b),f=c;if(d){f=d[1];b=d[2]}Of(a,"direction",f);return b};yl=function(a,b){var c=Vm(a,Em,j);if(c)b='<DIV DIR="'+c+'">'+b+"</DIV>";return b};var Pm=function(a){return an(a.de())&&an(a.If())},an=function(a){while(a){if(Pl(a))return j;a=a.parentNode}return e},Ym=function(){Hm=0;Im||(Cl=40);Dl=ua()},Zm=function(){if(Im||++Hm>Cl){var a=ua()-Dl;if(a>=20)return j;else if(!Im){Cl*=1+(1-a/20)*2;Cl++}}return e};wl=j;var bn=function(a){if(E){a.style.display="none";a.style.display="block"}},cn=function(a){if(E){var b=a.style.borderTopWidth,c=pg(a).top+1;a.style.borderTopWidth=c+"px";a.style.borderTopWidth=b}},dn=function(a,b){var c=N(a);return c.f("DIV",{style:"overflow:auto;height:100%;"},c.f("DIV",b?{style:"padding-left:5px;height:100%"}:{style:"padding-right:5px;height:100%"},a))};var fn=function(a,b){var c=a.ownerDocument||a.document;if(en(a)){a.selectionStart=b;a.selectionEnd=b}else if(c.selection&&a.createTextRange){var d=a.createTextRange();d.collapse(j);d.move("character",b);d.select()}},en=function(a){try{return typeof a.selectionStart=="number"}catch(b){return e}};var gn=function(a){I.call(this);this.ad=a||window;this.Dm=H(this.ad,nd,this.XG,e,this);this.sb=Ud(this.ad);if(this.lI())this.Un=window.setInterval(u(this.ru,this),500)};z(gn,I);o=gn.prototype;o.Dm=h;o.ad=h;o.sb=h;o.Un=h;o.lI=function(){return F&&lb||A&&this.ad.cO!=this.ad.top};o.ww=function(){return this.sb?this.sb.za():h};o.l=function(){gn.d.l.call(this);if(this.Dm){cd(this.Dm);this.Dm=h}if(this.Un){window.clearInterval(this.Un);this.Un=h}this.ad=h;this.sb=h};o.XG=function(){this.ru()};
o.ru=function(){var a=Ud(this.ad);if(!Gd(a,this.sb)){this.sb=a;this.dispatchEvent(nd)}};var kn=function(){this.Fj="closure_frame"+hn++;this.rj=[];jn[this.Fj]=this},ln;z(kn,I);var jn={},hn=0;var mn=function(){if(!ln){ln=Xd("form");ln.acceptCharset="utf-8";var a=ln.style;a.position="absolute";a.visibility="hidden";a.top=a.left="-10px";a.width=a.height="10px";a.overflow="hidden";Qd().s().body.appendChild(ln)}return ln},nn=function(a,b){rc(b,function(c,d){var f=Xd("input",{type:"hidden",name:d,value:c});a.appendChild(f)})};o=kn.prototype;o.gb=h;o.ia=h;o.Vf=h;o.WI=0;o.lb=e;o.ui=e;o.En=e;
o.Aj=h;o.Am=h;o.Tc=0;o.Yh=0;o.lf=h;o.Fv=h;o.Qe=h;o.send=function(a,b,c,d){if(this.lb)k(Error("[goog.net.IframeIo] Unable to send, already active."));var f=new Xh(a);this.Aj=f;var g=b?b.toUpperCase():"GET";c&&f.ay();this.gb=mn();g=="GET"&&nn(this.gb,f.Jb);d&&nn(this.gb,d);this.gb.action=f.toString();this.gb.method=g;this.Hz()};
o.KK=function(a,b,c){if(this.lb)k(Error("[goog.net.IframeIo] Unable to send, already active."));var d=new Xh(b||a.action);c&&d.ay();this.Aj=d;this.gb=a;this.gb.action=d.toString();this.Hz()};o.abort=function(a){if(this.lb){ed(this.Wl());this.ui=e;this.lb=e;this.En=e;this.Tc=a||7;this.dispatchEvent("abort");this.pr()}};o.l=function(){this.lb&&this.abort();kn.d.l.call(this);this.ia&&this.Cz();this.ev();delete this.vv;this.gb=h;this.wI=this.Am=this.Aj=h;this.Tc=0;delete jn[this.Fj]};o.Qq=function(){return this.ui};
o.Qx=function(){return this.En};o.td=function(){return this.lb};o.gq=function(){return this.Am};o.tw=function(){return dj(this.Am)};o.dk=function(a){this.Yh=Math.max(0,a)};o.dispatchEvent=function(a){this.ia&&Dj.$m(this.ia);try{kn.d.dispatchEvent.call(this,a)}finally{this.ia&&Dj.Ym()}};
o.Hz=function(){this.lb=j;this.ui=e;this.Tc=0;this.Yo();if(B){this.gb.target=this.Vf||"";this.Vt();H(this.ia,od,this.Gj,e,this);try{this.Jp=e;this.gb.submit()}catch(a){ad(this.ia,od,this.Gj,e,this);this.Sf(1)}}else{this.Vt();var b=this.Vf+"_inner",c=ne(this.ia);c.write("<body><iframe id="+b+" name="+b+"></iframe>");H(c.getElementById(b),"load",this.Qm,e,this);var d=this.gb.getElementsByTagName("textarea");for(var f=0,g=d.length;f<g;f++)xe(d[f])!=d[f].value&&oe(d[f],d[f].value);var i=c.importNode(this.gb,
j);i.target=b;c.body.appendChild(i);var l=this.gb.getElementsByTagName("select"),m=i.getElementsByTagName("select");for(var f=0,g=l.length;f<g;f++)m[f].selectedIndex=l[f].selectedIndex;var n=this.gb.getElementsByTagName("input"),q=i.getElementsByTagName("input");for(var f=0,g=n.length;f<g;f++)if(n[f].type=="file")if(n[f].value!=q[f].value){this.gb.target=b;i=this.gb;break}try{this.Jp=e;i.submit();c.close();if(E)this.Fv=Cd(this.xA,250,this)}catch(a){ad(c.getElementById(b),"load",this.Qm,e,this);c.close();
this.Sf(2)}}};o.Gj=function(a){if(this.ia.readyState=="complete"){ad(this.ia,od,this.Gj,e,this);var b;try{b=ne(this.ia);if(B&&b.location=="about:blank"&&!navigator.onLine){this.Sf(9);return}}catch(a){this.Sf(1);return}this.jj(b)}};o.Qm=function(){ad(this.Wl(),"load",this.Qm,e,this);this.jj(this.Yv())};
o.jj=function(a){this.ui=j;this.lb=e;var b;try{var c=a.body;this.Am=c.textContent||c.innerText}catch(d){b=1}var f;if(!b&&typeof this.vv=="function"){f=this.vv(a);if(f)b=4}if(b)this.Sf(b,f);else{this.En=j;this.Tc=0;this.dispatchEvent(xj);this.dispatchEvent(yj);this.pr()}};o.Sf=function(a,b){if(!this.Jp){this.En=e;this.lb=e;this.ui=j;this.Tc=a;if(a==4)this.wI=b;this.dispatchEvent(xj);this.dispatchEvent(zj);this.pr();this.Jp=j}};o.pr=function(){var a=this.ia;this.Cz();this.ev();Dj.$m(a);try{this.dispatchEvent("ready")}finally{Dj.Ym()}};
o.Yo=function(){this.Vf=this.Fj+"_"+(this.WI++).toString(36);var a={name:this.Vf,id:this.Vf};if(B&&ib<7)a.src='javascript:""';this.ia=Xd("iframe",a);var b=this.ia.style;b.visibility="hidden";b.width=b.height="10px";if(F)b.marginTop=b.marginLeft="-10px";else{b.position="absolute";b.top=b.left="-10px"}};o.Vt=function(){Qd().s().body.appendChild(this.ia)};
o.Cz=function(){var a=this.ia;if(a){a.onreadystatechange=h;a.onload=h;a.onerror=h;this.rj.push(a)}if(this.Qe){Dd(this.Qe);this.Qe=h}if(E||A)this.Qe=Cd(this.sp,2000,this);else this.sp();this.ia=h;this.Vf=h};o.sp=function(){if(this.Qe){Dd(this.Qe);this.Qe=h}var a=0;while(a<this.rj.length){var b=this.rj[a];if(Dj.ZH(b)){Gb(this.rj,a);Q(b)}else a++}if(this.rj.length!=0)this.Qe=Cd(this.sp,2000,this)};o.ev=function(){this.gb&&this.gb==ln&&$d(this.gb);this.gb=h};
o.Yv=function(){if(this.ia)return ne(this.Wl());return h};o.Wl=function(){if(this.ia)return B?this.ia:ne(this.ia).getElementById(this.Vf+"_inner");return h};o.xA=function(){if(this.lb){if(this.Yv())try{}catch(a){ad(this.Wl(),"load",this.Qm,e,this);navigator.onLine?this.Sf(3):this.Sf(9);return}this.Fv=Cd(this.xA,250,this)}};z(function(a){G.call(this,"incrementaldata");this.data=a},G);var on=function(a){if(a.match(/^([a-zA-Z]+):(.*)$/)){this.protocol=RegExp.$1.toLowerCase();a=RegExp.$2;if(this.protocol=="mailto"||this.protocol=="javascript"||a.indexOf("//")!=0)this.PN=j;else a=a.substring(2);if(a.match(/^([^\/]+)/)){this.domain=RegExp.$1;a=a.substring(this.domain.length)}}if(a.match(/^(\/|[^?#])/)){a.match(/^(.[^?#]*)/);this.Um=RegExp.$1;a=a.substring(this.Um.length)}if(a.charAt(0)=="?")this.dz=a;else if(a.charAt(0)=="#")this.hash=a};
on.prototype.zw=function(){var a=[],b=function(c){c&&a.push(c);return c};b(this.protocol)&&b("://");b(this.domain);b(this.Um);b(this.hash);b(this.dz);return a.join("")};var pn=function(a){this.xL(a)},qn=function(a){var b=a.location.toString(),c=b.substring(0,b.lastIndexOf("/")+1);return new pn({base:c,winbase:c,draft:c,preview:c,live:c,edit:c})};pn.prototype.xL=function(a){this.Ac=a;var b=this.Ac.base;this.Ac.site=b.substring(0,b.indexOf("/",9))};var rn=function(){alert("\u6b64\u7f51\u5740\u65e0\u6548\u800c\u4e14\u65e0\u6cd5\u52a0\u8f7d\u3002")};pn.prototype.zw=function(a,b){if(this.tm(a))a=(this.Ac[b]||this.Ac.base)+sn(a);return a};
pn.prototype.Aw=function(a){var b=a.getAttribute("href"),c=this.Ac.base;if(c&&c!=this.Ac.winbase&&b.indexOf(c)==0)b=this.Ac.winbase+b.substring(c.length);return b};pn.prototype.OF=function(a){if(this.tm(a))if(tn(a))return sn(a);else{var b="about:blank";if(a.indexOf(b)==0)a=a.substring(b.length)}return a};pn.prototype.or=function(a){var b=a.getElementsByTagName("img");for(var c=0,d=b.length;c<d;c++)b[c].src=this.zw(b[c].src,"live")};
var sn=function(a){var b=un(a),c=a.lastIndexOf("?");if(c==-1)return decodeURIComponent(a.substring(b));return decodeURIComponent(a.substring(b,c))},un=function(a){var b=a.lastIndexOf("/");!vn(a)||(b=a.lastIndexOf("/",b-1));var c="about:blank";if(a.indexOf(c,b+1)==0)b+=c.length;return b+1},wn=/href="([^"]*)"/;pn.prototype.by=function(a){var b="",c=a.nodeName=="A"?"href":"src";if(fl&&c=="href"){var d=a.outerHTML.match(wn);if(d&&d.length>0)b=d[1]}if(!b)try{b=a[c]}catch(f){return}if(this.tm(b))a[c]=this.OF(b)};
var vn=function(a){if(/.*\/([^\/]+)\.\w{1,4}\/([^\/]+)-(small|medium|large|full|custom).*(?:\.\w{1,4})?$/.test(a)){var b=RegExp.$3;if(RegExp.$1==RegExp.$2)return b}return h},xn=e;pn.prototype.tm=function(a){var b=xn;if(b)if(oa(b))return b(a);else{if(a.indexOf("mailto:")==0)return e;var c=e;for(var d in this.Ac)if(this.Ac[d]!="")c|=a.search(this.Ac[d])==0;return c||!tn(a)||a.search("/")==0}else return e};var yn=function(a){xn=a};
pn.prototype.wK=function(a,b){var c=a.getElementsByTagName(b);for(var d=0;d<c.length;d++)this.by(c[d])};var tn=function(a){return a.search(/[^:\/\s]+:\/\//)==0},zn=function(a){if(a.search(/:/)<0)a="http://"+Fa(a);return a},An=e;var Dn=function(a,b){var c=An;return c?oa(c)?c(a):Bn(a)||Cn(a,b):e},En=function(a){An=a},Bn=function(a){return a=="http://"||a=="http:///"||a==""||a=="/"},Cn=function(a,b){var c=b.substring(0,b.indexOf("/",9));return a==c+"/"||a==c};var Fn=function(a,b,c,d){I.call(this);this.db=a.document;this.S=N(this.db);this.Tn=a;this.bd=new tm(a);this.Bd=c;this.ly=b;this.ga=new zf(this);this.ag=new zf(this);this.Id=new gn(this.Tn);this.xu=j;this.Dl=h;d&&this.ns(d)};z(Fn,I);
Fn.prototype.ns=function(a){if(this.content)return;this.content=this.S.f("DIV",{id:ab(),"class":"tr_dialog"});P(a.parentNode,this.content);this.wu=a.Mo;this.nu=a.Fo;this.eK=a.lz;a.Us&&this.IB(a.Us);this.yB(a);if(a.zh)this.zh=this.GB(a.zh);if(a.Kg)this.Kg=this.BB(a.Kg);if(a.xh)this.yh=a.xh};var Gn="tr_backgroundMask",Hn="tr_dialog-section",In=[];o=Fn.prototype;o.Lt=function(a){if(!this.gu)this.gu=this.zB("tr_button-region-rhs");var b=this.S.f("INPUT",{type:"button",value:a});P(this.gu,b);return b};
o.zB=function(a){this.Qk||this.AB();var b=this.S.f("DIV",{"class":a});ae(b,this.$C);return b};o.AB=function(){if(!this.Qk){this.Qk=this.S.f("DIV",h,this.$C=this.S.f("DIV",{style:"clear:both"}));P(this.au,this.Qk)}};o.Yc=function(){this.dispatchEvent("beforeopen");if(this.ly){if(this.Bd){this.Bd.Mj();this.Bd.empty()}Jn(this);this.hA()}Fl(j);this.content.style.display="";this.Ge||this.AL()};o.hide=function(){this.nM();if(this.ly){Kn(this);this.Yy()}this.content.style.display="none";this.Se=j;Fl(e)};
o.lu=function(){return this.upload&&this.upload.IN()?confirm("\u4e0a\u4f20\u5f85\u5904\u7406\u72b6\u6001\u5c06\u4f1a\u88ab\u53d6\u6d88\u3002\u662f\u5426\u8981\u7ee7\u7eed\uff1f"):j};o.remove=function(){this.hide();this.wu&&this.wu();this.dispatchEvent("close");this.eK&&this.content.parentNode.removeChild(this.content);if(this.Bd){this.Bd.Fl();this.Bd.jg()}};
o.l=function(){this.isOpen()&&this.hide();if(this.he){this.he.Pu();this.he=h}if(this.ga){this.ga.k();this.ga=h}if(this.ag){this.ag.k();this.ag=h}if(this.Id){this.Id.k();this.Id=h}if(this.upload){this.upload.k();this.upload=h}if(this.Ge){this.Ge.k();this.Ge=h}};o.isOpen=function(){return!this.Se};o.setPosition=function(a,b){this.content.style.position="absolute";this.content.style.top=b+"px";this.content.style.left=a+"px"};
o.ou=function(){this.content.style.position="absolute";var a=this.bd.jh(),b=this.bd.Yi(),c=Vd(this.Tn),d=(a-this.content.offsetWidth)/2;d+=c.x;var f=(b-Am(this.content))/2;f+=c.y;this.setPosition(Math.floor(d),Math.floor(f))};o.uz=function(){var a=this.Kl();a.style.width=Math.max(this.bd.jh(),this.bd.QF())+"px";a.style.height=Math.max(this.bd.Yi(),this.bd.uw())+"px"};
o.IB=function(a){var b;this.ok=this.S.f("DIV",{id:ab(),"class":"tr_dialog-title",style:"cursor:move"},this.S.f("TABLE",{width:"100%","class":"tr_dialog-title-layout-table",id:ab()},b=this.S.f("TBODY")));var c=b.insertRow(0);this.Rs=this.S.f("TD",{innerHTML:a,width:"100%"});P(c,this.Rs);P(this.content,this.ok)};o.Zz=function(a){if(this.Rs)this.Rs.innerHTML=a};o.AL=function(){if(this.ok){this.Ge=new Qh(this.content,this.ok);this.ga.e(this.Ge,"start",this.ax);this.ga.e(this.Ge,"end",this.Nw);this.ys()}};
o.ys=function(){this.ok&&this.Ge&&this.Ge.jL(new Lf(0,0,this.bd.jh()-this.content.offsetWidth,this.bd.uw()-Am(this.content)))};o.ax=function(){this.content.setCapture&&this.content.setCapture(j)};o.Nw=function(){this.content.releaseCapture&&this.content.releaseCapture()};o.yB=function(a){this.au=this.S.f("DIV",h,a);P(this.content,this.au)};o.GB=function(a){var b=this.Lt(a);b.style.paddingLeft="1.9ex";b.style.paddingRight="1.9ex";b.onclick=u(this.sy,this);return b};
o.BB=function(a){var b=this.Lt(a);b.onclick=u(this.mu,this);return b};o.hA=function(){var a=this.Kl();this.uz();this.ga.e(this.Id,nd,this.gm);var b={zIndex:parseInt(this.content.style.zIndex,10)-1,display:"block",backgroundColor:this.eF()};Wl(a,b)};o.gm=function(){this.Kl().style.display="none";this.ys();this.uz();this.Yy()};o.eF=function(){return this.jN||"#afafaf"};
o.Kl=function(){var a=this.S.b(Gn);if(!a){var b={frameBorder:0,scrolling:"no",id:Gn,"class":Gn};if(B&&this.S.$().location.protocol=="https:")b.src='javascript:""';a=this.S.f("IFRAME",b);this.he=new vm(a);this.he.load(u(function(){this.he.Jr(this.ga)},this));P(this.db.body,a)}if(!this.he){this.he=new vm(a);this.he.load(u(function(){this.he.Jr(this.ga)},this))}return a};o.Yy=function(){var a=In.length;if(a>0)In[a-1].hA();else{this.Kl().style.display="none";this.ga.W(this.Id,nd,this.gm)}};
var Jn=function(a){if(!Cb(In,a)){var b=In.length;In.push(a);a.content.style.zIndex=b==0?201:parseInt(In[b-1].content.style.zIndex,10)+2}},Kn=function(a){var b=sb(In,a);b!=-1&&In.splice(b,1)};o=Fn.prototype;o.sy=function(){var a=this;if(!a.lu())return;a.yh&&a.yh();a.xu&&a.remove();a.dispatchEvent("ok")};o.WK=function(a){this.xu=a};o.mu=function(){var a=this;if(!a.lu())return;a.remove();a.nu&&a.nu();a.dispatchEvent("cancel")};
o.Kv=function(a){var b=this.S.b(a);if(b.tagName=="INPUT"){b.focus();fn(b,b.value.length)}};o.Ia=h;o.iL=function(){this.Ia=new Bg(this.db);this.ag.e(this.Ia,"key",this.Pb);if(this.Dl){this.ag.e(this.Dl,jd,this.hM);this.ag.e(this.Kg,jd,this.iM)}};o.nM=function(){if(this.Ia){this.ag.Ya();this.Ia.k();this.Ia=h}};o.Pb=function(a){var b=e;switch(a.keyCode){case 13:if(!this.zh.disabled){this.sy();b=j}break;case 27:this.mu();b=j;break}b&&a.preventDefault();return b};
o.hM=function(a){if(a.keyCode==9&&a.shiftKey){a.preventDefault();this.Kg.focus()}};o.iM=function(a){if(a.keyCode==9&&!a.shiftKey){a.preventDefault();this.Dl.focus()}};var Ln=function(a,b,c){this.pJ=a;this.oJ=b;this.kc=c};Ln.prototype.qb=function(a){if(this.kc!=a){this.hu(this.pJ);this.kc=a;this.hu(this.oJ)}};Ln.prototype.hu=function(a){this.kc&&a(this.kc)};Ln.prototype.$l=function(){return this.kc};var Mn=function(a,b,c,d){this.db=b;this.g=N(b);this.dI=c;if(d)this.Gn=this.ED(d);this.uA=[];var f=c?am(2,1,this.db,j):am(1,2,this.db,j);f.cellPadding=0;f.cellSpacing=0;this.Xh=f.rows[0].cells[0];this.Xh.className="tr_tabbed-pane-tabs";if(c){this.Xh.className+=" tr_horizontal-tab";var g=am(1,2,this.db,j);g.cellPadding=0;g.cellSpacing=0;this.OL=g.rows[0].cells[0];this.OL.width="99%";g.rows[0].cells[1].width="1%";P(this.Xh,g);this.Hn=this.g.f("TABLE",{cellPadding:0});this.Hn.insertRow(0);P(g.rows[0].cells[1],
this.Hn)}else{this.Xh.className+=" tr_vertical-tab";this.Xh.innerHTML="<p>"+a.Ps+"</p>"}this.To=c?f.rows[1].cells[0]:f.rows[0].cells[1];this.To.className="tr_tabbed-pane-tab-content";while(a.childNodes.length)this.KB(a);P(a,f);a.className+=" tr_tabbed-pane"};
Mn.prototype.KB=function(a){if(a.childNodes[0].nodeType==1){var b=a.childNodes[0];b.style.display="none";P(this.To,b);var c=b.RL;this.uA.push({id:c,Nc:b});b.id=c+"-content";var d=this.DD(c,b.SL,b.TL);this.dI?P(this.Hn.rows[0].insertCell(-1),d):P(this.Xh,d)}else a.removeChild(a.firstChild)};var Nn=function(a,b,c,d,f){var g=N(d).f("DIV",{RL:a,SL:b,TL:c});if(f)g.xh=f;return g};
Mn.prototype.DD=function(a,b,c){var d=this.g.f("DIV",{id:a,innerHTML:"<table cellpadding=0><tr valign=top><td><input type=radio id="+a+"-dialog-radio name="+a+" class=tr_radio /></td><td class=tr_tabbed-pane-tab-label>"+b+"</td></tr></table>",title:c,Gn:this.Gn});d.onclick=function(){this.Gn.qb(this.id)};return d};
Mn.prototype.ED=function(a){var b=this.db;return new Ln(function(c){b.getElementById(c).className="";b.getElementById(c+"-dialog-radio").checked="";b.getElementById(c+"-content").style.display="none"},function(c){b.getElementById(c).className="tr_selected-tab-in-tabbed-pane";b.getElementById(c+"-dialog-radio").checked="checked";b.getElementById(c+"-content").style.display="";a&&a(c)})};Mn.prototype.ue=function(a){this.Gn.qb(a)};
Mn.prototype.Xl=function(){var a,b,c=this.uA;for(var d=0;d<c.length;d++){a=c[d].id+"-dialog-radio";b=this.g.b(a);if(b.checked!="")return c[d].Nc}return h};var On=function(a,b,c,d){var f=a.childNodes;for(var g=0;g<f.length;g++)if(f[g].nodeType==1&&f[g].Ps)return new Mn(f[g],b,c,d)};var Pn=function(a,b,c,d,f,g,i){this.JK=b;this.mJ=c;this.Ka=d;this.NJ=f;this.wz=u(this.tz,this);this.az=g;Fn.call(this,a,j,this.JK);this.Mp();this.LJ=i||new Ci};z(Pn,Fn);var Qn="tr_raw-html-dialog-preview-tab",Rn="tr_raw-html-dialog-html-tab";o=Pn.prototype;o.Yc=function(){H(this.Tn,"resize",this.wz,e);this.pg.ue(Rn);Fn.prototype.Yc.call(this);this.tz();this.ys();this.Hc.focus();if(E){this.Hc.selectionStart=0;this.Hc.selectionEnd=0}};o.yh=function(){this.mJ(this.Hc.value);this.remove()};
o.hide=function(){ad(this.Tn,"resize",this.wz,e);Fn.prototype.hide.call(this)};o.tz=function(){this.Qr();this.ou()};
o.Qr=function(){var a=this.bd.Yi()*0.9,b=this.bd.jh()*0.9;this.content.style.width=b+"px";this.content.style.height=a+"px";var c=Am(this.Qk),d=Am(this.ok),f=Am(this.pg.Hn),g=a-c-d-f,i=b,l=this.pg.To,m=l,n=0,q=0;while(m!=this.content){n+=Hl(m);q+=Il(m);m=m.parentNode}g-=n;i-=q;if(B&&oi(this.db))g-=13;if(g>0)l.style.height=g+"px";if(i>0){l.style.width=i+"px";if(B)this.Hc.style.width=i+"px"}if(E)bn(this.content);else if(B&&oi(this.db)){var r=g-Hl(this.Hc)-Jl(this.Hc);if(r>0)this.Hc.style.height=r+"px"}};
o.Vz=function(a){this.Hc.value=this.LJ.Il(a)};o.ug=function(){this.yM(this.Hc.value)};o.yM=function(a){var b=this.Dh.s();b.body.innerHTML=a;this.Ka.or(b);this.DL()};o.yr=function(a){a==Qn&&this.ug()};o.Xo=function(){var a=this.S.f("DIV",{id:"tr_raw-html-dialog",className:"tr_raw-html-dialog-body",Us:"\u7f16\u8f91 HTML",zh:"\u66f4\u65b0",Kg:"\u53d6\u6d88",xh:u(this.yh,this),lz:j},this.tD());P(this.db.body,a);this.pg=On(a,this.db,j,u(this.yr,this));return a};
o.Mp=function(){this.ns(this.Xo());this.WK(e);this.content.className+=" tr_raw-html-dialog";this.pg.ue(Rn);this.content.style.display="none"};o.tD=function(){return this.S.f("DIV",{className:Hn,Ps:"&nbsp;"},this.xD(),this.BD())};
o.xD=function(){var a=Nn(Rn,"HTML","\u5728\u6b64\u5904\u4fee\u6539\u60a8\u7684 HTML",this.db);this.Hc=this.S.f("TEXTAREA",{id:"tr_raw-html-area",style:"height:98%;width:100%;direction:ltr"});var b=this.Hc;if(E){b=dn(this.Hc);b.style.height="100%"}P(a,b);a.style.height="100%";return a};
o.BD=function(){var a=Nn(Qn,"\u9884\u89c8","\u5728\u6b64\u5904\u9884\u89c8\u66f4\u6539",this.db),b=this.S.f("IFRAME",{id:"tr_raw-html-dialog-preview-pane",src:this.NJ,style:"width:100%;height:100%;"});this.Dh=new vm(b,j);this.Dh.load(u(this.TH,this));P(a,b);a.style.height="100%";return a};o.TH=function(){if(this.az){var a=this.Dh.s();dg(this.az,a);this.vu()}};o.vu=function(){var a=this.Dh.s();Td(a.body,{style:"border:0;margin:0;background:none transparent;"});Td(this.Dh.AF(),{style:"background:none transparent;"})};
o.DL=function(){var a=this.Dh.s();H(a.body,"mousedown",Sn,j);H(a,"click",Sn,j);a.onmousemove=um;a.onmouseover=um;a.onmouseout=um};var Sn=function(a){um();cm(a,e)};var Tn=function(a,b){this.Eg=a;this.vm=b};Tn.prototype.Ml=function(){if(!this.fp)this.fp=Yl(this.Eg);return this.fp};Tn.prototype.xx=function(a){this.Eg.href=a};Tn.prototype.TC=function(a,b){var c=this.Eg;c.href=b;var d=this.Ml();if(a!=d){var f=si(c);if(f.nodeType==3)f=f.parentNode;if(Yl(f)!=d)f=c;f.innerHTML="";Zl(f,a);this.fp=h}this.vm=e};
Tn.prototype.pe=function(a){var b=this.Eg;if(rl){var c,d=b.nextSibling;if(d&&d.nodeType==3&&(d.data.indexOf("\u00a0")==0||d.data.indexOf(" ")==0))c=d;else{var f=N(b);c=f.createTextNode("\u00a0");be(c,b)}Ee(c,1,c,1).select()}else a.pe(b)};var Un=function(a,b,c){var d=new Tn(a,j);d.xx(b);if(c)a.target=c;return d};var Vn=function(){xd.call(this)},Wn;z(Vn,xd);Vn.prototype.ac=function(){return"BasicTextFormatter"};
var Xn="+formatBlock",Yn="+outdent",Zn="+insertHorizontalRule",$n="+subscript",ao="+superscript",bo="+underline",co="+foreColor",eo="+backColor",fo="+insertOrderedList",go="+insertUnorderedList",ho="+justifyCenter",io="+justifyFull",jo="+justifyRight",ko="+justifyLeft",lo="+BLOCKQUOTE",mo,no,oo,po=ic({dd:"+link",ci:Xn,io:"+indent",ko:Yn,lo:"+strikeThrough",ho:Zn,Dk:$n,Ek:ao,Bg:bo,Ft:"+unlink",xg:"+bold",zg:"+italic",fo:"+fontSize",eo:"+fontName",bi:co,tt:"+emoticon",zk:eo,hi:fo,ki:go,di:ho,ei:io,
gi:jo,fi:ko,qt:lo,Ak:"ltr",ai:"rtl"});o=Vn.prototype;o.Yf=function(a){return a in po};o.hc=function(){return this.p.fa()};o.pd=function(){return this.Fb().s()};
o.Kp=function(a){var b,c,d,f,g,i=arguments[1];switch(a){case eo:if(!(i===h))if(il)this.TB(i);else A?this.Cf("hiliteColor",i):this.Cf(a,i);break;case "+link":g=this.aM("/",i);break;case ho:case io:case jo:case ko:this.uI(a);break;case "ltr":case "rtl":wl&&Al(this.hc(),a);break;case lo:break;case mo:this.oz();break;case "+emoticon":break;default:if(B&&a==Xn&&i)i="<"+i+">";if(a==co&&i===h)break;switch(a){case "+indent":case Yn:c=j;case fo:case go:if(ul&&this.fz(this.pd(),a))d=j;else vl||this.oD();if(E&&
tl&&!this.queryCommandValue(a))f|=this.tC();case Xn:b=wl;break;case $n:case ao:sl&&this.ZB(a);break;case bo:case "+bold":case "+italic":c=gl&&this.queryCommandValue(a);break;case co:case "+fontName":c=gl}this.Cf(a,i,b,c);f&&this.pd().execCommand("Delete",e,j);d&&this.pd().execCommand("FormatBlock",e,"<div>")}E&&this.Fb().$().focus();return g};
o.queryCommandValue=function(a){switch(a){case "+link":return this.iI("a");case ho:case io:case jo:case ko:return this.fI(a);case Xn:return this.RF();case lo:case "+indent":case Yn:case mo:case Zn:case "+unlink":case no:case oo:return e;case "+fontSize":case "+fontName":case co:case eo:return this.an(this.pd(),a,gl);case "ltr":case "rtl":return wl&&zl(this.hc())==a;case bo:case "+bold":case "+italic":var b=gl;default:return this.fz(this.pd(),a,b)}};o.WC=function(){};
o.ij=function(a,b,c){if(!c)return e;var d;switch(b){case "b":d="+bold";break;case "i":d="+italic";break;case "u":d=bo;break;case "s":return j}if(d){this.p.execCommand(d);return j}return e};var qo=/<br([^\/>]*)\/?>/gi;
Vn.prototype.oD=function(){var a=this.p.Hb(),b=a.$p(),c=this.pd();if(b.getElementsByTagName("BR")[0]){var d=dl?"&nbsp;":"",f=a.yK();f.bh(e).innerHTML=f.bh(j).innerHTML=d;if(b.tagName=="P")ro(b,j);else{var g=b.getElementsByClassName?"class":"id",i="temp_br";b.innerHTML=b.innerHTML.replace(qo,"<p$1 "+g+'="'+i+'">');var l=Jb(g=="class"?b.getElementsByClassName(i):b.all[i]);Vb(l,function(m){m.removeAttribute(g);Aa(xe(m))&&m.appendChild(c.createTextNode("\u00a0"));ro(m)})}f.restore();return j}return e};
var ro=function(a,b){var c=a.outerHTML.replace(/<(\/?)p/gi,"<$1div");a.outerHTML=b?c.replace(qo,"</div><div$1>"):c},so=function(a){return a.indexOf("+")==0?a.substring(1):a};Vn.prototype.uI=function(a){this.Cf(a,h,e,j);E&&this.Cf(a,h,e,j);if(!gl){var b=this.hc().ow();for(var c=0;c<b.length;c++){var d=Tl(b[c]);if(d.align&&!(B&&e)){d.style.textAlign=d.align;d.removeAttribute("align")}}}};
Vn.prototype.Cf=function(a,b,c,d){var f=this.hc();if(wl&&c)var g=zl(f);a=so(a);var i,l;if(B){var m=this.UB(a);i=m[0];l=m[1]}if(F)i=this.VB(a);var n=this.pd();d&&gl&&n.execCommand("useCSS",e,e);n.execCommand(a,e,b);d&&gl&&n.execCommand("useCSS",e,j);F&&!qb("526")&&a.toLowerCase()=="formatblock"&&b&&/^[<]?h\d[>]?$/i.test(b)&&this.XC();if(/insert(un)?orderedlist/i.test(a)){F&&this.zE();if(B){this.xE();l&&Q(l)}}i&&Q(i);wl&&g&&Al(this.hc(),g)};
Vn.prototype.TB=function(a){var b=this.hc(),c,d;if(b.Ue()){c=this.Fb().createTextNode(E?" ":"");var f=b.de();d=f.nodeType==1?f:f.parentNode;if(d.innerHTML==""){d.style.textIndent="-10000px";d.appendChild(c)}else{d=this.Fb().f("span",{style:"text-indent:-10000px"},c);b.Lq(d)}b.GK(c)}this.Cf("hiliteColor",a,e,j);if(c){if(E)c.data="";d.style.textIndent=""}};Vn.prototype.aM=function(a,b){var c=this.hc(),d=c.Zb(j),f=to(d,"a");if(f)ee(f);else return this.yi(c,a,b);return h};
Vn.prototype.yi=function(a,b,c){var d=h;if(a.Zb(j).tagName=="IMG")return h;if(a.Ue())if(Vk){d=this.Fb().createElement("a");a.$b().insertNode(d)}else{if(Uk){a.$b().pasteHTML("<a id='newLink'></a>");d=this.Fb().b("newLink");d.removeAttribute("id")}}else{var f=ab();this.Cf("CreateLink",f);var g=function(i){if(xa(i.href,f))d=i};tb(this.p.Ui().getElementsByTagName("a"),g)}return Un(d,b,c)};var uo={insertOrderedList:1,insertUnorderedList:1};
Vn.prototype.ZB=function(a){if(!this.queryCommandValue(a)){var b=a==$n?ao:$n,c=so(b);this.queryCommandValue(b)||this.pd().execCommand(c,e,h);this.pd().execCommand(c,e,h)}};
Vn.prototype.UB=function(a){var b=[],c=h,d=this.hc(),f=this.Fb();if(a in uo){var g=d.Zb();if(g){var i=Qd().eh("BLOCKQUOTE",h,g),l;for(var m=0;m<i.length;m++)if(d.containsNode(i[m],j)){l=i[m];break}var n=l||Be(g,"BLOCKQUOTE");if(n){var c=f.f("div",{style:"height:0"});P(n,c);b.push(c);if(l)d.selectNodes(l,0,c,0);else d.containsNode(c,j)&&d.selectNodes(d.de(),d.ta(),c,0)}}}return b};
Vn.prototype.XC=function(){var a=this.hc();Vb(a.Aa(),function(b){if(b.className=="Apple-style-span"){b.style.fontSize="";b.style.fontWeight=""}})};
Vn.prototype.zE=function(){var a=this.hc(),b=e;Vb(a.Aa(),function(c){var d=c.tagName;if(d=="UL"||d=="OL"){if(!b){b=j;return}var f=fe(c.previousSibling,e);if(!f)return;var g=c.ownerDocument.createRange();g.setStartAfter(f);g.setEndBefore(c);if(!za(g.toString()))return;if(f.nodeName==c.nodeName){while(f.lastChild)c.insertBefore(f.lastChild,c.firstChild);f.parentNode.removeChild(f)}}})};var Ao={"1":1,a:1,A:1,i:1,I:1},Bo={disc:1,circle:1,square:1};
Vn.prototype.xE=function(){var a=this.hc().Aa().sc();while(a&&a.tagName!="UL"&&a.tagName!="OL")a=a.parentNode;if(a)a=a.parentNode;if(!a)return;var b=Jb(a.getElementsByTagName("UL"));Kb(b,Jb(a.getElementsByTagName("OL")));tb(b,function(c){var d=c.type;if(d)if(!(c.tagName=="UL"?Bo:Ao)[d])c.type=""})};var Co={justifyCenter:1,justifyFull:1,justifyRight:1,justifyLeft:1,formatBlock:1},Do={insertOrderedList:1,insertUnorderedList:1};
Vn.prototype.VB=function(a){var b;if(Co[a]){b=this.Fb().f("div",{style:"height: 0"},"x");P(this.p.Ui(),b)}if(Do[a]){var c=this.p.Ui();b=this.Fb().f("div",{style:"height: 0"},"x");c.insertBefore(b,c.firstChild)}return b};Vn.prototype.tC=function(){var a=this.p.Hb();if(a.isCollapsed()&&a.sc().nodeType!=3){var b=this.Fb().createTextNode("\u00a0");a.insertNode(b);Ie(b).select();return j}return e};
Vn.prototype.RF=function(){var a=this.hc().fF(e);if(a.length){var b=a[0].nodeName;for(var c=0;c<a.length;c++)if(b!=a[c].nodeName)return h;if(b=="div")b="p";return b}};var Eo={center:1,justify:1,right:1,left:1};Vn.prototype.fI=function(a){var b=a.replace("+justify","").toLowerCase(),c=this.hc();if(wl)return b==Bl(c);else{var d=c.ow(j);if(d.length==0)return e;else{for(var f=0;f<d.length;f++){var g=Tl(d[f]);if(b!=Fo(g))return e}return j}}};
var Fo=function(a){var b=Gl(a,"textAlign");Eo[b]||(b=a.align||"left");return b};Vn.prototype.iI=function(a){var b=this.hc().Zb();return!!to(b,a)};Vn.prototype.fz=function(a,b,c){return this.ez(j,a,b,c)};Vn.prototype.an=function(a,b,c){return this.ez(e,a,b,c)};Vn.prototype.ez=function(a,b,c,d){c=so(c);if(d){var f=this.pd();f.execCommand("useCSS",e,e)}var g=a?b.queryCommandState(c):b.queryCommandValue(c);d&&f.execCommand("useCSS",e,j);return g};var Go=function(a,b,c,d,f){this.Av=a;this.PL=b;this.kN=c;this.BN=d;this.Az=f},Ho=function(a,b){this.lO=a;this.Ju=b},Io=function(){if(dl)return"<br>";return""},Jo=function(a){if(!a||Aa(a))return Io();return a},Ko=function(a){a=Jo(a);if(dl&&a.match(/^\s*<script/i))a="&nbsp;"+a;if(el){a=a.replace(/<(\/?)strong([^\w])/gi,"<$1b$2");a=a.replace(/<(\/?)em([^\w])/gi,"<$1i$2")}return a},Lo=function(a,b,c){var d=[];d.push("<html ");Wk&&!ol&&d.push("contentEditable ");d.push('style="background:none transparent;');
Wk&&!ol&&d.push("min-height:100%;");d.push('">');d.push("<head><style>");c&&c.Ju&&d.push(c.Ju);E&&a.PL&&d.push(" img {-moz-force-broken-image-icon: 1;}");d.push("</style></head>");d.push('<body g_editable="true" hidefocus="true" ');Wk&&ol&&d.push("contentEditable ");d.push('class="editable ');d.push('" id="',a.Av,'" style="');a.Az&&d.push(";direction:rtl");d.push('">',b,"</body></html>");return d.join("")},Mo=function(a,b,c,d){var f=Lo(a,b,c),g=ne(d);g.open();g.write(f);g.close()},No=function(a,b,
c){var d=b.body;if(Wk)d.contentEditable=j;d.className="editable";d.setAttribute("g_editable",j);d.hideFocus=j;d.id=a.Av;if(a.Az)d.style.direction="rtl";d.innerHTML=c};var Qo=function(a,b,c){var d=a.getElementsByTagName("input");if(c)for(var f=0;f<d.length;f++){var g=d[f];if((g.type=="text"||g.type=="file")&&ig(g))g.setAttribute("_wasUnselectable",j)}$k&&b.e(a,"mousedown",Oo,j);jg(a,j);for(var f=0;f<d.length;f++){var g=d[f];if(g.type=="text"||g.type=="file"){g.getAttribute("_wasUnselectable")||Po(g);g.removeAttribute("_wasUnselectable")}}},Oo=function(a){var b=dm(a).nodeName;b!="TEXTAREA"&&b!="INPUT"&&a.preventDefault()},Po=function(a){jg(a,e);if($k){var b=Ro(a);
while(b){So(a,b);a=b;b=Ro(a)}}},To=function(){if(E)return"MozUserSelect";else if(F)return"WebkitUserSelect"},Ro=function(a){return Ae(a,function(b){var c=To();return b&&b.style&&b.style[c].toLowerCase()=="none"},j)},So=function(a,b){while(a&&a!=b){var c=a;a=a.parentNode;if(!a.style)continue;var d=To();a.style[d]="";var f=a.firstChild;while(f){if(f!=c&&f.style)f.style[d]="none";f=f.nextSibling}}};var Uo=function(a){this.Yd=a;this.g=N(a)};Uo.prototype.Iu=function(a){var b=this.Hu(a,"tr_feedback",j);b.align="center";return b};Uo.prototype.dA=function(a,b,c,d,f){var g=a.cells;this.ek(g[0],b,f);this.ek(g[1],c,f);this.ek(g[2],d,f)};
Uo.prototype.Hu=function(a,b,c){var d=am(3,3,this.Yd);Td(d,{"class":b,border:0,cellSpacing:0,cellPadding:0});var f=d.rows;this.dA(f[0],"tr_tl",c?h:"tr_t","tr_tr",c?h:2);var g=f[1].cells;this.ek(g[0],c?h:"tr_l");Td(g[1],a);this.ek(g[2],c?h:"tr_r");this.dA(f[2],"tr_bl",c?h:"tr_b","tr_br",c?h:2);return d};Uo.prototype.ek=function(a,b,c){a.innerHTML="";a.className=b||"tr_sidebar";if(c){a.width=c;a.height=c}a.appendChild(this.g.f("img",{height:1,width:1,alt:""}))};var Vo=function(a){I.call(this);this.n=a;this.EI=H(this.n,B?"propertychange":F&&a.tagName=="TEXTAREA"?"keypress":"input",this)};z(Vo,I);Vo.prototype.handleEvent=function(a){var b=a.fb;if(b.type=="propertychange"&&b.propertyName=="value"||b.type=="input"||b.type=="keypress"){if(B){var c=b.srcElement;if(c!=M(c).activeElement)return}var d=new Dc(b);d.type="input";try{this.dispatchEvent(d)}finally{d.k()}}};Vo.prototype.l=function(){Vo.d.l.call(this);cd(this.EI);delete this.n};var Wo=function(){I.call(this);var a=this;this.Db=new zf(this);this.hm=new Ln(function(b){a.Lk(b,0)},function(b){a.Lk(b,2);a.dispatchEvent({type:md,$d:b})});this.mA=new Ln(function(b){b!=a.hm.$l()&&a.Lk(b,0)},function(b){b!=a.hm.$l()&&a.Lk(b,1)})};z(Wo,I);Wo.prototype.l=function(){this.Db.k();this.Db=h;Wo.d.l.call(this)};Wo.prototype.Lk=function(a,b){a.style.background=["","#FFFFE0","#FFFFCC"][b]};Wo.prototype.ak=function(a){this.hm.qb(a)};
Wo.prototype.add=function(a,b){var c=this,d=b&&b.onclick?b.onclick:Xo(c,a),f=b&&b.ondblclick?b.ondblclick:function(){},g=b&&b.onmouseover?b.onmouseover:Yo(c,a),i=b&&b.onmouseout?b.onmouseout:Zo(c);this.Db.e(a,"click",d,j);this.Db.e(a,"dblclick",f,j);this.Db.e(a,"mouseover",g,j);this.Db.e(a,"mouseout",i,j)};var Xo=function(a,b){return function(){a.hm.qb(b)}},Yo=function(a,b){return function(){a.mA.qb(b)}},Zo=function(a){return function(){a.mA.qb(h)}};var $o=function(a,b,c,d,f){this.Ka=b;this.pC=b.Ac.base;this.hN=d;this.rg=f;this.Hd=f.Eg;this.Hh=new Wo;Fn.call(this,a,j,c);this.Zq=gg(this.db.body);this.Mp()};z($o,Fn);$o.prototype.Of=function(){return this.Ka.Aw(this.Hd)};var ap="tr_email-address-tab",bp="tr_on-the-web-tab",cp="tr_on-the-web-tab-input",dp="tr_email-address-tab-input",ep="tr_email-warning-div",fp="tr_external-input-div",gp=e;o=$o.prototype;o.Ii=h;o.tk=h;
o.Yc=function(){this.iL();this.ga.e(this.Hh,md,this.Ly);this.ou();$o.d.Yc.call(this);this.Qs&&bg(this.Qs,j);this.Kv(this.we.id);this.DK(this.we.value,this.Of());this.Os()};o.hide=function(){this.ga.W(this.Hh,md,this.Ly);$o.d.hide.call(this)};
o.Xo=function(){var a=this.S.f("DIV",{id:"tr_choose-link-dialog",className:"tr_edit-link-dialog-body",Us:"\u4fee\u6539\u94fe\u63a5",zh:"\u786e\u5b9a",Kg:"\u53d6\u6d88",Mo:u(this.Mo,this),Fo:u(this.Fo,this),xh:u(this.yh,this),lz:j},this.HC(),this.EC());P(this.db.body,a);return a};o.Mp=function(){var a=this.Xo();this.ns(a);this.Dl=this.we;this.pg=On(a,this.db,e,u(this.yr,this));this.content.className+=" tr_edit-link-dialog";Qo(this.content,this.ga,j)};
o.HC=function(){var a=am(1,2,this.db,j);Wl(a,{fontSize:"10pt"});var b=this.S.f("DIV",{className:Hn,style:"padding-bottom:.8ex"});a.rows[0].cells[0].innerHTML='<span style="position: relative; bottom: 2px; padding-right: 1px;">\u8981\u663e\u793a\u7684\u6587\u672c\uff1a&nbsp;</span>';this.we=this.S.f("INPUT",{size:50,id:"tr_text-to-display"});var c=this.we,d=c;if(E){d=dn(c,this.Zq);this.Qs=d;bg(this.Qs,e)}P(a.rows[0].cells[1],d);c.value=this.rg.Ml();this.ga.e(c,"keyup",u(this.qJ,this));P(b,a);return b};
o.EC=function(){var a=this.S.f("DIV",{className:Hn,Ps:"\u94fe\u63a5\u81f3\uff1a"});Xl(a,this.GC(),this.FC());return a};
o.GC=function(){var a=Nn(bp,"\u7f51\u5740","\u94fe\u63a5\u5230\u4f4d\u4e8e\u7f51\u4e0a\u5176\u4ed6\u5730\u65b9\u7684\u7f51\u9875\u6216\u6587\u4ef6",this.db,u(this.NM,this)),b=this.S.f("DIV",{innerHTML:"<b>\u6b64\u94fe\u63a5\u5e94\u6307\u5411\u54ea\u4e2a\u7f51\u5740\uff1f</b>"}),c=this.S.f("INPUT",{id:cp});if(!B)c.type="url";var d=c;if(E)d=dn(c,this.Zq);if(al&&oi(c))c.style.width="99%";var f=this.S.f("DIV",{className:fp},d);this.tk=new Vo(c);H(this.tk,"input",u(this.Qy,this));$l(f,u(this.wJ,this),
this.ga).innerHTML="<br>\u6d4b\u8bd5\u6b64\u94fe\u63a5";var g=this.S.f("DIV",{className:"tr_dialog-tab-content-explanation-text",innerHTML:"<b>\u65e0\u6cd5\u786e\u5b9a\u5728\u6587\u672c\u6846\u4e2d\u8f93\u5165\u7684\u5185\u5bb9\uff1f</b>\u9996\u5148\uff0c\u67e5\u627e\u60a8\u8981\u94fe\u63a5\u7684\u7f51\u9875\u3002 \uff08<a href='http://www.google.com/' target='_new'>\u641c\u7d22\u5f15\u64ce</a>\u53ef\u80fd\u4f1a\u6709\u6240\u5e2e\u52a9\u3002\uff09\u7136\u540e\uff0c\u590d\u5236\u6d4f\u89c8\u5668\u5730\u5740\u680f\u6587\u672c\u6846\u4e2d\u7684\u7f51\u5740\uff0c\u5e76\u5c06\u5176\u7c98\u8d34\u5230\u4e0a\u9762\u7684\u6587\u672c\u6846\u4e2d\u3002"});
Xl(a,b,f,g);return a};
o.FC=function(){var a=Nn(ap,"\u7535\u5b50\u90ae\u4ef6\u5730\u5740","\u94fe\u63a5\u5230\u7535\u5b50\u90ae\u4ef6\u5730\u5740",this.db,u(this.nv,this)),b=this.S.f("DIV",{innerHTML:"<b>\u6b64\u94fe\u63a5\u6307\u5411\u54ea\u4e2a\u7535\u5b50\u90ae\u4ef6\u5730\u5740\uff1f</b>"});P(a,b);var c=this.S.f("INPUT",{id:dp}),d=c;if(E)d=dn(c,this.Zq);if(al&&oi(c))c.style.width="99%";P(a,d);d.className=fp;this.Ii=new Vo(c);H(this.Ii,"input",u(this.Qy,this));P(a,this.S.f("DIV",{id:ep},"\u65e0\u6548\u7684\u7535\u5b50\u90ae\u4ef6\u5730\u5740"));return a};
o.DK=function(a,b){if(this.rg.vm)this.bG(a);else if(b.indexOf("mailto:")==0){this.ue(ap);var c=b.substring(b.indexOf(":")+1);this.S.b(dp).value=c;this.mn()}else{this.ue(bp);this.S.b(cp).value=this.rg.vm?"http://":b;this.mn()}};o.bG=function(a){if(sm.test(a)){this.S.b(dp).value=a;this.Kh(j);this.ue(ap);this.pp(j)}else if(rm.test(a)){this.S.b(cp).value=a;this.Kh(j);this.ue(bp);this.pp(j)}else{this.rg.Ml()||this.Kh(j);this.ue(bp)}};o.pp=function(a){this.Kh(!a);gp=a};
o.mn=function(){var a=this.Xl(),b=e;if(!gp&&(a==ap||a==bp)){var c=this.S.b(a+"-input");b=c.value==this.we.value}this.Kh(b)};o.ue=function(a,b){this.jO=b;this.pg.ue(a)};o.Xl=function(){return this.gl};o.yr=function(a){this.gl=a;this.Kv(this.gl+"-input");this.Os();this.Hh.ak(h);this.vn();E&&cn(this.content)};o.wJ=function(){var a=this.S.b(cp),b=zn(a.value);!(An?Dn(b,this.pC):Bn(b))?this.bd.Ry(b,""):rn()};o.qJ=function(){this.we.value==""?this.Kh(j):this.mn()};
o.Qy=function(){if(this.Zt)this.vn();else this.we.value==""&&this.mn();this.Os()};o.Os=function(){var a;if(this.gl==ap){a=this.S.b(dp).value;this.$L(a!=""&&!sm.test(a))}else if(this.gl==bp)a=this.S.b(cp).value;else return;this.CA(Ea(a)!="")};o.Kh=function(a){this.Zt=a};o.vn=function(){if(this.Zt){var a=this.Xl();if(a==bp||a==ap)this.we.value=this.S.b(a+"-input").value}};o.Ly=function(){this.vn();this.CA(j)};o.$L=function(a){this.S.b(ep).style.visibility=a?"visible":""};
o.CA=function(a){this.zh.disabled=!a};o.Mo=function(){if(this.Bd){this.Bd.Fl();this.rg.pe(this.Bd)}this.Bd=h;if(this.Hh){this.Hh.k();this.Hh=h}if(this.tk){this.tk.k();this.tk=h}if(this.Ii){this.Ii.k();this.Ii=h}this.pp(e)};o.Fo=function(){var a=this.Hd;this.rg.vm&&ee(a)};o.yh=function(){var a=this.pg.Xl();a&&a.xh&&a.xh()};o.NM=function(){var a=this.S.b(cp).value;if(sm.test(a)){this.nv(cp);return}this.Yz(zn(a))};o.nv=function(a){var b=this.S.b(a?a:dp).value;b="mailto:"+b;this.Yz(b)};
o.Yz=function(a){this.vn();this.rg.TC(this.we.value,a)};var hp=function(){xd.call(this)};z(hp,xd);hp.prototype.ac=function(){return"TabHandler"};hp.prototype.ij=function(a,b,c){if(E&&El)return e;if(a.keyCode==9&&!c)return this.bx(a);return e};var ip=function(){hp.call(this)};z(ip,hp);ip.prototype.ac=function(){return"ListTabHandler"};ip.prototype.bx=function(a){var b=this.p.fa();if(Be(b.Zb(),"LI")||b.zu("li")){this.p.execCommand(a.shiftKey?Yn:"+indent");a.preventDefault();return j}return e};var jp=function(){xd.call(this)};z(jp,xd);var kp="+removeFormat",lp=/^(DIV|TR|LI|BLOCKQUOTE|H\d|PRE|XMP)/,mp=function(a){a.length&&a.push("<br>")};o=jp.prototype;o.ac=function(){return"RemoveFormatting"};o.Yf=function(a){return a==kp};o.Kp=function(a){a==kp&&this.oz()};o.oz=function(){var a=this.p.fa();if(a.Ue())return;var b=this.YN||Wn||u(this.nz,this);this.Au(a,b);this.Fb().s().execCommand("RemoveFormat",e,undefined);ql&&this.Au(a,function(c){return c.replace(/\u00A0/g," ")})};
o.EJ=function(a,b){var c=this.Fb(),d=ab(),f=ab();b='<span id="'+d+'"></span>'+b+'<span id="'+f+'"></span>';var g=ab(),i='<span id="'+g+'"></span>';if(Uk){var l=a.$b();l.pasteHTML(i);var m;while((m=l.parentElement())&&yi(m)&&!Pl(m)){var n=m.nodeName;if(n=="TD"||n=="TR"||n=="TH")break;Q(m)}l.pasteHTML(b);var q=c.b(g);q&&Q(q)}else if(Vk){c.s().execCommand("insertImage",e,g);var r=new RegExp("<[^<]*"+g+"[^>]*>");a.Kj();var m=a.Zb();if(m.nodeType==3)m=m.parentNode;while(!r.test(m.innerHTML))m=m.parentNode;
m.innerHTML=m.innerHTML.replace(r,i);var q=c.b(g);m=q;while((m=q.parentNode)&&yi(m)&&!Pl(m)){var n=m.nodeName;if(n=="TD"||n=="TR"||n=="TH")break;be(q,m);Q(m)}m.innerHTML=m.innerHTML.replace(new RegExp(i,"i"),b)}var t=c.b(d),v=c.b(f);a.EK(t,v);Q(t);Q(v)};
o.BF=function(a){var b=this.Fb().f("div"),c=a.gc();if(Vk)b.appendChild(c.cloneContents());else if(Uk){var d=a.nb();d=d.replace(/\r\n/g,"\r");var f=d.length,g=f-Fa(d).length,i=f-d.replace(/[\s\xa0]+$/,"").length;c.moveStart("character",g);c.moveEnd("character",-i);var l=c.htmlText;if(c.queryCommandValue("formatBlock")=="Formatted")l=c.htmlText.replace(/(\r\n|\r|\n)/g,"<br>");b.innerHTML=l}return b.innerHTML};o.Au=function(a,b){var c=a.Aa();if(c.Pf()>1)return;var d=this.BF(c);this.EJ(a,b(d))};
o.nz=function(a){var b=Qd().createElement("div");b.innerHTML=a;var c=[],d=[b.childNodes,0],f=[],g=0;for(var i=0;i>=0;i-=2){var l=e;while(g>0&&i<=f[g-1]){g--;l=j}l&&mp(c);var m=d[i],n=d[i+1];while(n<m.length){var q=m[n++],r=q.nodeName,t=this.Cw(q);if(t){c.push(t);continue}switch(r){case "#text":var v=g>0?q.nodeValue:Ba(q.nodeValue);v=Na(v);c.push(v);continue;case "P":mp(c);mp(c);break;case "BR":mp(c);continue;case "PRE":case "XMP":f[g++]=i;break;case "STYLE":case "SCRIPT":case "SELECT":continue;case "A":if(q.href&&
q.href!=""){c.push("<a href='");c.push(q.href);c.push("'>");c.push(this.nz(q.innerHTML));c.push("</a>");continue}else break;case "IMG":c.push("<img src='");c.push(q.src);c.push("'>");continue;case "TD":c.push(" ");break;case "DIV":var x=q.parentNode;if(x.firstChild==q&&lp.test(x.tagName))break;default:lp.test(r)&&mp(c)}var C=q.childNodes;if(C.length>0){d[i++]=m;d[i++]=n;m=C;n=0}}}return Da(c.join(""))};o.Cw=function(){return h};var np=function(){hp.call(this)};z(np,hp);np.prototype.ac=function(){return"SpacesTabHandler"};np.prototype.bx=function(a){var b=this.Fb(),c=this.p.fa();if(!Be(c.Zb(),"LI")&&!c.zu("li")&&!a.shiftKey){this.p.ve(j,j);c.Ue()||b.s().execCommand("delete",e,h);var d=b.createElement("span");b.tL(d,"\u00a0\u00a0 \u00a0");d=this.p.Hb().insertNode(d,e);this.p.ra();c.pe(d);this.p.Sg();a.preventDefault();return j}return e};var op=function(a){this.bC=a};z(op,I);var pp=function(){I.call(this);this.fy=100;this.Ub=[];this.re=[];this.Wm=[]};z(pp,I);o=pp.prototype;o.lm=h;o.vs=function(a){this.fy=a};o.HB=function(a){if(this.Ub.length==0||!a.yl(this.Ub[this.Ub.length-1])){this.Ub.push(a);this.Ub.length>this.fy&&this.Ub.shift();var b=this.re.length;this.re.length=0;this.dispatchEvent({type:"state_added",kc:a});if(this.Ub.length==1||b)this.rp()}};o.rp=function(){this.dispatchEvent("state_change")};o.Ys=function(){this.fA(this.Ub,this.re)};
o.Mr=function(){this.fA(this.re,this.Ub)};o.nH=function(){return this.Ub.length>0};o.kH=function(){return this.re.length>0};o.fA=function(a,b){if(a.length){var c=a.pop();b.push(c);this.wB({type:a==this.Ub?"before_undo":"before_redo",Ov:a==this.Ub?c.Ys:c.Mr,kc:c});if(a.length==0||b.length==1)this.rp()}};o.wB=function(a){this.Wm.push(a);this.Wm.length==1&&this.Xd()};
o.Xd=function(){if(this.lm||this.Wm.length==0)return;var a=this.Wm.shift();if(this.dispatchEvent({type:a.type,kc:a.kc}))if(a.kc.bC){this.lm=H(a.kc,"action_completed",this.vE,e,this);a.Ov.call(a.kc)}else{a.Ov.call(a.kc);this.Xd()}};o.vE=function(){cd(this.lm);this.lm=h;this.Xd()};o.Lo=function(){if(this.Ub.length>0||this.re.length>0){this.Ub.length=0;this.re.length=0;this.rp()}};o.lM=function(){return this.Ub[this.Ub.length-1]};o.WJ=function(){return this.re[this.re.length-1]};var qp=function(a){xd.call(this);this.wL(a||new pp);this.Bf={};this.Bi={};this.vx=h;this.zC=u(this.tK,this)};z(qp,xd);qp.prototype.sj=h;var rp=ic({Cg:"+undo",Ag:"+redo"});o=qp.prototype;o.vs=function(a){this.zc.vs(a)};o.wL=function(a){this.dy&&cd(this.dy);this.zc=a;this.dy=H(this.zc,"state_change",this.cE,e,this)};o.Yf=function(a){return a in rp};o.ig=function(a){if(!this.Yg)this.p=a};o.sk=function(a){this.wf(a);this.p=h};o.$v=function(){return this.Yg?this.Yg.Xi():this.p};
o.Vg=function(a){if(this.J(a))return;var b=new zf(this);Xk||b.e(a,R.of,this.dG);b.e(a,R.cd,this.tG);b.e(a,R.ao,this.hG);this.Bf[a.Qc]=b;this.dt(a)};o.wf=function(a){var b=this.Bf[a.Qc];if(b){b.k();delete this.Bf[a.Qc]}this.Bi[a.Qc]&&delete this.Bi[a.Qc]};o.J=function(a){return!!this.Bf[a.Qc]};o.l=function(){qp.d.l.call(this);for(var a in this.Bf){this.Bf[a].k();delete this.Bf[a]}this.p=h;this.Yg=h;if(this.zc){this.zc.k();delete this.zc}};o.ac=function(){return"UndoRedo"};
o.execCommand=function(a){if(a=="+undo")this.zc.Ys();else a=="+redo"&&this.zc.Mr()};o.queryCommandValue=function(a){var b=h;if(a=="+undo")b=this.zc.nH();else if(a=="+redo")b=this.zc.kH();return b};o.cE=function(){(this.Yg||this.p).dispatchEvent({type:R.$h,eD:["+redo","+undo"]})};
o.tK=function(a,b,c){var d=this.Yg?this.Yg.yF(a.Xg):this.p;if(!d)return;d.ve(j,j);d.kd();d.execCommand(K.ye,j);d.b().innerHTML=b;c&&d.os(c);var f=this.$v();d.focus();f&&f.Qc!=a.Xg&&f.execCommand(K.li);this.Bi[a.Xg].$z(b,c);this.sj=a;d.ra();d.Sg()};o.ij=function(a,b,c){if(c){var d;if(b=="z")d=a.shiftKey?"+redo":"+undo";else if(b=="y")d="+redo";if(d){var f=d=="+undo"?this.zc.lM():this.zc.WJ();f&&f.Xg?this.$v().execCommand(d):this.execCommand(d);return j}}return e};
o.Lo=function(){this.p.ve(j,j);this.zc.Lo();this.p.ng()};o.dG=function(a){if(this.sj)return;var b=a.target,c=b.Qc;if(this.vx!=c){this.vx=c;this.dt(b)}};o.tG=function(a){if(this.sj){var b=this.sj;this.sj=h;b.dispatchEvent("action_completed");return}this.dt(a.target)};o.hG=function(a){var b=a.target;b&&b.Ko()};o.dt=function(a){if(a.queryCommandValue(K.Ht))return;var b=a.Qc,c=a.b().innerHTML,d=a.Hf(),f=this.Bi[b];if(f){if(f.Mn==c)return;f.nL(c,d);this.zc.HB(f)}this.Bi[b]=new sp(b,c,d,this.zC)};
var sp=function(a,b,c,d){op.call(this,j);this.Xg=a;this.yz=d;this.$z(b,c)};z(sp,op);o=sp.prototype;o.Ys=function(){this.yz(this,this.Mn,this.kM)};o.Mr=function(){this.yz(this,this.Nr,this.VJ)};o.$z=function(a,b){this.Mn=a;this.kM=b};o.nL=function(a,b){this.Nr=a;this.VJ=b};o.yl=function(a){return this.Xg==a.Xg&&this.Mn==a.Mn&&this.Nr==a.Nr};var tp=function(a){this.Ka=a},up=["tabIndex","tabIndexSet"];tp.prototype.Bw=function(){return this.Ka};tp.prototype.CK=function(a,b){var c=a.getElementsByTagName("img");for(var d=0,f;f=c[d];d++){if(cl){Vl(f,up);sa(f)}this.Ka.by(f)}B&&this.Ka.wK(a,"a");var g=a.innerHTML;if(ll){var i=a.ownerDocument.getElementsByTagName("HEAD"),l=[];for(var d=1;d<i.length;++d){var m=i[d].getElementsByTagName("STYLE");for(var n=0;n<m.length;++n)l.push(m[n].outerHTML)}g=l.join("")+g}if(wl&&!b)g=yl(a,g);return g};var vp=function(a,b,c){I.call(this);this.id=a;this.Qc=a;this.Cb=h;if(c){this.Bl(c);this.Be=this.Ze.$()}this.qe={};this.uf="";this.ri="";if(b)if(!ma(b)){this.uf=b.cssStyles||"";this.ri=b.className||"";if(wl)this.kp=b.defaultDirection}if(F&&qb("525.13")&&Za(ib,"525.18")<=0){var d="tr-webkit-workaround";this.uf=this.uf+"."+d+">*{padding-right:1}";this.ri=this.ri+" "+d}this.Ns={};this.kf(R.yg);this.kf(R.cd);this.um=e;this.Uq=e;this.ll=new Ed(this.$u,250,this);this.jl={};for(var f in R)this.jl[R[f]]=0;
if(Xk)this.Lg=new Ed(this.qq,15,this);this.ga=new zf(this);this.QM=[];this.cr=[];this.dr=[];this.er=[];this.ds=[];this.Oo=[];this.Lr=[];this.fr=[];this.Io=[];this.uh=0},wp;z(vp,I);vp.prototype.Ez=h;vp.prototype.field=h;vp.prototype.jb=h;var R={$h:"cvc",ut:"load",Gt:"unload",of:"beforechange",yg:"change",cd:"delayedchange",pt:"beforefocus",co:"focus",ao:"blur",VA:"beforetab",ji:"selectionchange"},xp=h,yp=function(a){xp=a};o=vp.prototype;o.Ui=function(){return this.field||this.jb};o.b=function(){return this.field};
o.Bl=function(a){this.Ze=N(a);this.jb=this.Ze.b(this.id);this.Ez=new tp(qn(this.Ze.$()));this.Cp=this.jb};o.Ti=function(){var a=this.b();return a&&bl?a.ownerDocument:a};o.Vb=function(a,b,c,d){this.ga.e(this.Ti(),a,b,c,d)};o.fq=function(a){return this.qe[a]};
o.pb=function(a){this.qe[a.ac()]=a;a.KG&&this.cr.push(a);a.vq&&this.dr.push(a);a.Sw&&this.er.push(a);a.ij&&this.fr.push(a);a.oj&&this.ds.push(a);a.execCommand&&this.Oo.push(a);a.queryCommandValue&&this.Lr.push(a);a.WC&&this.Io.push(a);a.ig(this);this.Te()&&a.Vg(this)};o.dL=function(a){this.cssText=a};
o.pK=function(){var a=this.jb;a.removeAttribute("contentEditable");a.removeAttribute("g_editable");if(this.id)a.id=this.id;else a.removeAttribute("id");a.className=this.className||"";var b=this.cssText;b?Td(a,{style:b}):a.removeAttribute("style");if(ma(this.Sy)){Of(a,"lineHeight",this.Sy);this.Sy=h}};var zp={46:j,8:j};B||(zp[9]=j);var Ap={86:j,88:j};if(B)zp[229]=j;
var Cp=function(a,b){if(Bp(a))return j;return!!(b&&!(a.ctrlKey||a.metaKey)&&(!E||a.charCode))},Bp=function(a){var b=!(a.ctrlKey||a.metaKey)&&a.keyCode in zp;return(a.ctrlKey||a.metaKey)&&a.keyCode in Ap||b};o=vp.prototype;o.RK=function(a){this.Be=a};o.js=function(a){this.iN=a};o.cA=function(a){this.uh=2;this.field=a;this.Cb=N(a);this.um=e;this.Uq=e;a.setAttribute("g_editable","true")};
o.wA=function(){for(var a in this.qe){var b=this.qe[a];b.no()||b.wf(this)}this.uh=0;this.field=h;this.Cb=h;this.Rk=h};
o.zL=function(){if(jl){this.Vb(kd,this.cv);this.Vb(ld,this.Yu)}else this.Vb(kd,this.bv);if(Xk){this.Vb("blur",this.Zu,j);this.CL()}else{this.Vb(["beforecut","beforepaste","drop","dragend"],this.kd);this.Vb(["cut","paste"],this.ra);this.Vb("drop",this.Mw);this.Vb("blur",this.Zu)}this.Vb(F?"dragend":"dragdrop",this.Mw);this.Vb(jd,this.uq);this.Vb(Hc,this.wq);this.Vb("keyup",this.MG);var a=u(this.Sg,this);this.Vb(hd,a,e);this.es=new Ed(a,250);hl&&this.Vb(Ic,Dp);this.Vb(gd,this.lj)};
o.uu=function(){this.ga&&this.ga.Ya();this.Lg&&this.Lg.stop();this.ll.stop()};o.l=function(){this.jb&&this.execCommand(K.ye);this.wA();this.uu();this.Ze=h;if(this.ga){this.ga.k();this.ga=h}this.ZJ();xp==this.id&&yp(h);for(var a in this.qe){var b=this.qe[a];b.kC&&b.k()}delete this.qe;vp.d.l.call(this)};o.ZJ=function(){var a;while(a=this.QM.pop())a.k()};var Ep=["DOMNodeInserted","DOMNodeRemoved","DOMNodeRemovedFromDocument","DOMNodeInsertedIntoDocument","DOMCharacterDataModified"];
vp.prototype.CL=function(){var a=this.Cb.s();this.ga.e(a,Ep,this.Yw,j);this.ga.e(a,"DOMAttrModified",u(this.BG,this,this.Yw),j)};vp.prototype.Ew=function(a){if(a.keyCode==9&&!this.$D(a)||E&&a.metaKey&&(a.keyCode==37||a.keyCode==39)){a.preventDefault();return e}else{this.mq=a.charCode||Cp(a,E);this.mq&&this.kd()}return j};var Fp={8:1,9:1,13:1,33:1,34:1,35:1,36:1,37:1,38:1,39:1,40:1,46:1},Gp={65:j,86:j,88:j},Hp={8:1,9:1,13:1,27:1,33:1,34:1,37:1,38:1,39:1,40:1};o=vp.prototype;
o.uq=function(a){if(!Xk)if(!this.Ew(a))return;for(var b=0;b<this.cr.length;++b){var c=this.cr[b];if(c.J(this)&&c.KG(a))return}pl&&this.Tw(a)};o.wq=function(a){if(Xk){if(!this.Ew(a))return}else{this.mq=j;this.kd()}for(var b=0;b<this.dr.length;++b){var c=this.dr[b];if(c.J(this)&&c.vq(a))return}pl||this.Tw(a)};
o.MG=function(a){if(!Xk&&(this.mq||Bp(a)))this.qq();for(var b=0;b<this.er.length;++b){var c=this.er[b];if(c.J(this)&&c.Sw(a))break}if(this.Rc(R.ji))return;if(Fp[a.keyCode]||(a.ctrlKey||a.metaKey)&&Gp[a.keyCode])this.es.start()};
o.Tw=function(a){if(a.altKey)return;var b=kb?a.metaKey:a.ctrlKey;if(b||Hp[a.keyCode]){var c=a.which||a.charCode||a.keyCode;if(c==17)return;var d=String.fromCharCode(c).toLowerCase();for(var f=0;f<this.fr.length;++f){var g=this.fr[f];if(g.J(this)&&g.ij(a,d,b)){a.preventDefault();break}}}};o.execCommand=function(a){var b=arguments,c;for(var d=0;d<this.Oo.length;++d){var f=this.Oo[d];if(f.J(this)&&f.Yf(a)){c=f.execCommand.apply(f,b);break}}return c};
o.queryCommandValue=function(a){var b=this.Te()&&this.Ox();if(ma(a))return this.an(a,b);else{var c={};for(var d=0;d<a.length;d++)c[a[d]]=this.an(a[d],b);return c}};o.an=function(a,b){for(var c=0;c<this.Lr.length;++c){var d=this.Lr[c];if(d.J(this)&&d.Yf(a)&&(b||d.no()))return d.queryCommandValue(a)}return b?h:e};
o.BG=function(a,b){if(this.Rc(R.yg))return;b=b.fb;try{if(b.originalTarget.prefix||b.originalTarget.nodeName=="scrollbar")return}catch(b){return}if(b.prevValue==b.newValue)return;a.call(this,b)};o.Yw=function(a){if(this.Rc(R.yg))return;a=a.Tv?a.fb:a;if(a.target.AN)return;this.um=j;this.Uq=j;this.Lg.start()};o.Mw=function(){B&&this.execCommand(K.ye,j);Xk&&this.bv();this.ra()};o.fw=function(){var a;if(a=this.Cb){var b=a.$();return b&&b.frameElement}return h};
o.lq=function(){var a=this.fw();return a&&new vm(a)};o.DF=function(){return this.lq()};o.fa=function(){var a=this.Cb&&this.Cb.$();return a&&new nm(a)};o.Hb=function(){var a=this.Cb&&this.Cb.$();return a&&Ue(a)};o.Sg=function(a){if(this.Rc(R.ji))return;var b=this.fa();this.Rk=b;this.$q=b.Rq(this.b());this.bE();this.dispatchEvent({type:R.ji,selection:b,Ty:a&&a.type});for(var c=0;c<this.ds.length;++c){var d=this.ds[c];if(d.J(this)&&d.oj(a))break}};o.kd=function(){if(this.Rc(R.of))return;this.dispatchEvent(R.of)};
o.$D=function(a){return this.dispatchEvent({type:R.VA,shiftKey:a.shiftKey,altKey:a.altKey,ctrlKey:a.ctrlKey})};o.ve=function(a,b){if(a){this.Lg&&this.Lg.Mi();this.kf(R.yg)}if(b){this.Ko();this.kf(R.cd)}};o.ng=function(a,b){this.Bn(R.yg);this.Bn(R.cd);a&&this.qq();b&&this.$u()};o.kf=function(a){this.Ns[a]=1};o.Bn=function(a){this.Ns[a]=0};o.HD=function(a){this.jl[a]=ua()};o.Rc=function(a){return!!this.Ns[a]||this.jl[a]&&ua()-this.jl[a]<=500};
o.bE=function(a){a?this.dispatchEvent({type:R.$h,eD:a}):this.dispatchEvent(R.$h)};o.ra=function(a){this.ng(j,a)};o.qq=function(){if(this.Rc(R.yg))return;this.um=j;this.Uq=j;if(this.Rc(R.cd))return;this.ll.start()};o.$u=function(){if(this.Rc(R.cd))return;this.um=e;this.dispatchEvent(R.cd)};o.Ko=function(){this.ll.Mi()};o.bv=function(){this.Yu();this.cv()};o.Yu=function(){if(this.Rc(R.pt))return;this.execCommand(K.ye,j);this.dispatchEvent(R.pt)};
o.cv=function(){if(this.Rc(R.co))return;yp(this.id);if(this.Rk&&this.Rk.Rq(this.b()))this.$q=j;this.dispatchEvent(R.co);if(Yk){var a=this.b(),b=this.Hb();if(b){var c=b.Vi();if(b.Wi()==0&&(!c||c==a||c.tagName=="BODY"))this.fa().Gz(a)}}Zk||this.Cb.$().parent.getSelection().removeAllRanges()};o.Zu=function(){if(this.Rc(R.ao))return;xp==this.id&&yp(h);this.$q=e;this.dispatchEvent(R.ao)};o.Ox=function(){return this.$q};var Dp=function(a){Be(a.target,"A")&&a.preventDefault()};o=vp.prototype;
o.lj=function(a){xp||yp(this.id);if(B){var b=a.target;b&&b.tagName=="A"&&a.ctrlKey&&(new tm(this.Ze.$())).Ry(b.href,"")}};o.Ll=function(a){if(this.queryCommandValue(K.Ht))return"\u00a0";if(!this.Te())return this.jb.innerHTML;var b=this.uF();for(var c=0;c<this.Io.length;++c)this.Io[c].J(this)&&void 0;return this.Ez.CK(b,a)};o.uF=function(){var a=this.b(),b=a.cloneNode(e),c=a.innerHTML;if(B&&c.match(/^\s*<script/i))c="\u00a0"+c;b.innerHTML=c;return b};
o.ss=function(a,b,c,d,f){if(this.gI())return;d&&this.execCommand(K.ye);c&&this.ve(e,j);this.fL(b,f);d&&this.execCommand(K.li);if(this.Te())c?this.ng():this.ra()};o.fL=function(a,b){var c=this.b();if(c){if(wl)a=xl(c,a,b||this.cw())}else c=this.jb;if(c){if(ll){var d=c.ownerDocument.getElementsByTagName("HEAD");for(var f=d.length-1;f>=1;--f)d[f].parentNode.removeChild(d[f])}c.innerHTML=Ko(a)}this.Rk=h};o.s=function(){return this.Cb?this.Cb.s():h};
o.jM=function(){var a=this.Cb.s();a.designMode="on";a.execCommand("useCSS",e,j)};o.UH=function(){this.uf&&this.yn()&&dg(this.uf,this.b())};o.eE=function(){var a=this.b();this.ri&&Kd(a,this.ri);this.UH();this.ng();this.dispatchEvent(R.ut)};o.sI=function(){return this.uh==0};o.Te=function(){return this.uh==2};o.gI=function(){return this.uh==1};o.Hf=function(){var a=this.fa(),b=this.b();return a.Hf(b)};o.os=function(a){var b=this.fa(),c=this.b();b.as(a,c)};
o.focus=function(){F||E?this.Cb.$().focus():this.b().focus()};o.DE=function(){if(Uk||F)this.Zy();this.focus()};o.Zy=function(){var a=this.b(),b=this.fa(),c=a;if(Vk){if(a)c=si(a)}else{var d=this.Cb.s();if(b.s()!=d){d.body.createTextRange().select();b=this.fa()}}b.Hr(c)};o=vp.prototype;
o.wh=function(a,b){this.uh=1;var c=this.jb;this.nodeName=c.nodeName;this.className=c.className;this.dL(c.style.cssText);c.className+=" editable";if(wl){var d=c.innerHTML,f=xl(c,d,this.cw());if(f!=d)c.innerHTML=f}this.FI(a,b)};o.FI=function(a,b){this.GI(a,b)};o.Ow=function(a){B&&this.fa().empty();xp!=this.id&&this.execCommand(K.li);a();this.zL();this.eE();for(var b in this.qe)this.qe[b].Vg(this)};
o.$x=function(a){if(this.sI())k(Error("makeUneditable: Field is already uneditable"));Xk&&this.Lg.Mi();this.Ko();this.es.Mi();this.execCommand(K.ye);var b=h;if(!a&&this.b())b=this.Ll();this.tu();var c=this.jb;xp==c.id&&yp(h);this.uu();if(ma(b)){c.innerHTML=b;this.pK()}this.sK();this.wA();F&&c.blur();this.execCommand(K.li);this.dispatchEvent(R.Gt)};o.sK=function(){var a=this.jb;if(a){var b=this.fw();b&&ce(a,b)}};
o.yn=function(){if(!ba(this.Xq)){this.Xq=e;if(B){var a=this.Ze.$();while(a!=a.parent)try{a=a.parent}catch(b){break}var c=a.location;this.Xq=c.protocol=="https:"&&c.search.indexOf("nocheckhttps")==-1}}return this.Xq};o.GI=function(a,b){var c=this.jb;if(c){var d=c.innerHTML,f=this.Ze.f("IFRAME",this.CF());if(this.yn()){var g=u(this.px,this,f,d,a);this.Lp=H(f,"load",g,j);f.src=b}this.dC(f);this.yn()||this.px(f,d,a)}};o.dC=function(a){var b=this.jb;a.className=b.className;a.id=b.id;ce(a,b)};
o.vF=function(){var a=this.jb,b=gg(a),c=oi(a);return new Go(this.id,c,e,e,b)};o.RM=function(a,b){var c=this.vF();if(this.yn()){var d=ne(a);No(c,d,b)}else{var f=new Ho(this.b(),this.uf);Mo(c,b,f,a)}};o.px=function(a,b,c){this.tu();a.eN="true";b=Ko(b);this.RM(a,b);var d=ne(a);this.cA(d.body);if(!Wk){qn(this.Ze.$()).or(d);this.jM()}(new vm(a)).Jr(this.ga,j);this.Ow(c)};o.tu=function(){if(this.Lp){cd(this.Lp);this.Lp=h}};
o.CF=function(){var a="padding:0;"+this.jb.style.cssText;xa(a,";")||(a+=";");a+="background-color:white;";if(B)a+="overflow:visible;";return{frameBorder:0,style:a}};o.cw=function(){if(!this.kp){var a=this.b()||this.jb;this.kp=a&&gg(a)?"rtl":"ltr"}return this.kp};w("TR_EditableField",vp);var Ip=vp.prototype;y(Ip,"registerPlugin",Ip.pb);var Jp=function(a,b){zf.call(this,b);this.Bv=a};z(Jp,zf);Jp.prototype.aF=function(a,b){this.e(a,b,this.sC,e,this)};Jp.prototype.bF=function(a,b){this.e(a,b,this.UC,e,this)};Jp.prototype.sC=function(){this.Bv.kd()};Jp.prototype.UC=function(a){this.Bv.ra(!!a.XI)};var Kp=/\s*;\s*/,Lp=function(a,b){var c=a+"=",d=String(document.cookie).split(Kp);for(var f=0,g;g=d[f];f++)if(g.indexOf(c)==0)return g.substr(c.length);return b};var Mp=function(){var a=ib;return Lp("letmeinanyway")||E&&Za(a,"1.8")>=0||B&&Za(a,"6.0")>=0};w("TR_IsBrowserSupported",Mp);var Np=function(a,b,c,d,f,g,i){I.call(this);this.Qd=new tm(a);this.Ap=b;var l=this.Qd.s();this.g=N(l);this.qC=f.Ac.base;this.Ka=f;this.Hd=c;this.WL=d;var m=this.g.f("div",{"class":"tr_bubble"});P(l.body,m);this.gd=m;this.On=g;this.In=c.nodeName;this.JL=ta(i,this.In=="A"?new Tn(c,e):c);this.H=new vh(m);this.Db=new zf(this);this.Ia=new Bg(c.ownerDocument);this.Db.e(this.Ia,"key",this.Pb);this.Db.e(this.H,"show",this.fk);this.Db.e(this.H,"hide",this.VG);this.Uo();this.CB();this.ua();Qo(m,this.Db)};
z(Np,I);Np.prototype.Uo=function(){this.In=="A"&&this.yD()};Np.prototype.ax=function(a){if(a.eu.target!=this.ql.bm&&Gl(a.eu.target,"cursor")!="move")a.preventDefault();else this.ql.target.setCapture&&this.ql.target.setCapture(j)};Np.prototype.Nw=function(){this.ql.target.releaseCapture&&this.ql.target.releaseCapture()};var Op="beforelocationchange",Pp="beforechange";Np.prototype.Pb=function(){this.Og();return j};Np.prototype.sL=function(a){this.yA=a};Np.prototype.gL=function(a){this.Hx=a};
Np.prototype.TK=function(a){this.gd&&Of(this.gd,"zIndex",a)};var Qp="tr_test-link",Rp="tr_link-text",Sp="tr_edit-page-span",Tp="tr_test-link-span";Np.prototype.Of=function(){var a=this.Hd;if(this.In=="IMG")return a.src;else if(this.In=="A")return this.Ka.Aw(a)};var Up=B?4:2;o=Np.prototype;o.xJ=function(){this.H.o(j);this.dispatchEvent("opened")};o.Og=function(){this.H.o(e)};
o.VG=function(){if(this.gd){Q(this.gd);this.gd=h;if(this.Db){this.Db.k();this.Db=h}if(this.Ia){this.Ia.k();this.Ia=h}this.dispatchEvent("closed");this.dispatchEvent("dispose")}};o.fk=function(){this.Sm();this.ua()};o.oa=function(){return this.H.oa()};
o.ua=function(){var a=this.Hd,b=this.WL,c=a.offsetHeight,d=this.Qd.$(),f=this.Qd.PF(),g=this.Qd.Yi()+f.y,i=$f(this.gd),l=i.height,m=zm(a,b,d),n=m.y,q;q=c+n+Up;if(l+q>g){var r=zm(this.Ap.document.body,this.Ap,d),t=Vd(this.Ap).y;q=Math.max(n-Up-l,r.y+t+Up)}var v=i.width,x=m.x,C=this.Qd.jh()+f.x;if(v+x>C)x=C-v;Uf(this.gd,x,q)};o.aE=function(a){this.dispatchEvent({type:"change",XI:a});this.ua()};o.yi=function(a,b,c,d){var f=this.Zo(a,b,e,d);c&&this.Db.e(f,Ic,c);return f};
o.Zo=function(a,b,c,d){var f=this.g.f(c?"a":"span",{"class":"tr_bubble_link"},b);this.BL(f,a,d);Qo(f,this.Db);return f};o.BL=function(a,b,c){if(c)c.appendChild(a);else{var d=this.g.b(b);if(d){be(a,d);Q(d)}}a.id=b};
o.yD=function(){this.Sm=this.GA;var a=this.FF();if(sm.test(a.mr)||a.color=="red")var b=this.g.f("span",{id:Rp,style:"color:"+a.color},this.g.createTextNode(a.mr));else{var c=this.g.f("span",{id:Tp},"\u8f6c\u5230\u94fe\u63a5\uff1a"),b=this.g.f("span",{id:Rp,style:"color:"+a.color},"");this.Zo(Qp,this.g.createTextNode(Sa(a.mr,48)).data,j,b).target="_blank"}var d=this.$o("tr_change-link-span");this.yi("tr_change-link","\u66f4\u6539",this.JL,d);var f=this.$o(Sp);this.yi("tr_edit-page-link","\u4fee\u6539\u7f51\u9875",
this.lE,f);var g=this.$o("tr_delete-link-span");this.yi("tr_delete-link","\u5220\u9664",this.ND,g);this.GA();var i=this.qD(b,d,f,g,c?c:"");P(this.Du(),i)};o.Cu=function(){Eb(arguments,0,0,"div",{id:"tr_link-div",style:"padding-top:2px;"});return this.g.f.apply(this.g,arguments)};o.qD=function(a,b,c,d,f){return this.Cu(f?f:"",a,b,c,d)};o.$o=function(a){return this.g.f("span",{id:a,"class":"tr_option-link"},this.g.createTextNode("\u00a0-\u00a0"))};
o.FF=function(){var a,b=this.Of();if(b.indexOf("mailto:")==0)b=b.substring(7);else if(Dn(b,this.qC)){b="\u65e0\u6548\u7684\u7f51\u5740";a=j}else if(this.Ka.tm(b)){for(var c=0;c<this.On.length;c++){var d=this.On[c].zN({it:b});if(d)break}if(d)b=d.title;else{function f(g){return g+" not found"}b=f(sn(b));a=j}}return{mr:b,color:a?"red":"black"}};
o.GA=function(){if(this.g.b("tr_link-div")){var a=this.g.b(Qp);if(a){var b=this.g.b(Tp),c=this.Of();bg(b,!(c.indexOf("mailto:")==0));a.href=this.VF()}var d=this.g.b(Sp);d&&bg(d,this.bI())}};o.VF=function(){var a=this.Of();return this.yA?this.yA(a):a};o.ND=function(){this.dispatchEvent(Pp);this.dispatchEvent("linkremoved");this.aE();this.Og();var a=this.Hd,b=this.Qd.fa(),c=a.lastChild;ee(a);b.pe(c)};o.bI=function(){return this.Hx&&this.Hx(this.Of())};
o.Du=function(){var a=new Uo(this.Qd.s()),b="tr_bubble-content-"+ab(),c=a.Hu({"class":"tr_body",id:b},"tr_bubble");P(this.gd,c);var d=this.Qd.pF(b);d.innerHTML="";this.BC=d;return d};o.CB=function(){var a=this.g.f("div",{"class":"tr_bubble_closebox",innerHTML:"&nbsp;"});this.Db.e(a,Ic,this.Og);this.BC.appendChild(a)};o.lE=function(){var a=new on(this.Ka.Ac.edit),b=a.Um.substring(0,a.Um.lastIndexOf("/")+1)+sn(this.Of())+(a.dz||"");if(this.dispatchEvent({type:Op,it:b})){this.dispatchEvent(Pp);this.Qd.us(b)}};var Vp=function(a){this.OM=a;this.Al={}};Vp.prototype.JB=function(a,b){this.Al[a]=b};Vp.prototype.iK=function(a){this.Al[a]=h};var Wp=function(a){var b=Rl(a,"g_editable","true");return!!b&&a!=b};Vp.prototype.Ox=function(a){if(!a.Aa())return e;var b=a.Zb(j);if(!b)return e;return Wp(b)||Pl(b)};var to=function(a,b,c){c||(c="");var d=Be(a,b,c);Wp(d)||(d=h);return d};o=Vp.prototype;o.fa=function(a){return this.kq(a).fa()};o.kq=function(a){var b=a||xp,c=b?this.Le(b):h;return b&&this.Al[b]?c.DF():this.OM};
o.s=function(a){return this.kq(a).s()};o.$=function(a){return this.kq(a).$()};o.wF=function(a){var b=Ae(a,Pl,j);return b&&E?this.sF(b.id):b};o.xF=function(a){var b=this.wF(a);return b?this.Le(b.id):h};o.Le=function(a){return this.Al[a]};o.sF=function(a){var b=this.Le(a);return b&&b.b()};o.Pv=function(){var a=xp;return a?this.Le(a):h};var Xp=function(a){this.ld=a};Xp.prototype.fa=function(){return this.ld.fa()};var Yp=function(a,b){xd.call(this);this.yc=a;this.Vy=b};z(Yp,xd);o=Yp.prototype;o.Px=ud(j);o.zz=e;o.l=function(){if(this.Na){this.Na.k();this.Na=h}Yp.d.l.call(this)};o.Kp=function(a,b){if(a!=this.yc)return;if(!this.zz&&this.Na){this.Na.k();this.Na=h}if(!this.Na)this.Na=this.Wo(b);this.Vy&&this.Na.Uz(this.Vy);$c(this.Na,"close",this.wG,e,this);this.Na.Yc()};o.Yf=function(a){return a==this.yc};o.wG=function(){this.p.HD(R.ji);if(!this.zz&&this.Na){this.Na.k();this.Na=h}};var Zp=function(a,b,c){Yp.call(this,a,b);this.Bp=b;this.oN=c;this.jn=new zf(this)};z(Zp,Yp);Zp.prototype.l=function(){Zp.d.l.call(this);this.jn.k();this.jn=h};Zp.prototype.fC=function(a){this.jn.e(a,["ok","cancel"],this.fJ)};Zp.prototype.fJ=function(a){var b=a.target.Hd,c=a.type=="ok";if(c||b.parentNode)this.Bp.zn(b,this.p);c&&this.p.ra();this.jn.Ya()};var $p=function(a,b){Zp.call(this,wd.dd,a,h);this.Ka=a.Ka;this.lr=b};z($p,Zp);$p.prototype.ac=ud("EditLinkDialogPlugin");$p.prototype.Wo=function(a){var b=new $o(this.p.Be,this.Ka,this.p.fa(),"http://pages.google.com/-/images/",a,this.lr);this.fC(b);return b};var aq=function(a,b,c){Yp.call(this,wd.Bk,c);this.Ka=a;this.Fg=b};z(aq,Yp);aq.prototype.ac=ud("RawHtmlDialogPlugin");aq.prototype.Wo=function(a){var b=this.p,c=new Pn(b.Be,b.fa(),u(this.Rm,this),this.Ka,this.Fg,h);c.Vz(a||b.Ll(j));return c};aq.prototype.Rm=function(a){var b=this.p;b.execCommand(K.ye,j);b.ss(e,a,e,j);E&&this.Ka.or(M(b.Ui()));var c=b.fa();p.setTimeout(u(c.empty,c),0);b.ra()};var bq=function(a,b){I.call(this);this.MN={};this.On=[];this.lr=[];this.LN=[];this.Wa=h;this.Zd=new tm(a);var c=this.Zd.$();this.Be=window;this.QL=b+"static_files";this.Fg=this.QL+"/blank_"+(!B&&c.document.compatMode=="CSS1Compat"?"standards":"quirks")+".html";this.Ka=qn(c);this.ld=new Vp(this.Zd);this.zf=new zf(this);this.Id=new gn(this.Be);this.style=new Xp(this.ld);this.rc={}};z(bq,I);bq.prototype.Bw=function(){return this.Ka};bq.prototype.lq=function(){return this.Zd};
bq.prototype.js=function(a){this.rC=a};bq.prototype.Wp=function(){return this.rC||0};o=bq.prototype;o.wh=function(a){dc(this.rc)&&this.zf.e(this.Id,nd,this.gm);if(ka(a))for(var b=0;b<a.length;++b)this.Zx(a[b]);else this.Zx(a)};o.yF=function(a){return this.rc[a]};o.Gm=function(a,b){if(ka(a))for(var c=0;c<a.length;++c)a[c].$x(b);else a.$x(b)};
o.IG=function(a){var b=a.target,c=b.id;if(this.Wg[c]){this.Wg[c].k();this.Wg[c]=h}this.ld.iK(c);delete this.rc[b.Qc];if(dc(this.rc)){this.zf&&this.zf.Ya();this.yN=h}};o.SJ=function(){this.k()};o.l=function(){this.sf();if(this.Jc){this.Jc.k();this.Jc=h}if(this.sx){this.sx.k();this.sx=h}if(this.Id){this.Id.k();this.Id=h}for(var a in this.rc){var b=this.rc[a];this.Gm(b,j);b.k()}if(this.zf){this.zf.k();this.zf=h}bq.d.l.call(this)};o.Wg={};
o.hg=function(a,b,c,d){var f=a.id;this.Wg[f]||(this.Wg[f]=new zf(this));this.Wg[f].e(a,b,c,d)};o.gm=function(){this.rh()&&this.Wa.ua()};o.AE=function(a){if(ig(a.target)){var b=a.target.ownerDocument,c=b.defaultView,d=b.activeElement;if(d&&d.contentEditable){var f=Ue(c);if(!f.isCollapsed()){if(nl){c.getSelection().collapseToEnd();f.select()}c.setTimeout(function(){var g=Ue(c);if(g.isCollapsed()){var i=g.Q(),l=g.ta();if(i==f.Q()&&l==f.ta()||i==f.ha()&&l==f.Fa())f.select()}},0)}}}};
o.Pz=function(a,b,c,d,f,g){a.jb||a.Bl(this.Zd.s());a.ss(b,c,d,f,g)};o.aL=function(a,b,c,d){this.Pz(this.ld.Le(a),e,b,c,j,d)};o.gw=function(a){a.jb||a.Bl(this.Zd.s());return a.Ll()};o.tF=function(a){return this.gw(this.ld.Le(a))};o.GG=function(a){this.dispatchEvent({type:"focus",p:a.target})};o.FG=function(a){var b=j;if(B){var c=a.b(),d=wm(Ll(c)),f=M(d);if(d.contains(zi(f)))b=e;else{var g=a.fa();g.Rq(c)&&g.empty()}}this.dispatchEvent({type:"blur",p:a});b&&a.execCommand(K.li)};
o.Zx=function(a){a.RK(this.Be);a.js(this.Wp());a.fq("RawHtmlDialogPlugin")||a.pb(new aq(this.Ka,this.Fg,this));a.fq("EditLinkDialogPlugin")||a.pb(new $p(this,this.lr));var b=a.id;a.Bl(this.Zd.s());if(!a.jb)return;a.execCommand(K.ye,j);ml&&e&&this.zf.e(this.lq().s(),gd,this.AE);this.ld.JB(b,a);a.wh(u(this.HG,this,a),this.Fg);this.rc[a.Qc]=a};o.HG=function(a){this.aC(a);this.hg(a,R.ji,u(this.IJ,this,a));kl||this.hg(a.b(),hd,u(this.CC,this,a))};
o.aC=function(a){a.b();this.hg(a,R.Gt,this.IG);this.hg(a,"focus",this.GG);this.hg(a,"blur",u(this.FG,this,a));this.hg(a,"selectionchange",ta(em,this));this.hg(a,R.$h,ta(em,this))};o.oE=function(a){if(B||F)this.Xi()||a.b().focus()};o.aK=function(){this.Jc.Ya()};o.CC=function(a,b){var c=dm(b);if(c&&c.nodeName!="IMG"&&j)c=Be(c,"A");this.zn(c,a)};
o.IJ=function(a,b){if(!kl&&b.Ty&&b.Ty==hd)return;var c=a.Hb(),d=c&&c.$p();if(d){var f=d;if(d.getAttribute&&d.getAttribute("imageanchor")){var g=Ai(d,function(i){return i.tagName=="IMG"});g===h||(f=d.childNodes[g])}else if(d.nodeName!="IMG")f=Be(d,"A");this.zn(f,a)}};
o.zn=function(a,b){this.rh()&&a!=this.Wa.Hd&&this.sf();if(a&&!this.rh())if(Wp(a)){var c=a.nodeName=="IMG",d=a.nodeName=="A";if(a.getAttribute("imageanchor")||c&&Nd(a,"tr_noresize"))return;if(c&&j||d&&e)return;var f=b||this.ld.xF(a),g=this.Zd.$(),i=wd.dd;this.Wa=new Np(this.Be,g,a,f.Cb.$(),this.Ka,this.On,u(this.openDialog,this,i));if(this.Jc)this.Jc.Ya();else this.Jc=new Jp(f,this);this.Jc.e(this.Wa,"dispose",this.aK);this.Jc.bF(this.Wa,"change");this.Jc.aF(this.Wa,Pp);this.Jc.e(this.Wa,Op,this.dispatchEvent);
this.Jc.e(this.Wa,"closed",this.jG);if(a.nodeName=="A"){this.Wa.sL(this.qN);this.Wa.gL(this.pN)}this.Wp()&&this.Wa.TK(this.Wp());this.Wa.xJ();this.oE(f)}};o.rh=function(){if(this.Wa)if(this.Wa.oa()&&this.Wa.gd&&this.Wa.gd.parentNode)return j;else this.Wa=h;return e};o.sf=function(){this.rh()&&this.Wa.Og()};o.jG=function(){this.Wa=h};var cq=wd;bq.prototype.openDialog=function(a,b){var c=this.kw();if(c){this.sf();c.execCommand(a,b)}};bq.prototype.Xi=function(){return this.ld.Pv()};
bq.prototype.kw=function(){var a=this.Xi();if(!a&&!dc(this.rc)){a=$b(this.rc);this.Jv(a)}return a};bq.prototype.kF=function(a){var b=this.Xi();return b?b.queryCommandValue(a):{}};var S=K;o=bq.prototype;o.execute=function(a,b){var c=h;this.sf();var d=this.kw();if(!d)return h;c=d.execCommand(a,b);a==K.dd&&this.$G(d,c);return c};o.Jv=function(a){if(xp==a.id){Ue(this.Zd.$())||a.Zy();return}yp(a.id);this.Zd.Fl();a.DE()};o.Iv=function(a){this.Jv(this.ld.Le(a))};
o.$G=function(a,b){if(b){var c=b.Ml();if(rm.test(c))this.bA(a,b,zn(c));else sm.test(c)?this.bA(a,b,"mailto:"+c):this.openDialog(wd.dd,b)}else this.sf()};o.bA=function(a,b,c){b.xx(c);this.zn(b.Eg,a);b.pe(a.fa())};w("TR_Editor",bq);var dq=bq.prototype;y(dq,"execute",dq.execute);y(dq,"getCommandValues",dq.kF);y(dq,"makeEditable",dq.wh);y(dq,"makeNotEditable",dq.Gm);y(dq,"getFieldContentsById",dq.tF);y(dq,"openDialog",dq.openDialog);y(dq,"quit",dq.SJ);y(dq,"dispose",dq.k);y(dq,"focusOnField",dq.Iv);
y(dq,"setFieldContentsById",dq.aL);y(dq,"setBaseZindex",dq.js);y(dq,"getFieldHTML",dq.gw);y(dq,"setFieldHTML",dq.Pz);y(bq,"isBrowserSupported",Mp);y(bq,"setInvalidUrlCheck",En);y(bq,"setInternalUrlCheck",yn);w("TR_EditorCommand",K);y(bq,"COMMAND",K);y(K,"UNDO",K.Cg);y(K,"REDO",K.Ag);y(K,"LINK",K.dd);y(K,"FORMAT_BLOCK",K.ci);y(K,"INDENT",K.io);y(K,"OUTDENT",K.ko);y(K,"REMOVE_FORMAT",K.ii);y(K,"STRIKE_THROUGH",K.lo);y(K,"HORIZONTAL_RULE",K.ho);y(K,"SUBSCRIPT",K.Dk);y(K,"SUPERSCRIPT",K.Ek);
y(K,"UNDERLINE",K.Bg);y(K,"UNLINK",K.Ft);y(K,"BOLD",K.xg);y(K,"ITALIC",K.zg);y(K,"FONT_SIZE",K.fo);y(K,"FONT_FACE",K.eo);y(K,"FONT_COLOR",K.bi);y(K,"EMOTICON",K.tt);y(K,"BACKGROUND_COLOR",K.zk);y(K,"ORDERED_LIST",K.hi);y(K,"UNORDERED_LIST",K.ki);y(K,"TABLE",K.vB);y(K,"JUSTIFY_CENTER",K.di);y(K,"JUSTIFY_FULL",K.ei);y(K,"JUSTIFY_RIGHT",K.gi);y(K,"JUSTIFY_LEFT",K.fi);y(K,"BLOCKQUOTE",K.qt);y(K,"DIR_LTR",K.Ak);y(K,"DIR_RTL",K.ai);w("TR_DialogType",wd);y(bq,"DIALOG",wd);y(wd,"IMAGE",wd.dB);
y(wd,"SP_CHAR",wd.oB);y(wd,"EDIT_HTML",wd.Bk);y(wd,"EDIT_IMAGE",wd.st);y(wd,"LINK",wd.dd);y(wd,"INSERT_MODULE",wd.eB);y(dq,"getUrlUtil",dq.Bw);var eq={},T,fq,gq={};
var iq=function(a,b,c,d){var f=b||new tc,g=new Xh("MiscCommands");g.mg(ji(["command"],[a],g));hq(g,f,c,d)},jq=function(a,b,c,d){var f=b||new tc,g=new Xh("UserMiscCommands");g.mg(ji(["command"],[a],g));hq(g,f,c,d)},hq=function(a,b,c,d){var f=new Kj;f.dk(30000);if(d){var g=gq[d];g&&kq(g);gq[d]=f}H(f,[yj,zj,Aj,"abort"],u(lq,h,c,d));var i=b?ji(pc(b),oc(b),undefined,undefined):new Zh;i.h("POST_TOKEN",postToken);var l=i.toString();if(l)l+="&";l+="finis=true";window.setTimeout(function(){f.send(DasherizeURL(a?a.toString():
""),"POST",l)},0)},lq=function(a,b,c){delete gq[b];var d=c.target,f=c.type==yj;try{var g=d.am();if(g==302||g==301){d.getResponseHeader("Location").indexOf("unavailable.html")==-1&&mq();f=e}var i=p.offline;i&&i.NA&&i.NA(!f);if(a)a(f?d.na:h,c.type==Aj)}finally{kq(c.target)}},nq=function(a){var b=Qd().s(),c=b.location.protocol+"//"+(b.location.host+a).replace(/\/\//g,"/");if(c.charAt(c.length-1)!="/")c+="/";return c},oq=function(a){var b=new Xh("https://www.google.com");b.$j(a+(a?"":"/accounts")+"/ServiceLogin");
var c=new Zh;c.add("service","writely");c.add("continue",nq(a));b.mg(c);return b.toString()},mq=function(){var a="\u60a8\u53ef\u80fd\u5df2\u7ecf\u6ce8\u9500\u3002 \u8bf7"+('<a target="_blank" href="'+oq(SitePrefix)+'">\u70b9\u51fb\u6b64\u5904</a>\u5728\u65b0\u7a97\u53e3\u4e2d\u767b\u5f55\u3002');typeof pq!="undefined"&&pq([a])},kq=function(a){ed(a);a.abort();a.k()};w("writely.net.sendRequest",hq);w("writely.net.miscCommand",iq);w("writely.net.userMiscCommand",jq);var qq=h,rq=h,sq=h,tq=function(){qq||(qq=new Xh(window.location.href,j));return qq};
var uq=function(){if(rq)return rq;rq=tq().qd("docid")||tq().qd("id")||docID;return rq},vq=function(){if(typeof eq.nF!="undefined")return eq.nF();return h},wq=function(a){sq=a},U=function(a,b){if(sq)sq(a,b);else{window.alert(xq(a));if(oa(b))b();else if(b&&b.focus)b.focus();else b!==e&&"SetFocusBack"in window&&window.Ct()}},yq=function(a,b){return window.prompt(xq(a),xq(b))},zq=function(a){return window.confirm(xq(a))},xq=function(a){var b=String(a);b=b.replace(/&lt;/g,"<").replace(/&amp;/g,"&");b=
b.replace(/\0+/g,"");return b},Aq=function(){var a=E&&qb("1.8")||B&&qb("6")||F&&qb("522")||A&&qb("9.50");if(navigator.userAgent.toLowerCase().indexOf("konqueror")>=0)a=e;var b=typeof document.getElementById!="undefined"&&typeof document.designMode!="undefined";if((!a||!b)&&tq().qd("browserok")!="true")return e;return j};w("writely.getAction",function(){return tq().qd("action")});w("writely.alert",U);w("writely.confirm",zq);w("writely.prompt",yq);w("writely.getDocId",uq);var Bq=function(a,b){var c=a,d=b;if(!c){c=Xa()+(new Date).getTime().toString();d=0}else if(!d)d=0;else if(d<0||d>=2147483647){c=Xa()+(new Date).getTime().toString();d=0}this.DA=c;this.aa=d+1};Bq.prototype.Pa=function(){return this.aa};Bq.prototype.hI=function(){return this.aa==1};var Cq=function(a){if(WritelyVars[a]!=h)return String(WritelyVars[a]);var b=vq();if(b){var c=b.HN(a);if(c!=h){WritelyVars[a]=c;return c}}return h},Eq=function(a){var b=uq(),c=vq();if(Dq[a]&&Dq[a].get&&c){var d=Dq[a].get(b,c);return String(d)}if(WritelyDocVars[a]!=h)return String(WritelyDocVars[a]);if(c){var d=c.FN(b,a);if(d!=h){WritelyDocVars[a]=d;return d}}return h},Fq=/^\s*(true|1)\s*$/i,Gq=/^\s*(false|0)\s*$/i,Hq=function(a){if(typeof a=="boolean")return a;if(!a)return h;if(Fq.test(a))return j;
if(Gq.test(a))return e;return h},Iq=function(a){if(typeof a=="number")return a;if(!a)return h;var b=Number(a);return isNaN(b)?h:b},V=function(a){return Hq(Cq(a))},W=function(a){return Hq(Eq(a))},Jq=function(a){return Iq(Cq(a))},Kq=function(a){return Iq(Eq(a))},Lq=function(a,b){var c=b||b==e||b==0?String(b):"";WritelyVars[a]=c;var d=vq();d&&d.eO(a,c)},X=function(a,b){var c=uq(),d=vq();if(Dq[a]&&Dq[a].set&&d){Dq[a].set(c,b,d);return}WritelyDocVars[a]=b;d&&d.dO(c,a,b)},Mq=function(){var a=vq();if(a)return a.WN(uq());
var b=new Bq(WritelyDocVars.sessionEditToken,parseInt(WritelyDocVars.sessionPostbackCount,10));if(b.hI())WritelyDocVars.sessionEditToken=b.DA;WritelyDocVars.sessionPostbackCount=b.Pa();return b},Dq={title:{get:function(a,b){return b.EN(a)}}};w("writely.Vars",function(){});w("writely.Vars.getStringSiteVar",Cq);w("writely.Vars.getBooleanSiteVar",V);w("writely.Vars.getNumberSiteVar",Jq);w("writely.Vars.getStringDocVar",Eq);w("writely.Vars.getBooleanDocVar",W);w("writely.Vars.getNumberDocVar",Kq);
w("writely.Vars.setDocVar",X);w("writely.Vars.nextSessionData",Mq);var Nq=function(){},Oq={dl_1st_email:3000,dl_1st_share:3001,load_tab_view:3002,load_tab_edit:3003,load_tab_revlist:3004,load_tab_revcomp:3005,load_tab_revbrowse:3006,load_tab_htmledit:3007,load_tab_share:3008,load_tab_publish:3009,doc_load_5k:3010,"doc_load_5k_1-3img":3011,doc_load_5k_4x_img:3012,doc_load_10k:3013,"doc_load_10k_1-3img":3014,doc_load_10k_4x_img:3015,doc_load_20k:3016,"doc_load_20k_1-3img":3017,doc_load_20k_4x_img:3018,doc_load_50k:3019,"doc_load_50k_1-3img":3020,doc_load_50k_4x_img:3021,
doc_load_100k:3022,"doc_load_100k_1-3img":3023,doc_load_100k_4x_img:3024,doc_load_250k:3025,"doc_load_250k_1-3img":3026,doc_load_250k_4x_img:3027,doc_load_500k:3028,"doc_load_500k_1-3img":3029,doc_load_500k_4x_img:3030,click_to_load_5k:3031,"click_to_load_5k_1-3img":3032,click_to_load_5k_4x_img:3033,click_to_load_10k:3034,"click_to_load_10k_1-3img":3035,click_to_load_10k_4x_img:3036,click_to_load_20k:3037,"click_to_load_20k_1-3img":3038,click_to_load_20k_4x_img:3039,click_to_load_50k:3040,"click_to_load_50k_1-3img":3041,
click_to_load_50k_4x_img:3042,click_to_load_100k:3043,"click_to_load_100k_1-3img":3044,click_to_load_100k_4x_img:3045,click_to_load_250k:3046,"click_to_load_250k_1-3img":3047,click_to_load_250k_4x_img:3048,click_to_load_500k:3049,"click_to_load_500k_1-3img":3050,click_to_load_500k_4x_img:3051,html_load_5k:3052,"html_load_5k_1-3img":3053,html_load_5k_4x_img:3054,html_load_10k:3055,"html_load_10k_1-3img":3056,html_load_10k_4x_img:3057,html_load_20k:3058,"html_load_20k_1-3img":3059,html_load_20k_4x_img:3060,
html_load_50k:3061,"html_load_50k_1-3img":3062,html_load_50k_4x_img:3063,html_load_100k:3064,"html_load_100k_1-3img":3065,html_load_100k_4x_img:3066,html_load_250k:3067,"html_load_250k_1-3img":3068,html_load_250k_4x_img:3069,html_load_500k:3070,"html_load_500k_1-3img":3071,html_load_500k_4x_img:3072,js_load:3073,js_parse:3074,js_loadparse:3075,js_execute:3076,dl_BlogSettings:3077,dl_Britannica:3078,dl_ChangeCell:3079,dl_ChangeColumn:3080,dl_ChangeList:3081,dl_ChangeRow:3082,dl_CSSEdit:3083,dl_CommentSettings:3084,
dl_DocSettings:3085,dl_EditHtmlSelection:3086,dl_EmailDocument:3087,dl_EmailMsg:3088,dl_FindReplace:3089,dl_InsertBookmark:3090,dl_InsertChar:3091,dl_InsertImage:3092,dl_InsertLink:3093,dl_InsertTable:3094,dl_MiscTextBox:3095,dl_PrintSettings:3096,dl_TocSettings:3097,dl_WordCount:3098,gears_click_to_load_local:3099,gears_click_to_load_fullsync:3100,gears_html_load_local:3101,gears_html_load_fullsync:3102,newdoc:3103,copydoc:3104,publish:3105,update_collaborators:3106,send_email:3107,doc_load:3108,
click_to_load:3109,html_load:3110,css_load:3111,click_to_html:3112,blocking_save:3113,make_editable:3114,load_dialogs:3115,print:3116,click_to_doc_readable:3117,click_to_doc_readable_5k:3118,"click_to_doc_readable_5k_1-3img":3119,click_to_doc_readable_5k_4x_img:3120,click_to_doc_readable_10k:3121,"click_to_doc_readable_10k_1-3img":3122,click_to_doc_readable_10k_4x_img:3123,click_to_doc_readable_20k:3124,"click_to_doc_readable_20k_1-3img":3125,click_to_doc_readable_20k_4x_img:3126,click_to_doc_readable_50k:3127,
"click_to_doc_readable_50k_1-3img":3128,click_to_doc_readable_50k_4x_img:3129,click_to_doc_readable_100k:3130,"click_to_doc_readable_100k_1-3img":3131,click_to_doc_readable_100k_4x_img:3132,click_to_doc_readable_250k:3133,"click_to_doc_readable_250k_1-3img":3134,click_to_doc_readable_250k_4x_img:3135,click_to_doc_readable_500k:3136,"click_to_doc_readable_500k_1-3img":3137,click_to_doc_readable_500k_4x_img:3138,click_to_doc_loaded:3139},Pq={},Rq=function(a){if(!Qq())return;var b={start:(new Date).getTime(),
Ie:h,wo:h};Pq[a]||(Pq[a]=[]);Pq[a].push(b)},Sq=function(a){if(!Qq())return;delete Pq[a]},Tq=function(a,b){if(!Qq())return;var c=(new Date).getTime();if(!Pq[a]||!Pq[a].length)return;for(var d=0;d<Pq[a].length;d++){var f=Pq[a][d];if(!f.Ie){f.Ie=c-f.start;if(f.Ie<=0||f.Ie>120000){Pq[a].splice(d,1);break}if(b)f.wo=b;break}}},Uq=function(a,b,c){if(!Qq())return;if(b<=0||b>120000)return;var d={start:h,Ie:b,wo:c};Pq[a]||(Pq[a]=[]);Pq[a].push(d)},Vq=function(){if(!Qq())return;window.setTimeout(Vq,600000);
var a=[],b=[],c=[],d=/^(click_to_load|doc_load|html_load|click_to_doc_readable)/;for(var f in Pq){if(f){var g=Pq[f];for(var i=0;i<g.length;i++)if(g[i].Ie){var l=f+(g[i].wo||""),m=g[i].Ie;Wq(l,m,a,b,c);var n=l.match(d);n&&Wq(n[0],m,a,b,c)}}delete Pq[f]}if(a.length==0)return;iq("report_timing",{names:a.join(","),values:b.join(","),events:hj(c)});try{if(V("x10latency")&&typeof _gat!="undefined"){var q=Cq("urchinid"),r=_gat._getTracker(q)._createEventTracker("TimeTracker"),t=[0,10,25,50,100,250,500,1000,
2500,5000,10000],v=Math.floor(a.length*Math.random()),x=a[v],C=b[v],J;for(i=1;i<t.length;i++)if(C<t[i]){J=t[i-1]+"-"+(t[i]-1);break}J||(J=t[i-1]+"+");r._trackEvent(J,x,C)}}catch(D){}},Wq=function(a,b,c,d,f){c.push(encodeURIComponent(a));d.push(b);var g=Oq[a];g&&f.push({eC:g,cT:b})},Qq=function(){return V("client_latency_stats")};var Xq=function(a){this.ad=a||window},Yq,Zq=function(a){if(a)return new Xq(a);Yq||(Yq=new Xq);return Yq};Xq.prototype.mw=function(){return new Xh(this.ad.location.href)};Xq.prototype.us=function(a){this.ad.location.href=a.toString()};Xq.prototype.reload=function(a){this.ad.location.reload(a)};var $q=function(){},ar=e,cr=function(a,b,c){if(ar)return;var d=ta(br,a,b,c);ar=j;var f=N().createElement("script");f.src="https://ssl.google-analytics.com/ga.js";f.onreadystatechange=d;f.onload=d;N().appendChild(document.body,f)},br=function(a,b,c){if(typeof _gat!="undefined"){var d=window.urchinPage||Zq().mw().toString(),f=_gat._getTracker(a);f._setAllowAnchor(j);f._trackPageview(d);if(b){f=_gat._getTracker(b);f._setAllowAnchor(j);document.location.host.indexOf(".google.com")!=-1&&f._setCookiePath("/a/"+
c);f._trackPageview()}}};function dr(){return typeof eq!="undefined"&&typeof er!="undefined"?fr():TabIsEditor}window.isUPWindow=j;function gr(a,b){try{if(a!=h){for(var c=0;c<a.childNodes.length;c++)gr(a.childNodes[c],b);hr(a,b)}}catch(d){}}function hr(a,b){try{if(a&&"tagName"in a){a.disabled=!b;a.style.color=b?"#000":"#676767"}}catch(c){}}function ir(a,b){if(b!="")a+="?"+b;return DasherizeURL(a)}function jr(a,b){var c=window.prompt(xq(a),xq(b||""));if(c)return c.replace(/[\r\n]/g," ");return h}
function kr(a){var b=a.replace(/(<([^>]+)>)/ig,"");return Ca(Qa(b))}function lr(a){var b=window.open("","_blank");if(!b||b.closed)return;var c;switch(a){case "newdoc":c=SitePrefix+"/DocAction?action=newdoc";break;case "newpres":c=SitePrefix+"/DocAction?action=new_presentation&source=writely";break;case "newtrix":c=window.location.protocol+"//spreadsheets.google.com"+SitePrefix+"/ccc?new";break;case "newtemp":c=SitePrefix+"/templates?type=docs";break}b.location.href=c;b.focus()}
function mr(){if(window.LIMITED_EDITING){nr("&spi=1&hgd=1",j);return}or(function(){pr("Print")})}function pr(a,b){var c="";if(b)c+="&"+ji(pc(b),oc(b),undefined,undefined).toString();if(a!="Export")c+="&print=1";if(qr&&a!="Export")c+="&silent=true";var d="MiscCommands?command=save_print_settings&docID="+encodeURIComponent(docID)+c,f=new Date((new Date).getTime()+120000);document.cookie="PDF_INLINE=ok;path=/;expires="+f.toUTCString();if(qr||a=="Export"){B||Rq("print");rr(d)}else window.open(d)}
function rr(a){var b=O("hidden_download_frame");if(b)b.src=a;else{O("hidden_download_container").innerHTML='<iframe id="hidden_download_frame" style="width:0;height:0;border:0" src="'+a+'"></iframe>';b=O("hidden_download_frame")}$c(b,"load",function(){Tq("print")})}
function sr(a,b,c,d,f){var g="",i="";if(b!=""&&b!=h)i="&revision='"+b+"'";g=a=="0"?d+"DocAcention?action=newdoc":i!=""?d+"View?docid="+encodeURIComponent(a)+i:d+"Doc?id="+encodeURIComponent(a);if(typeof f!="undefined"&&f!=h&&f!="")g=g+"&btr="+f;return g}
function tr(a,b){var c="";try{b=b.replace(/\./g,"");b=b.replace(/\s/g,"");var d=window.open(a,b,c);if(d!=h){d.focus();return e}ur(a);return e}catch(f){try{var g=window.location.href.slice(0,window.location.href.lastIndexOf("/",window.location.href.length-(/\/$/.test(window.location.href)?2:0))+1)+a;window.open(g,b,c)}catch(f){return j}return e}}
function vr(a,b){var c=Wf(a);if(b){var d=N(a).od();c.x-=d.x;c.y-=d.y}if(a.className=="misspell"||a.className=="writely-comment"){var f=Wf(O("wys_frame"));c.x+=f.x;c.y+=f.y}return c}function wr(a,b,c,d,f,g){document.cookie=a+"="+escape(b)+(c?"; expires="+c.kO():"")+(d?"; path="+d:"")+(f?"; domain="+f:"")+(g?"; secure":"")}
function xr(a,b){var c=document.cookie,d=a+"=",f=c.indexOf("; "+d);if(f==-1){f=c.indexOf(d);if(f!=0)return b}else f+=2;var g=document.cookie.indexOf(";",f);if(g==-1)g=c.length;return unescape(c.substring(f+d.length,g))}var yr="";function zr(a){return parseInt(a.replace("list_cb",""),10)}function Ar(a){if(a&&a.match(/0x/i))return parseInt(a,16);return parseInt(a,10)}
function Br(a,b){if(a.shiftKey&&yr!=""){var c=b.checked,d=zr(b.id),f=zr(yr),g=zr(d<f?b.id:yr),i=zr(d>f?b.id:yr);if(g!=i){var l=document.body.getElementsByTagName("input");if(l)for(var m=0,n;n=l[m];m++)if(n.name.indexOf("list_cb")==0){var q=zr(n.id);if(q>g&&q<i)n.checked=c;else if(q>i)break}}}if(!a.shiftKey)yr=b.id;Cr(e)}
function Cr(a){var b="";if(a)b=xr("checkedDocs","");var c=document.body.getElementsByTagName("input");if(c)for(var d=0,f;f=c[d];d++)if(f.name.indexOf("list_cb")==0){var g=Dr(f,"tr");if(g!=h&&g.className!="cbRow"){g=Dr(g,"table");if(g!=h)g=Dr(g,"tr")}if(a)f.checked=b.indexOf(f.value)!=-1;else if(f.checked)b+=","+f.value;g.style.background=f.checked?"#FFFFCC":"#ffffff"}a||wr("checkedDocs",b)}
function Er(a){var b=(new Pd(window.document)).eh("table","doclist");for(var c=0;c<b.length;c++)b[c].style.cursor=a}function Fr(a){if(a&&a.childNodes&&a.childNodes.length)return a.childNodes.length;return 0}function Gr(a,b){oe(a,b)}function Hr(a,b){while(a!=h&&Fr(a)==1&&a.childNodes[0].nodeType!=3)a=a.childNodes[0];Gr(a,b)}function Ir(a){return function(b,c){b=b?b:window.event?window.event:h;if(b==h&&Y)b=Y.event;if(b){var d=b.target?b.target:b.srcElement;if(d)return a(b,d,c)}return j}}
function Jr(a,b,c,d){if(d){a.setAttribute(c,b);return j}a.removeAttribute(c);return e}function Kr(a){try{return!!a.match(/^\d+$/)}catch(b){return e}}function Dr(a,b){var c=a;b=b.toUpperCase();while(c){if(c.tagName==b)return c;var d=c.parentNode;if(d==c)return h;c=d}return h}function Lr(a){return Ea(a)}function Mr(a){return Ba(a)}function Nr(a){if(a==h||a.length==0)return"";a=Ea(a);return a.replace(/\s/g,"_")}
function ur(a){if(typeof window.location.assign=="function")window.location.assign(a);else if(typeof window.location.replace=="function")window.location.replace(a);else if(self.location.href)self.location.href=a;else window.location=a}
function Or(a){try{var b=e;try{b=window.opener&&!window.opener.closed&&"isUPWindow"in window.opener&&window.opener.isUPWindow!=h}catch(c){}var d=window.opener==window;if(b&&!d)window.opener.newDoclist||window.opener.location.reload(j);if(a&&(!b||d)){window.location.href=SitePrefix+"/";window.name="Writely";return}if(a){if(!window.closed)if(B){var f=window.navigator.appVersion,g=f.indexOf("MSIE "),i=f.substring(g+5,g+8);if(parseFloat(i)>=7){window.open("","_self");window.setTimeout(function(){self.close()},
100)}else self.close()}else window.setTimeout(function(){window.close()},100);b&&window.opener.closed&&window.opener.focus()}}catch(c){rce("ReloadOpener",c)}}var Pr="RawDocContents",Qr="RawDocContents";function Rr(a){a=Sr(a);if(a)if(B){a.cancelBubble=j;a.returnValue=e;if(a.keyCode==80)a.keyCode=0}else{a.preventDefault();a.stopPropagation()}}function Sr(a){if(a)return a;if(window.event)return window.event;if(Y)return Y.event;return h}
function Tr(a,b){if(b){var c=b.name,d=b.message;if(c)a+=":"+c;if(d)a+=":"+d;if(!c&&!d)a+=":"+b.toString()}typeof RunningOnLocalServer=="function"&&RunningOnLocalServer()?U(a):rce("DebugAlert",a)}
function Ur(){var a="",b=Ur,c=[];try{a:while(b!=h){c.push(b);var d=b.toString(),f=d.indexOf("(");if(f>=0)d=d.substring(0,f);a+=d+"(";if("arguments"in b)for(var g=0;g<b.arguments.length;g++){var i=b.arguments[g].toString();if(i.length>100)i=i.substring(0,100);a+=i;if(g<b.arguments.length-1)a+=", "}a+=")\n";b=b.caller;for(var l=0;l<c.length;l++)if(c[l]==b)break a}}catch(m){}return a}function Vr(a,b){if(a)return;Tr(b)}
function Wr(a,b,c,d){if(c!=h&&c.length>0)b+=c;if(d!=h)b+=": "+d.tagName.toLowerCase();rce(a,b);return h}
function Xr(a,b,c){try{if(a==h)return Wr("UpToTag","nodeorpath is null");var d="length"in a?a[0]:a;while(j){if(d==h)return Wr("UpToTag","node is null in while",h,h);if(!("tagName"in d))return Wr("UpToTag","tagName is undefined in while",h,h);if(d.tagName==h)return Wr("UpToTag","node.tagName is null in while",h,h);if(!("parentNode"in d))return Wr("UpToTag","parentNode is undefined in while",h,d);if(d.parentNode==h)return Wr("UpToTag","node.parentNode is null in while",h,d);if(d.tagName.toLowerCase()==
b)return d;if(c!=h&&d.tagName.toLowerCase()==c)return d;if(d.tagName=="BODY")return h;d=d.parentNode}}catch(f){rce("UpToTag",f,"Can't go up to \""+b+'".')}return h}
function Yr(a,b){try{if(a==h)return Wr("UpToClass","nodeorpath is null");var c="length"in a?a[0]:a;while(j){if(c==h)return Wr("UpToClass","node is null in while",path,h);if(e in c)return Wr("UpToClass","parentNode is undefined in while",path,c);if(c.parentNode==h)return Wr("UpToClass","node.parentNode is null in while",path,c);if(c.className==b)return c;c=c.parentNode}}catch(d){rce("UpToClass",d,"Can't go up to \""+b+'".')}return h}window.gData=h;window.dialogIsShowing=e;
function Zr(a){if(!B)return e;if(e in a.document.body)return e;if(e in a.document.body)return e;var b=e,c=a.document.body.getElementsByTagName("p");if(c&&c[0])for(var d=0,f;f=c[d];d++)try{var g=f.innerHTML;if(!g||g==" "||g=="\r\n"){f.innerHTML="&nbsp;";b=j}}catch(i){}return b}function $r(a,b){var c=b.getElementsByTagName("SELECT");for(var d=0,f;f=c[d];d++)f.style.display=a?"":"none"}
function as(){window.setTimeout(function(){$r(j,window.document);if(typeof Y!="undefined"&&Y!=h){bs(Y);if(cs&&"moveEnd"in cs){cs.moveEnd("character",0);cs.collapse();cs.select()}}},A?100:0)}function bs(a){try{a.focus()}catch(b){return e}return j}function ds(a,b,c,d,f,g){var i=es("MiscTextBox",{text:a,caption:b,title:c,width:d,Yx:f});if(i){if(!oa(g)&&g!==e)if(g&&g.focus){var l=g;g=function(){l.focus()}}else g=oa(window.Ct)?as:h;g&&$c(i,"afterhide",g)}}
function fs(a){if(a==h)return e;return a.indexOf("Error:")==0}function gs(a){if(a==h)return e;return a.indexOf("Redirect:")==0}function hs(a){if(a==h)return e;return a.indexOf("Warning:")==0}function is(a,b){if(a==h)return"";var c=a;if(c.indexOf(b+":")==0)c=c.substring((b+":").length);if(c.indexOf("<!DOCTYPE")!=-1)c=c.substring(0,c.indexOf("<!DOCTYPE"));return c}
function js(a){if(a&&typeof Y!="undefined"&&Y&&!Y.document.getElementById(a))return a;var b=Math.random()*40000000,c=ks.charAt(b%26)+ks.charAt((b>>6)%40)+ks.charAt((b>>12)%40)+ks.charAt((b>>18)%40);if(typeof Y!="undefined"&&Y)while(Y.document.getElementById(c))c+=ks.charAt(Math.random()*40);if(c.indexOf("--")!=-1)return js();return c}var ks="abcdefghijklmnopqrstuvwxyz0123456789-_:.";
function ls(a){if(Y.document.createRange){var b=Y.document.createRange();b.setStart(a,0);b.setEnd(a,0);var c=He(Y);if(c){c.removeAllRanges();c.addRange(b)}}else{var b=Y.document.body.createTextRange();b.moveToElementText(a);b.collapse();b.select()}return e}function ms(a){if(Y.document.createRange){var b=Y.document.createRange();b.selectNodeContents(a);var c=He(Y);if(c){c.removeAllRanges();c.addRange(b)}}else{var b=Y.document.body.createTextRange();b.moveToElementText(a);b.select()}return e}
function ns(a,b){if(!b)return;if(b.parentNode==a.document.body)if(b.nextSibling==h||e in b.nextSibling||b.nextSibling.tagName==h){var c=a.document.createElement("br");a.document.body.appendChild(c)}}function os(){ps("\u6b63\u5728\u4fdd\u5b58...")}function qs(){rs()}function ps(a){a||(a="\u6b63\u5728\u64cd\u4f5c...");var b=O("savingDiv");if(b){b.innerHTML="<nobr>"+a+"</nobr>";b.style.left=-1000;b.className="visibleStatus";b.style.left=(b.offsetParent.clientWidth-b.clientWidth)/2}}
function rs(){var a=O("savingDiv");if(a)a.className="hiddenStatus"}function ss(a){ts();var b=O("noticeDiv");if(!b)return;b.innerHTML="";if(a.indexOf("<nobr>"<0))a="<nobr>"+a+"</nobr>";b.innerHTML=a}function ts(){qs();rs()}function us(){window.location==window.top.location&&typeof er!="undefined"?window.setTimeout(vs,0):window.location.reload(j)}
function ws(a){if(a)if(hs(a.responseText)){ts();return!zq(is(a.responseText,"Warning"))}else if(fs(a.responseText)){ts();U(is(a.responseText,"Error"));return j}else if(gs(a.responseText)){ts();window.location.href=xq(is(a.responseText,"Redirect"));return j}return e}function xs(a,b){if(b==(typeof eq!="undefined"&&typeof er!="undefined"?ys():typeof Tab!="undefined"?Tab:h))typeof er!="undefined"?vs():window.location.reload();else ts();return j}
var zs=/google-navclient-hilite|__firefox-findbar-search-id|gtbmisp_\d+/i,As=/__mozilla-findbar-search/i;function Bs(a){if(!a)return;var b=a.getElementsByTagName("span");for(var c=b.length-1;c>=0;--c){var d=b[c],f=d.getAttribute("id"),g=d.className;if(zs.test(f||"")||As.test(g||""))!!(d&&ee(d))}}function Cs(){var a;a=window.getComputedStyle?window.getComputedStyle(document.body,h):document.body.currentStyle;return a.direction=="rtl"}
function nr(a,b){var c=function(){leavePageButtonClicked=j;var d="View?docID="+encodeURIComponent(docID)+"&revision=_latest";if(a)d=d+a;if(b)window.open(d);else window.location.href=d};if(dr())window.LIMITED_EDITING?Ds(c):Es(e,j,c,e);else c();return e}function Fs(a){if(dr()){a&&a.blur();var b=function(){leavePageButtonClicked=j};Gs(function(){Es(j,j,b,e)},"result=done&docID="+encodeURIComponent(docID))}else Or(j)}function Hs(a){Nq&&Rq("dl_1st_email");var b=W("isshared");Is(b,b,b,j,a)}
window.NewFolks=h;window.ToCollaborators=e;window.ToViewers=e;window.ToBoth=e;window.AllowAttach=e;window.SendDocument=e;function Is(a,b,c,d,f){window.ToCollaborators=a;window.ToViewers=b;window.ToBoth=a&&b;window.AllowAttach=d;window.NewFolks=h;window.SendDocument=f;es("EmailDocument")}function Js(a){Nq&&Rq("dl_1st_share");window.ToCollaborators=e;window.ToViewers=e;window.ToBoth=e;window.NewFolks=a;window.AllowAttach=e;es("EmailDocument")}w("InError",ws);w("ShowWorkingDiv",ps);function Ks(a){a=a.replace(/&/g,"&amp;");a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");a=a.replace(/\"/g,"&quot;");return a}function Ls(a,b,c){if(!zq("This will move over any documents and spreadsheets for "+a+" from the public Docs & Spreadsheets web site. Continue?"))return;Er("wait");iq("move_old_docs",{forward:b},function(d){Er("default");if(ws(d))return e;else typeof c!="undefined"&&c!=h?ur(c):us()})}
function Ms(a,b,c){var d=[SitePrefix,"/DocAction?action=",c||"copy","&docid=",encodeURIComponent(a)];b&&W("isshared")&&zq('\u70b9\u51fb"\u786e\u5b9a"\u4ee5\u590d\u5236\u534f\u4f5c\u8005\uff0c\n \u6216\u70b9\u51fb"\u53d6\u6d88"\u4ec5\u590d\u5236\u5728\u7ebf\u6587\u6863\u3002')&&d.push("&copycollaborators");return tr(d.join(""),"Editor_"+a)}function Ns(a){if(!a||a==gUntitled)return lUntitled;return a}function Os(a){if(!a||a==lUntitled)return gUntitled;return a}
function Ps(){if(typeof Qs=="undefined"||Qs==h)return;var a=jr("\u8f93\u5165\u65b0\u5728\u7ebf\u6587\u6863\u7684\u540d\u79f0\uff1a",Ns(Qs||docTitle));if(a!=h&&a.length>0){docTitle=Os(a);ps();or(function(){Rs(docTitle)})}return e}function Ss(a){if(a.length>32)a=a.substring(0,30)+"...";return a}function Rs(a){rs();docTitle=a;X("title",a);Qs=a;var b=O("txtTitleEdit");if(b!=h)b.innerHTML=Ks(Ss(Ns(Qs)));document.title=Ss(Ns(Qs))+" - Docs & Spreadsheets";Or(e)}
function Ts(a){if(a=="pdf"){or(function(){pr("Export")});return e}var b="MiscCommands?command=saveasdoc&docID="+encodeURIComponent(docID)+"&exportFormat="+a;or(function(){rr(b)});return e}function Us(){var a="UserMiscCommands?command=saveaszip&docID="+encodeURIComponent(docID);or(function(){rr(a)});return e}function Vs(){es("WordCount",{IK:Ue(Y)})}function Ws(){or(function(){es("DocSettings")})}function Xs(){window.LIMITED_EDITING?nr("&spi=1&hgd=1"):or(function(){es("PrintSettings")})}
function or(a){typeof Ys=="function"&&dr()?Ys(j,a):a()}function Zs(){if(!zq("\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f"))return;Er("wait");jq("setarchive",{docID:docID,archived:j},function(a){Er("default");if(ws(a))return;Fs(h)},"UserMiscCommands_setarchive"+docID)}function $s(a){a||at();iq("butter",{id:a,on:e},at)}function at(){O("GDS_pageButter").style.display="none"}
function pq(a){var b=O("buttercontents"),c="";for(var d=0;d<a.length;d++)c+='<p class="app bpara">'+(d?"":"<b>")+a[d]+(d?"":"</b>")+"</p>";b.innerHTML=c;O("GDS_pageButter").style.display=""};var bt=function(){},ct={},dt=h,zt=function(){dt={BlogSettings:et,Britannica:ft,ChangeCell:gt,ChangeColumn:ht,ChangeList:it,ChangeRow:jt,CSSEdit:kt,CommentSettings:lt,DocSettings:mt,EditHtmlSelection:nt,EmailDocument:ot,FindReplace:pt,InsertBookmark:qt,InsertChar:rt,InsertImage:st,InsertLink:tt,InsertTable:ut,MiscTextBox:vt,PrintSettings:wt,TocSettings:xt,WordCount:yt}},At={},Bt=h,Ct=h,es=function(a,b){dt||zt();if(!a)return h;var c=ct[a];if(!c&&oa(dt[a])){c=new dt[a];ct[a]=c}if(!c)return h;Nq&&Rq("dl_"+
a);c.N(b);return c},Dt=function(a){Ct=a},Gt=function(){if(Bt)return;Nq&&Rq("load_dialogs");var a=[];for(var b in DIALOG_VERSIONS)a.push("f="+b,"v="+DIALOG_VERSIONS[b]);a.push("lang="+Cq("language"));a=a.join("&");Bt=new Kj;Bt.dk(30000);H(Bt,yj,Et);H(Bt,[zj,Aj],Ft);Bt.send("DialogFetcher?"+a)},Ht=function(){typeof $q!="undefined"&&cr(Cq("urchinid"),Cq("domainurchinid"),Cq("dasherdomain"))},Et=function(){var a=Bt.gq();if(a.indexOf("while(true);")==0)a=a.substr("while(true);".length);a=ej(a);for(var b=
0;b<a.dialogs.length;b++){var c=a.dialogs[b];At[c.id]={title:c.title,html:c.html}}if(Ct){es(Ct);Ct=h}Bt.k();Bt=h;wq(function(i,l){ds(h,i,wa("Attention"),300,h,l)});Nq&&Tq("load_dialogs");Ht();if(Cq("enable_powerkey")=="true"&&E){var d=Cq("powerkey_lib").split(",");for(var b=0,f;f=d[b];b++){if(f=="")continue;var g=Qd().createElement("script");g.src=f;P(document.body,g)}}},Ft=function(){Bt.k();Bt=h;var a=Ct;if(a){U("\u5f88\u62b1\u6b49\uff0c\u73b0\u5728\u65e0\u6cd5\u8fde\u63a5\u5230\u8be5\u670d\u52a1\u3002\n\u786e\u4fdd\u7f51\u7edc\u8fde\u63a5\u6b63\u5e38\uff0c\u6216\u5728\u6570\u5206\u949f\u540e\u91cd\u8bd5\u3002");
ct[a].o(e);Ct=h}Ht()};w("writely.DialogFetcher",bt);w("writely.DialogFetcher.openDialog",es);var Z=function(){Th.call(this);this.Su=h;this.yc=h;if(B&&Cs()){var a=this.YF();a.appendChild(a.firstChild);a.style.direction="ltr";a.style.height="2em";var b=this.ZF();b.style.position="absolute";b.style.right="16px";b.style.direction="rtl"}var c=this.XF(),d=Xd("span",{id:this.c("close_box"),title:"\u5173\u95ed\u5bf9\u8bdd\u6846","class":"goog-inline-block close_box"});P(c,d);var f=new Uh;f.h("ok","\u786e\u5b9a",j);f.h(Wh,"\u53d6\u6d88",e,j);this.ef(f);H(this,"dialogselect",this.fm,e,this);this.Xp().style.textAlign=
Cs()?"right":"left"};z(Z,Th);o=Z.prototype;o.wa=h;o.N=function(a,b){if(!this.Su){var c=At[this.wa];if(c){this.rb(c.title);this.Sb(c.html);this.Su=c;var d=function(){return e};for(var f=0,g;g=document.forms[f];f++)if(!g.onsubmit&&!g.action)g.onsubmit=d}else{Dt(this.wa);this.yc=b||h;Gt();return e}}a||this.o(j);if(Nq){var i="dl_"+this.wa;window.setTimeout(function(){Tq(i)},0)}return j};
o.ua=function(){Z.d.ua.call(this);if(B){var a=document.body.offsetWidth,b=parseInt(this.n.style.left,10),c=this.n.offsetWidth;c||(c=a/2);if(b>a-c){this.n.style.left=(a-c)/2+"px";if(c){var d="WritelyDialog";if(!this.n.id){if(document.getElementById(d))O(d).id="";this.n.id=d}window.setTimeout('document.getElementById("'+this.n.id+'").style.width = "'+c+'px"',0)}}}};o.o=function(a){window.dialogIsShowing=a;Z.d.o.call(this,a);!a&&this.wa!="MiscTextBox"&&oa(window.Ct)&&as()};
o.fm=function(a){if(a&&a.Qb=="ok")this.da(a);else if(a&&a.Qb==Wh)this.Ah(a);else a&&this.zr(a)};o.ip=function(){};o.da=Z.prototype.ip;o.Ah=Z.prototype.ip;o.zr=Z.prototype.ip;o.c=function(a){return this.wa+a};o.z=function(a){var b=O(this.c(a));if(b)return b.value;return h};o.Ca=function(a){try{var b=O(this.c(a));if(b)return b.options[b.selectedIndex].value}catch(c){}return h};o.la=function(a){var b=O(this.c(a));b&&Of(b,"display","")};o.G=function(a){var b=O(this.c(a));b&&Of(b,"display","none")};
o.ic=function(a,b,c,d){var f=O(this.c(c)),g=a.getAttribute(b);f.value=g||d};o.qi=function(a,b,c){var d=parseInt(this.z(a),10);if(isNaN(d)||d<b)this.L(a,b);else d>c&&this.L(a,c)};o.L=function(a,b){var c=O(this.c(a));if(c.type=="select-one"){var d=e;for(var f=0;f<c.options.length;f++)if(c.options[f].value==b){c.selectedIndex=f;d=j;break}d||rce("Option not found in selection widget.",a,b)}else c.value=b?b.toString():""};o.qa=function(a){try{var b=O(this.c(a));if(b)return b.checked}catch(c){}return e};
o.jc=function(a,b,c,d){if(d){a.setAttribute(c,b);return j}a.removeAttribute(c);return e};o.ph=function(a,b,c,d){var f=a.getAttribute(b);if(f)f=f.toString();var g=O(this.c(c));if(f)if(f=="100%")g.value=0;else{if(f.indexOf("%")>0){f=f.substring(0,f.length-1);g.value=3}else g.value=2;O(this.c(d)).value=f}else g.value=1};o.vg=function(){this.Zh("width_select","width_amt",e);this.Zh("height_select","height_amt",e)};
o.Zh=function(a,b,c){var d=this.z(a),f=O(this.c(b));if(d>1){f.style.display="";c&&f.focus()}else f.style.display="none"};o.Rh=function(a,b,c,d){var f=this.z(b),g=this.z(c),i=this.UF(f,g);i!=h?a.setAttribute(d,i,0):a.removeAttribute(d)};o.UF=function(a,b){if(a==0)return"100%";else if(a==2)return Kr(b)?b.toString():h;else if(a==3)return Kr(b)?b+"%":h;return h};o.Re=function(a,b){var c=O(this.c(b)),d=Vg(c),f=O(this.c(b+"Value"));Q(f);c.appendChild(f);d.va(a);H(d,vg,this.dJ.bind(this));this.ms(c,a||"")};
o.Xj=function(a,b,c){var d=this.Qi(O(this.c(b)));d==""?a.removeAttribute(c):a.setAttribute(c,d,0)};o.$f=function(a){return a&&(typeof a.style=="undefined"||a.style.display=="")};o.dJ=function(a){var b=a.target.Ra();this.ms(O(a.target.Gb()),b)};o.Qi=function(a){a=O(a.id+"Value");var b=a.innerHTML;b=b.replace(/&lrm;/g,"").replace(/\u200E/g,"");return b=="none"?"":b};
o.ms=function(a,b){a=O(a.id+"Value");a.style.backgroundColor=b;var c=b.match(/^#?([a-f0-9][a-f0-9])([a-f0-9][a-f0-9])([a-f0-9][a-f0-9])$/i);if(c){var d=parseInt(c[1],16),f=parseInt(c[2],16),g=parseInt(c[3],16);a.style.color=d+f+g>382.5?"black":"white"}b=b.replace(/^#/,"&lrm;#");if(b=="none")b="";a.innerHTML=b||""};
o.Cv=function(a,b,c){var d=a.getElementsByTagName("a"),f=O(this.c(b));$d(f);if(d.length>0){var g=0;if(c)f.options[g++]=new Option("\u9009\u62e9\u4e66\u7b7e","");for(var i=0,l;l=d[i];i++)if(l.name)f.options[g++]=new Option(l.name,l.name)}else f.options[0]=new Option("\u6b64\u6587\u6863\u4e2d\u65e0\u4e66\u7b7e","")};o.dc=function(a){this.Uv("ok").innerHTML=a};o.pz=function(a){this.Uv("cancel").innerHTML=a};
o.Uv=function(a){var b=this.Xp().getElementsByTagName("button");for(var c=0,d;d=b[c];c++)if(d.name==a)return d;return h};w("writely.Dialog",Z);var Jt=function(a){var b="",c="";for(var d=0;d<a.length;){var f=It(a,d);if(f.charAt(0)=="<"&&f.indexOf(">")!=-1){var g=f.indexOf(">");c=f.substring(1,g)}else if(c=="")b+=f;d+=f.length}if(c==""&&b.indexOf("@")!=-1){c=b;b=""}b=ya(b);b=Ra(b,"'");b=Ra(b,'"');c=ya(c);return[b,c]},Kt=function(a){var b=[],c="",d;for(var f=0;f<a.length;){d=It(a,f);if(d==","){za(c)||b.push(Jt(c));c="";f++;continue}c+=d;f+=d.length}za(c)||b.push(Jt(c));return b},It=function(a,b){var c=a.charAt(b),d='"<(['.indexOf(c);if(d==
-1)return c;var f=a.indexOf('">)]'.charAt(d),b+1);return f>=0?a.substring(b,f+1):c},Lt=function(a){if(a.indexOf("=")!=-1)return"\u4e0d\u5141\u8bb8\u6709\u201c=\u201d\u3002";else if(a.indexOf(" ")!=-1)return"\u4e0d\u5141\u8bb8\u6709\u7a7a\u683c\u3002";else if(a.indexOf("@")==-1||a.indexOf(".")==-1||a.lastIndexOf(".")<a.indexOf("@"))return"\u5730\u5740\u683c\u5f0f\u4e0d\u6b63\u786e\u3002";else{var b=a.split("@");if(b.length!=2)return"\u4ec5\u5141\u8bb8\u4f7f\u7528\u4e00\u4e2a\u201c@\u201d\u3002";else if(b[0].length==
0)return"\u672a\u6307\u5b9a\u7528\u6237\u540d\u3002";var c=b[1].split("."),d=e;for(var f=0;f<c.length;f++)if(c[f].length==0){d=j;break}if(b[1].length<4||c.length<2||d)return"\u6307\u5b9a\u7684\u57df\u65e0\u6548\u3002"}return h};var qr;(function(){var a="";if(B){function b(f){try{new ActiveXObject(f);return j}catch(g){return e}}if(b("AcroPDF.PDF.1"))a="7";else if(b("PDF.PdfCtrl.6"))a="6"}else if(navigator.mimeTypes&&navigator.mimeTypes.length>0){var c=navigator.mimeTypes["application/pdf"];if(c&&c.enabledPlugin){var d=c.enabledPlugin.description;if(d&&d.indexOf("Adobe")!=-1)a=d.indexOf("Version")!=-1?d.split("Version")[1]:"7"}}qr=lb&&Za(a,"6")>=0})();var ft=function(){this.wa="Britannica";Z.call(this);this.ef(new Uh)};ft.Ha(Z);ft.prototype.Ih=h;ft.prototype.oc="";ft.prototype.Ep="";var Mt="getfrombritannica";o=ft.prototype;
o.N=function(a){this.Ih=a.PK;this.oc=a.PM;this.Ep=encodeURIComponent(this.oc);if(!ft.d.N.call(this,j))return;if(this.Ih=="encyclopedia"){this.Is("\u5728\u201c\u4e0d\u5217\u98a0\u767e\u79d1\u5168\u4e66\u201d\u4e2d\u67e5\u627e\u201c"+(this.oc+"\u201d..."));jq(Mt,{type:"encyclopedia",word:this.oc},this.Cy.bind(this))}else if(this.Ih=="thesaurus"){this.Is("\u5728\u201c\u97e6\u6c0f\u5728\u7ebf\u8bcd\u5178\u201d\u4e2d\u67e5\u627e\u201c"+(this.oc+"\u201d\u7684\u540c\u4e49\u8bcd..."));jq(Mt,{type:"thesaurus",
word:this.oc},this.rJ.bind(this))}this.Kq()};
o.Kq=function(){this.G("FrmSep");this.G("CntrSep");this.G("SearchSep");this.G("MWCopyrightS");this.G("EBCopyright");this.G("MWCopyrightD");if(!this.ya){H(O(this.c("Searchbttn")),"click",this.DG.bind(this));H(O(this.c("Replacebttn")),"click",this.WG.bind(this));this.ya=j;this.hp=new Nt;this.hp.pn(Y)}if(this.Ih=="dictionary"){this.rb("\u97e6\u6c0f\u5728\u7ebf\u8bcd\u5178");this.la("MWCopyrightD");O(this.c("DlgFrame")).src="http://www2.merriam-webster.com/cgi-bin/collegiate?%word%".replace(/\%word\%/g,this.Ep);
this.la("FrmSep");this.Cq()}else if(this.Ih=="encyclopedia"){this.rb("Britannica.com");this.la("EBCopyright");this.la("SearchSep")}else if(this.Ih=="thesaurus"){this.hp.capture();this.rb("\u97e6\u6c0f\u5728\u7ebf\u8bcd\u5178");this.la("MWCopyrightS");this.la("CntrSep");O("synonymlist").options[0]=new Option("","")}ft.d.N.call(this)};o.Gs=function(a,b){O(this.c(a)).innerHTML=b};
o.rJ=function(a){if(!a||!a.responseText||Ea(a.responseText).length==0){this.As("\u5f88\u62b1\u6b49\uff0c\u8be5\u8bf7\u6c42\u51fa\u9519\u3002 \u8bf7\u91cd\u8bd5\u3002");return}this.Kq();var b=a.responseText;if(b.indexOf("while(true);")==0)b=b.substr("while(true);".length);var c=ej(b),d=O("synonymlist");if(c.file=="error"){this.As("\u5f88\u62b1\u6b49\uff0c\u5728\u201c\u97e6\u6c0f\u5728\u7ebf\u8bcd\u5178\u201d\u4e2d\u6ca1\u6709\u627e\u5230\u201c"+(this.oc+"\u201d\u7684\u540c\u4e49\u8bcd\u3002"));return}else{this.Gs("SynonymsFor",
"\u201c"+(this.oc+"\u201d\u7684\u540c\u4e49\u8bcd\uff1a"));var f=c.synonyms,g=0;for(var i=0;i<f.length;i++){var l=Ea(f[i]);if(l.length>0){l=l.toLowerCase();d.options[g]=new Option(l,l);g++}}}d.options[0].selected="yes";var m=c.learnmore;if(m==h)m="http://www.britannica.com/bps/search?query=%word%".replace(/\%word\%/g,this.Ep);var n="<a target=_blank href=%link%>Learn more about %word%</a> and related topics at <a target=_blank href=%link%>Britannica.com</a>".replace(/\%link\%/g,m);n=n.replace(/\%word\%/g,
this.oc);this.Gs("LearnMore",n);this.Cq()};
o.Cy=function(a){if(!a||!a.responseText||Ea(a.responseText).length==0){this.As("\u5f88\u62b1\u6b49\uff0c\u8be5\u8bf7\u6c42\u51fa\u9519\u3002 \u8bf7\u91cd\u8bd5\u3002");return}this.Kq();O(this.c("EnyclopediaTermInput")).value=this.oc;var b=a.responseText;if(b.indexOf("while(true);")==0)b=b.substr("while(true);".length);var c=ej(b);if(c.file=="error"){O(this.c("SearchAgainPrompt")).style.display="none";this.Gs("ResultsDiv",wa("\u6ca1\u6709\u627e\u5230\u4efb\u4f55\u641c\u7d22\u7ed3\u679c\u3002",{word:this.oc}))}else{O(this.c("SearchAgainPrompt")).style.display=
"";var d=c.results;O(this.c("ResultsDiv")).innerHTML=this.DC(d)}if(B){this.G("SearchSep");this.la("SearchSep")}this.Cq()};o.DC=function(a){var b="",c=a.length;if(c>14)c=14;var d=0,f=1;while(d<c){var g=a[d];d++;var i=a[d];d++;var l=a[d];d++;b+="<b>"+f+'. </b><a id="<?cs var:Dialog.Namespace ?>link'+f+'" target="_blank" href="'+i+'">'+g+"</a><br>"+l+"<p>";f++}return b};
o.DG=function(){this.oc=O(this.c("EnyclopediaTermInput")).value;this.Is("\u5728\u201c\u4e0d\u5217\u98a0\u767e\u79d1\u5168\u4e66\u201d\u4e2d\u67e5\u627e\u201c"+(this.oc+"\u201d..."));jq(Mt,{type:"encyclopedia",word:this.oc},this.Cy.bind(this))};o.WG=function(){var a=O("synonymlist"),b=a.selectedIndex;if(b<0)return;var c=a.options[b].value;a.length=0;var d=Ot();if(!d){this.hp.restore();d=Ot();if(!d)return}Pt(d,j);if(B){var f=Qt(d);d.text=f?"":" "}else d.deleteContents();Rt(c,h,j);St();this.o(e)};
o.Is=function(a){this.G("MainDialog");O(this.c("Status")).innerHTML=a;this.la("Status");this.ua()};o.Cq=function(){this.G("Status");this.la("MainDialog");this.ua()};o.As=function(a){this.o(e);U(a)};
var Pt=function(a,b){if(!a)return"";var c=Qt(a),d=a;if(c){c=Ea(c);return c}if("toString"in d&&!A){if(!d||!d.startContainer||d.startContainer.nodeType!=3)return"";var f=0,g;while(d.startOffset>0){d.setStart(d.startContainer,d.startOffset-1);g=d.toString().charAt(0);if(g.match(/\s/)||g.match(/\W/)){d.setStart(d.startContainer,d.startOffset+1);break}f++;if(f>50)return""}var i=d.toString().length;while(d.endOffset<d.endContainer.data.length){d.setEnd(d.endContainer,d.endOffset+1);g=d.toString().charAt(i);
if(g.match(/\s/)||g.match(/\W/)){d.setEnd(d.endContainer,d.endOffset-1);break}i++;f++;if(f>50)return""}c=d.toString();if(b){He(Y).removeAllRanges();He(Y).addRange(d)}}else if("text"in d){d.expand("word");c=d.text;b&&d.select()}return c};var gt=function(){this.wa="ChangeCell";Z.call(this);this.Od=[];this.ya=e};gt.Ha(Z);
gt.prototype.N=function(){if(!gt.d.N.call(this))return;this.dc("\u66f4\u6539");this.Od=[];if(!B){var a=He(Y);if(a)for(var b=0;b<a.rangeCount;b++){var c=a.getRangeAt(b),d=c.startContainer;if(c&&d.nodeType==1)d=d.childNodes[c.startOffset];d&&d.tagName=="TD"&&this.Od.push(d)}}if(this.Od.length==0){this.Od=[Xr($,"td")];if(!this.Od[0]){U("\u8bf7\u70b9\u51fb\u8868\u683c\u5355\u5143\u683c\uff0c\u7136\u540e\u91cd\u8bd5\u3002");this.o(e);return}}this.Od.length==1?this.rb("\u66f4\u6539\u5355\u5143\u683c"):
this.rb("\u66f4\u6539\u5355\u5143\u683c");var f=this.Od[0];this.ph(f,"width","width_select","width_amt");this.ph(f,"height","height_select","height_amt");this.vg();if(!this.ya){var g=O(this.c("width_select")),i=O(this.c("height_select"));H(g,"change",this.vg.bind(this));H(i,"change",this.vg.bind(this));this.ya=j}this.ic(f,"align","halign_select","select");this.ic(f,"valign","valign_select","select");this.Re(f.getAttribute("bgcolor"),"bgcolor")};
gt.prototype.da=function(a){for(var b=0;b<this.Od.length;b++){var c=this.Od[b];this.Rh(c,"width_select","width_amt","width");this.Rh(c,"height_select","height_amt","height");var d=this.z("halign_select")||"select";this.jc(c,d,"align",this.z("halign_select")!="select");var f=this.z("valign_select")||"select";this.jc(c,f,"valign",this.z("valign_select")!="select");this.Xj(c,"bgcolor","bgcolor")}T.ra();St();gt.d.da.call(this,a)};var ht=function(){this.wa="ChangeColumn";Z.call(this);this.Ee=h;this.ya=e};ht.Ha(Z);
ht.prototype.N=function(){if(!ht.d.N.call(this))return;this.dc("\u66f4\u6539");this.Ee=Xr($,"td");if(this.Ee==h){U("\u8bf7\u70b9\u51fb\u8868\u683c\u4e2d\u7684\u67d0\u5217\uff0c\u7136\u540e\u91cd\u8bd5\u3002");this.o(e);return}this.ph(this.Ee,"width","width_select","width_amt");this.Zh("width_select","width_amt",e);if(!this.ya){var a=O(this.c("width_select"));H(a,"change",this.Zh.bind(this,"width_select","width_amt",e));this.ya=j}this.ic(this.Ee,"align","halign_select","select");this.ic(this.Ee,"valign",
"valign_select","select");this.Re(this.Ee.getAttribute("bgcolor"),"bgcolor")};ht.prototype.da=function(a){var b=Xr(this.Ee,"table");if(b!=h){var c=this.z("halign_select")||"select",d=this.z("valign_select")||"select",f=this.Ee.cellIndex;for(var g=0;g<b.rows.length;g++){var i=b.rows[g];if(f<i.cells.length){var l=i.cells[f];this.Rh(l,"width_select","width_amt","width");this.jc(l,c,"align",c!="select");this.jc(l,d,"valign",d!="select");this.Xj(l,"bgcolor","bgcolor")}}}T.ra();St();ht.d.da.call(this,a)};var it=function(){this.wa="ChangeList";Z.call(this)};it.Ha(Z);
it.prototype.N=function(){if(!it.d.N.call(this))return;this.dc("\u66f4\u6539");this.oe=Xr($,"ul","ol");if(this.oe==h){U("\u8bf7\u70b9\u51fb\u5217\u8868\uff0c\u7136\u540e\u91cd\u8bd5\u3002");this.o(e);return}if(this.oe.tagName=="OL"){this.G("bullets");this.la("numbers");this.ic(this.oe,"start","start_at","1");this.ic(this.oe,"type","number_select","decimal");this.Ir="decimal";this.Bu();var a=O(this.c("number_select"));H(a,"change",this.Bu.bind(this))}else{this.G("numbers");this.la("bullets");this.ic(this.oe,
"type","shape_select","disc")}this.ua()};it.prototype.da=function(a){if(this.oe.tagName=="OL"){var b=this.z("start_at");b=Tt(b,this.z("number_select"),"decimal");this.jc(this.oe,b,"start",b!="1");var c=this.z("number_select")||"decimal";this.jc(this.oe,c,"type",c!="decimal")}else{var d=this.z("shape_select")||"disc";this.jc(this.oe,d,"type",d!="disc")}T.ra();St();it.d.da.call(this,a)};it.prototype.Ir="decimal";
it.prototype.Bu=function(){var a=this.z("start_at");a=Tt(a,this.Ir,this.z("number_select"));this.L("start_at",a);this.Ir=this.z("number_select")||"decimal"};
var Tt=function(a,b,c){var d=parseInt(a,10);if(isNaN(d))d=b=="I"||b=="i"?Ut(a):b=="A"||b=="a"?Vt(a):0;d=Math.max(1,Math.round(d));if(c=="decimal")return d;else if(c=="I")return Wt(d,j);else if(c=="i")return Wt(d,e);else if(c=="A")return Xt(d,j);else if(c=="a")return Xt(d,e);return 1},Yt="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Vt=function(a){a=a.toUpperCase();var b=0;for(var c=0;c<a.length;c++){var d=Yt.indexOf(a.charAt(c))+1;if(d){b*=26;b+=d}}return b},Xt=function(a,b){a=typeof a!="number"||a<1?0:Math.floor(a);
var c="";while(a>0){var d=a%26;if(d==0)d=26;c=Yt.charAt(d-1)+c;a-=d;a/=26}return b?c:c.toLowerCase()},Ut=function(a){a=a.toUpperCase();var b=0;for(var c=0;c<a.length;c++){var d=a.charAt(c),f=a.charAt(c+1);if(d=="M")b+=1000;else if(d=="D")b+=500;else if(d=="C"&&f=="M"){b+=900;c++}else if(d=="C"&&f=="D"){b+=400;c++}else if(d=="C")b+=100;else if(d=="L")b+=50;else if(d=="X"&&f=="C"){b+=90;c++}else if(d=="X"&&f=="L"){b+=40;c++}else if(d=="X")b+=10;else if(d=="V")b+=5;else if(d=="I"&&f=="X"){b+=9;c++}else if(d==
"I"&&f=="V"){b+=4;c++}else if(d=="I")b+=1;else return 0}return b},Wt=function(a,b){a=typeof a!="number"||a<1?0:Math.floor(a);var c="";while(a>0)if(a>=1000){c+="M";a-=1000}else if(a>=900){c+="CM";a-=900}else if(a>=500){c+="D";a-=500}else if(a>=400){c+="CD";a-=400}else if(a>=100){c+="C";a-=100}else if(a>=90){c+="XC";a-=90}else if(a>=50){c+="L";a-=50}else if(a>=40){c+="XL";a-=40}else if(a>=10){c+="X";a-=10}else if(a>=9){c+="IX";a-=9}else if(a>=5){c+="V";a-=5}else if(a>=4){c+="IV";a-=4}else if(a>=1){c+=
"I";a-=1}return b?c:c.toLowerCase()};var jt=function(){this.wa="ChangeRow";Z.call(this)};jt.Ha(Z);
jt.prototype.N=function(){if(!jt.d.N.call(this))return;this.dc("\u66f4\u6539");this.se=Xr($,"tr");if(this.se==h){U("\u8bf7\u70b9\u51fb\u8868\u683c\u4e2d\u7684\u67d0\u884c\uff0c\u7136\u540e\u91cd\u8bd5\u3002");this.o(e);return}this.ph(this.se,"height","height_select","height_amt");this.Zh("height_select","height_amt",e);if(!this.ya){var a=O(this.c("height_select"));H(a,"change",this.Zh.bind(this,"height_select","height_amt",e));this.ya=j}this.ic(this.se,"align","halign_select","select");this.ic(this.se,
"valign","valign_select","select");this.Re(this.se.getAttribute("bgcolor"),"bgcolor")};jt.prototype.da=function(a){this.Rh(this.se,"height_select","height_amt","height");var b=this.z("halign_select")||"select";this.jc(this.se,b,"align",b!="select");var c=this.z("valign_select")||"select";this.jc(this.se,c,"valign",c!="select");this.Xj(this.se,"bgcolor","bgcolor");T.ra();St();jt.d.da.call(this,a)};var lt=function(){this.wa="CommentSettings";Z.call(this)};lt.Ha(Z);lt.prototype.da=function(a){Zt(this.qa("ColorAll"),this.qa("SaveColor"));T.ra();St();lt.d.da.call(this,a)};var kt=function(){this.wa="CSSEdit";Z.call(this)};kt.Ha(Z);kt.prototype.N=function(){if(!kt.d.N.call(this))return;this.L("CSSText",Eq("css_style"));O(this.c("CSSText")).focus();this.Ab.Lz(e)};kt.prototype.da=function(a){var b=new tc;b.h("stylesheet",this.z("CSSText"));b.h("updateStyleSheets",j);b.h("docID",docID);iq("setstylesheet",b,this.Bh.bind(this),"postCssContents_"+docID);kt.d.da.call(this,a)};
kt.prototype.Bh=function(a){if(!ws(a)){if(a.responseText){var b=a.responseText.replace("while(true);","");if(b.replace(/\s/g,"")!=""){b=ej(b);b.css_style&&X("css_style",b.css_style);b.stylesheet&&X("stylesheet",b.stylesheet);b.styles!=h&&X("styles",b.styles)}}if(typeof er!="undefined"&&($t=="edit"||$t=="insert"))au()}};var bu=function(a,b,c,d){this.Fq=a;this.Qj=b;this.sm=typeof c=="undefined"?j:!!c;this.XH=!!d;this.Hp=e;this.Gq=[];this.AA=[];this.Dr=[];this.Er=[];this.gs=[];this.nt=[];this.qf=[];this.wk=[];this.Wh=[];this.$g=[];this.Df=[];this.pf=[]},cu="address|br|div|hr|p|pre|h1|h2|h3|h4|h5|h6|table|tbody|tfoot|td|th|thead|tr|dl|ul|ol|menu",du=new RegExp("(\\s*<\\/?("+cu+")[^>]*>\\s*)+","ig"),eu=new RegExp("(\\s*(<\\/?("+(cu+"|blockquote|li|dt|dd")+")[^>]*>|[\\.!\\?])\\s*)+","ig"),fu=/[\s\,\!\?\"\\\/\@\&\*\+\|\=\^\<\>\(\)\[\]\{\}]+/g;
o=bu.prototype;o.vc=function(){return this.Pe(1)>1};o.hq=function(a,b){var c=a.replace(b,"<p>");c=c.replace(/(<p>)+/g,"<p>");c=c.replace(/^<p>/,"");c=c.replace(/<p>$/,"");return c.split("<p>").length};o.Ul=function(a){if(this.Dr[a]==h){var b;if(a==1){b=this.Qj.gc().lN;if(typeof b=="undefined"){var c=this.Qj.Q().parentNode,d=this.Qj.ha().parentNode;b=Wf(d).y+d.offsetHeight-Wf(c).y}}else b=this.Fq.scrollHeight;var f=Math.min(this.Fq.scrollWidth,1000);this.Dr[a]=Math.ceil(b*f/800000)}return this.Dr[a]};
o.Vl=function(a){if(this.Er[a]==h)this.Er[a]=this.hq(this.dq(a),du);return this.Er[a]};o.Nf=function(a){if(this.gs[a]==h)this.gs[a]=this.hq(this.dq(a),eu);return this.gs[a]};o.Pe=function(a){if(this.nt[a]==h)this.nt[a]=this.XH?this.ih(a):this.hq(this.nb(a),fu);return this.nt[a]};
var gu=function(a){a=a.replace(/(<[^>]+>)/g," ");a=a.replace(/&nbsp;/g," ");a=a.replace(/&#12288;/g," ");a=a.replace(/&#x3000;/g," ");a=a.replace(/&[#\w]+;/g,"_");a=a.replace(/\s+/g," ");a=a.replace(/^ /,"");a=a.replace(/ $/,"");return a};o=bu.prototype;o.dq=function(a){if(this.Gq[a]==h)this.Gq[a]=a==1?this.Qj.fh():this.Fq.innerHTML;return this.Gq[a]};o.nb=function(a){var b=this.AA[a];if(b==h){b=a==1?this.Qj.nb():this.dq(a);b=gu(b);this.AA[a]=b}return b};
o.Wv=function(a){if(this.qf[a]==h)this.qf[a]=this.nb(a).length;this.Hp=this.qf[0]&&this.qf[1]&&this.qf[0]==this.qf[1];return this.qf[a]};o.ih=function(a){if(this.wk[a]==h){var b=this.nb(a).replace(/\s+/g,"");this.wk[a]=b.length;if(this.Hp)this.wk[1]=this.wk[0]}return this.wk[a]};
o.xw=function(a){if(!this.Wh[a])if(this.sm){var b=this.nb(a);b=" "+b+" ";b=b.replace(/(ed|e|)\s+/ig," ");b=b.replace(/[^ aeiouy]*[aeiouy]+[^ aeiouy]*/ig,"e");b=b.replace(/ee/g,"e e");b=b.replace(/ee/g,"e e");if(b&&b.charAt(0)==" ")b=b.substring(1);if(b&&b.charAt(b.length-1)==" ")b=b.substring(0,b.length-1);this.Wh[a]=b.split(" ").length;if(this.Hp)this.Wh[1]=this.Wh[0]}else this.Wh[a]="-";return this.Wh[a]};
o.jw=function(a){if(this.$g[a]==h)if(this.sm){var b=this.Pe(a),c=b/this.Nf(a),d=this.xw(a)/b;this.$g[a]=206.835-1.015*c-84.6*d;this.$g[a]=Math.max(0,this.$g[a])}else this.$g[a]="-";return this.$g[a]};o.iw=function(a){if(this.Df[a]==h)if(this.sm){var b=this.Pe(a),c=b/this.Nf(a),d=this.xw(a)/b;this.Df[a]=0.39*c+11.8*d-15.59;if(F)this.Df[a]*=1.01;this.Df[a]=Math.round(Math.max(0,this.Df[a]))}else this.Df[a]="-";return this.Df[a]};
o.Qv=function(a){if(this.pf[a]==h)if(this.sm){var b=this.Pe(a),c=b/this.Nf(a),d=this.ih(a)/b;this.pf[a]=4.71*d+0.5*c-21.43;if(F)this.pf[a]*=1.02;this.pf[a]=Math.round(Math.max(0,this.pf[a]))}else this.pf[a]="-";return this.pf[a]};var mt=function(){this.wa="DocSettings";Z.call(this)};mt.Ha(Z);o=mt.prototype;
o.N=function(){if(!mt.d.N.call(this))return;if(!this.ya){var a=O(this.c("yesStyles")),b=O(this.c("noStyles"));H(a,"click",this.Bs.bind(this));H(b,"click",this.Bs.bind(this));var c=O(this.c("fontNameSel")),d=O(this.c("fontSizeSel")),f=O(this.c("paraSpacingSel"));H(c,"change",this.vp.bind(this));H(d,"change",this.vp.bind(this));H(f,"change",this.vp.bind(this));this.ya=j;var g=[],i;for(i in SITE_LANG_FONTS){if(!i||!SITE_LANG_FONTS[i])continue;var l=document.createElement("OPTION");l.value=SITE_LANG_FONTS[i];
l.innerHTML=i;g.unshift(l)}for(i=0;i<g.length;i++)c.insertBefore(g[i],c.firstChild)}if(W("usestylesheet"))O(this.c("yesStyles")).checked=j;else O(this.c("noStyles")).checked=j;O(this.c("rtlSetting")).checked=W("rtl");O(this.c("makeDefault")).checked=W("makedefault");var c=Eq("fontname");c&&this.L("fontNameSel",c);var d=Eq("fontsize");d&&this.L("fontSizeSel",d);var f=Eq("linespacing");if(f=="normal")f="";f&&this.L("paraSpacingSel",f);this.Re(String(Eq("bgcolor")),"docBgColor");this.Bs()};
o.da=function(a){var b=new tc,c=this.qa("yesStyles");b.h("usesSS",c);b.h("makeDefault",this.qa("makeDefault"));b.h("updateStyleSheets",j);if(c){b.h("face",this.Ca("fontNameSel"));b.h("size",this.Ca("fontSizeSel"));b.h("spacing",this.Ca("paraSpacingSel"));b.h("rtl",this.qa("rtlSetting"));var d=this.Qi(O(this.c("docBgColor")));b.h("bgColor",d)}b.h("docid",docID);iq("save_doc_settings",b,this.Bh.bind(this));a.preventDefault()};
o.vp=function(){var a=O(this.c("preview"));a.style.fontFamily=this.Ca("fontNameSel");a.style.fontSize=this.Ca("fontSizeSel")+"pt";a.style.lineHeight=this.Ca("paraSpacingSel");a.style.backgroundColor=this.Qi(O(this.c("docBgColor")))};o.Bs=function(){var a=this.qa("yesStyles");gr(O(this.c("docSettingsTable")),a);if(a){var b=O(this.c("docBgColor")),c=this.Qi(b);this.ms(b,c)}};
o.Bh=function(a){if(!a||ws(a)){U("\u65e0\u6cd5\u4fdd\u5b58\u5728\u7ebf\u6587\u6863\u8bbe\u7f6e\u3002");this.o(e);return}if(a.responseText){var b=a.responseText.replace("while(true);","");if(b.replace(/\s/g,"")!=""){b=ej(b);b.stylesheet&&X("stylesheet",b.stylesheet);b.styles&&X("styles",b.styles)}}X("usestylesheet",O(this.c("yesStyles")).checked);var c=this.Ca("fontNameSel");c&&X("fontname",c);var d=this.Ca("fontSizeSel");d&&X("fontsize",d);var f=this.Ca("paraSpacingSel");f&&X("linespacing",f);X("rtl",
O(this.c("rtlSetting")).checked);var g=this.Qi(O(this.c("docBgColor")));X("bgcolor",g);X("makedefault",O(this.c("makeDefault")).checked);this.o(e);au()};var nt=function(){this.wa="EditHtmlSelection";Z.call(this)};nt.Ha(Z);nt.prototype.N=function(){if(!nt.d.N.call(this))return;O(this.c("htmlSnippet")).focus()};nt.prototype.da=function(a){var b=O(this.c("htmlSnippet")).value||"";if(b)b=Ea(b);if(b){Rt(b,h,j);St()}this.L("htmlSnippet","");nt.d.da.call(this,a)};nt.prototype.Ah=function(a){this.L("htmlSnippet","");nt.d.Ah.call(this,a)};var ot=function(){this.wa="EmailDocument";Z.call(this);this.vr=h;this.rr=0};ot.Ha(Z);o=ot.prototype;
o.N=function(a){if(!ot.d.N.call(this,j))return;if(W("isshared")==j&&window.NewFolks==h&&!a){this.jF();return}this.vr=h;if(!this.ya){var b=O(this.c("tab0")),c=O(this.c("tab1")),d=O(this.c("tab2")),f=O(this.c("includeAsDocInBody")),g=O(this.c("includeAsAttachment")),i=O(this.c("checkAllC")),l=O(this.c("checkNoneC")),m=O(this.c("checkAllV")),n=O(this.c("checkNoneV"));H(b,"click",this.kg.bind(this,0,e));H(c,"click",this.kg.bind(this,1,e));H(d,"click",this.kg.bind(this,2,e));H(f,"click",function(){O("EmailDocumentattachmentSelect").setAttribute("disabled",
j)});H(g,"click",function(){O("EmailDocumentattachmentSelect").removeAttribute("disabled")});H(i,"click",this.Wk.bind(this,j,"c"));H(l,"click",this.Wk.bind(this,e,"c"));H(m,"click",this.Wk.bind(this,j,"v"));H(n,"click",this.Wk.bind(this,e,"v"));this.ya=j;var q=[b,c,d,i,l,m,n],r=function(){return e};for(var t=0;t<q.length;t++)q[t].onclick=r}document.forms[this.c("EmailForm")].reset();O(this.c("attachmentSelect")).removeAttribute("disabled");this.pz("\u53d6\u6d88");this.dc("\u53d1\u9001");this.Ab.Lz(e);
this.o(j);this.la("tabRow");this.rb("\u7535\u5b50\u90ae\u4ef6\u5728\u7ebf\u6587\u6863");this.MH(window.NewFolks,window.SendDocument);document.forms[this.c("EmailForm")].reset();this.L("subject",Eq("title"));O(this.c("CCme")).checked=V("ccme");var v=new Qk(SERVER_BASE,"writely");v.ts(Cq("language"));var x=O(this.c("toanytext"));try{v.uo(x,{groups:j,implicitGroups:j,extendedInterface:j});O(this.c("email_picker_link")).onclick=function(J){v.jr(x,J);return e}}catch(C){}};
o.MH=function(a,b){this.G("newFolksRow");if(a){this.kg(0,j);this.vr=a;a=Mr(Ea(a));a=Na(a);a=a.replace(/,+$/,"");O(this.c("newFolksCell")).innerHTML=a;this.G("toAny");this.G("tabRow");this.la("newFolksRow");this.rb("\u662f\u5426\u8981\u5c06\u6b64\u5728\u7ebf\u6587\u6863\u901a\u77e5\u8fd9\u4e9b\u4eba\uff1f");this.pz("\u8df3\u8fc7\u53d1\u9001\u9080\u8bf7")}else if(!W("isshared")||b)!W("ispublished")||b?this.kg(2):this.kg(1);else this.kg(0)};
o.kg=function(a,b){if(a==0&&!W("isshared")&&!b){if(zq("\u6b64\u6587\u6863\u5c1a\u672a\u5171\u4eab\u3002\u8981\u73b0\u5728\u5171\u4eab\u5b83\u5417\uff1f\u70b9\u51fb\u201c\u786e\u5b9a\u201d\u4ee5\u5173\u95ed\u6b64\u7a97\u53e3\u5e76\u5207\u6362\u5230\u201c\u534f\u4f5c\u201d\u9009\u9879\u5361\u3002")){hu("share");this.o(e)}return}if(a==1&&!W("ispublished")&&!b){if(zq('\u6b64\u5728\u7ebf\u6587\u6863\u5c1a\u672a\u53d1\u5e03\u3002 \u8981\u73b0\u5728\u53d1\u5e03\u5b83\u5417\uff1f \u70b9\u51fb"\u786e\u5b9a"\u4ee5\u5173\u95ed\u6b64\u7a97\u53e3\u5e76\u5207\u6362\u5230"\u53d1\u5e03"\u9009\u9879\u5361\u3002')){hu("publish");
this.o(e)}return}this.rr=a;for(var c=0;c<3;c++)if(a==c){this.G("d"+c+"it");this.la("d"+c+"at")}else{this.la("d"+c+"it");this.G("d"+c+"at")}switch(a){case 0:this.G("toAny");this.G("includeDocAs");O(this.c("cbc0"))&&this.la("toControlList_c");O(this.c("cbv0"))&&this.la("toControlList_v");this.la("linkIncluded");this.G("pubLinkIncluded");this.la("includeEntireDoc");O(this.c("msg")).focus();break;case 1:this.la("toAny");this.G("newFolksRow");this.G("includeDocAs");this.G("toControlList_c");this.G("toControlList_v");
this.G("linkIncluded");this.la("pubLinkIncluded");this.G("includeEntireDoc");O(this.c("toAny")).focus();break;case 2:this.la("toAny");this.G("newFolksRow");this.la("includeDocAs");this.G("toControlList_c");this.G("toControlList_v");this.G("linkIncluded");this.G("pubLinkIncluded");this.G("includeEntireDoc");O(this.c("toAny")).focus()}};
o.da=function(a){var b=new tc;b.h("docID",docID);var c=!!window.NewFolks,d="";if(c)d=this.vr;else if(this.rr==0){d=this.lw("c")+this.lw("v");if(Ea(d)==""){U("\u8bf7\u9009\u62e9\u6b64\u6d88\u606f\u7684\u53d1\u9001\u5bf9\u8c61\u3002",e);a.preventDefault();return}}else{d=this.z("toanytext");var f=O(this.c("toanytext"));if(Ea(d)==""){U("\u8bf7\u9009\u62e9\u6b64\u6d88\u606f\u7684\u53d1\u9001\u5bf9\u8c61\u3002",e);a.preventDefault();return}var g;if(g=this.KM(d)){U(g,f);a.preventDefault();return}}b.h("users",
d);var i=this.z("msg");if(V("promptEmptyMsg")==j&&!i&&!zq("\u9664\u975e\u60a8\u5728\u8fd9\u91cc\u8f93\u5165\u4e00\u4e2a\uff0c\u5426\u5219\u90ae\u4ef6\u4e2d\u4e0d\u4f1a\u5305\u542b\u60a8\u7684\u4e2a\u4eba\u6ce8\u89e3\u3002 \u662f\u5426\u7ee7\u7eed\uff1f")){a.preventDefault();return}i&&b.h("msg",i);var l=this.z("subject");l||(l=Eq("title"));b.h("subject",l);var m=this.qa("CCme");Lq("ccme",m);m&&b.h("cc",m);var n=e;switch(this.rr){case 0:b.h("function","message");n=this.qa("includeDocInBody");break;
case 1:b.h("function","publink");break;case 2:b.h("function","document");b.h("code",this.Ca("attachmentSelect"));n=this.qa("includeAsDocInBody");break}n&&b.h("inc",j);iu(b,c);ot.d.da.call(this,a)};o.Ah=function(){!!window.NewFolks&&us();ot.d.Ah.call(this)};o.KM=function(a){var b=Kt(a);for(var c=0,d;d=b[c];c++){var f;if(f=Lt(d[1]))return f}return h};
var iu=function(a,b){Rq("send_email");ps("\u6b63\u5728\u53d1\u9001\u6d88\u606f...");iq("sendvalidemail",a,b?function(c,d){ju(c,d,a)}:function(c,d){ku(c,d,a)},"EmailDocument")},lu=function(a,b,c){rs();if(!a||b){U("\u53d1\u9001\u7535\u5b50\u90ae\u4ef6\u65f6\u51fa\u9519\u3002\u8bf7\u91cd\u8bd5\u3002");return}if(a.responseText){var d=ej(a.responseText);if(d.warning){if(zq(d.warning)){c.h("ignore_warnings",j);iu(c,e)}}else d.error&&U(d.error)}},ju=function(a,b,c){lu(a,b,c);us();Tq("send_email")},ku=function(a,
b,c){lu(a,b,c);Tq("send_email")};ot.prototype.jF=function(){iq("getcollaborators",{docid:uq()},this.cJ.bind(this),"GetCollaborators")};
ot.prototype.cJ=function(a,b){if(a&&!b){var c=a.responseText;c=c.replace("while(true);","");c=ej(c);var d='<nobr><input type="checkbox" checked value="_EMAIL_" id="_ID_"><label for="_ID_">_NAME_</label></nobr>&nbsp; &nbsp;',f=[{id:"c",Rn:c.collaborators},{id:"v",Rn:c.viewers}],g=new Oe;for(var i=0;i<f.length;i++){var l=f[i];g.clear();for(var m=0;m<l.Rn.length;m++){var n=l.Rn[m],q=d.replace(/_EMAIL_/g,n.email);q=q.replace(/_NAME_/g,n.name);q=q.replace(/_ID_/g,this.wa+"cb"+l.id+m);g.Y(q)}var r=O(this.c(l.id+
"TD"));if(l.Rn.length>0)r.innerHTML=g.toString()}}this.N(j)};ot.prototype.lw=function(a){var b=new Oe,c=0,d=O(this.c("cb"+a+c));while(d){d.checked&&b.Y(d.value+"; ");if(++c>1000)break;d=O(this.c("cb"+a+c))}return b.toString()};ot.prototype.Wk=function(a,b){var c=0,d=O(this.c("cb"+b+c));while(d){d.checked=a;if(++c>1000)break;d=O(this.c("cb"+b+c))}};var pt=function(){this.wa="FindReplace";Z.call(this);this.lK=j};pt.Ha(Z);pt.prototype.N=function(){if(!pt.d.N.call(this))return;this.dc("\u5168\u90e8\u66ff\u6362");if(mu){this.L("findText",mu);mu=""}else{this.L("findText","");this.L("txtReplace","")}O(this.c("findText")).focus()};
pt.prototype.da=function(a){var b=this.z("findText"),c=this.z("txtReplace"),d=O(this.c("findText"));if(!b){U("\u8bf7\u8f93\u5165\u8981\u641c\u7d22\u7684\u6587\u672c\u3002",d);a.preventDefault();return}if(b==c){U("\u8981\u67e5\u627e\u7684\u6587\u672c\u4e0e\u66ff\u6362\u5b83\u7684\u6587\u672c\u76f8\u540c\u3002 \u8bf7\u66f4\u6539\u5b83\u4eec\u4e4b\u4e2d\u7684\u4e00\u4e2a\u3002",d);a.preventDefault();return}var f=this.qa("chkCase")?"g":"gi",g=b;this.qa("regex")||(g=g.replace(/([^a-zA-Z0-9])/g,"\\$1"));
if(this.qa("chkWord"))g="\\b"+g+"\\b";var i=0;i=this.Jj(Y.document.body,new RegExp(g,f),c,this.lK,i);var l="\u5f88\u62b1\u6b49\uff0c\u627e\u4e0d\u5230\u201c"+(b+"\u201d\u3002 \u8bf7\u91cd\u8bd5\u3002"),m="\u201c"+(b+("\u201d\u5df2\u66ff\u6362\u4e3a\u201c"+(c+"\u201d\u3002")));i==0?U(l):U(m);T.ra();pt.d.da.call(this,a)};
pt.prototype.Jj=function(a,b,c,d,f){for(var g=0;g<a.childNodes.length;g++){var i=a.childNodes[g];if(i.nodeType==3){var l=i.nodeValue.replace(b,c);if(i.nodeValue!=l){f++;i.nodeValue=l;i.nodeValue.replace(b,c);if(!d)return f}}f=this.Jj(i,b,c,d,f)}return f};var qt=function(){this.wa="InsertBookmark";Z.call(this)};qt.Ha(Z);o=qt.prototype;o.N=function(){if(!qt.d.N.call(this))return;this.dc("\u63d2\u5165");this.Cv(Y.document,"otherBookmarks",e);this.L("bookmarkname",Nr(nu));O(this.c("bookmarkname")).focus();if(!this.ya){var a=O(this.c("removeBookmark")),b=O(this.c("otherBookmarks"));H(a,"click",this.$J.bind(this));H(b,"change",this.AM.bind(this));this.ya=j}};
o.da=function(a){var b=O(this.c("bookmarkname"));b.value=b.value.replace(/[_&<>\r\n\"]+/g,"_");var c=h;if(b.value=="")c="\u8bf7\u8f93\u5165\u4e66\u7b7e\u540d\u3002";if(this.wC(b.value))c="\u5728\u7ebf\u6587\u6863\u4e2d\u5df2\u5b58\u5728\u4f7f\u7528\u6b64\u540d\u79f0\u7684\u4e66\u7b7e\u3002 \u8bf7\u9009\u62e9\u5176\u4ed6\u540d\u79f0\u3002";if(c){U(c,b);a.preventDefault();return}var d=js(),f='<a id="'+d+'" name="'+Nr(b.value)+'"></a>';Rt(f,d,j);St();qt.d.da.call(this,a)};
o.wC=function(a){var b=Y.document.getElementsByTagName("a");for(var c=0,d;d=b[c];c++)if(d.name==a)return j;return e};o.AM=function(){this.z("otherBookmarks")?O(this.c("removeBookmark")).removeAttribute("disabled"):O(this.c("removeBookmark")).setAttribute("disabled",j)};o.$J=function(){var a=this.z("otherBookmarks");if(!a)return;var b=Y.document.getElementsByTagName("a");for(var c=0,d;d=b[c];c++)if(d.name==a){d.parentNode.removeChild(d);St();this.o(e);return}};var rt=function(){this.wa="InsertChar";Z.call(this);this.yx=e;this.ef(new Uh)};rt.Ha(Z);o=rt.prototype;
o.N=function(){if(!rt.d.N.call(this))return;var a=O("insert-char-form").R1;if(!this.yx){for(var b=0;b<a.length;b++)H(a[b],"click",this.GL,e,this);var c=O(this.c("uniplus")),d=O(this.c("uniminus")),f=O(this.c("univalue")),g=O(this.c("uniok"));H(c,"click",this.tx.bind(this,1));H(d,"click",this.tx.bind(this,-1));H(f,"keyup",this.ug,e,this);H(g,"click",this.Bx.bind(this,h));this.KH();this.JH();this.yx=j}this.G("ac");this.G("ad");if(B||E&&"contentEditable"in window.document.body)this.G("wd");else{this.G("selector1");
this.G("selector2")}for(var b=0;b<a.length;b++)a[b].checked&&this.iA(a[b])};o.KH=function(){var a=Rd("TD");for(var b=0;b<a.length;b++){var c=a[b];if(c.className=="insertchar-sc"||c.className=="insertchar-wd"){c.innerHTML=String.fromCharCode(c.innerHTML);H(c,"mouseover",this.By,e,this);H(c,"mouseout",this.Ay,e,this);H(c,"click",this.zy,e,this)}}};
o.JH=function(){var a=Rd("TD","insertchar-ac"),b="&#12539;&#215;&#12304;&#12305;&#12302;&#12303;&#12298;&#12299;&#8220;&#8221;&#12300;&#12301;&#12296;&#12297;&#8810;&#8811;&#65378;&#65379;&#65308;&#65310;&#8216;&#8217;&#12308;&#12309;&#12849;&#13261;&#65374;&#13069;&#65292;&#12291;&#20189;&#12445;&#12446;&#12293;&#12306;&#8251;&#8243;&#13076;&#13199;&#13214;&#8786;&#13080;&#9733;&#9679;&#12966;&#8251;&#9650;&#9661;&#9651;&#9660;&#8895;&#9671;&#9670;&#9633;&#9632;&#8595;&#12294;&#9839;&#65295;&#65340;&#13180;&#12964;&#9734;&#9675;&#167;&#13213;&#13090;&#13213;&#65504;&#13091;&#13181;&#12857;&#8224;&#12443;&#8741;&#65372;&#8242;&#8243;&#8451;&#65509;&#8491;&#65504;&#65505;&#65285;&#8240;&#65284;&#176;&#12965;&#8481;&#176;&#8451;&#13095;&#8757;&#8229;&#8470;&#9678;&#65285;&#13099;&#215;&#12444;&#12967;&#13179;&#13217;&#13217;&#13110;&#13115;&#13115;&#8251;&#65294;&#65377;&#12290;&#12968;&#13212;&#13129;&#13198;&#13130;&#13212;&#8734;&#13133;&#13182;&#12850;&#8756;&#65374;&#13137;&#13143;&#12800;&#12801;&#12802;&#12803;&#12804;&#12805;&#12806;&#12807;&#12808;&#12814;&#12815;&#12816;&#12817;&#12818;&#12819;".split(";"),c=
Math.min(a.length,b.length);for(var d=0;d<c;d++){var f=a[d];f.innerHTML=b[d];H(f,"mouseover",this.By,e,this);H(f,"mouseout",this.Ay,e,this);H(f,"click",this.zy,e,this)}};o.By=function(a){a.target.style.border="1px solid #ACA899"};o.Ay=function(a){a.target.style.border="1px solid #EBE8D7"};o.zy=function(a){var b=a.target.innerHTML;if(a.target.className=="insertchar-wd")b='<font face="Wingdings">'+b+"</font>";this.Bx(b)};
o.Bx=function(a){if(!a)try{a=O(this.c("preview")).innerHTML}catch(b){}if(a){Rt(a,h,j);St();this.o(e)}};o.GL=function(a){this.iA(a.target)};o.iA=function(a){this.G("sc");this.G("ac");this.G("wd");this.G("ad");this.la(String(a.value));a.value=="ad"?this.G("explain"):this.la("explain");this.ug();this.ua()};o.tx=function(a){var b=Ar(this.z("univalue"));if(isNaN(b)||b<0)b=215;else{b=b+a;if(b<33)b=33;else if(b>1114111)b=1114111}this.L("univalue",String(b));this.ug()};
o.ug=function(){var a=Ar(this.z("univalue"));if(!isNaN(a)&&33<=a&&a<=1114111)O(this.c("preview")).innerHTML="&#"+a+";";else O(this.c("preview")).innerHTML="?"};var st=function(){this.wa="InsertImage";Z.call(this)};st.Ha(Z);var ou="InsertImage",pu=h,qu=h,ru=h,su=h,tu={};var uu=function(a){su=a};
st.prototype.N=function(){if(!st.d.N.call(this))return;vu("Working");O(this.c("ImageForm")).reset();var a=O(this.c("ImageOptionsForm"));a.reset();if($){var b=$;if(!b||b.tagName!="IMG")try{wu();b=$}catch(c){}if(b&&b.tagName&&b.tagName.toLowerCase()=="img"){this.rb("\u66f4\u6539\u56fe\u7247");this.dc("\u66f4\u6539");vu("Upload");vu("Toggle");xu("ImageOptions");this.PH(yu($))}}else{this.rb("\u63d2\u5165\u56fe\u50cf");this.dc("\u63d2\u5165");zu();ru=e;Au();xu("Upload");xu("UploadImageFormDiv");vu("URLImageFormDiv");
xu("Toggle");O(this.c("FileUpload")).checked=j;O(this.c("UrlUpload")).checked=e;var a=O(this.c("ImageOptionsForm"));a.ShowOptions.value=="true"&&Nu()}this.ua()};var Ou=function(){zu();O(ou+"FileUpload").checked=e;xu("URLImageFormDiv");vu("UploadImageFormDiv");O(ou+"ImageOptionsForm").reset();O(ou+"ImageURL").value=""},Pu=function(){zu();O(ou+"UrlUpload").checked=e;vu("URLImageFormDiv");xu("UploadImageFormDiv");O(ou+"ImageForm").reset();O(ou+"ImageOptionsForm").reset()};
st.prototype.PH=function(a){var b=O(this.c("ImageOptionsForm"));if(!a.width||a.width=="auto"){b.ImageWidth.value="original";b.ImageWidthPx.value=""}else{var c=/([\d.]+)(%|e[mx]\b|p[xtc]\b|in\b|[cm]m\b)/i.exec(a.width),d=c[1]?parseFloat(c[1]):h,f=c[2]?c[2].toLowerCase():h;if(!isNaN(d))if(!f||f=="px"){b.ImageWidth.value="custom";b.ImageWidthPx.value=d}else if(f=="%"){b.ImageWidth.value="fit";b.ImageWidthPx.value=""}else{b.ImageWidth.value="original";b.ImageWidthPx.value=""}}Au();if(a.align)b.ImagePosition.value=
a.align;b.WrapText.checked=a.Jd;Qu();b.LinkImage.checked=a.Bj};
st.prototype.da=function(a){if($&&$.tagName&&$.tagName=="IMG"){this.tM($);st.prototype.sz();$=h;if(B){su.collapse();su.select()}}else if(O(this.c("FileUpload")).checked){zu();a.preventDefault();var b=O(this.c("ImageForm")),c=b.ImageFile.value;if(c==h||c.length==0){U(Ru,b.ImageFile);vu("Working");b.reset();return}else if(B&&(c.length<2||!/^(\\\\|\w:)/i.test(c))){U(Ru,b.ImageFile);vu("Working");b.reset();return}else{b.action=DasherizeURL("Dialogs/ImageUploader?DocID="+encodeURIComponent(uq()));xu("Working");
var d=new kn;H(d,yj,this.uJ.bind(this));H(d,zj,this.Py.bind(this));H(d,Aj,this.Py.bind(this));d.KK(b)}}else{a.preventDefault();var f=O(ou+"ImageURL"),g=f.value;if(Ea(g).length==0){U("\u8bf7\u9009\u62e9\u6709\u6548\u7684\u7f51\u5740\u56fe\u50cf\u6587\u4ef6\u3002",f);return}else{xu("Working");var i=new Xh("Dialogs/UrlImageUploader");i.ea("DocID",uq());hq(i,{urlimagesrc:g},this.JM.bind(this))}}st.d.da.call(this,a)};
st.prototype.JM=function(a){if(!a){U(Su+" (1)");this.xa();return}var b=h;try{var c=a.responseText;if(c.indexOf("while(true);")==0)c=c.substr("while(true);".length);b=ej(c)}catch(d){U(Su+" (2)");this.xa()}if(b)if(b.type=="ok"){if(b.details!=h){this.Hq=b.details;pu=this.Hq.fileName;this.ew(pu,this.Mq);this.xa()}this.xa()}else{var f=O(this.c("ImageURL"));if(b.details&&b.details=="Invalid File Type"){U("\u8bf7\u9009\u62e9\u6709\u6548\u7684\u7f51\u5740\u56fe\u50cf\u6587\u4ef6\u3002",f);vu("Working");f.value=
""}else{U(b.details||Su+" (3)");vu("Working");f.value="";this.xa()}}else{U(Su+" (4)");this.xa()}zu()};var vu=function(a){O(ou+a).style.display="none"},xu=function(a){O(ou+a).style.display=""};
st.prototype.tM=function(a){var b=O(this.c("ImageOptionsForm")),c=yu(a),d=this.IC(b.ImageWidth.value,b.ImageWidthPx.value,c.naturalWidth,c.naturalHeight);if(d.width!=c.width)a.style.width=d.width;if(d.height!=c.height)a.style.height=d.height;a.removeAttribute("width");a.removeAttribute("height");var f=c.ze;if(b.LinkImage.checked!=c.Bj)if(b.LinkImage.checked){f=a.ownerDocument.createElement("a");f.href=a.src;f.target="_blank";a.parentNode.insertBefore(f,a);f.appendChild(a)}else{var g;while(g=c.ze.firstChild){if(g.parentNode!=
c.ze)break;c.ze.parentNode.insertBefore(c.ze.removeChild(g),c.ze)}c.ze.parentNode.removeChild(c.ze);f=h}if(!c.Jd&&!b.WrapText.checked&&c.align!=b.ImagePosition.value){c.Nc.style.textAlign=b.ImagePosition.value;a.style.cssFloat="";a.style.styleFloat=""}else if(c.Jd&&(!b.WrapText.checked||b.ImagePosition.value=="center")){var i=a.ownerDocument.createElement("div");i.style.textAlign=b.ImagePosition.value;if(f){f.parentNode.insertBefore(i,f);i.appendChild(f)}else{a.parentNode.insertBefore(i,a);i.appendChild(a)}a.style.cssFloat=
"";a.style.styleFloat="";a.style.marginTop="";a.style.marginBottom="";a.style.marginLeft="";a.style.marginRight="";i.style.paddingTop="1em";i.style.paddingBottom="1em";i.style.paddingLeft="0";i.style.paddingRight="0"}else if(!c.Jd&&b.WrapText.checked&&b.ImagePosition.value!="center"){if(c.Nc){var g;while(g=c.Nc.firstChild){if(g.parentNode!=c.Nc)break;c.Nc.parentNode.insertBefore(c.Nc.removeChild(g),c.Nc)}c.Nc.parentNode.removeChild(c.Nc)}a.style.cssFloat=b.ImagePosition.value;a.style.styleFloat=b.ImagePosition.value;
a.style.marginTop="1em";a.style.marginBottom="0";a.style.marginLeft=a.style.cssFloat=="left"?"0":"1em";a.style.marginRight=a.style.cssFloat=="right"?"0":"1em"}else if(c.Jd&&b.WrapText.checked&&c.align!=b.ImagePosition.value&&b.ImagePosition.value!="center"){a.style.cssFloat=b.ImagePosition.value;a.style.styleFloat=b.ImagePosition.value;a.style.marginTop="1em";a.style.marginBottom="0";a.style.marginLeft=a.style.cssFloat=="left"?"0":"1em";a.style.marginRight=a.style.cssFloat=="right"?"0":"1em"}a.removeAttribute("align");
try{St()}catch(l){}};
var Au=function(){var a=O(ou+"ImageOptionsForm");if(a.ImageWidth&&a.ImageWidthPx)if(a.ImageWidth.value=="custom"){a.ImageWidthPx.disabled=e;a.ImageWidthPx.style.display="";O(ou+"ImageWidthPxLabel").style.display=""}else{a.ImageWidthPx.disabled=j;a.ImageWidthPx.style.display="none";O(ou+"ImageWidthPxLabel").style.display="none"}},Qu=function(){var a=O(ou+"ImageOptionsForm");if(a.ImagePosition&&a.WrapText)if(a.ImagePosition.value=="center"){a.WrapText.disabled=j;a.WrapText.style.display="none";O(ou+
"WrapTextLabel").style.display="none"}else{a.WrapText.disabled=e;a.WrapText.style.display="";O(ou+"WrapTextLabel").style.display=""}},Nu=function(){var a=O(ou+"ImageOptions"),b=O(ou+"ImageOptionsForm").ShowOptions;if(a)if(a.style.display=="none"){xu("ImageOptions");vu("ToggleIconPlus");vu("ToggleLinkPlus");xu("ToggleIconMinus");xu("ToggleLinkMinus");b.value="true"}else{vu("ImageOptions");vu("ToggleIconMinus");vu("ToggleLinkMinus");xu("ToggleIconPlus");xu("ToggleLinkPlus");b.value="false"}},zu=function(){O(ou+
"ImagePreviewTextDiv").style.display="";O(ou+"ImagePreviewDiv").style.display="none";O(ou+"ImagePreview").src=""},Tu=function(){var a=new Image;a.src=O(ou+"ImageURL").value;var b=O(ou+"ImagePreview"),c=O(ou+"ImagePreviewDiv");if(a.complete){O(ou+"ImagePreviewTextDiv").style.display="none";b.src=a.src;if(a.width>120||a.height>120){var d=a.width,f=a.height,g=120/d,i=120/f;if(i>g){d=120;f=f*g}else{f=120;d=d*i}b.width=d;b.height=f}c.style.display=""}else zu()};
st.prototype.IC=function(a,b,c,d){var f={};if(a=="fit"){f.width="100%";f.height=h}else if(d&&c){switch(a){case "custom":f.width=parseFloat(b);break;case "default":f.width=Math.min(648,c);break;case "xs":f.width=Math.min(160,c);break;case "s":f.width=Math.min(320,c);break;case "m":f.width=Math.min(640,c);break;case "l":f.width=Math.min(1024,c);break;case "xl":f.width=Math.min(1600,c);break;case "original":default:f.width=c;break}f.height=f.width==c?d:f.width*(d/c);f.width+="px";f.height+="px"}else{switch(a){case "custom":f.width=
parseFloat(b)+"px";break;case "xs":f.width="160px";break;case "s":f.width="320px";break;case "m":f.width="640px";break;case "l":f.width="1024px";break;case "xl":f.width="1600px";break;case "default":case "original":default:f.width=h;break}f.height=h}return f};
st.prototype.Mq=function(a){var b=O(ou+"ImagePosition"),c=O(ou+"ImageWidth"),d={src:pu,Bj:O(ou+"LinkImage").checked,Jd:O(ou+"WrapText").checked,align:b.options[b.selectedIndex].value},f=c.options[c.selectedIndex].value,g=O(ou+"ImageWidthPx").value;if(f=="fit"){d.width="100%";d.height=h}else if(a.naturalHeight&&a.naturalWidth){d.naturalWidth=a.naturalWidth;d.naturalHeight=a.naturalHeight;switch(f){case "custom":d.width=parseFloat(g);break;case "default":d.width=Math.min(648,d.naturalWidth);break;case "xs":d.width=
Math.min(160,d.naturalWidth);break;case "s":d.width=Math.min(320,d.naturalWidth);break;case "m":d.width=Math.min(640,d.naturalWidth);break;case "l":d.width=Math.min(1024,d.naturalWidth);break;case "xl":d.width=Math.min(1600,d.naturalWidth);break;case "original":default:d.width=d.naturalWidth;break}d.height=d.width==d.naturalWidth?d.naturalHeight:d.width*(d.naturalHeight/d.naturalWidth);d.width+="px";d.height+="px"}else{switch(f){case "custom":d.width=parseFloat(g)+"px";break;case "xs":d.width="160px";
break;case "s":d.width="320px";break;case "m":d.width="640px";break;case "l":d.width="1024px";break;case "xl":d.width="1600px";break;case "default":d.width="default";break;case "original":default:d.width=h;break}d.height=h}var i=st.prototype.oF(d),l=i.ownerDocument.createElement("div");l.appendChild(i);try{qu=j;var m=Rt(l.innerHTML,i.id,e);if(d.width=="default"&&m.childNodes[0]){var n=m.childNodes[0],q=function(){var t=Uu(n);n.style.width=Math.min(t.naturalWidth,648)+"px"};if(n.complete)q();else n.onload=
q}}catch(r){rce("InsertImage_insertImage",r,this)}T.ra();try{St()}catch(r){}qu=e;ru=j};st.prototype.uJ=function(a){var b;if(a!=h&&a.target!=h){try{var c=a.target.tw()}catch(d){U(Su+" (5)");this.xa();return}if(c.type=="ok"){if(c.details!=h){this.Hq=c.details;pu=this.Hq.fileName;this.ew(pu,this.Mq);T.ra();this.xa()}}else if(c.type=="error")if(c.details!=h){b=c.details;var f=O(this.c("ImageFile"));window.setTimeout(function(){U(b,f)},0);vu("Working");f.value=""}}};
st.prototype.Py=function(){U("\u4e0a\u4f20\u5931\u8d25\u3002",e)};
var yu=function(a){if(a){var b={};b.src=a.src;if("naturalWidth"in a&&"naturalHeight"in a){b.naturalWidth=a.naturalWidth;b.naturalHeight=a.naturalHeight}else{var c=a.style.width,d=a.style.height,f=a.width,g=a.height;a.style.width="";a.style.height="";a.removeAttribute("width");a.removeAttribute("height");b.naturalWidth=a.width;b.naturalHeight=a.height;a.style.width=c||f;a.style.height=d||g}b.width=a.style.width||(B?a.currentStyle.width:a.getAttribute("width"));b.height=a.style.height||(B?a.currentStyle.height:
a.getAttribute("height"));b.Bj=e;for(var i=a.parentNode;i&&i!=i.ownerDocument.body;i=i.parentNode)if(i.tagName&&i.tagName=="A"){if(i.href==a.src){b.Bj=j;b.ze=i}break}b.Jd=j;if(a.style.cssFloat&&a.style.cssFloat!=""||a.style.styleFloat&&a.style.styleFloat!=""){var l=a.style.cssFloat||a.style.styleFloat;if(l)l=l.toLowerCase();if(l=="left"||l=="right"){b.align=l;b.Jd=j}}else if(a.align&&a.align!=""){var m=a.align.toLowerCase();if(m=="left"||m=="right"){b.align=m;b.Jd=j}}else for(var i=a.parentNode;i&&
i!=i.ownerDocument.body;i=i.parentNode)if(i.tagName&&i.tagName=="DIV"){var n=i.style.textAlign||i.getAttribute("align");if(n){n=n.toLowerCase();if(n=="left"||n=="right"||n=="center"){b.align=n;b.Nc=i;b.Jd=e}}break}return b}else return h},Uu=function(a){var b={};if(a){a.removeAttribute("width");a.removeAttribute("height");a.style.height="auto";a.style.width="auto";b.naturalWidth=a.naturalWidth||a.width;b.naturalHeight=a.naturalHeight||a.height}return b},Vu=function(a,b){if(!ru){if(tu&&tu[a.src]){window.clearTimeout(tu[a.src]);
tu[a.src]=h;delete tu[a.src]}b(Uu(a))}};st.prototype.ew=function(a,b){if(a&&b){var c=new Image;c.onload=c.onerror=c.onabort=function(){Vu(c,b)};c.src=a+(a.indexOf("?")!=-1?"&t=":"?t=")+(new Date).getTime();tu[c.src]=window.setTimeout(function(){Vu(c,b)},10000)}};
st.prototype.oF=function(a){var b=h;if(a){var c=document.createElement("img");c.src=a.src;b=c;if(a.width)if(a.width!="default")c.style.width=a.width;if(a.height)c.style.height=a.height;if(a.Bj){var d=document.createElement("a");d.target="_blank";d.href=a.src;d.appendChild(b);b=d}if(c.style.width&&c.style.width=="100%"){var f=document.createElement("div");f.style.textAlign="center";f.appendChild(b);b=f;b.style.paddingTop="1em";b.style.paddingBottom="1em";b.style.paddingRight="1em";b.style.paddingLeft=
"1em"}else if(a.Jd&&(a.align=="left"||a.align=="right")){c.style.cssFloat=a.align;c.style.styleFloat=a.align;c.style.marginTop="1em";c.style.marginBottom="0";c.style.marginLeft=a.align=="left"?"0":"1em";c.style.marginRight=a.align=="right"?"0":"1em"}else{var f=document.createElement("div");f.style.textAlign=a.align;f.appendChild(b);b=f;b.style.paddingTop="1em";b.style.paddingBottom="1em";b.style.paddingRight="0";b.style.paddingLeft="0"}b.id=js()}return b};
st.prototype.Ah=function(){if(B){su.collapse();su.select()}if($&&$.tagName&&$.tagName=="IMG"){st.prototype.sz();$=h}else zu()};st.prototype.sz=function(){xu("Upload");xu("UploadImageFormDiv");vu("URLImageFormDiv");xu("Toggle");vu("ImageOptions");vu("ToggleIconMinus");vu("ToggleLinkMinus");xu("ToggleIconPlus");xu("ToggleLinkPlus")};w("writely.Dialog.InsertImage",st);w("writely.Dialog.InsertImage.toggleOptions",Nu);w("writely.Dialog.InsertImage.handleChangeWidth",Au);
w("writely.Dialog.InsertImage.handleChangePosition",Qu);y(st.prototype,"insertImage",st.prototype.Mq);w("writely.Dialog.InsertImage.onLoadHandler",Vu);w("writely.Dialog.InsertImage.getNaturalDimensions",Uu);w("writely.Dialog.InsertImage.handleChangeUrlUpload",Ou);w("writely.Dialog.InsertImage.handleChangeFileUpload",Pu);w("writely.Dialog.InsertImage.checkForPreview",Tu);var tt=function(){this.wa="InsertLink";Z.call(this);this.mt=""};tt.Ha(Z);o=tt.prototype;
o.N=function(){this.GH=B&&Za("7.0",ib)==1;if(!tt.d.N.call(this))return;var a=O(this.c("DocLinkType")),b=O(this.c("DocLinkTypeLabel"));if(window.LIMITED_EDITING){a.setAttribute("disabled",j);Kd(b,"textDisabled")}else{a.removeAttribute("disabled");Ld(b,"textDisabled")}jq("getinsertlinklist",h,this.gJ.bind(this));if(!this.ya){var c=O(this.c("WebLinkType")),d=O(this.c("DocLinkType")),f=O(this.c("AnchorLinkType")),g=O(this.c("EmailLinkType"));H(c,"click",this.Fd.bind(this,"WebLink"));H(d,"click",this.Fd.bind(this,
"DocLink"));H(f,"click",this.Fd.bind(this,"AnchorLink"));H(g,"click",this.Fd.bind(this,"EmailLink"));this.ya=j;this.ua()}var i=h,l=h,m=h;this.Cv(Y.document,"AnchorLinkCtl",j);this.yb=$;if(this.yb){this.rb("\u66f4\u6539\u94fe\u63a5");this.dc("\u66f4\u6539");this.yb=Xr(this.yb,"a");if(!this.yb){U("\u8bf7\u70b9\u51fb\u94fe\u63a5\uff0c\u7136\u540e\u91cd\u8bd5\u3002");this.o(e);return}i=this.yb.href?this.yb.href:"";if(i.indexOf("#")!=-1)i=i.substring(i.indexOf("#"));l=this.sE(i);if(i.indexOf("mailto:")==
0){var n=i.indexOf("?");if(n==-1)n=i.length;m=this.tj("EmailLink","EmailLinkType","EmailLinkCtl",i.substring("mailto:".length,n))}else m=i.indexOf("#")==0?this.tj("AnchorLink","AnchorLinkType","AnchorLinkCtl",i.substring(i.indexOf("#")+1)):(i.indexOf("/")>=0||i.indexOf("View")>=0)&&this.zv(l,"docid")?this.tj("DocLink","DocLinkType","DocLinkCtl",this.zv(l,"docid")):this.tj("WebLink","WebLinkType","WebLinkCtl",i);this.L("linktitle",Mr(this.yb.getAttribute("title")));this.Bz=Mr(xe(this.yb));this.L("linktext",
this.Bz);O(this.c("openlink")).checked=this.yb.getAttribute("target")=="_blank"}else{this.rb("\u63d2\u5165\u94fe\u63a5");this.dc("\u63d2\u5165");this.tj("WebLink","WebLinkType","linktext",Ba(nu));m=O(this.c("WebLinkCtl"));nu.search(/^\s*(https?|gopher|news):\/\/\S/i)!=-1?this.L("WebLinkCtl",Ea(nu)):this.L("WebLinkCtl","");this.L("linktitle","");this.L("EmailLinkCtl","")}m!=h&&m.focus()};
o.da=function(a){var b="",c=e,d=Lr(this.z("linktext"));if(this.qa("WebLinkType")){b=Lr(this.z("WebLinkCtl"));if(!b||b=="http://"){U("\u8bf7\u8f93\u5165\u7f51\u5740\u3002",O(this.c("WebLinkCtl")));a.preventDefault();return}if(b&&b.indexOf(":")==-1)b="http://"+b;d||(d=b)}else if(this.qa("DocLinkType")){if(!this.z("DocLinkCtl")){U("\u8bf7\u9009\u62e9\u5728\u7ebf\u6587\u6863\u3002",O(this.c("DocLinkCtl")));a.preventDefault();return}b=ir("View","docid="+this.z("DocLinkCtl"));if(!d){var f=O(this.c("DocLinkCtl"));
d=f.options[f.selectedIndex].text}}else if(this.qa("AnchorLinkType")){var g=this.z("AnchorLinkCtl");if(!g){U("\u8bf7\u9009\u62e9\u4e66\u7b7e\u3002",O(this.c("AnchorLinkCtl")));a.preventDefault();return}b="#"+Nr(g);d||(d=g)}else if(this.qa("EmailLinkType")){b=Lr(this.z("EmailLinkCtl"));if(!b){U("\u8bf7\u8f93\u5165\u7535\u5b50\u90ae\u4ef6\u5730\u5740\u3002",O(this.c("EmailLinkCtl")));a.preventDefault();return}else if(!b.match(/\S@\S/)||b.match(/\s/)){U("\u8be5\u7535\u5b50\u90ae\u4ef6\u5730\u5740\u65e0\u6548\u3002",
O(this.c("EmailLinkCtl")));a.preventDefault();return}if(b.indexOf("mailto")==-1)b="mailto:"+b;d||(d=b)}else{U("\u60a8\u5fc5\u987b\u5148\u9009\u62e9\u94fe\u63a5\u7c7b\u578b\u3002",e);return e}c=this.qa("openlink");var i=Lr(this.z("linktitle"))||d;if(!this.yb){var l=js();this.yb=Rt('<a id="'+l+'">'+d+"</a>",l,e);this.iH(this.yb)||this.yJ(this.yb);ns(Y,this.yb)}this.yb.href=b;this.Bz!=d&&Hr(this.yb,d);Jr(this.yb,"_blank","target",c);Jr(this.yb,i,"title",j);T.ra();St();tt.d.da.call(this,a)};
o.tj=function(a,b,c,d){this.Fd(a);O(this.c(b)).checked=j;if(c=="DocLinkCtl")this.mt=d;if(c!="DocLinkCtl"||O(this.c(c)).options.length>1)this.L(c,d);return O(this.c(c))};
o.Fd=function(a){if(this.GH){O(this.c("DocLink")).style.position=a=="DocLink"?"static":"absolute";O(this.c("DocLink")).style.visibility=a=="DocLink"?"visible":"hidden";O(this.c("AnchorLink")).style.position=a=="AnchorLink"?"static":"absolute";O(this.c("AnchorLink")).style.visibility=a=="AnchorLink"?"visible":"hidden"}else{this.G("DocLink");this.G("AnchorLink")}this.G("WebLink");this.G("EmailLink");if(a!=""){this.la(a);O(this.c("webopenlink_td")).style.display=a=="WebLink"||a=="DocLink"?"":"none"}};
o.sE=function(a){var b=h,c=h,d=a.split("?");if(d&&d.length>=2){var f=d[1].split("&");b=[];c=[];for(var g=0;g<f.length;g++){var i=f[g].split("=");if(i&&i.length>1)c[g]=i[1];i&&i.length>0&&b.push(i[0])}}return[b,c]};o.zv=function(a,b){if(!a||!a.length||a.length<2||!a[0]||!a[1])return h;b=b.toLowerCase();for(var c=0;c<a[0].length;c++)if(a[0][c].toLowerCase()==b)return a[1][c];return h};
o.iH=function(a){if(a&&a.nextSibling){var b=a.nextSibling,c=b.nodeType==3?b.nodeValue:xe(b);return c.length>0&&" ,.:;'\"".indexOf(c.charAt(0))>-1}return e};o.yJ=function(a){var b=Y.document.createTextNode(" ");b=a.parentNode.insertBefore(b,a.nextSibling);if(oa(Y.document.createRange)){var c=Y.document.createRange();c.selectNode(b);c.setStartAfter(b);c.setEndAfter(b);Y.getSelection().removeAllRanges();Y.getSelection().addRange(c)}};
o.gJ=function(a){if(!a)return;var b=O(this.c("DocLinkCtl")),c=b.lastChild;while(c!=b.firstChild){var d=c.previousSibling;b.removeChild(c);c=d}b.firstChild.setAttribute("selected","");var f=a.responseText;if(f.indexOf("while(true);")==0)f=f.substr("while(true);".length);var g=ej(f);for(var i=0;i<g.documentList.length;i++){var l=Xd("option",{value:g.documentList[i].id},g.documentList[i].title);P(b,l);if(this.mt==l.value)l.selected=j}this.mt=""};var ut=function(){this.wa="InsertTable";Z.call(this);this.lc=h};ut.Ha(Z);
ut.prototype.N=function(){if(!ut.d.N.call(this))return;this.lc=$?Xr($,"table"):h;if(this.lc){this.rb("\u66f4\u6539\u8868\u683c");this.dc("\u66f4\u6539");this.G("rowsandcols");this.G("width_same_row");this.ph(this.lc,"width","width_select","width_amt");this.ph(this.lc,"height","height_select","height_amt");this.vg();this.ic(this.lc,"float","float_select","select");this.lc.parentNode!=h&&this.lc.parentNode.tagName=="DIV"&&this.ic(this.lc.parentNode,"align","align_select","select");this.ic(this.lc,"cellPadding",
"padding_amt",1);this.ic(this.lc,"cellSpacing","spacing_amt",2);this.ic(this.lc,"border","border_amt",0);var a=this.lc.getAttribute("bordercolor");this.Re(a,"bordercolor");a=this.lc.getAttribute("bgcolor");this.Re(a,"bgcolor")}else{this.rb("\u63d2\u5165\u8868\u683c");this.dc("\u63d2\u5165");this.la("rowsandcols");this.la("width_same_row");this.L("rows","2");this.L("columns","2");this.L("width_select","0");this.L("height_select","1");this.L("padding_amt","3");this.L("spacing_amt","0");this.L("align_select",
"select");this.L("float_select","select");this.L("border_amt","0");this.Re("","bordercolor");this.Re("","bgcolor");this.vg()}if(!this.ya){var b=O(this.c("width_select")),c=O(this.c("height_select"));H(b,"change",this.vg.bind(this));H(c,"change",this.vg.bind(this));this.ya=j}};
ut.prototype.da=function(a){var b=this.lc;if(!b){this.qi("rows",1,100);this.qi("columns",1,25);this.qi("padding_amt",0,50);this.qi("spacing_amt",0,50);this.qi("border_amt",0,50);b=this.HI()}b&&this.EM(b);T.ra();St();ut.d.da.call(this,a)};
ut.prototype.HI=function(){var a=js(),b="";if(E)b="<br>";var c='<div><table id="'+a+'"><tbody>',d=this.z("columns"),f=this.z("rows"),g="";if(this.qa("width_same"))g=' width="'+100/d+'%"';for(var i=0;i<f;i++){c+="<tr>";for(var l=0;l<d;l++)c+="<td"+g+">"+b+"</td>";c+="</tr>"}c+="</tbody></table></div>";var m=Rt(c,a,e);if(!m)return h;if(m.tagName=="div"){var n=Y.document.createElement("table");m.appendChild(n);m=n}ns(Y,m.parentNode);return m};
ut.prototype.EM=function(a){this.Rh(a,"width_select","width_amt","width");this.Rh(a,"height_select","height_amt","height");if(a.parentNode.tagName.toUpperCase()!="DIV"){var b=Y.document.createElement("DIV");a.parentNode.insertBefore(b,a);a.parentNode.removeChild(a);b.appendChild(a)}var c=this.z("align_select")||"select";this.jc(a.parentNode,c,"align",c!="select");var d=this.z("float_select")||"select";this.jc(a,d,"float",d!="select");var f=this.z("padding_amt")||"select";this.jc(a,f,"cellPadding",
f!="select");var g=this.z("spacing_amt")||"select";this.jc(a,g,"cellSpacing",g!="select");var i=this.z("border_amt")||"";this.jc(a,i,"border",i!=""&&!isNaN(i));a.getAttribute("border")=="0"?Kd(a,"zeroBorder"):Ld(a,"zeroBorder");this.Xj(a,"bordercolor","bordercolor");this.Xj(a,"bgcolor","bgcolor")};var vt=function(){this.wa="MiscTextBox";Z.call(this);var a=new Uh;a.h(Wh,"\u786e\u5b9a",j,j);this.ef(a)};vt.Ha(Z);
vt.prototype.N=function(a){window.setTimeout(u(this.ua,this),0);if(!vt.d.N.call(this))return;this.b().style.zIndex=10000;if(a.caption){var b=a.caption.replace("\n","<br>");O(this.c("caption")).innerHTML=b}else O(this.c("caption")).innerHTML="";var c=O(this.c("msg")),d=O(this.c("ctrlhelp"));if(a.text){c.style.display="";d.style.display="";c.value=a.text;if(a.Yx>0)c.style.rows=a.Yx;O(this.c("msg")).focus();O(this.c("msg")).select()}else{c.style.display="none";d.style.display="none"}if(a.width>0)O(this.c("container")).width=
a.width;a.title?this.rb(a.title):this.rb("\u6765\u81ea Google \u6587\u6863\u7684\u6d88\u606f")};var wt=function(){this.wa="PrintSettings";Z.call(this);var a=this.Ab;a.h("print","\u6253\u5370...",e,e);this.ef(a)};wt.Ha(Z);o=wt.prototype;
o.N=function(a){if(!wt.d.N.call(this,j,a))return;this.yc=a||h;a=="Export"?this.rb("\u5bfc\u51fa\u4e3a PDF"):this.rb("\u6253\u5370\u8bbe\u7f6e");this.L("paperSizeSel",Eq("papersize"));if(W("usesportrait"))O(this.c("portrait")).checked=j;else O(this.c("landscape")).checked=j;this.Ds();this.L("topMarginSel",Eq("topmargin"));this.L("bottomMarginSel",Eq("bottommargin"));this.L("leftMarginSel",Eq("leftmargin"));this.L("rightMarginSel",Eq("rightmargin"));var b=Eq("pagenumber");O(this.c("includePageNumSel")).checked=
b!="NONE";b!="NONE"&&this.L("pageNumberSel",Eq("pagenumber"));O(this.c("includeCommentsSel")).checked=!W("stripcomments");if(V("enable_footnotes")){O(this.c("includeFootnotesSel")).checked=W("printfootnotes");O(this.c("includeFootnotesSel")).style.display="";O(this.c("includeFootnotesSelLabel")).style.display=""}if(!this.ya){var c=O(this.c("portrait")),d=O(this.c("landscape"));H(c,"click",this.Ds.bind(this));H(d,"click",this.Ds.bind(this));this.ya=j}this.o(j)};
o.zr=function(a){if(a&&a.Qb=="print"){pr(this.yc,this.sw());this.Bh()}wt.d.zr.call(this,a)};
o.sw=function(){var a=new tc;a.h("paperSize",this.Ca("paperSizeSel"));a.h("usesPortrait",O(this.c("portrait")).checked);a.h("topMargin",this.Ca("topMarginSel"));a.h("bottomMargin",this.Ca("bottomMarginSel"));a.h("leftMargin",this.Ca("leftMarginSel"));a.h("rightMargin",this.Ca("rightMarginSel"));this.qa("includePageNumSel")?a.h("pageNumber",this.Ca("pageNumberSel")):a.h("pageNumber","NONE");a.h("stripComments",!this.qa("includeCommentsSel"));V("enable_footnotes")&&a.h("printFootnotes",this.qa("includeFootnotesSel"));
return a};o.da=function(a){var b=this.sw();b.h("saveonly",j);b.h("docid",docID);iq("save_print_settings",b,this.Bh.bind(this));wt.d.da.call(this,a)};o.Ds=function(){var a=O(this.c("portrait")).checked,b=O(this.c("portrait-icon")),c=O(this.c("landscape-icon"));if(a){c.style.display="none";b.style.display="block"}else{c.style.display="block";b.style.display="none"}};
o.Bh=function(){var a=this.Ca("paperSizeSel");a&&X("papersize",a);X("usesportrait",O(this.c("portrait")).checked);var b=this.Ca("topMarginSel");b&&X("topmargin",b);var c=this.Ca("bottomMarginSel");c&&X("bottommargin",c);var d=this.Ca("leftMarginSel");d&&X("leftmargin",d);var f=this.Ca("rightMarginSel");f&&X("rightmargin",f);var g=this.Ca("pageNumberSel");this.qa("includePageNumSel")||(g="NONE");g&&X("pagenumber",g);X("stripcomments",!this.qa("includeCommentsSel"));V("enable_footnotes")&&X("printfootnotes",
this.qa("includeFootnotesSel"));ys()=="printpreview"&&Wu()};var xt=function(){this.wa="TocSettings";Z.call(this)};xt.Ha(Z);xt.prototype.N=function(){if(!xt.d.N.call(this))return;if(!this.ya){var a=O(this.c("Type"));H(a,"change",this.ug.bind(this));this.ya=j}var b=Xu();if(b){var c=b.getAttribute("toctype");c=c||"none+none";this.L("Type",c);this.ft(c);this.dc("\u66f4\u65b0\u76ee\u5f55")}else{this.L("Type","none+none");this.ft("none+none");this.dc("\u63d2\u5165\u76ee\u5f55")}};
xt.prototype.da=function(){var a=this.Ca("Type").split("+");Yu(a[0]||"none",a[1]||"none")};xt.prototype.ug=function(){this.ft(this.Ca("Type"))};xt.prototype.ft=function(a){a=a.split("+");var b=a[0]||"none",c=a[1]||"none",d=[O(this.c("HtmlList")),O(this.c("PrintList"))];for(var f=0,g;g=d[f];f++){g.style.listStyleType=b;g.style.paddingLeft="3em";for(var i=0,l;l=g.childNodes[i];i++)if(l.tagName=="OL"){l.style.listStyleType=c;l.style.marginLeft="0"}}};var yt=function(){this.wa="WordCount";Z.call(this);this.O=h;var a=new Uh;a.h(Wh,"\u5b8c\u6210",j,j);this.ef(a)};yt.Ha(Z);o=yt.prototype;o.N=function(a){if(!yt.d.N.call(this))return;this.O=new bu(Y.document.body,a.IK,SiteLanguageIsEnglish,SiteLanguageIsAsian);window.setTimeout(this.jD.bind(this),1)};o.jD=function(){O(this.c("NumberOfPages")).innerHTML=this.O.Ul(0);O(this.c("NumberOfPagesSelection")).innerHTML=this.O.vc()?this.O.Ul(1):"-";window.setTimeout(this.iD.bind(this),1)};
o.iD=function(){O(this.c("NumberOfLettersWithSpaces")).innerHTML=this.O.Wv(0);O(this.c("NumberOfLettersWithSpacesSelection")).innerHTML=this.O.vc()?this.O.Wv(1):"-";window.setTimeout(this.hD.bind(this),1)};o.hD=function(){O(this.c("NumberOfLettersNoSpaces")).innerHTML=this.O.ih(0);O(this.c("NumberOfLettersNoSpacesSelection")).innerHTML=this.O.vc()?this.O.ih(1):"-";window.setTimeout(this.kD.bind(this),1)};
o.kD=function(){O(this.c("NumberOfParagraphs")).innerHTML=this.O.Vl(0);O(this.c("NumberOfParagraphsSelection")).innerHTML=this.O.vc()?this.O.Vl(1):"-";window.setTimeout(this.nD.bind(this),1)};o.nD=function(){O(this.c("NumberOfWords")).innerHTML=this.O.Pe(0);O(this.c("NumberOfWordsSelection")).innerHTML=this.O.vc()?this.O.Pe(1):"-";window.setTimeout(this.mD.bind(this),1)};
o.mD=function(){O(this.c("NumberOfSentences")).innerHTML=this.O.Nf(0);O(this.c("NumberOfSentencesSelection")).innerHTML=this.O.vc()?this.O.Nf(1):"-";window.setTimeout(this.gD.bind(this),1)};
o.gD=function(){var a=this.O.Nf(0),b=this.O.Vl(0),c=this.O.Pe(0),d=this.O.ih(0),f=this.O.Ul(0),g=a/b;O(this.c("NumberOfSentencesPerParagraph")).innerHTML=g.toFixed(2);var i=c/a;O(this.c("NumberOfWordsPerSentence")).innerHTML=i.toFixed(2);var l=d/c;O(this.c("NumberOfLettersPerWord")).innerHTML=l.toFixed(2);var m=c/f;O(this.c("NumberOfWordsPerPage")).innerHTML=m.toFixed(2);a=this.O.Nf(1);b=this.O.Vl(1);c=this.O.Pe(1);d=this.O.ih(1);f=this.O.Ul(1);O(this.c("NumberOfSentencesPerParagraphSelection")).innerHTML=
this.O.vc()?(a/b).toFixed(2):"-";O(this.c("NumberOfWordsPerSentenceSelection")).innerHTML=this.O.vc()?(c/a).toFixed(2):"-";O(this.c("NumberOfLettersPerWordSelection")).innerHTML=this.O.vc()?(d/c).toFixed(2):"-";O(this.c("NumberOfWordsPerPageSelection")).innerHTML=this.O.vc()?(c/f).toFixed(2):"-";window.setTimeout(this.lD.bind(this),1)};
o.lD=function(){if(SiteLanguageIsEnglish){var a=this.O.jw(0);if(a!=h)O(this.c("FleschReadingEase")).innerHTML=a.toFixed(2);a=this.O.jw(1);if(a!=h)O(this.c("FleschReadingEaseSelection")).innerHTML=this.O.vc()?a.toFixed(2):"-";var b=this.O.iw(0);if(b!=h)O(this.c("FleschKincaidGradeLevel")).innerHTML=b.toFixed(2);b=this.O.iw(1);if(b!=h)O(this.c("FleschKincaidGradeLevelSelection")).innerHTML=this.O.vc()?b.toFixed(2):"-";var c=this.O.Qv(0);if(c!=h)O(this.c("AutomatedReadabilityIndex")).innerHTML=c.toFixed(2);
c=this.O.Qv(1);if(c!=h)O(this.c("AutomatedReadabilityIndexSelection")).innerHTML=this.O.vc()?c.toFixed(2):"-"}};var et=function(){this.wa="BlogSettings";Z.call(this);var a=new Uh;a.h("ok","\u786e\u5b9a",j);a.h(Wh,"\u53d6\u6d88",e,j);a.h("test","\u6d4b\u8bd5",e,e);this.ef(a);H(this,"dialogselect",this.fm,e,this)};et.Ha(Z);o=et.prototype;
o.N=function(){if(!et.d.N.call(this))return;if(!this.ya){var a=O(this.c("BlogServiceHosted")),b=O(this.c("BlogServiceCustom"));H(a,"click",this.Fd.bind(this,j));H(b,"click",this.Fd.bind(this,e));this.ya=j}this.L("blog_name",Cq("blogname"));this.L("user_name",Cq("blogusername"));this.L("password",Cq("blogpassword"));O(this.c("includetitle")).checked=V("blogusestitle");if(V("blogiscustom")){O(this.c("BlogServiceCustom")).checked=j;this.L("blog_url",Cq("blogurl"));this.L("blog_api",Cq("blogtype"));this.Fd(e)}else{O(this.c("BlogServiceHosted")).checked=
j;this.L("provider",Cq("blogtype"));this.Fd(j)}};
o.da=function(a){if(!this.QA()){a.preventDefault();return}var b="",c=this.z("provider"),d=e;if(!this.qa("BlogServiceHosted")){b=this.z("blog_url");c=this.z("blog_api");d=j}var f=this.z("blog_name"),g=this.z("user_name"),i=this.z("password"),l=this.qa("includetitle"),m=new tc;m.h("blog_custom",d);Lq("blogiscustom",d);m.h("blog_usetitle",l);Lq("blogusestitle",l);if(b!=h){m.h("blog_url",b);Lq("blogurl",b)}if(f!=h){m.h("blog_name",f);Lq("blogname",f)}if(g!=h){m.h("blog_user",g);Lq("blogusername",g)}if(i!=
h){m.h("blog_pwd",i);Lq("blogpassword",i)}if(c!=h){m.h("blog_type",c);Lq("blogtype",c)}ps();jq("blogsettings_save",m,this.aJ.bind(this));et.d.da.call(this,a)};
o.test=function(){if(!this.QA())return;var a="",b=this.z("provider"),c=e;if(!this.qa("BlogServiceHosted")){a=this.z("blog_url");b=this.z("blog_api");c=j}var d=this.yw();d.value="\u6b63\u5728\u6d4b\u8bd5...";d.disabled=j;var f=new tc;f.h("url",a);f.h("type",b);f.h("name",this.z("blog_name"));f.h("user",this.z("user_name"));f.h("pwd",this.z("password"));f.h("custom",c);iq("blogsettings_test",f,this.oK.bind(this))};
o.Fd=function(a){if(a){this.la("HostedBlogOptions");this.G("CustomBlogOptions")}else{this.G("HostedBlogOptions");this.la("CustomBlogOptions")}this.ua()};
o.QA=function(){if(this.qa("BlogServiceHosted")){if(!this.uk("provider","\u8bf7\u9009\u62e9\u535a\u5ba2\u7ad9\u70b9\u63d0\u4f9b\u5546\u3002"))return e}else if(!this.uk("blog_api","\u8bf7\u9009\u62e9\u535a\u5ba2\u7ad9\u70b9 API\u3002")||!this.uk("blog_url","\u8bf7\u8f93\u5165\u60a8\u7684\u535a\u5ba2\u7ad9\u70b9 URL\u3002"))return e;if(!this.uk("user_name","\u8bf7\u8f93\u5165\u60a8\u7684\u535a\u5ba2\u7ad9\u70b9\u7528\u6237\u540d\u3002")||!this.uk("password","\u8bf7\u8f93\u5165\u60a8\u7684\u535a\u5ba2\u7ad9\u70b9\u5bc6\u7801\u3002"))return e;
return j};o.uk=function(a,b){var c=O(this.c(a));if(c.value.length==0||c.value=="none"){U(b);c.focus();return e}return j};o.oK=function(a){if(a!=h){var b=a.responseText;b.indexOf("Error: ")==0?U(b.substring("Error: ".length)):U(b)}var c=this.yw();c.value="\u6d4b\u8bd5";c.disabled=e};o.aJ=function(a){rs();typeof Zu!="undefined"&&Zu==j&&$u();xs(a,"publish")};o.fm=function(a){if(a.Qb=="test"){this.test();a.preventDefault()}else et.d.fm.call(this,a)};
o.yw=function(){var a=this.Xp().getElementsByTagName("button");for(var b=0,c;c=a[b];b++)if(c.name=="test")return c;return h};w("MoveOldDocuments",Ls);var gv=function(a,b,c){var d=[];for(var f=0,g;g=c[f];f++){var i=h,l=h;switch(g.operation){case "insert":try{i=av(a,b,g)}catch(m){l=m}break;case "delete":try{i=bv(a,b,g)}catch(m){l=m}break;case "update":try{i=cv(a,b,g)}catch(m){l=m}break;case "graft":try{i=dv(a,b,g)}catch(m){l=m}break;case "move":try{i=ev(a,b,g)}catch(m){l=m}break;default:l='unknown operation: "'+g.operation+'"'}if(i)d.push(i);else{fv(d);if(l)k(new Error('changeDom: error: "'+l+'"'));return e}}return j},av=function(a,b,c){var d=hv(c.source,
a);if(!d)return h;var f=iv(b,d);if(jv(d,f,b))return{Ch:"insert",M:f};return h},bv=function(a,b,c){var d=hv(c.target,b);if(!d)return h;if(!d.parentNode||d==b.body)return h;var f={Ch:"delete",M:d,parent:d.parentNode,nextSibling:d.nextSibling};d.parentNode.removeChild(d);return f},cv=function(a,b,c){var d=hv(c.source,a),f=hv(c.target,b);if(!d||!f)return h;if(f.nodeType!=d.nodeType)return h;if(f.nodeType==1&&f.tagName!=d.tagName)return h;var g=iv(b,f),i={Ch:"update",M:f,nC:g};kv(d,f);return i},dv=function(a,
b,c){var d=hv(c.source,a),f=hv(c.target,b);if(!d||!f)return h;if(f.nodeType!=1||d.nodeType!=1)return h;if(f.nodeType==1&&f.tagName!=d.tagName)return h;var g={Ch:"graft",M:f,oC:f.innerHTML};f.innerHTML=d.innerHTML;return g},ev=function(a,b,c){var d=hv(c.source,a),f=hv(c.target,b);if(!d||!f)return h;var g={Ch:"move",M:f,parent:f.parentNode,nextSibling:f.nextSibling};if(jv(d,f,b))return g;return h},jv=function(a,b,c){var d=a.parentNode,f;if(d)if(d.tagName=="BODY")f=c.body;else{if(!d.id)return e;f=c.getElementById(d.id);
if(!f)return e}else return e;if(d.lastChild==a||!f.hasChildNodes())f.appendChild(b);else if(d.firstChild==a)f.insertBefore(b,f.firstChild);else{if(a.previousSibling.id){var g=c.getElementById(a.previousSibling.id);if(g&&g.parentNode==f){g=g.nextSibling;g?f.insertBefore(b,g):f.appendChild(b);return j}}if(a.nextSibling.id){var g=c.getElementById(a.nextSibling.id);if(g&&g.parentNode==f){f.insertBefore(b,g);return j}}var i=a.previousSibling.nodeValue,l=a.nextSibling.nodeValue;if(i||l){var m=0,n=d.firstChild;
while(n!=a){n=n.nextSibling;m++}n=f.firstChild;while(m!=0){if(!n.nextSibling)break;n=n.nextSibling;m--}var q=n,r=n;while(q||r){if(i&&q&&i==q.nodeValue){r=q.nextSibling;r?f.insertBefore(b,r):f.appendChild(b);return j}if(l&&q&&l==q.nodeValue){f.insertBefore(b,r);return j}if(l&&r&&l==r.nodeValue){f.insertBefore(b,r);return j}if(i&&r&&i==r.nodeValue){r=r.nextSibling;r?f.insertBefore(b,r):f.appendChild(b);return j}if(q)q=q.previousSibling;if(r)r=r.nextSibling}}return e}return j},fv=function(a){for(var b=
a.length-1;b>=0;b--){var c=a[b];switch(c.Ch){case "insert":c.M.parentNode.removeChild(c.M);break;case "delete":case "move":c.nextSibling?c.parent.insertBefore(c.M,c.nextSibling):c.parent.appendChild(c.M);break;case "update":kv(c.nC,c.M);break;case "graft":c.M.innerHTML=c.oC;break;default:k(new Error('undoStack_: unknown operation: "'+c.Ch+'"'))}}},iv=function(a,b){if(document.importNode)return a.importNode(b,j);var c=h;switch(b.nodeType){case 1:c=a.createElement(b.nodeName);lv(b,c);if(b.innerHTML)c.innerHTML=
b.innerHTML;break;case 3:c=a.createTextNode(b.nodeValue);break;case 8:c=a.createComment(b.nodeValue);break;default:k(new Error("importNode_: unknown type: "+b.nodeType))}return c},kv=function(a,b){if(a.nodeType==1){for(var c=0;c<b.attributes.length;c++){var d=b.attributes[c].name;typeof a[d]=="undefined"&&b.removeAttribute(d)}a.id||b.removeAttribute("id");a.lang||b.removeAttribute("lang");a.title||b.removeAttribute("title");lv(a,b)}else if(a.nodeType==3||a.nodeType==8)if(b.nodeValue!=a.nodeValue)b.nodeValue=
a.nodeValue},lv=function(a,b){for(var c=0;c<a.attributes.length;c++)if(a.attributes[c].nodeValue!=h&&a.attributes[c].nodeValue!=""){var d=a.attributes[c].name;if(d=="class")b.className=a.attributes[c].value;else b.setAttribute(d,a.attributes[c].value)}if(a.style&&a.style.cssText!=h&&b.style.cssText!=a.style.cssText)b.style.cssText=a.style.cssText};var hv=function(a,b){var c=a.replace(/([*#^])/g," $1 ").split(" "),d=c.shift();d=d?b.getElementById(d):b.body;while(d&&c.length){var f=c.shift();if(c.length==0)k(new Error("pathToNode: Missing number"));var g=c.shift();g=parseInt(g,10);if(isNaN(g))k(new Error("pathToNode: Bad number"));switch(f){case "^":d=mv(d,g);break;case "#":d=nv(d,g);break;case "*":d=ov(d,g);break;default:k(new Error('pathToNode: Unknown operation: "'+f+'"'))}}return d},mv=function(a,b){if(b<0)k(new Error("walkToParent_: Negative parent: "+
b));for(var c=0;c<b;c++){if(a.tagName=="BODY")return h;a=a.parentNode;if(!a)return h}return a},nv=function(a,b){if(!a.hasChildNodes())return h;if(b>=0){if(b>=a.childNodes.length)return h;a=a.childNodes[b]}else{if(-b>a.childNodes.length)return h;a=a.childNodes[a.childNodes.length+b]}return a},ov=function(a,b){if(b>0)while(b--){a=a.nextSibling;if(!a)return h}else if(b<0)while(b++){a=a.previousSibling;if(!a)return h}return a};var pv=function(){this.sa=[]};o=pv.prototype;o.ge=0;o.qg=0;o.tv=function(a){this.sa[this.qg++]=a};o.ml=function(){if(this.ge==this.qg)return undefined;var a=this.sa[this.ge];delete this.sa[this.ge];this.ge++;return a};o.Pa=function(){return this.qg-this.ge};o.ke=function(){return this.qg-this.ge==0};o.clear=function(){this.sa=[];this.ge=0;this.qg=0};o.contains=function(a){return qc(this.sa,a)};o.remove=function(a){var b=sb(this.sa,a);if(b<0)return e;if(b==this.ge)this.ml();else{Gb(this.sa,b);this.qg--}return j};
o.Ob=function(){var a=[];for(var b=this.ge;b<this.qg;b++)a.push(this.sa[b]);return a};var qv=function(a,b){Bc.call(this);this.jy=a||0;this.cg=b||10;if(this.jy>this.cg)k(Error("[goog.structs.Pool] Min can not be greater than max"));this.Eb=new pv;this.sd=new xc;this.Rt()};z(qv,Bc);o=qv.prototype;o.Pc=function(){var a=this.gK();a&&this.sd.add(a);return a};o.bf=function(a){if(this.sd.remove(a)){this.Gk(a);return j}return e};o.gK=function(){var a;while(this.cq()>0){a=this.Eb.ml();if(this.qy(a))break;else this.Rt()}if(!a&&this.Pa()<this.cg)a=this.zi();return a};
o.Gk=function(a){this.sd.remove(a);this.qy(a)&&this.Pa()<this.cg?this.Eb.tv(a):this.xf(a)};o.Rt=function(){var a=this.Eb;while(this.Pa()<this.jy)a.tv(this.zi());while(this.Pa()>this.cg&&this.cq()>0)this.xf(a.ml())};o.zi=function(){return{}};o.xf=function(a){if(typeof a.k=="function")a.k();else for(var b in a)a[b]=h};o.qy=function(a){if(typeof a.PC=="function")return a.PC();return j};o.contains=function(a){return this.Eb.contains(a)||this.sd.contains(a)};o.Pa=function(){return this.Eb.Pa()+this.sd.Pa()};
o.EF=function(){return this.sd.Pa()};o.cq=function(){return this.Eb.Pa()};o.ke=function(){return this.Eb.ke()&&this.sd.ke()};o.l=function(){qv.d.l.call(this);if(this.EF()>0)k(Error("[goog.structs.Pool] Objects not released"));Vb(this.sd,this.xf,this);this.sd.clear();delete this.sd;var a=this.Eb;while(!a.ke())this.xf(a.ml());delete this.Eb};var rv="gdoc:callout";var sv=function(){G.call(this,"hover")};z(sv,G);var tv=function(){G.call(this,"unhover")};z(tv,G);var uv=function(a){G.call(this,"datachange");this.rc=a};z(uv,G);var vv=function(){G.call(this,"reload")};z(vv,G);var wv=function(a){G.call(this,"addnewitem");this.Vk=a};z(wv,G);var xv=function(){G.call(this,"documentchange")};z(xv,G);var yv=function(){G.call(this,"documentchangepost")};z(yv,G);var zv=function(){G.call(this,"documentreload")};z(zv,G);var Av=function(a){G.call(this,"remove");this.tN=a};
z(Av,G);var Bv=function(a){G.call(this,"positionchange");this.JJ=a};z(Bv,G);Bv.prototype.ce=function(){return this.JJ};var Cv=function(){G.call(this,"sizechange")};z(Cv,G);var Dv=function(){G.call(this,"pageviewswitch")};z(Dv,G);var Ev=function(){G.call(this,"calloutclick")};z(Ev,G);var Gv=function(a){this.R=h;this.r=new zf(this);this.Ig=new zf(this);this.CH=e;this.tb=e;this.vh=e;this.ka=h;this.Uj(a);this.r.e(Fv(),"documentchange",this.hj);this.r.e(Fv(),"reload",this.oq)},Hv;z(Gv,I);var Iv=new xc,Jv=function(a){if(Iv.contains(a))return e;else{Iv.add(a);return j}},Kv=function(a){Iv.remove(a)};o=Gv.prototype;o.Uj=function(a){this.R&&this.r.W(this.R,"datachange",this.kh);this.R=a;if(this.R){this.r.e(this.R,"datachange",this.kh);this.r.e(this.R,"datachange",this.lG)}};
o.iC=function(a){this.Ig.Ya();this.Ig.e(a,"remove",this.kG);this.Ig.e(a,"hover",this.fG);this.Ig.e(a,"unhover",this.gG)};o.kh=function(){k(Error("writely.callout.Callout.handleCalloutDataChange_ must be overridden in subclasses."))};o.lG=function(a){Cb(a.rc,"markerId")&&this.R.Xe!=h&&!Jv(this.R.Xe)&&this.R.Sz(h)};o.hj=function(){if(this.ka){this.ro();var a=this.Sk();this.dispatchEvent(new Bv(a))}};
o.oq=function(){this.Ig.Ya();this.lp();Kv(this.R.Xe);this.Uj(h);this.r.W(Fv(),"documentchange",this.hj);this.r.W(Fv(),"reload",this.oq)};o.vw=function(){k(Error("writely.callout.Callout.getSidebarBlock must be overriden"))};o.YK=function(a){this.lp();this.ka=a;this.ca=h;H(this.ka,"mouseover",this.Pw,undefined,this);H(this.ka,"mouseout",this.cx,undefined,this);this.RA=j};o.IA=function(){};
o.lp=function(){if(this.ka){try{ed(this.ka)}catch(a){}try{ed(this.ca)}catch(a){}try{Q(this.ca)}catch(a){}this.ka=h;this.RA=j}};o.save=function(){if(this.ka){this.MK();St()}};o.MK=function(){return this.R.ln(this.ka)};
o.PG=function(a){this.dispatchEvent(new Ev);if(!fr())return;B&&a.preventDefault();this.ca.style.display="inline";Od(T.b(),"writely-footnote-hide-selection",j);this.rl=undefined;this.yp=undefined;this.r.e(document,"mousemove",this.em);this.r.e(Y.document,"mousemove",this.em);this.r.e(document,"mouseup",this.dm);this.r.e(Y.document,"mouseup",this.dm);return e};
o.em=function(a){if(!this.rl){this.rl=a.clientX;this.yp=a.clientY}this.wp=a.clientX;this.xp=a.clientY;if(!this.Td){this.Td=document.createElement("div");this.Td.className="writely-footnote-cursor-follow";this.Td.innerHTML="&nbsp;";ag(this.Td,0.5);this.pu=Wf(T.jb);document.body.appendChild(this.Td)}this.Td.style.top=this.pu.y+this.xp+-10;this.Td.style.left=this.pu.x+this.wp+5;var b=T;if(B){var c=b.fa();c.Mj();c.collapse(b.Hb().ne());c.jg()}else{var d=b.Hf();if(d.collapse){d.collapse(b.Hb().ne());b.fa().empty()}b.os(d)}};
o.dm=function(){this.r.W(document,"mousemove",this.em);this.r.W(Y.document,"mousemove",this.em);this.r.W(document,"mouseup",this.dm);this.r.W(Y.document,"mouseup",this.dm);Od(T.b(),"writely-footnote-hide-selection",e);Q(this.Td);this.ca.style.display="inline-block";this.Td=h;var a=this.rl,b=this.wp,c=this.yp,d=this.xp;if((b>a?a+10<b:a-10>b)||(d>c?c+10<d:c-10>d))if(B){var f=Y.document.body.createTextRange();f.moveToPoint(b,d);var g=f.duplicate();g.move("character",-1);var i=g.duplicate();i.move("character",
1);var l=this.bD(new yd(b,d),f,g,i);l.select();var m=l.parentElement().nodeName.toLowerCase();if(m!=rv&&m!="callout"&&m!="marker"){var n=js();l.execCommand("InsertButton",e,n);var q=Y.document.getElementById(n);q.parentNode.replaceChild(this.ka,q)}window.setTimeout(Lv,1)}else{var r=T.fa();r.collapse(!(d>c||b>a));var m=r.Zb().nodeName.toLowerCase();if(m!=rv&&m!="callout"&&m!="marker"){Q(this.ka);r.Lq(this.ka)}this.ro();window.setTimeout(Mv,1)}this.rl=undefined;this.yp=undefined;this.wp=undefined;this.xp=
undefined};o.bD=function(a){var b=Infinity,c=h,d;for(var f=1;d=arguments[f];f++){var g=new yd(d.mN,d.nN),i=zd(a,g);if(i<b){c=d;b=i}}return c};o.Nn=function(a){this.CH=a;this.IA(a)};o.Pw=function(){this.Nn(j);if(B&&T)T.b().style.cursor="move";this.dispatchEvent(new sv)};o.cx=function(){this.Nn(e);if(B&&T)T.b().style.cursor="";this.dispatchEvent(new tv)};o.fG=function(){this.Nn(j)};o.gG=function(){this.Nn(e)};
o.hK=function(){if(this.ka){var a=this.mz();this.lp();this.r.W(Fv(),"documentchange",this.hj);this.r.W(Fv(),"reload",this.oq);try{var b=Y.document.getElementById(this.R.Xe);b&&b.parentNode.removeChild(b);a=j}catch(c){}a&&St()}};o.mz=function(){var a=e;try{var b=this.ka.innerHTML,c=Y.document.createElement("span");c.innerHTML=b;this.ka.parentNode.replaceChild(c,this.ka);a=j}catch(d){}return a};o.remove=function(){this.hK();this.Ig.Ya();this.dispatchEvent(new Av)};o.Se=function(){return this.R.Se()};
o.Gb=function(){return this.id};o.Oh=function(a){this.id=a;this.RA=j};o.Wj=function(a,b){if(!b)if(a&&!this.cn)this.cn=Cd(this.remove,10000,this);else if(!a&&this.cn){Dd(this.cn);this.cn=h}};
o.ro=function(){var a=e,b=j,c=this.R.Xe;if(this.ka){if(!this.ka.parentNode){this.remove();return}if(!this.ca||!this.ca.parentNode){this.ca=c?Y.document.getElementById(c):h;a=j}if(this.ca){if(this.ka.nextSibling!=this.ca){this.ca.parentNode.removeChild(this.ca);try{this.ka.parentNode.insertBefore(this.ca,this.ka.nextSibling)}catch(d){this.ka.parentNode.appendChild(this.ca)}}b=e}else b=j;if(b){this.ca=Y.document.createElement("marker");if(!c||c.length==0){c=js();this.R.Sz(c);Jv(c);this.save()}this.ca.id=
c;this.ca.className=this.nw();this.ca.style.display="inline-block";try{this.ka.parentNode.insertBefore(this.ca,this.ka.nextSibling)}catch(d){this.ka.parentNode.appendChild(this.ca)}a=j}var f=E?"&nbsp;":String.fromCharCode(160);if(this.ca.innerHTML!=f){if(F){var g=this.ca.innerHTML,i=j;if(g.charCodeAt(0)==160)g=g.substring(1);else if(g.charCodeAt(g.length-1)==160){g=g.substring(0,g.length-1);i=e}var l=Y.document.createElement("span");l.innerHTML=g;i?be(l,this.ca):ae(l,this.ca.previousSibling);var m=
Ie(l);m.collapse();m.select()}try{this.ca.innerHTML=f}catch(d){if(!Hv){Hv=j;rce("Footnote marker load error","between "+(this.ka.previousSibling?this.ka.previousSibling.tagName:"none")+" and "+(this.ca.nextSibling?this.ca.nextSibling.tagName:"none"))}}}if(a){H(this.ca,"mousedown",this.PG,undefined,this);H(this.ca,"mouseover",this.Pw,undefined,this);H(this.ca,"mouseout",this.cx,undefined,this)}if(E){var n=this.ca,q=sb(n.parentNode.childNodes,n),r=Ae(n,Bi),t=Y.document.createRange();t.setStart(n.parentNode,
q+1);t.setEnd(r,r.length||r.childNodes.length);var v=Ue(Y);if(Aa(t.toString())&&!t.isPointInRange(v.Q(),v.ta())){var x=Y.document.createTextNode("\u00a0");n.parentNode.insertBefore(x,n.nextSibling)}}}};o.nw=function(){k(Error("Must override Callout.getMarkerElementClassName_"));return""};o.Sk=function(){if(!this.ka||!this.ka.parentNode)return new yd(-100,-100);this.ca||this.ro();return Wf(this.ca)};o.kG=function(){this.remove()};var Nv=function(){this.R=h;this.Cc=h;this.Nk=e},Ov;o=Nv.prototype;o.qo=function(a,b){this.R=a;var c=Ue(Y);b||c&&!c.isCollapsed()?this.zx(b):this.fM()};o.fM=function(){if(this.Nk){this.Ru();this.Nk=e}else{this.jC();this.Nk=j}};
o.jC=function(){if(!this.Cc){this.Cc=document.createElement("div");this.Cc.style.position="absolute";this.Cc.className="commentMarker"}document.body.appendChild(this.Cc);ag(this.Cc,0.4);H(document,"mousemove",this.Ww,undefined,this);this.my=O("wys_frame");H(Y.document,"mousemove",this.Vw,undefined,this);H(Y.document,"mousedown",this.lj,undefined,this)};
o.Ru=function(){document.body.removeChild(this.Cc);ad(Y.document,"mousemove",this.Vw,undefined,this);ad(document,"mousemove",this.Ww,undefined,this);ad(Y.document,"mousedown",this.lj,undefined,this)};o.Ww=function(a){this.Cc.style.top=a.clientY+-10+"px";this.Cc.style.left=a.clientX+5+"px"};o.Vw=function(a){var b=Wf(this.my),c=this.my;this.Cc.style.top=a.clientY-c.scrollTop+b.y+-10+"px";this.Cc.style.left=a.clientX-c.scrollLeft+b.x+5+"px"};
o.lj=function(){ag(this.Cc,1);ad(Y.document,"mousedown",this.lj,undefined,this);H(Y.document,"mouseup",this.Xw,undefined,this)};o.Xw=function(){ad(Y.document,"mouseup",this.Xw,undefined,this);this.Ru();this.zx();this.Nk=e;Lv()};
o.zx=function(a){var b=h,c=Ot();if(!c){c=cs;if(!c)return h}if("collapsed"in c)if(a){c.collapse(e);b=Y.document.createElement(rv);c.insertNode(b)}else{if(!c.collapsed){var d=c.cloneContents();c.deleteContents();b=Y.document.createElement(rv);b.appendChild(d);c.insertNode(b)}}else if("htmlText"in c)if(a){c.collapse(e);c.pasteHTML("<"+rv+' id="writely-temp-callout-id"></'+rv+">");b=Y.document.getElementById("writely-temp-callout-id")}else if(c.htmlText.length>0){var f=c.htmlText;f=f.replace(/<p (goog_docs_charIndex=\"[0-9]+\")?>/ig,
"<br>");f=f.replace(/<\/p.*>/ig,"");c.pasteHTML("<"+rv+' id="writely-temp-callout-id" >'+f+"</"+rv+">");b=Y.document.getElementById("writely-temp-callout-id")}if(!b){var g="<"+rv+' id="writely-temp-callout-id"></'+rv+">";try{Pv(g);b=Y.document.getElementById("writely-temp-callout-id")}catch(i){b=Y.document.createElement(rv);if(!!c)if("surroundContents"in c)c.surroundContents(b);else if("insertNode"in c)c.insertNode(b);else{U("\u5f88\u62b1\u6b49\uff0c\u60a8\u7684\u6d4f\u89c8\u5668\u4f3c\u4e4e\u4e0d\u652f\u6301\u7f51\u7edc\u6587\u5b57\u5904\u7406\u3002");
rce("insertCallout","Ran out of html insertion options")}}}if(b){b.setAttribute("name","gdoccallout");b.id=js();b.className="writely-callout";b.setAttribute("callouttype",this.R.ju);this.R.ln(b);St()}return b};var Qv=function(){I.call(this);this.Bb=h;this.Hg=0;this.Do=0;this.bn=0;this.iO=j;this.JN=j;this.R=h;this.Lb=new zf(this);this.rx=e;this.rk=new tc;this.Ar=e};z(Qv,I);var Rv="threadWrapper"+(B?" threadWrapperIE":""),Sv="writely-comment-border-height",Tv="writely-callout-corner-left",Uv="writely-callout-corner-right",Vv="writely-callout-corner-top",Wv="writely-callout-corner-bottom",Xv="comment-show-color",Yv="calloutBorder"+(B?" calloutBorderIE":""),Zv="commentTitle";o=Qv.prototype;
o.hC=function(a){this.Lb.Ya();this.Lb.e(a,"hover",this.KC);this.Lb.e(a,"unhover",this.OC);this.Lb.e(a,"positionchange",this.LC);this.Lb.e(a,"remove",this.NC);this.Lb.e(a,"calloutclick",this.JC);this.Lb.e(Fv(),"reload",this.MC);this.iu();this.Uj(a.R)};o.Uj=function(a){this.R&&this.Lb.W(this.R,"datachange",this.kh);this.R=a;if(this.R){this.Lb.e(this.R,"datachange",this.kh);this.Nv()}};o.KC=function(){this.tg(j)};o.OC=function(){this.tg(e)};o.tg=function(){};
o.LC=function(a){if(this.Hg!=a.ce().y||this.Do!=a.ce().x){this.Hg=a.ce().y;this.Do=a.ce().x;this.dispatchEvent(new Bv(a.ce()))}};o.Vv=function(){return{x:this.Do,y:this.Hg}};o.NC=function(){this.Cd(e);this.Lb.Ya();this.dispatchEvent(new Av)};o.MC=function(){this.iu();this.Uj(h);this.Lb.Ya()};o.JC=function(){this.ck(j)};o.Si=function(){k(Error("writely.callout.CalloutBlock.buildDomElement must be overridden"))};o.Gw=function(){this.LA(j);this.dispatchEvent(new sv)};o.Fw=function(){this.LA(e);this.dispatchEvent(new tv)};
o.LA=function(){k(Error("writely.callout.CalloutBlock.updateHoverState_ must be overridden in subclasses."))};o.kh=function(a){if(this.rx)return;this.FM(a.rc)};o.qx=function(a){this.rx=a};o.xM=function(){var a=this.bn>this.Hg?this.bn:this.Hg;if(this.yI!=a){this.Bb.style.top=a+"px";this.yI=a;if(this.bc)this.bc.style.display=this.bn>this.Hg?"none":""}};o.mL=function(a){this.bn=a;this.xM()};o.Rl=function(){this.il=this.Bb?this.Bb.offsetHeight:0;return this.il};
o.FM=function(a){for(var b=0,c;c=a[b];b++){var d=this.rk.Ea(c);d&&d.call(this)}};o.Nv=function(){var a=this.rk.Ob();for(var b=0,c;c=a[b];b++)c.call(this)};o.ck=function(){k(Error("callout.CalloutBlock.setShowFull must be overridden"))};o.Cd=function(){k(Error("callout.CalloutBlock.setEditable_ must be overridden"))};o.LB=function(){this.Ar=j;this.dispatchEvent(new $v)};o.kK=function(){this.Ar=e};o.iu=function(){this.Cd(e)};var $v=function(){G.call(this,"addedtodom")};var aw=function(){I.call(this);this.ju="generic";this.Xe="";this.Th=j;this.Zk=e;this.Ib=""};z(aw,I);o=aw.prototype;o.Oh=function(a){this.Ib=a;this.dispatchEvent(new uv(["id"]))};o.Gb=function(){return this.Ib};o.ck=function(a){this.Th=a;this.dispatchEvent(new uv(["showfull"]))};o.Wj=function(a){if(this.Zk!=a){this.Zk=a;this.dispatchEvent(new uv(["closed"]))}};o.Se=function(){return this.Zk};o.Sz=function(a){this.Xe=a;this.dispatchEvent(new uv(["markerId"]))};
o.$s=function(a){this.Xe=a.getAttribute("calloutmarkerId");this.Wj(a.getAttribute("calloutclosed")=="true");this.Th=a.getAttribute("calloutshowfull")!="false";var b=["markerId","closed","showfull"],c=this.FA(a);Kb(b,c);this.dispatchEvent(new uv(b))};o.ln=function(a){Od(a,"writely-callout-data",j);a.setAttribute("calloutmarkerId",this.Xe);a.setAttribute("calloutclosed",this.Zk);a.setAttribute("calloutshowfull",this.Th?"true":"false");a.setAttribute("contentEditable","false");this.Iz(a);return a};
o.FA=function(){return[]};o.Iz=function(a){return a};var dw=function(){this.r=new zf(this);this.Lb=new zf(this);this.Zc=h;this.Uk=new tc;this.Jg=new xc;this.xz=new Lj(Mv,500,bw);this.No=new cw;this.r.e(window,nd,this.mh);this.r.e(Fv(),"reload",this.nG);this.r.e(Fv(),"addnewitem",this.mG);this.r.e(Fv(),"pageviewswitch",this.zG);this.r.e(Fv(),"documentreload",this.AG);this.r.e(Fv(),"documentchange",this.Lw)},ew;z(dw,Bc);o=dw.prototype;o.n=h;o.Uh=e;o.jf=h;o.k=function(){if(!this.mF()){this.xz.k();dw.d.k.call(this);this.r.k();Q(this.n)}};
o.bj=function(){if(!this.Zc)this.Zc=O(ys()+"_wys_sidebar");return this.Zc};o.fu=function(){if(!this.n){this.n=document.createElement("div");this.jf=document.createElement("div");this.jf.className="commentThreadContainerElement";if(Cs())this.jf.style.right="10px";this.jf.style.display="none";for(var a=0,b;b=this.Jg[a];a++)this.Mt(b);this.n.appendChild(this.jf)}return this.n};o.YG=function(){this.at()};
o.nG=function(){var a=this.Jg.Ob();for(var b=0,c;c=a[b];b++){this.jz(c);this.Uk.Ea(s(c.constructor)).Gk(c);this.Jg.remove(c);this.No.iz(c)}this.visible(e)};o.mG=function(a){var b=a.Vk,c=[];for(var d=0,f;f=b[d];d++){var g=f.vw(),i,l,m=s(g);if(!(i=this.Uk.Ea(m))){i=new qv(0,200);this.Uk.h(m,i)}if(i.cq()<1){var n=new g;i.Gk(n)}l=i.Pc();this.Jg.add(l);l.hC(f);f.iC(l);this.Lb.e(l,"remove",this.pq);this.Mt(l);c.push(l)}for(var d=0,q;q=c[d];d++)this.No.xB(q)};
o.pq=function(a){var b=a.target,c,d=s(b.constructor);if(c=this.Uk.Ea(d))c.contains(b)&&c.Gk(b);this.Jg.remove(b);this.No.iz(b);this.jz(b)};o.zG=function(){this.mh()};o.AG=function(){this.mh();this.Lw();this.at()};o.Mt=function(a){ka(a)||(a=[a]);this.KA();if(this.n)for(var b=0,c;c=a[b];b++){this.jf.appendChild(c.Si());c.Si().style.display="";c.LB()}};o.jz=function(a){if(this.n)try{a.Si().style.display="none";Q(a.Si());a.kK()}catch(b){}this.KA()};
o.KA=function(){this.visible(this.xo()!=0);var a=this.xo();if(!this.hr||this.hr!=a){var b=this.hr;this.hr=a;if(b==0||a==0)this.Gv()}};o.xo=function(){return this.Jg.Pa()};o.Gv=function(){if(!Y.document.body)return;var a=this.xo()>0&&this.Uh;if(W("fullwidtheditor"))if(a){Y.document.documentElement.style.backgroundColor="#F3F3F3";Y.document.body.style.width=this.Pl().offsetWidth-230+"px"}else Y.document.body.style.width=""};o.visible=function(a){if(this.Uh!=a){a?this.fk():this.nh();this.Gv();this.mh()}};
o.oa=function(){return this.Uh};o.fk=function(){this.Uh=j;this.bj().style.display="";this.jf.style.display="";this.mh()};o.nh=function(){this.Uh=e;this.jf.style.display="none"};o.at=function(){F?this.qM():this.pM()};o.pM=function(){this.bj().scrollTop=Y.document.documentElement.scrollTop};o.qM=function(){this.bj().scrollTop=Y.document.body.scrollTop};o.Lw=function(){this.n.style.height=Y.document.documentElement.scrollHeight+O("navigation").offsetHeight;this.at();this.xz.Np()};
o.mh=function(){if(!this.n||!Y||!Y.document||!Y.document.documentElement)return;if(this.Uh){this.bj().style.height=this.Pl().offsetHeight;this.bj();if(W("fullwidtheditor")){var a=this.Pl().offsetWidth-230;if(Cs()){this.Zc.style.left=0;Y.document.body.style.width=a+"px";Y.document.body.style.marginLeft="230px"}else{this.Zc.style.left=a;Y.document.body.style.width=a+"px"}}else{var b=Y.document.body.offsetWidth,c=this.Pl().offsetWidth;if(B&&!qb("7"))c+=14;if(c/2-b/2>230){Y.document.body.style.marginLeft=
"";Y.document.body.style.marginRight="";if(Cs()){this.Zc.style.left="";this.Zc.style.right=c/2+b/2-(B&&!qb("7")?15:0)}else this.Zc.style.left=c/2+b/2-15}else{var d=c-b-230;d=d<0?0:d;if(Cs()){Y.document.body.style.marginRight=d-10+"px";this.Zc.style.right=c-230-(B&&!qb("7")?15:0);this.Zc.style.left=0}else{Y.document.body.style.marginLeft=d+"px";this.Zc.style.left=c-230}}}}else{Y.document.body.style.marginLeft="";Y.document.body.style.marginRight="";Y.document.body.style.width=""}};
o.Pl=function(){return ys()=="view"?O("viewiframe"):O("wys_frame")};var fw=function(){I.call(this);this.Gg=h;this.start=0;this.md=0;this.Xa=0;this.height=0;this.left=0;this.oh=e};z(fw,I);o=fw.prototype;
o.ks=function(a){if(this.Gg){ad(this.Gg,"positionchange",this.Hw,undefined,this);ad(this.Gg,"remove",this.Iw,undefined,this);ad(this.Gg,"sizechange",this.Jw,undefined,this)}this.Gg=a;if(a){this.height=a.Rl();H(a,"positionchange",this.Hw,undefined,this);H(a,"remove",this.Iw,undefined,this);H(a,"sizechange",this.Jw,undefined,this)}};o.Hw=function(a){this.height=a.target.Rl();this.dispatchEvent(new gw(a.ce()))};o.Iw=function(){this.ks(h);this.dispatchEvent(new Av)};
o.Jw=function(a){this.height=a.target.Rl();this.dispatchEvent(new hw)};o.setStart=function(a){this.start=a};var cw=function(){this.r=new zf(this);this.ni=new tc;this.Gd=[];this.r.e(Fv(),"documentchangepost",this.hj)};o=cw.prototype;o.hj=function(){this.et(0)};o.xB=function(a){var b=this.ni.Ea(s(a));if(!b){b=new fw;b.ks(a)}this.ni.h(s(a),b);var c=a.Vv();if(c.x>0||c.y>0)this.Qt(b,a.Vv());this.r.e(b,"bcipositionchange",this.Qw);this.r.e(b,"bcisizechange",this.Rw)};
o.iz=function(a){var b=this.ni.Ea(s(a));if(b){this.r.W(b,"bcipositionchange",this.Qw);this.r.W(b,"bcisizechange",this.Rw);this.aG(b);this.ni.remove(s(a));b.ks(h)}};o.Qw=function(a){this.Qt(a.target,a.ce())};o.Rw=function(a){this.et(this.$r(a.target))};o.aG=function(a){var b=Nb(this.Gd,a,this.Qo);if(b>-1){Rb(this.Gd,a,this.Qo);this.et(b)}};
o.Qt=function(a,b){var c=this.$r(a);if(c>-1){var d=this.Gd[c-1],f=this.Gd[c+1];a.Lm=b.y;a.Km=b.x;if((!d||this.yu(d,a)<0)&&(!f||this.yu(a,f)<0)){a.Lm=undefined;a.Km=undefined;a.Xa=b.y;a.left=b.x;return}else{a.Lm=undefined;a.Km=undefined;Gb(this.Gd,c)}}a.Xa=b.y;a.left=b.x;this.SH(a)};o.SH=function(a){var b=this.$r(a);if(b<0){Fb(this.Gd,a,-(b+1));return-(b+1)}return-1};o.$r=function(a,b){return Nb(this.Gd,a,b||this.Qo)};
o.et=function(a){var b=h,c=h,d=a;while(this.Gd[d]){b=this.Gd[d];c=this.Gd[d-1];if(b&&c&&(c.md>b.Xa||c.oh)){if(c.md>b.Xa){var f=0;f=c.Xa==b.Xa?0:2;c.oh=j;b.setStart(c.md+f)}else if(c.oh){var g=0;if(b.Xa-c.md<2){g=2-(b.Xa-c.md);c.oh=j}else c.oh=e;b.setStart(b.Xa+g)}b.md=b.start+b.height}else if(b&&!c){b.setStart(b.Xa);b.md=b.start+b.height}else if(b&&c){var g=0;if(b.Xa-c.md<2){g=2-(b.Xa-c.md);c.oh=j}b.setStart(b.Xa+g);b.md=b.start+b.height}d++}var i=this.ni.Ob();for(var l=0,m;m=i[l];l++)m.Gg.mL(m.start)};
o.Qo=function(a,b){if(a.Xa<b.Xa)return-1;else if(a.Xa>b.Xa)return 1;else if(a.Xa==b.Xa)if(a.left<b.left)return-1;else if(a.left>b.left)return 1;else if(s(a)==s(b))return 0;else if(s(a)<s(b))return-1;else if(s(a)>s(b))return 1};o.yu=function(a,b){var c=a.Lm||a.Xa,d=b.Lm||b.Xa,f=a.Km||a.left,g=b.Km||b.left;if(c<d)return-1;else if(c>d)return 1;else if(c==d)if(f<g)return-1;else if(f>g)return 1;else if(s(a)==s(b))return 0;else if(s(a)<s(b))return-1;else if(s(a)>s(b))return 1};
var gw=function(a){G.call(this,"bcipositionchange");this.TI=a};z(gw,G);gw.prototype.ce=function(){return this.TI};var hw=function(){G.call(this,"bcisizechange")};z(hw,G);var bw=function(){I.call(this);this.Vk=new tc;this.Lb=new zf(this);this.r=new zf(this);this.r.e(this,"documentreload",this.load);this.Ji=new xc},iw;z(bw,I);var Fv=function(){return iw||(iw=new bw)};o=bw.prototype;o.ul=function(a){ka(a)?this.Ji.Fk(a):this.Ji.add(a);Lv()};o.Wu=function(a){ka(a)?this.Ji.Ya(a):this.Ji.remove(a);Lv()};o.Fx=function(a){return this.Ji.contains(a)};
o.load=function(){if(!Y)return h;var a=Y.document.getElementsByTagName(rv);if(a.length==0){a=Y.document.getElementsByTagName("callout");if(a.length==0)a=Y.document.getElementsByName("gdoccallout")}this.Lb.Ya();this.dispatchEvent(new vv);this.Vk.clear();var b=this.Fx("comment"),c=this.Fx("footnote"),d=[];for(var f=0,g;g=a[f];f++){var i;if((i=g.getAttribute("callouttype"))!=h){var l;if(b&&i=="comment"){var m=new eq.bl.Et(i);l=new eq.bl.bN(m);m.$s(g)}else if(c&&i=="footnote"){var m=new jw;l=new kw(m);
m.$s(g)}if(l&&!l.Se()){l.YK(g);this.Lb.e(l,"remove",this.pq);d.push(l)}}}this.dispatchEvent(new wv(d));Mv();return this.Vk};o.pq=function(){};var lw=function(){var a=Y.document.getElementsByTagName("marker");for(var b=0,c;c=a[b];b++)Q(c)},Mv=function(){Fv().dispatchEvent(new xv);Fv().dispatchEvent(new yv)},Lv=function(){if(!Y||!Y.document)return;Fv().dispatchEvent(new zv)},mw=function(){Fv().dispatchEvent(new Dv)},nw=function(){Fv().dispatchEvent(new vv)};var kw=function(a){Gv.call(this,a)};z(kw,Gv);kw.prototype.vw=function(){return ow};kw.prototype.kh=function(a){this.save();Cb(a.rc,"closed")&&this.Wj(this.R.Se())};kw.prototype.nw=function(){return"writely-footnote-marker"};kw.prototype.IA=function(a){Od(this.ca,"writely-footnote-marker-highlight",a)};Gv.prototype.mz=function(){var a=e;try{Q(this.ka);a=j}catch(b){}return a};var ow=function(){Qv.call(this);this.r=new zf(this);this.be=new zf(this);this.Hi=e;this.rk.h("content",this.gt);this.rk.h("closed",this.GM);this.rk.h("showfull",this.HM)};z(ow,Qv);var pw="footnoteWrapper-grey";o=ow.prototype;o.Rl=function(){if(this.Bb){B&&this.wE();this.il=this.Bb.offsetHeight}else this.il=0;return this.il};
o.Si=function(){if(!this.Bb){this.Bb=document.createElement("div");this.Bb.className=Rv+" "+pw;this.r.e(this.Bb,"mouseover",this.Gw);this.r.e(this.Bb,"mouseout",this.Fw);this.Vn=document.createElement("div");this.Vn.className=Xv+" commentWrapper";this.qk=document.createElement("div");this.qk.className=Sv;this.kr=document.createElement("div");this.kr.className=Tv+" "+Sv+" "+Xv+" "+Vv;this.Tr=document.createElement("div");this.Tr.className=Uv+" "+Sv+" "+Xv+" "+Vv;if(B){this.kr.style.width="1px";this.Tr.style.width=
"1px"}this.qr=document.createElement("div");this.qr.innerHTML="&nbsp;";this.qr.className=Sv+" "+Xv+" "+Yv+" calloutBorderTop";this.qk.appendChild(this.kr);this.qk.appendChild(this.qr);this.qk.appendChild(this.Tr);this.Bb.appendChild(this.qk);this.nc=document.createElement("div");this.nc.className=B?"calloutBlockTitleBarIE "+Xv:"calloutBlockTitleBar";this.r.e(this.nc,"mousedown",this.yq);this.Jn=document.createElement("div");this.Jn.className=Zv;this.Jn.innerHTML="\u811a\u6ce8";this.ud=document.createElement("div");
this.ud.innerHTML="&nbsp;";this.ud.className="commentMenu";ag(this.ud,0.5);this.r.e(this.ud,"mouseover",this.TG);this.r.e(this.ud,"mouseout",this.SG);this.LF().mi(this.ud);this.$k=document.createElement("div");this.$k.style.overflow="auto";this.$k.style.clear="both";this.Va=document.createElement("div");this.Va.className="commentBody footnoteBody-grey";this.Va.title="\u70b9\u51fb\u53ef\u8fdb\u884c\u7f16\u8f91";this.r.e(this.Va,"click",this.iG);this.bc=document.createElement("div");this.bc.style.position=
"absolute";this.bc.height="13px";this.bc.width="12px";this.bc.style.top=4;if(Cs())this.bc.style.right=2;else this.bc.style.left=-10;var a=this.GJ;this.bc.appendChild(a(0,9,11,2));this.bc.appendChild(a(1,7,9,2));this.bc.appendChild(a(2,5,7,2));this.bc.appendChild(a(3,3,5,2));this.bc.appendChild(a(4,1,3,2));this.bc.appendChild(a(5,0,1,1));this.Bb.appendChild(this.Vn);this.Bb.appendChild(this.bc);this.nc.appendChild(this.Jn);this.nc.appendChild(this.ud);this.$k.appendChild(this.Va);this.Vn.appendChild(this.nc);
this.Vn.appendChild(this.$k);this.oi=document.createElement("div");this.oi.className=Sv;this.yo=document.createElement("div");this.yo.className=Tv+" "+Sv+" "+Xv+" "+Wv;this.Ao=document.createElement("div");this.Ao.className=Uv+" "+Sv+" "+Xv+" "+Wv;if(B){this.yo.style.width="1px";this.Ao.style.width="1px"}this.zo=document.createElement("div");this.zo.className=Sv+" "+Xv+" "+Yv+" calloutBorderBottom";this.zo.innerHTML="&nbsp;";this.oi.appendChild(this.yo);this.oi.appendChild(this.zo);this.oi.appendChild(this.Ao);
this.Bb.appendChild(this.oi);this.Nv()}return this.Bb};o.GJ=function(a,b,c,d){var f=document.createElement("div");f.style.top=a;f.style.left=Cs()?10-b:b;f.className="comment-show-color writely-callout-block-pointer-line";f.style.height=c+"px";f.style.width=d+"px";if(b==0){f.style.borderLeftWidth="1px";f.style.borderLeftStyle="solid";f.style.borderBottomWidth="0px"}f.innerHTML="&nbsp;";return f};
o.LF=function(){if(!this.Zm){this.Zm=new Kh;var a=new Xg("\u5220\u9664\u811a\u6ce8","");this.Zm.Z(a);this.r.e(a,"action",this.vG);this.Zm.zb();a.u(fr())}return this.Zm};o.vG=function(){this.R.Wj(j)};
o.gt=function(){if(this.Va)if(this.Hi&&this.R){var a=this.eb.Hf();this.eb.ss(e,this.R.pa);this.eb.os(a)}else if(this.R){var b=this.R.pa;if(!this.Ho)this.Ho=document.createElement("div");this.Ho.innerHTML=b;if(!this.R.Se()&&this.Jx(this.Ho))this.Cd(j);else this.Va.innerHTML=this.R.pa}else this.Va.innerHTML=""};o.wE=function(){this.Va.style.height=!this.Hi&&$f(this.Va).height>=80?"80px":""};
o.GM=function(){if(this.R.Se()){this.Cd(e);var a=document.createElement("span");a.innerHTML="\u811a\u6ce8\u5df2\u5220\u9664\u3002&nbsp;";a.className=Zv;var b=document.createElement("span");b.innerHTML="\u64a4\u6d88";b.style.color="blue";b.className=Zv;this.r.e(b,"click",this.aH);$d(this.nc);this.nc.appendChild(a);this.nc.appendChild(b);this.r.W(this.nc,"mousedown",this.yq);this.Va.style.display="none";this.dispatchEvent(new Cv)}else{if(this.nc){$d(this.nc);this.nc.appendChild(this.Jn);this.nc.appendChild(this.ud);
this.r.e(this.nc,"mousedown",this.yq);if(this.R.Th)this.Va.style.display="";this.gt()}this.dispatchEvent(new Cv)}};o.aH=function(){this.R.Wj(e)};
o.Cd=function(a){if(a){qw();this.JA()}if(this.Hi!=a&&fr())if(a){if(!this.Ar){this.r.e(this,"addedtodom",this.Dw);return}if(!this.Nd){this.Nd=document.createElement("div");this.Nd.id=js();this.Nd.style.height="80px";this.Nd.style.width="98%"}this.Va.innerHTML="";this.Va.appendChild(this.Nd);this.eb&&fq.Gm(this.eb);this.eb=new rw(this.Nd.id,{cssStyles:"body {font-family: Arial, sans-serif; font-size: 11px; margin:0;} p {margin: 0;}"});this.be.e(this.eb,"delayedchange",this.rq);this.be.e(this.eb,"focus",
this.rq);this.be.e(this.eb,R.ut,u(this.DB,this));var b=this.Va.style.display;this.Va.style.display="";fq.wh(this.eb);this.Va.style.display=b}else{sw();this.YC();this.be.Ya();this.fn();try{fq.Gm(this.eb)}catch(c){}this.eb=h;Q(this.Nd);this.Qp=e;this.Tt(a)}};
o.DB=function(){if(this.Va.style.display=="none"){this.Cd(e);this.Va.style.display="none"}else{this.be.e(this.eb.Ti(),"mousedown",this.rq);this.be.e(this.eb.Ti(),"keypress",this.wq);this.be.e(T.Ti(),"mousedown",this.nq);this.be.e(fq,"focus",this.CG);this.be.e(this.eb.Ti(),"blur",this.fn);this.eb.b().focus();this.eb.focus();this.Tt(j)}};o.Tt=function(a){this.Hi=a;this.gt();this.dispatchEvent(new Cv)};
o.fn=function(){if(this.eb){this.qx(j);var a=this.eb.Ll();if(F)a=a.replace(/(<div[^<]*)(<div[^>]*>)/ig,"$1<br>");a=a.replace(/<div[^>]*>/ig,"");a=a.replace(/<\/div>/ig,"<br>");a=a.replace(/<p[^>]*>/ig,"");a=a.replace(/<\/p>/ig,"<br>");a=a.replace(/(<br[^>]*>)+$/i,"");this.R.Sb(a);this.qx(e)}};o.Dw=function(){this.r.W(this,"addedtodom",this.Dw);this.Cd(j)};o.rq=function(){if(this.Vr){Dd(this.Vr);this.Vr=h}this.Vr=Cd(this.fn,1000,this)};o.wq=function(a){if(a.keyCode==27){a.preventDefault();T.focus()}this.JA()};
o.iG=function(){this.Cd(j);this.Nd&&this.Nd.focus()};o.Jx=function(a){return Ea(a.innerText==undefined?a.textContent:a.innerText).length<1?j:e};o.JA=function(){this.qj&&window.clearTimeout(this.qj);this.qj=window.setTimeout(u(this.vC,this),60000)};o.YC=function(){this.qj&&window.clearTimeout(this.qj);this.qj=h};o.vC=function(){if(this.Hi){Y.focus();F&&this.nq()}};o.nq=function(){sw();this.Qp=e;this.tg(e);this.Jx(this.eb.b())?this.fn():window.setTimeout(u(this.Cd,this,e),0)};o.yq=function(){this.ck(!this.R.Th)};
o.TG=function(){ag(this.ud,1)};o.SG=function(){ag(this.ud,0.5)};o.HM=function(){if(this.Va){if(this.R.Th)this.Va.style.display="";else{this.Cd(e);this.Va.style.display="none"}this.dispatchEvent(new Cv)}};o.ck=function(a){this.R.ck(a)};o.CG=function(a){if(a.p!=this.eb)this.nq();else{this.Qp=j;this.tg(j)}};o.tg=function(a){if(this.Qp)a=j;Od(this.Bb,pw,!a);Od(this.Bb,"footnoteWrapper-grey-highlight",a)};o.Gw=function(){this.tg(j);this.dispatchEvent(new sv)};o.Fw=function(){this.tg(e);this.dispatchEvent(new tv)};
var rw=function(a,b){vp.call(this,a,b);this.pb(new Bm);this.pb(new tw);this.pb(new Vn);this.pb(new jp);this.pb(new np);this.pb(new ip)};z(rw,vp);var jw=function(a){aw.call(this);this.ju="footnote";this.pa="";a&&this.$s(a)};z(jw,aw);jw.prototype.FA=function(a){this.pa=a.innerHTML;return["content"]};jw.prototype.Iz=function(a){Od(a,"google_footnote",j);a.innerHTML=this.pa;return a};jw.prototype.Sb=function(a){if(this.pa!=a){this.pa=a;this.dispatchEvent(new uv(["content"]))}};var uw=function(a){aq.call(this,a.Ka,a.Fg,a)};z(uw,aq);Pn.prototype.vu=function(){};uw.prototype.Wo=function(a){var b=this.p,c=new Pn(b.Be,b.fa(),u(this.Rm,this),this.Ka,this.Fg,Eq("styles"),new Ci(4500));c.Vz(a||this.iF());return c};uw.prototype.iF=function(){var a=vw().Kd();a=a.replace(/^\s+?( *\S)/,"$1");a=a.replace(/\s+$/,"");a+="\n";return a};uw.prototype.Rm=function(a){uw.d.Rm.call(this,a);Lv()};var ww=function(){this.$N=u(this.FB,this);this.Sp=new Ac;this.Sp.fO=e;this.Sp.gO=e;this.YH=e};ww.prototype.VK=function(a){if(a==this.YH)return;if(!a)this.UN=""};
ww.prototype.FB=function(a){var b=this.Sp.CN(a);if(window.console&&window.console.firebug)switch(a.GN()){case zc.wt.vt.$M:window.console.info(b);break;case zc.wt.vt.ZM:window.console.error(b);break;case zc.wt.vt.cN:window.console.warn(b);break;default:window.console.debug(b);break}else if(window.console)window.console.log(b);else window.opera&&window.opera.postError(b)};var xw=h,yw=function(){xw||(xw=new ww);window.location.href.indexOf("Debug=true")!=-1&&xw.VK(j)};var zw={},Aw=function(a){var b=0;if(a.charAt(0)=="!"){a=a.substring(1);b=1}return!!(b^(zw[a]||window.location.search&&window.location.search.match(a+"=true")!=h?1:0))};w("_setFlag",function(a,b){zw[a]=b});var Bw=Aw("Debug");w("_initConsole",function(a){if(a)Bw=a;Bw&&window.console&&yw()});var Cw=function(a){this.sN=a};o=Cw.prototype;o.b=function(a){if(document.getElementById(a)!=h)return O(a);else if(window.parent!=h)return window.parent.document.getElementById(a)};o.$K=function(a,b){if(this.b(a)!=h)this.b(a).innerHTML=b};o.HL=function(a){if(this.b(a)!=h)this.b(a).style.display=""};o.yH=function(a){if(this.b(a)!=h)this.b(a).style.display="none"};o.IL=function(a){this.$K("noticeText",a);this.HL("noticeTable");window.setTimeout(this.zH.bind(this),5000)};o.zH=function(){this.yH("noticeTable")};
o.cf=function(){typeof er!="undefined"?vs():window.location.reload(j)};o.Hv=function(a){var b=this.b(a).style.display==="";this.b(a).style.display=b?"none":""};var Dw=function(a){this.pc=new Cw(this);this.wm=a;this.wm&&this.gg(e)};o=Dw.prototype;o.Kr=function(a,b){ps();document.body.style.cursor="wait";this.gg(j);b=b||u(this.pc.cf,this.pc);var c=function(f){document.body.style.cursor="default";rs();if(f&&!ws(f)){X("ispublished",a);b()}},d=uq();iq("publish_public",{docid:d,on:a},u(c,this),"publish_public"+d)};
o.oM=function(){var a=W("ispublished")||zq("\u6b64\u5728\u7ebf\u6587\u6863\u5c1a\u672a\u53d1\u5e03\u3002\u7acb\u5373\u53d1\u5e03\u5417\uff1f"),b=O("autoRepublish").checked;a?this.Kr(j,u(this.ol,this,b,"auto_republish")):this.ol(b,"auto_republish")};o.zM=function(){var a=!W("ispublished")&&zq("\u6b64\u5728\u7ebf\u6587\u6863\u5c1a\u672a\u53d1\u5e03\u3002\u7acb\u5373\u53d1\u5e03\u5417\uff1f"),b=O("publishOutside").checked;a?this.Kr(j,u(this.ol,this,b,"allow_public_access")):this.ol(b,"allow_public_access")};
o.ol=function(a,b){ps();document.body.style.cursor="wait";var c=function(f){document.body.style.cursor="default";rs();f&&!ws(f)&&this.pc.cf()},d=uq();iq("set_sharing_option",{docid:d,type:b,on:a},u(c,this),"set_sharing_option"+d)};o.gg=function(a){if(this.wm)window.parent.editor&&typeof window.parent.editor.recordLatencyStat=="function"&&window.parent.editor.recordLatencyStat(a,29);else{var b="publish";a?Rq(b):Tq(b)}};w("writely.Publish",Dw);y(Dw.prototype,"publish",Dw.prototype.Kr);
y(Dw.prototype,"updateAutoRepublish",Dw.prototype.oM);y(Dw.prototype,"updatePublicAccess",Dw.prototype.zM);var Ew=function(a,b,c){this.Pn=a;this.pc=new Cw(this);this.wm=b;this.Tq=c};o=Ew.prototype;o.dK=function(a){if(a!=this.Pn||zq("\u786e\u5b9e\u8981\u4ece\u6b64\u5728\u7ebf\u6587\u6863\u4e2d\u5220\u9664\u81ea\u5df1\u5417\uff1f")){ps();document.body.style.cursor="wait";this.gg(j);var b=function(d){document.body.style.cursor="default";rs();if(d&&!ws(d)){this.gg(e);this.pc.cf()}else U(Fw)},c=uq();iq("remove_collaborator",{docid:c,authors:a},u(b,this),"remove_collaborator"+c)}};
o.cM=function(){var a=!W("allowopencollaboration");X("allowopencollaboration",a);ps();document.body.style.cursor="wait";var b=function(d){document.body.style.cursor="default";rs();if(d&&!ws(d)){this.pc.Hv("hintAllowOpenCollaboration");this.pc.Hv("hintNoAllowOpenCollaboration");this.Es()}else U(Gw)},c=uq();iq("set_sharing_option",{docid:c,type:"allow_open_collaboration",on:a},u(b,this),"set_sharing_option"+c)};
o.dM=function(){if(Kq("numcollaborators")!=0||Kq("numviewers")!=0)if(W("allowopeninvites"))if(!zq("\u60a8\u786e\u5b9a\u5417\uff1f\u5982\u679c\u6709\u4eba\u4ee5\u524d\u7684\u9080\u8bf7\u4e0d\u662f\u5bf9\u5e94\u5230\u786e\u5b9e\u7684\u7535\u5b50\u90ae\u4ef6\u5730\u5740\uff08\u6bd4\u5982\u90ae\u4ef6\u5217\u8868\uff09\uff0c\u5219\u6b64\u4eba\u7684\u8bbf\u95ee\u5c06\u4f1a\u906d\u5230\u62d2\u7edd\u3002")){O("allowOpenCollaboration").checked=j;return}var a=!W("allowopeninvites");X("allowopeninvites",a);
ps();document.body.style.cursor="wait";var b=function(d){document.body.style.cursor="default";rs();d&&!ws(d)?this.Es():U(Gw)},c=uq();iq("set_sharing_option",{docid:c,type:"allow_open_invites",on:a},u(b,this),"set_sharing_option"+c)};o.MA=function(a){var b=O("inviteButton");if(!b)return;var c=Va("<b><b><b><strong>",a?"\u9080\u8bf7\u534f\u4f5c\u8005":"\u9080\u8bf7\u6d4f\u89c8\u8005","</strong></b></b></b>");b.innerHTML=c};
o.fK=function(a){var b;b=a?this.Tq?"\u672c\u64cd\u4f5c\u5c06\u5220\u9664\u8be5\u5728\u7ebf\u6587\u6863\u7684\u6240\u6709\u534f\u4f5c\u8005\u3002\u662f\u5426\u7ee7\u7eed\uff1f":"\u8fd9\u4f1a\u4ece\u8be5\u5728\u7ebf\u6587\u6863\u4e2d\u5220\u9664\u6240\u6709\u534f\u4f5c\u8005\uff08\u5305\u62ec\u60a8\u81ea\u5df1\uff09\uff01\u662f\u5426\u7ee7\u7eed\uff1f":"\u672c\u64cd\u4f5c\u5c06\u5220\u9664\u8be5\u5728\u7ebf\u6587\u6863\u7684\u6240\u6709\u67e5\u770b\u8005\u3002\u662f\u5426\u7ee7\u7eed\uff1f";if(zq(b)){ps();
document.body.style.cursor="wait";var c=function(g){document.body.style.cursor="default";rs();g&&!ws(g)?this.pc.cf():U(Fw)},d=uq(),f=a?"remove_all_collaborators":"remove_all_viewers";iq(f,{docid:d},u(c,this),f+d)}};o.ZC=function(a){if(W("allowopencollaboration")||this.Tq){O("users_to_invite").value="";a&&this.pc.cf()}};o.nr=function(){return Ea(document.getElementById("users_to_invite").value)};
o.SB=function(a){var b=O("anyoneCanEditOrView"),c=O("anyoneCanEditOption").selected,d=a||b.checked;if(a&&!b.checked)b.checked=j;var f=O("users_to_invite").value.length==0?this.pc.cf:this.Es;ps();document.body.style.cursor="wait";var g=function(m){document.body.style.cursor="default";rs();m&&!ws(m)?f():U(Gw)},i=uq(),l="invite_everyone";iq(l,{docid:i,everyone:d,can_edit:c},u(g,this),l+i)};
o.mE=function(a,b,c,d){if(window.location!=window.top.location)if(window.parent.editor&&typeof window.parent.editor.sendEmail=="function"){window.parent.editor.sendEmail(a,b);return}else{if(typeof window.parent.bB=="function"){window.parent.bB(a,b,c,d,e);return}}else if(typeof Is=="function"){Is(a,b,c,d,e);return}this.pc.cf()};
o.WH=function(){var a=this.nr();if(a==""){U("\u8bf7\u8f93\u5165\u8981\u9080\u8bf7\u6765\u5171\u4eab\u6b64\u6587\u6863\u7684\u4eba\u3002");return}ps();document.body.style.cursor="wait";this.gg(j);var b=O("as_collaborators").checked?"authors":"viewers",c=uq(),d="validate_addresses";iq(d,{docid:c,addr:a},u(this.vJ,this,b,a),d+c)};
o.vJ=function(a,b,c){if(!c||ws(c)){U(Gw);document.body.style.cursor="default";rs();return}var d=uq(),f=new tc;f.h(a,b);f.h("docid",d);var g="invite_people";iq(g,f,u(this.lJ,this,b),g+d)};
o.lJ=function(a,b){document.body.style.cursor="default";rs();if(!b||ws(b)){U(Gw);return}this.ZC();this.gg(e);if(a&&Kt(a).length>Jq("max_email_recipients")){us();return}if(window.location!=window.top.location){if(window.parent.editor&&typeof window.parent.editor.sendEmail=="function"){window.parent.editor.sendEmail(e,e,a);return}if(typeof window.parent.cB=="function"){window.parent.cB(a);return}}else if(typeof Js=="function"){Js(a);return}this.pc.cf()};o.Es=function(){this.pc.IL("\u8bbe\u7f6e\u5df2\u66f4\u6539\u3002")};
o.gH=function(){if((W("allowopencollaboration")||this.Tq)&&this.nr().length>0)return'\u60a8\u5c1a\u672a\u9080\u8bf7\u8fd9\u4e9b\u4eba\u3002 \u73b0\u5728\u70b9\u51fb"\u53d6\u6d88"\uff0c\u7136\u540e\u70b9\u51fb"\u9080\u8bf7\u8fd9\u4e9b\u4eba"\u9080\u8bf7\u4ed6\u4eec\u3002 \u73b0\u5728\u5355\u51fb"\u786e\u5b9a"\u7565\u8fc7\u9080\u8bf7\u3002';return h};
o.gg=function(a){if(this.wm)window.parent.editor&&typeof window.parent.editor.recordLatencyStat=="function"&&window.parent.editor.recordLatencyStat(a,30);else{var b="update_collaborators";a?Rq(b):Tq(b)}};w("writely.Share",Ew);y(Ew.prototype,"removeCollaborator",Ew.prototype.dK);y(Ew.prototype,"toggleOpenCollaboration",Ew.prototype.cM);y(Ew.prototype,"toggleOpenInvitations",Ew.prototype.dM);y(Ew.prototype,"updateInviteButton",Ew.prototype.MA);y(Ew.prototype,"removeEveryone",Ew.prototype.fK);
y(Ew.prototype,"listInvitees",Ew.prototype.nr);y(Ew.prototype,"anyoneCanEditOrView",Ew.prototype.SB);y(Ew.prototype,"inviteThesePeople",Ew.prototype.WH);y(Ew.prototype,"emailFolks",Ew.prototype.mE);y(Ew.prototype,"hasPendingChanges",Ew.prototype.gH);var Hw="\u5f88\u62b1\u6b49\uff0c\u7f51\u7edc\u9519\u8bef\u963b\u6b62\u201cGoogle \u6587\u6863\u201d\u5b8c\u6210\u6b64\u64cd\u4f5c\u3002\u8bf7\u91cd\u8bd5\u3002",Iw="\u62b1\u6b49\uff0c\u7531\u4e8e\u7f51\u7edc\u9519\u8bef\uff0c\u201cGoogle \u6587\u6863\u201d\u65e0\u6cd5\u4fdd\u5b58\u60a8\u7684\u66f4\u6539\u3002\u8bf7\u91cd\u8bd5\u3002\u5982\u679c\u95ee\u9898\u4ecd\u7136\u5b58\u5728\uff0c\u8bf7\u5728\u91cd\u5efa\u7f51\u7edc\u8fde\u63a5\u4e4b\u540e\u518d\u5f00\u59cb\u64cd\u4f5c\uff0c\u5426\u5219\u672a\u4fdd\u5b58\u7684\u66f4\u6539\u53ef\u80fd\u4f1a\u4e22\u5931\u3002",
Jw="\u5185\u90e8\u9519\u8bef\u4f7f\u201cGoogle \u6587\u6863\u201d\u65e0\u6cd5\u4fdd\u5b58\u66f4\u6539\u3002\u9519\u8bef\u5df2\u8bb0\u5f55\u4e0b\u6765\uff0c\u4ee5\u4f9b\u60a8\u7acb\u5373\u8c03\u67e5\u3002\u5bf9\u4e8e\u9020\u6210\u7684\u4e0d\u4fbf\uff0c\u6211\u4eec\u5f88\u62b1\u6b49\u3002",Kw="\u7531\u4e8e\u53d1\u751f\u5185\u90e8\u9519\u8bef\uff0c\u201cGoogle \u6587\u6863\u201d\u65e0\u6cd5\u5b8c\u6210\u6b64\u64cd\u4f5c\u3002\u9519\u8bef\u5df2\u8bb0\u5f55\u4e0b\u6765\uff0c\u4ee5\u4f9b\u60a8\u7acb\u5373\u8c03\u67e5\u3002\u5bf9\u4e8e\u9020\u6210\u7684\u4e0d\u4fbf\uff0c\u6211\u4eec\u5f88\u62b1\u6b49\u3002",
Lw="\u5f88\u62b1\u6b49\uff0c\u6b64\u5728\u7ebf\u6587\u6863\u592a\u5927\uff0c\u65e0\u6cd5\u4fdd\u5b58\u5728\u201cGoogle \u6587\u6863\u201d\u4e2d\u3002HTML \u6587\u4ef6\u7684\u5927\u5c0f\u9650\u5236\u4e3a 512KB\u3002",Mw="\u60a8\u6700\u8fd1\u5bf9\u4ee5\u4e0b\u5728\u7ebf\u6587\u6863\u7684\u66f4\u6539\u4e0e\u534f\u4f5c\u8005\u521a\u521a\u6240\u505a\u7684\u66f4\u6539\u53d1\u751f\u51b2\u7a81\uff0c\u6240\u4ee5\u60a8\u7684\u8fd9\u4e9b\u66f4\u6539\u5df2\u88ab\u53d6\u6d88\u3002\u8fd9\u53ea\u4f1a\u5f71\u54cd\u521a\u521a\u8fdb\u884c\u7684\u66f4\u6539\uff1a",
Nw="\u60a8\u6700\u8fd1\u5bf9\u4ee5\u4e0b\u5728\u7ebf\u6587\u6863\u7684\u66f4\u6539\u4e0e\u534f\u4f5c\u8005\u521a\u521a\u6240\u505a\u7684\u66f4\u6539\u53d1\u751f\u51b2\u7a81\uff0c\u6240\u4ee5\u60a8\u7684\u8fd9\u4e9b\u66f4\u6539\u5df2\u88ab\u53d6\u6d88\u3002 \u8fd9\u53ea\u4f1a\u5f71\u54cd\u521a\u521a\u8fdb\u884c\u7684\u66f4\u6539\u6216\u79bb\u7ebf\u72b6\u6001\u4e0b\u6240\u505a\u7684\u66f4\u6539\uff1a",Ow="\u62b1\u6b49\uff0c\u60a8\u7684\u66f4\u6539\u5c1a\u672a\u4fdd\u5b58\u3002 \u4e3a\u4e86\u907f\u514d\u4e22\u5931\u66f4\u6539\uff0c\u8bf7\u5c06\u8be5\u6587\u672c\u590d\u5236\u5230\u526a\u8d34\u677f\uff0c\u7136\u540e\u5237\u65b0\u8be5\u9875\uff0c\u518d\u91cd\u65b0\u5c06\u8be5\u6587\u672c\u7c98\u8d34\u5230\u6587\u6863\u4e2d\u3002",
Ru='\u8bf7\u9009\u62e9\u56fe\u50cf\u6587\u4ef6 \uff0d \u60a8\u53ef\u4ee5\u4f7f\u7528"\u6d4f\u89c8"\u6309\u94ae\u6765\u67e5\u627e\u3002',Su="\u76ee\u524d\u65e0\u6cd5\u4e0a\u4f20\u56fe\u50cf\u3002",Gw="\u62b1\u6b49\uff01\u7531\u4e8e\u51fa\u73b0\u670d\u52a1\u5668\u9519\u8bef\uff0c\u60a8\u65e0\u6cd5\u5171\u4eab\u6587\u6863\u3002 \u8bf7\u91cd\u8bd5\u3002",Fw="\u62b1\u6b49\uff01\u7531\u4e8e\u51fa\u73b0\u670d\u52a1\u5668\u9519\u8bef\uff0c\u60a8\u65e0\u6cd5\u5171\u4eab\u6587\u6863\u3002 \u8bf7\u91cd\u8bd5\u3002";var Pw=ua(),Qw=h,Rw=0,Sw=0,Tw=e,Uw=0,Vw=e,Ww=e,sw=function(){Ww=j},qw=function(){Ww=e},Xw=function(a){a=a||ua();return a-Pw},Yw=function(){var a=Qw;return a!=h&&ua()-a<300000},Zw=function(){Uw=ua()},$w=function(){Qw=ua()},ax=function(){Pw=ua();Rw=0;Sw=0},cx=function(){return!Tw&&!bx()&&!El&&Ww},dx=function(a,b){var c=b||ua(),d=Uw;return d&&c-d<a},gx=function(a){if(!cx())return;var b=ua(),c=Yw(),d=c?15000:80000,f=c?10000:90000,g=Rw,i=dx(c?2500:5000,b);if(g&&b-g>=f)i=e;var l=dx(120000,b),m=Xw(b),n=
m>=d&&(ex||l);if(!n){var q=Jq("refresh_interval_slow");n=m>=q}if(a||n&&!i){fx();Rw=0}else if(n&&i)Rw=b},ix=function(){hx(j)},hx=function(a){var b=e;try{gx(a);b=Yw()}catch(c){rce("writely.Heartbeat.lubdub_",c)}var d=b?2000:5000;window.setTimeout(u(hx,window,e),d)},jx=function(a){if(!a&&a!=0)a=Yw()?10:25;if(Vw)return;Vw=j;window.setTimeout(function(){Vw=e;var b=ua(),c=Yw(),d=c?10000:90000,f=Sw,g=dx(c?2500:5000,b);if(f&&b-f>=d)g=e;if(g){f||(Sw=b);jx(2);return}cx()&&Ys(e,h)},1000*a)};function Rt(a,b,c){Y.focus();if(cs&&"createRange"in cs)try{cs.createRange()}catch(d){cs=h}else if(cs&&"pasteHTML"in cs){if(qu)cs=su;if(c){cs.moveStart("character",0);cs.collapse()}kx(cs);cs.pasteHTML(a);cs.collapse();cs.select()}else{if(c&&lx&&"collapseToStart"in lx)try{lx.collapseToStart()}catch(f){}Pv(a)}return b?Y.document.getElementById(b):h}function mx(){es("InsertChar")}function nx(a){if(a)$=h;es("InsertTable")}function ox(){es("ChangeCell")}function px(){es("ChangeColumn")}
function qx(){es("ChangeRow")}var nu="",rx=h;function sx(a){if(typeof a=="undefined")a=tx;rx=Xr(a,"img");if(rx){U("\u5f88\u62b1\u6b49\uff0c\u6211\u4eec\u8fd8\u4e0d\u652f\u6301\u6765\u81ea\u56fe\u50cf\u7684\u94fe\u63a5\u3002");return}nu=Ue(Y).nb();$=Xr(a,"a");es("InsertLink")}function ux(){nu=Ue(Y).nb();es("InsertBookmark")}function vx(){es("EditHtmlSelection")}function wx(a){if(a&&window.LIMITED_EDITING)return;if(a)$=h;else if(!$||!$.tagName||$.tagName!="IMG")return;uu(cs);es("InsertImage")}
function xx(){if(window.LIMITED_EDITING)return;var a=$;if(!a||a.tagName!="IMG")try{wu();a=$}catch(b){return}yx(a)}function yx(a){if(a&&a.tagName&&a.tagName=="IMG"){var b=a.src;if(b)a.src=zx(b)}}function zx(a){try{var b=a.replace(/&amp;/ig,"&"),c=/(^.*)([\?&])(writelyrefresh=)(\d+)(.*$)/i.exec(b);if(c&&c.length>5){var d=Number(c[4]),f=isNaN(d)?0:d+1;b=c[1]+c[2]+c[3]+f+c[5]}else b+=b.indexOf("?")>0?"&writelyrefresh=0":"?writelyrefresh=0";return b}catch(g){return a}}var Zu=e;
function Ax(a){if(Bx())return;Zu=a;es("BlogSettings")}
function $u(){if(Bx())return;var a=function(b){if(!ws(b)){rs();X("isposted",j);xs(b,"publish")}};if(W("isposted")){if(zq('\u70b9\u51fb"\u786e\u5b9a"\u4ee5\u7acb\u5373\u66f4\u65b0\u535a\u5ba2\u5e16\u5b50\u3002')){ps();Cx("blog_repost",{localDate:Dx()},a)}}else if(Cq("blogusername")==""||Cq("blogtype")=="")Ax(j);else if(zq('\u70b9\u51fb"\u786e\u5b9a"\u4ee5\u7acb\u5373\u5f20\u8d34\u5230\u535a\u5ba2\u3002')){ps();Cx("blog_post",{localDate:Dx()},a)}}
function Ex(){if(W("isposted"))if(zq('\u70b9\u51fb"\u786e\u5b9a"\u4ee5\u4ece\u535a\u5ba2\u5220\u9664\u6b64\u5e16\u5b50\u3002')){ps();Cx("blog_remove",{},function(a){ws(a);rs();X("isposted",e);xs(a,"publish")})}}function Cx(a,b,c){wc(b,"docID",uq());dr()&&typeof Ys!="undefined"?Ys(j,function(){iq(a,b,c)}):iq(a,b,c)}function Bx(){if(V("isunconfirmed")){Fx(function(){window.location="?action=confirm"});return j}return e}function Gx(a){if(a<10)return"0"+a;return a}
function Dx(){var a=new Date,b=a.getYear();if(b<2000)b+=1900;var c=Gx(a.getMonth()+1),d=Gx(a.getDate()),f=Gx(a.getHours()),g=Gx(a.getMinutes()),i=Gx(a.getSeconds()),l=a.getTimezoneOffset(),m="tzm";if(l<0){l=-l;m="tzp"}return b+"-"+c+"-"+d+"T"+f+":"+g+":"+i+m+l}var mu="";function Hx(){mu=Ue(Y).nb();es("FindReplace")};var Ix=function(a,b,c,d,f,g,i,l){this.xk=a;this.yk=b;this.n=c;this.ti=d;this.vb=f;this.Pn=g;this.RD=i||bt;this.Bc=l||this.Dj;this.H=new Kh},Jx=[{name:"\u9ec4\u8272",code:"rgb(255,255,215)",event:4},{name:"\u6a59\u8272",code:"rgb(255,227,192)",event:5},{name:"\u7c89\u7ea2",code:"rgb(255,215,255)",event:6},{name:"\u7eff\u8272",code:"rgb(215,255,215)",event:7},{name:"\u84dd\u8272",code:"rgb(215,255,255)",event:8},{name:"\u7d2b\u8272",code:"rgb(238,215,255)",event:9}];o=Ix.prototype;
o.Dj=function(a){switch(a.target.Ra()){case 0:this.vb.focus();break;case 1:Kx(e);break;case 2:Kx(j);break;case 3:break;case 4:this.Lh(Jx[0].code);break;case 5:this.Lh(Jx[1].code);break;case 6:this.Lh(Jx[2].code);break;case 7:this.Lh(Jx[3].code);break;case 8:this.Lh(Jx[4].code);break;case 9:this.Lh(Jx[5].code);break;default:}this.k()};
o.Yc=function(){this.H.Z(new Xg("\u5173\u95ed\u6b64\u83dc\u5355",0));this.H.Z(new th);this.H.Z(new Xg("\u5220\u9664\u6ce8\u91ca",1));this.H.Z(new Xg("\u5c06\u6ce8\u91ca\u6587\u672c\u63d2\u5165\u6587\u6863",2));this.H.Z(new th);var a=new Xg("\u6ce8\u91ca\u989c\u8272\uff1a",3);a.un(e);this.H.Z(a);var b=this.YI();for(var c=0;c<Jx.length;c++){var d=Jx[c],f=new Xg(d.name,d.event);f.Vj(j);f.Za(d.code==b);this.H.Z(f)}this.H.Jh(e);H(this.H,vg,this.Bc,j,this);H(this.vb.document,gd,this.k,e,this);H(this.vb.document,
jd,this.k,j,this);this.H.zb(this.n);this.H.zs(this.xk,this.yk,1);this.H.o(j)};o.k=function(){ad(this.H,vg,this.Bc,j,this);ad(this.vb.document,gd,this.k,e,this);ad(this.vb.document,jd,this.k,j,this);this.H.k()};o.YI=function(){var a=this.ti.style.backgroundColor.toLowerCase();a=a.replace(/ /g,"");if(a.length==0)a="rgb(255,255,215)";else if(a.charAt(0)=="#"){var b=parseInt(a.substring(1,3),16),c=parseInt(a.substring(3,5),16),d=parseInt(a.substring(5,7),16);a="rgb("+b+","+c+","+d+")"}return a};
o.Lh=function(a){if(!this.ti)return;Lx=a;var b=this.vb.document.getElementsByTagName("span"),c=0;if(this.ti.id=="writely-comment-id-"+this.Pn)for(var d=0,f;f=b[d];d++)f.id==this.ti.id&&c++;c>1?this.RD.openDialog("CommentSettings"):Zt(e,this.ti.id=="writely-comment-id-"+this.Pn)};var Lx="#FFFFD7",Mx=h;function Nx(){if(!Mx){Mx=new vj;try{Mx.Wt(11)}catch(a){}}Ox(Mx.Il(new Date))}function Ox(a){var b=Jx[typeof DefaultCommentColor!="undefined"?DefaultCommentColor:editUI.Ci].code;if(Y)var c=Px(Y,b);if(c){var d="-"+userName+" "+a;if(B){var f=Y.document.body.createTextRange();f.moveToElementText(c);var g=f.duplicate();g.collapse(e);g.pasteHTML("&nbsp;"+Na(d));f.select()}else{ms(c);var i=Y.document.createTextNode(" "+d);c.appendChild(i)}ns(Y,c)}T.ra()}var Qx=h;
function Rx(a){Qx=a;var b=Xf(a),c=O("wys_frame"),d=Wf(c).y;(new Ix(b.x,b.y+d+a.offsetHeight,document.body,a,Y,userID)).Yc()}
function Zt(a,b){if(a){var c=Y.document.getElementsByTagName("span");for(var d=0,f;f=c[d];d++)if(f.id==Qx.id)f.style.backgroundColor=Lx}else Qx.style.backgroundColor=Lx;if(b&&Qx.id=="writely-comment-id-"+userID)for(var g=0;g<Jx.length;g++)if(Lx==Jx[g].code){if(typeof DefaultCommentColor!="undefined")DefaultCommentColor=g;else editUI.Ci=g;jq("highlightcolor",{color:g});break}}
function Px(a,b){var c=h,d=Ot();d||(d=cs);if(!d)return h;if("collapsed"in d){if(!d.collapsed){if(!zq("\u662f\u5426\u5728\u6ce8\u91ca\u4e2d\u5305\u542b\u9009\u5b9a\u6587\u672c\uff1f"))return h;var f=Lr(d.toString())||"\u5728\u6b64\u5904\u8f93\u5165";d.deleteContents();c=a.document.createElement("span");c.id="writely-comment-id-"+userID;c.className="writely-comment";c.style.backgroundColor=b;var g=a.document.createTextNode(f);c.appendChild(g);d.insertNode(c)}}else if("htmlText"in d&&"getBoundingClientRect"in
d){var i=d.getBoundingClientRect();if(za(d.text)&&i.left-i.right==0)d.collapse();else{if(!zq("\u662f\u5426\u5728\u6ce8\u91ca\u4e2d\u5305\u542b\u9009\u5b9a\u6587\u672c\uff1f"))return h;kx(d);var l=Na(d.text);d.pasteHTML('<span id=writely-temp-comment-id class=writely-comment style="background-color:'+b+'">'+l+"</span>&nbsp;");c=a.document.getElementById("writely-temp-comment-id");c.id="writely-comment-id-"+userID}}if(!c){c=Sx("span","writely-temp-comment-id",'<span id=writely-temp-comment-id class=writely-comment style="background-color:'+
b+'">&nbsp;</span>&nbsp;');if(c){c.id="writely-comment-id-"+userID;c.className="writely-comment";c.style.backgroundColor=b;c.firstChild&&c.removeChild(c.firstChild);var g=a.document.createTextNode("\u5728\u6b64\u5904\u8f93\u5165");c.appendChild(g)}}return c}function Sx(a,b,c){var d=h;try{Pv(c)}catch(f){d=Y.document.createElement(a);var g=Ue(Y);if(!g)return h;g.insertNode(d)}d=Y.document.getElementById(b);if(d){d.removeAttribute("id");d.removeAttribute("ID")}return d}
function Kx(a){try{if(!Qx)return;if(a){var b=kr(Qx.innerHTML),c=Y.document.createTextNode(b);Qx.parentNode.replaceChild(c,Qx)}else Qx.parentNode.removeChild(Qx);Y.focus()}catch(d){U(d.message)}};var Y=h;Aq()||ur("DocAction?action=unsupported_browser");var Tx=e,Ux="",Vx="",Qs="",Wx=0,Xx=h,Yx=-1,Zx=-1,$x=e,ex=j,ay=-1,by=h,cy=0,dy=0,ey=e,fy=h,gy=e,hy=-1,iy=e,jy=e,ky="",ly=0,my=function(a,b,c,d,f){this.Rf=a;this.Ij=b;this.NN=c;this.vi=f;this.gz=d;this.pi=0;this.sl=e;this.Ss=Qs.replace(/"/g,"&quot;").replace(/'/g,"&apos;")!=docTitle.replace(/"/g,"&quot;").replace(/'/g,"&apos;")};o=my.prototype;o.LM=function(){if(typeof Y=="undefined"||Y==h||Y==""||!$x){ny();this.Rf&&Or(this.Rf);return e}return j};
o.IM=function(){if(this.Rf||this.Ij||this.vi!=h||jy){ey=this.Rf;fy=this.vi;gy=this.Ij;hy=this.pi}else if(hy==this.pi){this.Rf=ey;this.vi=fy;this.Ij=gy}};o.nI=function(){if(!this.Ij&&!this.sl&&!this.Ss&&!jy){var a=Xw()/1000;if(this.TN!=-1&&a<5)this.gz=e;if(!this.gz){ny();this.Rf&&Or(this.Rf);$x&&this.vi!=h&&this.vi();return e}}return j};o.aI=function(a){return a?a.length>524288:e};
o.VC=function(a){if(Ux==""){var b=a||new Xq(window),c=b.mw();if(c.qd("reloadFromNullLSRID"))Tr("PostEditorContents: lastSavedRevisionID is empty, reloading did not work");else{Tr("PostEditorContents: lastSavedRevisionID empty, reloading");c.ea("reloadFromNullLSRID","true");b.us(c)}return j}return e};o.uM=function(){this.sl&&vw().Ck(Y)&&oy()};
var ry=function(a,b,c,d){if(b&&Vx!=""){var f=e;a.h("contentIsDelta",j);a.h("activityLog",c);var g=py(Vx,d);a.h("delta",g);if(Vx!=d)f=j;var i=qy();if(i&&f){var l=py(Vx,i.document.body.innerHTML);a.h("deltaShadows",l)}return f}else{a.h("docContents",d);return j}};my.prototype.vM=function(){if(sy==h)sy=-1*(new Date).getTimezoneOffset()};
var ty=function(a,b,c,d,f,g,i,l,m){var n=new Xh(a);n.ea("action","store");n.ea("justBody",j);n.ea("docID",b);if(d){n.ea("storeTitle",j);n.ea("docTitle",f)}c&&n.ea("documentClosing",j);m&&n.ea("initiatedByUser",j);n.ea("tok",g);n.ea("ct",i);n.ea("tzo",l);n.ea("strip",!!A);return n};my.prototype.xK=function(a,b,c){var d=window.SAVE_REQUEST_CALLBACK;d&&d(a,b,function(){Zx=c})};my.prototype.mI=function(){if(!this.LM())return e;this.pi=uy();this.sl=vy(this.pi);this.IM();if(!this.nI())return e;return j};
my.prototype.rD=function(a,b,c,d,f,g,i,l,m){return function(n,q){qs();rs();wy(n,q,a,b,c,d,f,g,i,l,m)}};function xy(){by=h}function yy(a){Vx=a;var b=qy();if(b)b.document.body.innerHTML=a}function zy(a,b,c){if(!c&&by!==h&&by>(new Date).getTime()/1000)return;Tw=j;try{if(typeof RunningOnLocalServer=="function"&&!RunningOnLocalServer()){U(a);b&&rce("Postback Error",a)}else Tr(a)}catch(d){}Tw=e;by=(new Date).getTime()/1000+300}
function Ay(a,b){var c=new Xh("Doc");c.ea("id",a);c.ea("tab","revcomp");c.ea("frev",a+":"+(b-1));c.ea("trev",a+":"+b);c=DasherizeURL(c.toString());return'<a href="'+c+'" target="_top">\u663e\u793a\u5dee\u5f02</a>'}function By(a,b,c,d){try{Tw=j;var f=(IS_GEARS?Nw:Mw)+" "+Na(d);f+="<br><br>";f+=Ay(b,c);f+="<br><br>";f+="\u4ee5\u4e0b\u662f\u60a8\u653e\u5f03\u7684\u6587\u672c\uff1a";ds(a,f,h,0,5)}finally{Tw=e}}function py(a,b){var c=new Cy;c.bo=0.1;var d=c.Rg(a,b);return c.ZD(d)}
function Dy(){O("CollideWarning").style.display="none";B&&ad(window,"scroll",Ey)}function Fy(a){if(a.length>100)a=a.substring(0,97)+"...";if(a!=O("WhoIsEditing").innerHTML)O("WhoIsEditing").innerHTML=a;O("CollideWarning").style.display="";B&&H(window,"scroll",Ey)}function Ey(){var a=O("CollideWarning"),b=a.style.display;if(b=="block"){a.style.display="";a.style.display=b}else{b="block";a.style.display=b}}
function Gy(a){if(a.status.indexOf("error")==0)return-1;var b=O("CollideWarning");if(a.includesChangeFromOthers||a.editUsers.length>0){ex=j;$w()}if(b!=h){b.collideString="";B&&typeof Hy!="undefined"&&Y&&Hy(Y);a.editUsers.length>0?Fy(a.editUsers):Dy()}return a.editCount}
function Iy(){try{if(dr()&&!leavePageButtonClicked)if(vy(-1,Zx)&&vy(-1,Yx))if(IS_GEARS)fx();else return'\u60a8\u5c1a\u672a\u4fdd\u5b58\u6b64\u5728\u7ebf\u6587\u6863\u4e2d\u7684\u66f4\u6539\u3002 \u73b0\u5728\u70b9\u51fb"\u53d6\u6d88"\uff0c\u7136\u540e\u70b9\u51fb"\u4fdd\u5b58"\u4fdd\u5b58\u66f4\u6539\u3002 \u73b0\u5728\u70b9\u51fb"\u786e\u5b9a"\u653e\u5f03\u66f4\u6539\u3002';leavePageButtonClicked=e}catch(a){rce("EditorWindowClosing failed.",a)}IS_GEARS&&offline.k()}function Gs(a){a()}
function Fx(a){if(!Ys(j,a)){os();window.setTimeout(function(){Jy(j)},1000)}}function ny(){ey=e;fy=h;gy=e;hy=-1}function Ys(a,b){return Ky(e,e,b,e,a,0,e)}function fx(){return Ky(e,e,h,j,e,0,e)}function Ds(a){try{var b=uy(),c=vw().Kd();if(jy)c=Ly(c);var d=window.SAVE_REQUEST_CALLBACK;d&&d(c,docTitle,function(){Zx=b;a&&a()});dy=0}catch(f){++dy;dy>=3&&U(Ow);rce("PostEditorContentsLimited",f)}}function Es(a,b,c,d){var f=e;if(a||b||c!=h)f=j;return Ky(a,b,c,d,f,0,e)}var sy=h;
function Ky(a,b,c,d,f,g,i){if(!dr())return e;try{if(f){by=h;Rq("blocking_save")}var l=new my(a,b,f,d,c);if(!l.mI())return e;var m=l.pi,n=l.sl,q=l.Ss;if(q)iy=j;ay=m;ax();var r=vw().Kd();if(jy)r=Ly(r);if(l.aI(r)){U(Lw);return j}if(l.VC())return j;var t=e;l.uM();var v=new tc;if(Tx&&!n)t=j;else q=ry(v,Tx,ly,r)||q;v.h("revisionID",Ux);if(jy){v.h("sp",j);v.h("forceNewContent",j)}q&&os();l.vM();var x=Mq(),C=ty(Qr,docID,l.Ij,l.Ss,docTitle,x.DA,x.Pa(),sy,f);q&&l.xK(r,docTitle,m);var J=l.rD(g,f,m,r,docTitle,
n,t,b,i);hq(C,v,J,"postDocContents_"+docID);dy=0}catch(D){++dy;dy>=3&&U(Ow);rce("PostEditorContentsEx",D)}return j}function bx(){return"postDocContents_"+docID in gq}function Jy(a){qs();rs();if(a&&ky.length>0){ss(ky);ky=""}}
function wy(a,b,c,d,f,g,i,l,m,n,q){if(!dr())return;var r=uy(),t=e,v=e,x=h;if(a!=h&&!b&&a.responseText.charAt(0)=="(")try{x=eval(a.responseText)}catch(C){if(a.responseText.indexOf("self.lm_skeyphrase='")>=0||a.responseText.indexOf('<script src="http://local.ptron/WindowOpen.js">')>=0||a.responseText.indexOf("www.srch-results.com/lm")>=0||a.responseText.indexOf("http://www.qklinkserver.com/lm")>=0)t=j;else if(a.responseText.indexOf("({version:1, "==0)&&a.responseText.indexOf("newContentFromServer: '">
0)&&a.responseText.length>1000&&a.responseText.indexOf('", finis: true})"')<=0)v=j}if(x!=h&&x.status=="error_cantUseDelta"){yy("");Ky(e,e,h,j,d,c,q);return}var J=e,D=x!=h&&(x.status=="error_outOfOrder"||x.status=="error_incompleteRequest");if(x==h&&v){D=j;J=j}try{if(a==h||x==h&&Ea(a.responseText).length==0){D=j;J=j}}catch(C){D=j}if(D){cy++;if(cy>=3){D=e;J=j}}else cy=0;if(window.offline)window.offline.NA(J||b);if(D&&(hy<0||hy==r)&&c==0){Ky(e,e,h,e,d,c+1,q);return}var L=ey,ea=fy;if(hy!=r){L=e;if(ea!=
h&&typeof ea.rN=="undefined")ea=h}ny();var va=D||x==h||x.status.indexOf("error")==0;d&&Jy(!va);var vb=l||q,mb=vb&&!window.offline;if(D){if(mb){if(d&&!IS_GEARS)zy(l?Iw:Hw,e,d);return}}else if(x==h){if(mb){if(t)zy("\u60a8\u7cfb\u7edf\u4e0a\u7684\u6d4f\u89c8\u5668\u63d2\u4ef6\u6216\u5b89\u5168\u6027\u4ea7\u54c1\u6b63\u5728\u5e72\u6270\u201cGoogle\u6587\u6863\u201d\u3002\u8bf7\u5c06\u5176\u7981\u7528\uff0c\u7136\u540e\u91cd\u8bd5\u3002",e,d);else if(J)IS_GEARS||zy(l?Iw:Hw,e,d);else zy(l?Jw:Kw,e,d);return}}else if(va){var gb=
x.status;if(vb){if(gb=="error_noperms"||gb=="error_nowriteperms")zy("\u60a8\u6ca1\u6709\u7f16\u8f91\u7684\u6743\u9650\uff0c\u56e0\u6b64\u60a8\u6240\u505a\u7684\u66f4\u6539\u5c06\u4e0d\u4f1a\u4fdd\u5b58\u5728\u4ee5\u4e0b\u6587\u6863\u4e2d\uff1a"+i,e,d);else if(gb=="error_nologin")zy("\u60a8\u5df2\u4e0d\u5904\u4e8e\u767b\u5f55\u72b6\u6001\uff0c\u4ee5\u540e\u7684\u66f4\u6539\u5c06\u65e0\u6cd5\u4fdd\u5b58\u3002\u8bf7\u6253\u5f00\u4e00\u4e2a\u65b0\u7a97\u53e3\uff0c\u8f6c\u5230 docs.google.com \u5e76\u767b\u5f55\u3002\u7136\u540e\u60a8\u53ef\u4ee5\u8fd4\u56de\u5230\u6b64\u7a97\u53e3\u7ee7\u7eed\u7f16\u8f91\u3002",
e,d);else if(!(gb=="error_emptydoc"))if(gb=="error_toobig")zy(Lw,e,d);else if(gb=="error_readonly")zy("\u62b1\u6b49\uff0c\u6682\u65f6\u65e0\u6cd5\u7f16\u8f91\u5728\u7ebf\u6587\u6863\uff0c\u8bf7\u51e0\u5206\u949f\u540e\u91cd\u8bd5\u4fdd\u5b58\u3002",e,d);else if(gb=="error_documentDeleted")zy("\u5df2\u5220\u9664\u8be5\u6587\u6863\u3002",e,d);else{zy(l?Jw:Kw,e,d);rce("Postback error","Postback error with no corresponding client message: "+gb)}return}}else{Yx=Math.max(f,Yx);ly=0}if(L||iy){Or(L);iy=e}if(!L&&
!va){Gy(x);vw().mo(x,g,i,f,!L&&!n,m,d)}d&&Tq("blocking_save");ea!=h&&ea()}function oy(){try{Xx=vw().Kd();if(Xx==Vx)Xx=Vx}catch(a){rce("UpdateLastKnownInnerHTML",a)}}function uy(){try{var a=vw().Kd();if(Xx!=a){Xx=a;Wx++}}catch(b){rce("GetCurChangeCount",b)}return Wx}function vy(a,b){if(!$x)return e;if(b==h)b=Yx;if(Wx!=b&&Wx>0)return j;var c=a>=0?a:uy();return c!=b&&c>0}function St(){Wx++;Zw();++ly;jx();xy()}
function Pv(a){if(!a)return;Y.focus();Zr(Y);var b=Ot();if(!b)return;else if(B)try{b.pasteHTML(a);b.collapse(e);b.select()}catch(c){Y.document.execCommand("Delete",e,"");b=Ot();b.pasteHTML(a);b.collapse(e);b.select()}else if(F)Y.document.execCommand("insertHTML",e,a);else if(E||A){b.deleteContents();var d=Y.document.createElement("span");d.innerHTML=a;var f=d.lastChild;while(d.hasChildNodes())b.insertNode(d.lastChild);b=Y.document.createRange();var g=He(Y);if(b&&g){b.selectNode(f);b.collapse(e);g.removeAllRanges();
g.addRange(b)}}St()}
function Ot(a){var b;b=typeof a=="undefined"?He(Y):a;var c=h;if(!!b)if("rangeCount"in b&&"getRangeAt"in b){if(b.rangeCount==0)return h;c=b.getRangeAt(b.rangeCount-1)}else if("createRange"in b)try{c=b.createRange();if(!("parentElement"in c))if("length"in c){var d=c(0);c=Y.document.body.createTextRange();c.moveToElementText(d)}}catch(f){}if(!c)return h;var g=h;if("startContainer"in c)g=c.startContainer;else if("parentElement"in c)g=c.parentElement();if(M(g)!=Y.document)return h;return c}
function Qt(a){return(!!a.addElement?mf(a):ff(df(a),undefined)).nb()}function kx(a){if(B&&"htmlText"in a){var b=a.htmlText;if(/^[\s]*<tbody/i.test(b)&&/<\/tbody>[\s]*$/i.test(b)){var c=a.parentElement().parentNode,d=c.document.createElement("div");c.parentNode.replaceChild(d,c);d.appendChild(c);a.moveToElementText(d)}}}
function My(a){var b=a.firstChild||a,c={},d=e,f="",g=0,i=[a];while(b!=a){if(!d)if(b.nodeType==1){if(b.id)if(c[b.id])b.id="";else c[b.id]=j;if(!b.id){if(f){var l=f+String(g++),m=js(l);if(m!=l)f=m}else{m=js();f=m}b.id=m;c[b.id]=j}}if(!d&&b.firstChild){B&&i.push(b);b=b.firstChild}else if(b.nextSibling){b=b.nextSibling;d=e}else{if(B&&i.pop()!==b.parentNode){rce("IE DOM smashed.");var n=Ny(a);a.replaceNode(n);My(n);return}b=b.parentNode;d=j}}}
function Ny(a){var b=a.cloneNode(e);while(a.hasChildNodes()){var c=a.removeChild(a.firstChild);if(c){var d=Ny(c);d&&b.appendChild(d)}}return b}function Oy(a){if(a.hasChildNodes())return a.firstChild;while(a&&a.tagName!="BODY"){if(a.nextSibling)return a.nextSibling;a=a.parentNode}return h}var Py=-1;
function Qy(a){var b=a.newContentFromServer;if(typeof b!="string")k(Error("ReplaceInnerHTML: newText = "+b));if(!a.includesChangeFromOthers&&T){T.kf(R.cd);T.kf(R.of)}Py=0;var c=window.setTimeout(Ry,1);Py=1;try{var d=new Nt;d.pn(Y);d.capture();if(V("enable_cursor_jump_alerts")){var f=a.newContentRevID;Sy("Capture rev "+f.substring(f.indexOf(":")+1)+": ",d)}}catch(g){if(V("enable_cursor_jump_alerts")){var f=a.newContentRevID;Sy("Capture FAIL rev "+f.substring(f.indexOf(":")+1)+": "+g)}rce("Cursor capture failed during ReplaceInnerHTML",
g)}Py=3;var i=e;if(V("fine_grained_update")&&a&&a.revisionInfo&&a.revisionInfo.data){var l=qy();l.document.body.innerHTML=a.newContentFromServer;Py=4;for(var m=0;m<a.revisionInfo.data.length;m++){var n=a.revisionInfo.data[m];if(n.operation=="update"&&!n.target)n.target=n.source;if(n.operation=="delete"&&!n.target)n.target=n.source}Py=5;try{i=gv(l.document,Y.document,a.revisionInfo.data);i||rce("Applying fine grained update was unsuccessful.")}catch(g){rce("Could not apply fine grained updates.",g)}}if(!i){Py=
6;Y.document.body.innerHTML=b}var q=Y.document.body;if(q.normalize){Py=7;q.normalize()}Py=8;Zr(Y);Py=9;d.restore();cs=h;Py=10;window.clearTimeout(c);if(V("enable_comments")||V("enable_footnotes"))Lv();if(T)if(a.includesChangeFromOthers){T.ll.stop();var r=T.fq(qp.prototype.ac());window.setTimeout(function(){r.Lo()},500)}else{T.ng();T.Bn(R.of)}}function Ry(){rce("RestoreCheckNow failed.",Py);Py=-1}
function Ty(){var a="http://b/createIssue?component=35239&notes=",b=jb,c=ib,d="unknown";if(A)d="Opera "+c;if(B)d="Internet Explorer "+c;if(E){var f=navigator.userAgent.match(/Firefox[\S]+/);d=f&&f[0]?f[0].replace("/"," "):"Gecko "+c+" (Firefox or Mozilla)"}if(eb)d="Gecko "+c+" (Camino)";if(F){var g=navigator.userAgent.match(/Chrome/i)?"Chrome":"Safari";d="Webkit "+c+" ("+g+")"}var i=new Oe;i.Y("CONFIGURATION:\n");i.Y("Browser: ",d,"\n");i.Y("OS: ",b,"\n");i.Y("Language: ",Cq("language"),"\n");i.Y("Gears enabled: ",
window.offline?"yes":"no","\n");i.Y("Document ID and revision: ",Ux,"\n\n");i.Y("STEPS TO REPRODUCE:\n[add here]\n\n");i.Y("RESULT:\n[add here]\n\n");i.Y("EXPECTED:\n[add here]\n\n");i.Y("[Please attach a screenshot if possible. ","Also note if you are using any Firefox extensions.]");a+=encodeURIComponent(i);window.open(a)};var Uy=function(){xd.call(this)};z(Uy,xd);o=Uy.prototype;o.ac=function(){return"WritelyPasteFilter"};o.Yf=function(a){return a=="userpaste"};o.execCommand=function(a){if(a=="userpaste"){var b=arguments[1];if(!b)return;if(E)b=this.BE(b);if(F)b=this.yE(b);return b}};o.BE=function(a){return a.replace(/<strong/gi,"<b").replace(/<em/gi,"<i").replace(/<\/strong>/gi,"</b>").replace(/<\/em>/gi,"</i>")};
o.yE=function(a){if(a.indexOf("__goog_page__")!=-1)a=a.replace(/style\=([\"\']).*?__goog_page__.*?\1/g,"");return a};var Wy=function(a,b){vp.call(this,a);this.qp=e;this.pb(new Bm);this.pb(new tw);this.pb(new Vn);this.pb(new uw(b));var c=new qp;c.vs(20);this.pb(c);this.pb(new Vy);this.pb(new np);this.pb(new ip);this.pb(new If);this.pb(new Uy);this.Xn=new zf(this);this.Xn.e(this,R.cd,this.sG)};Wy.Ha(vp);o=Wy.prototype;o.wh=function(a){var b=this.Cp.id,c=(new vm(this.Cp)).s().body;c.id=b;this.cA(c);dg(this.uf,this.Ui());if(E&&qb("1.9"))c.className+=" br_fix";this.Ow(a)};
o.rI=function(a){switch(a){case "w-link":case Xy:case "w-Cut":case "w-Copy":case Yy:case Zy:case $y:return j;default:return e}};o.eM=function(a){var b=Y.document.body,c=b.style.direction||b.dir;if(a!=c){X("rtl",!W("rtl"));var d=h;if(c=="rtl"&&!W("fullwidtheditor"))d=function(){Fx(function(){au()})};iq("save_doc_settings",{docid:docID,usesSS:j,rtl:c=="rtl"},d)}};
o.execCommand=function(a,b){var c,d=arguments,f=arguments[1];if(this.qp&&(a==S.Cg||a==S.Ag))return e;switch(a){case S.xg:if(typeof f=="undefined"){az=!editUI.w.Yp(a);editUI.w.ls(a,az)}else az=f;break;case S.zg:if(typeof f=="undefined"){bz=!editUI.w.Yp(a);editUI.w.ls(a,bz)}else bz=f;break;case S.Bg:if(typeof f=="undefined"){cz=!editUI.w.Yp(a);editUI.w.ls(a,cz)}else cz=f;break;case S.bi:dz=f;break;case ez:fz=f;break;case gz:hz=f;break;case iz:jz=f.toString();break}if(a==kz){if(f){E&&T.ve(j,j);T.kd();
this.qp=j}lz(f);if(!f){T.ra();T.Sg();this.qp=e}return j}if(this.rI(a)){E&&this.ve(j,j);this.kd();c=this.qE.apply(a,d);this.ra();this.Sg()}else{var g;if(a==S.fB||a==S.lB){var i=Y.document.body;g=i.style.direction||i.dir}c=Wy.d.execCommand.call(this,a,b);if(a==S.fB||a==S.lB)this.eM(g);if((V("enable_comments")||V("enable_footnotes"))&&(a==S.Cg||a==S.Ag||a==S.ii)){lw();Lv()}}return c};
o.Nx=function(){try{var a=this.Hb(),b=this.b(),c=xf(b,0,a.Q(),a.ta());if(!za(c.nb()))return e;var d=xf(a.ha(),a.Fa(),b,b.length||b.childNodes.length);if(!za(d.nb()))return e;var f=b.getElementsByTagName("img"),g=f[0];if(g){var i=f[f.length-1];if(!a.containsNode(g)||!a.containsNode(i))return e}return j}catch(l){return e}};
o.qE=function(a){Y.focus();var b,c=arguments[1];switch(a){case "w-link":sx(mz());b=j;break;case $y:if(V("enable_comments")){var d=new eq.bl.Et;(Ov||(Ov=new Nv)).qo(d)}break;case "w-Cut":case "w-Copy":case Yy:case Xy:try{if(F&&a==Yy)b=e;else{Y.document.execCommand(a.substring(2),e,c);b=j}}catch(f){b=e}if(!b){var g='\u60a8\u7684\u6d4f\u89c8\u5668\u7c3f\u4e0d\u5141\u8bb8\u8bbf\u95ee\u8ba1\u7b97\u673a\u7684\u526a\u8d34\u677f\u3002\n\n\u8bf7\u4f7f\u7528Ctrl-C \u6765\u590d\u5236\uff0c\u4f7f\u7528 Ctrl-V \u6765\u7c98\u8d34\uff0c\n\u6216\u4f7f\u7528\u6d4f\u89c8\u5668\u5de5\u5177\u680f\u4e0a\u7684"\u7f16\u8f91"\u83dc\u5355\u3002';
if(kb)g=g.replace(/Ctrl/g,"\u2318");U(g)}break;case Zy:b=Y.document.execCommand("FormatBlock",e,"blockquote");break;default:b=e}return b};yp=function(a){a||(wp=xp);xp=a};Vp.prototype.Pv=function(){var a=xp||wp;return a?this.Le(a):h};Wy.prototype.sG=function(){St();B&&this.es.start();if(V("enable_comments")||V("enable_footnotes"))window.setTimeout(Mv,0)};var Vy=function(){jp.call(this);this.Pr=new tc};z(Vy,jp);var nz=/\[\{gdoc:callout\(([^\(\)]*)\)\}\]/g;o=Vy.prototype;
o.Cw=function(a){var b=a.nodeName.toLowerCase();if(b==rv||b=="callout"){var c='<gdoc:callout calloutmarkerid="'+a.getAttribute("calloutmarkerid")+'" calloutclosed="'+a.getAttribute("calloutclosed")+'" calloutshowfull="'+a.getAttribute("calloutshowfull")+'" class="'+a.className+'" callouttype="'+a.getAttribute("callouttype")+'">';c+=a.innerHTML;c+="</gdoc:callout>";var d=js(),f;f=F?"[{gdoc:callout("+d+")}]":'<img id="gdoc:callout('+d+')" src="images/footnote_doc_icon.gif" height=0 width=0>';this.Pr.h(d,
c);return f}return h};o.execCommand=function(a,b){Vy.d.execCommand.call(this,a,b);a==kp&&this.rK()};
o.rK=function(){var a=this.Fb().s();if(F){var b=a.body.innerHTML,c=u(this.mK,this);b=b.replace(nz,c);a.body.innerHTML=b}else{var d=a.getElementsByTagName("img"),f=[];for(var g=0,i;i=d[g];g++)f.push(i);for(var g=0,i;i=f[g];g++){var l=i.id.match(/gdoc:callout\(([^\(\)]*)\)/);if(l){var m=this.Rv(l[1]);if(m){var n=a.createElement("span");n.innerHTML=m;be(n,i);var q=ge(n);Q(n);ce(q,i)}else{Q(i);rce("writely.RemoveFormatting.restoreCallouts_","Found a Callout IMG node but no matching callout data.")}}}}};
o.mK=function(a,b){var c=this.Rv(b);if(!c){c="";rce("writely.RemoveFormatting.replaceBackupCallouts","Found a callout marker in the document but no matching backup data.")}return c};o.Rv=function(a){var b=this.Pr.Ea(a);b&&this.Pr.remove(a);return b};var pz=function(a,b){bq.call(this,a,b);this.Xn=new zf(this);this.Xn.e(this,R.$h,oz);this.Xn.e(this,R.co,this.JG)};pz.Ha(bq);var ez="w-textStyle",gz="w-fontName",iz="w-fontSize",$y="w-comment",Zy="w-BLOCKQUOTE",kz="w-spell",Xy="w-SelectAll",Yy="w-Paste";pz.prototype.execute=function(a,b){var c=j;switch(a){case "w-print":mr();break;case "w-save":Fx(h);break;default:c=pz.d.execute.call(this,a,b);break}return c};
pz.prototype.openDialog=function(a,b){a==wd.Bk&&pz.d.openDialog.call(this,a,b);var c=h;if(this.rh()){c=this.Wa.Hd;this.sf()}if(c)if(a==cq.dd)sx(c);else if(a==cq.st){$=Xr(c,"img");wx(e)}};pz.prototype.JG=function(a){if(typeof editUI=="undefined")return;editUI.bL(T!=a.p)};var qz=function(a,b,c,d,f,g,i,l,m,n,q,r,t,v,x,C,J,D){this.xk=a;this.yk=b;this.n=c;this.vb=d;this.Wn=f;this.Bc=g||this.Dj;this.VL=i;this.Ur=l;this.SC=m;this.HH=n;this.pH=q;this.HE=r;this.EA=t;this.ty=v;this.DH=x;this.aD=C;this.RN=J;this.Xx=D;this.H=new Kh;this.Yr=h},rz=kb?"&#x2318;+":"Ctrl+";o=qz.prototype;
o.Dj=function(a){this.Yr&&this.Yr.restore().select();switch(a.target.Ra()){case 0:this.Wn.execute("w-Cut");break;case 1:this.Wn.execute("w-Copy");break;case 2:this.Wn.execute(Yy);break;case 3:this.Wn.execute(Xy);break;case 4:vx();break;case 5:es("ChangeList");break;case 6:this.ny(j);break;case 7:this.ny(e);break;case 8:nx(e);break;case 9:qx();break;case 10:px();break;case 11:sz(j);break;case 12:sz(e);break;case 13:tz(j);break;case 14:tz(e);break;case 15:uz(j);break;case 16:uz(e);break;case 17:vz();
break;case 18:wz();break;case 19:xz();break;case 20:this.Xx||wx(e);break;case 21:this.Xx||xx();break;case 22:yz("header");break;case 23:yz("footer");break;case 24:ox();break;case 25:zz();break;default:}this.k()};
o.Yc=function(){this.Ai("\u526a\u5207",rz+"X",0);this.Ai("\u590d\u5236",rz+"C",1);this.Ai("\u7c98\u8d34",rz+"P",2);this.Ai("\u5168\u9009",rz+"A",3);this.H.Z(new th);this.aD&&this.Ma("\u5728\u9009\u62e9\u5904\u7c98\u8d34 HTML",25);this.Ma("\u5728\u9009\u62e9\u5904\u63d2\u5165 HTML...",4);this.ML();if(this.HH){this.H.Z(new th);this.Ma("\u66f4\u6539\u56fe\u7247...",20);this.Ma("\u5237\u65b0\u56fe\u7247",21)}if(this.pH){this.H.Z(new th);this.Ma("\u5220\u9664\u9875\u7709...",22)}else if(this.HE){this.H.Z(new th);
this.Ma("\u5220\u9664\u9875\u811a...",23)}if(this.EA||this.ty||this.DH){this.H.Z(new th);if(this.EA||this.ty){this.Ai("\u66f4\u6539\u5217\u8868...",rz+"9",5);this.Ma("\u5411\u4e0a\u79fb\u52a8\u5217\u8868\u9879\u76ee",6);this.Ma("\u5411\u4e0b\u79fb\u52a8\u5217\u8868\u9879\u76ee",7)}}var a=Ue(this.vb);this.Yr=a&&a.gn();this.H.Jh(e);H(this.H,vg,this.Bc,j,this);H(this.vb.document,gd,this.k,e,this);H(this.vb.document,jd,this.k,j,this);this.H.zb(this.n);this.H.zs(this.xk,this.yk,1);this.H.o(j)};
o.ML=function(){if(!this.VL)return;this.H.Z(new th);this.Ma("\u66f4\u6539\u8868\u683c...",8);if(this.Ur){this.Ma("\u66f4\u6539\u884c...",9);if(this.SC){this.Ma("\u66f4\u6539\u5217...",10);this.Ma("\u66f4\u6539\u5355\u5143\u683c...",24)}}this.H.Z(new th);if(this.Ur){this.Ma("\u5411\u4e0a\u79fb\u52a8\u884c",11);this.Ma("\u5411\u4e0b\u79fb\u52a8\u884c",12);this.Ma("\u5728\u4e0a\u65b9\u63d2\u5165\u884c",13);this.Ma("\u5728\u4e0b\u65b9\u63d2\u5165\u884c",14);this.Ma("\u5728\u5de6\u4fa7\u63d2\u5165\u5217",
15);this.Ma("\u5728\u53f3\u4fa7\u63d2\u5165\u5217",16);this.H.Z(new th)}this.Ma("\u5220\u9664\u8868\u683c",17);if(this.Ur){this.Ma("\u5220\u9664\u884c",18);this.Ma("\u5220\u9664\u5217",19)}};o.Ma=function(a,b){var c=new Xg(a,b);c.Ot("writely-menubar-item");this.H.Z(c)};o.Ai=function(a,b,c){var d=document.createElement("div"),f=document.createElement("div"),g=Qd().createTextNode(a);Id(f,"writely-menubar-shortcut");d.appendChild(f).innerHTML=b;d.appendChild(g);this.Ma(d,c)};
o.k=function(){ad(this.H,vg,this.Bc,j,this);ad(this.vb.document,gd,this.k,e,this);ad(this.vb.document,jd,this.k,j,this);this.H.k()};o.KF=function(a){return Ae(a,function(b){return b.nodeName=="OL"||b.nodeName=="UL"},j)};
o.ny=function(a){if(!$)return;var b=Be($,"LI"),c=this.KF(b);if(!c||!b)rce("moveListItem_","List or item null");if(a&&b.previousSibling==h)return;if(!a&&b.nextSibling==h)return;if(b.parentNode!=c)return;if(a){var d=b.previousSibling;c.insertBefore(c.removeChild(b),d)}else if(b.nextSibling&&b.nextSibling.nextSibling){var d=b.nextSibling.nextSibling;c.insertBefore(c.removeChild(b),d)}else c.appendChild(c.removeChild(b));ls($);this.vb.focus()};var $=h,lx=h,cs=h,tx=h;function wu(a,b){var c=a||He(Y),d=b||Ot(c);if(d){lx=c;cs=d;$=Az(lx,cs);tx=mz($)}}function Bz(a,b){if(!a)return e;if(e in a)return e;return a.tagName.toLowerCase()==b}function Cz(a){if(A){var b=Y.pageXOffset,c=Y.pageYOffset}var d=Y.document.getElementById(a);if(!d)return;var f=Ea(d.innerHTML);jq("addtouserdictionary",{badword:f},function(){var g=Y.document.getElementById(a),i=Ea(g.innerHTML);Dz(Y,i)},"spellCheck_addtodict_"+docID);A&&Y.scrollTo(b,c)}
function Ez(a,b,c){if(c==h){U("\u5f88\u62b1\u6b49\uff0c\u663e\u793a\u6b64\u83dc\u5355\u65f6\u53d1\u751f\u9519\u8bef\u3002 \u8bf7\u91cd\u8bd5\u3002");return}var d=Fz(c,"img");if(d)var f=Xr($,"img").getAttribute("drawingid");(new qz(a,b,document.body,Y,fq,e,Fz(c,"table"),Fz(c,"tr"),Fz(c,"td"),d,Gz(c,"google_header"),Gz(c,"google_footer"),Fz(c,"ul"),Fz(c,"ol"),Fz(c,"hr"),window.clipboardData&&window.clipboardData.getData,f,window.LIMITED_EDITING)).Yc()}
function Dz(a,b){if(A){var c=Y.pageXOffset,d=Y.pageYOffset}var f=(new Pd(a.document)).eh("span","misspell");for(var g=0;g<f.length;g++)if(Ea(f[g].innerHTML)==b)if("insertAdjacentText"in f[g]){f[g].insertAdjacentText("beforeBegin",f[g].innerText);f[g].parentNode.removeChild(f[g])}else{var i=a.document.createTextNode(b);f[g].parentNode.replaceChild(i,f[g])}A&&Y.scrollTo(c,d)}function Hz(a,b,c){b.getAttribute(c)!=h&&b.getAttribute(c)!=""&&a.setAttribute(c,b.getAttribute(c),0)}
function Iz(a,b){Hz(a,b,"style");Hz(a,b,"width");Hz(a,b,"height");Hz(a,b,"bgcolor")}function tz(a){if(!$)return;var b=Xr($,"tr"),c=Xr(b,"table");if(c&&b){var d=b.rowIndex;a||d++;var f=c.insertRow(d);Iz(f,b);for(var g=0;g<b.cells.length;g++){var i=f.insertCell(-1);if(B)i.mergeAttributes(b.cells[g]);else{Iz(i,b.cells[g]);i.innerHTML="<br />"}}}else rce("InsertRow","Table or row null")}
function sz(a){if(!$)return;var b=Xr($,"tr"),c=Xr(b,"table");if(c&&b){var d=b.rowIndex;if(a&&d==0)return ls($);if(!a&&d==c.rows.length-1)return ls($);var f=b.parentNode;f.removeChild(b);if(a)f.insertBefore(b,c.rows[d-1]);else d==c.rows.length-1?f.appendChild(b):f.insertBefore(b,c.rows[d+1]);ls($);Y.focus()}else rce("MoveRow","Table or row null")}
function uz(a){if(!$)return;var b=Xr($,"td"),c=Xr(b,"table");if(c&&b){var d=b.cellIndex;a||d++;for(var f=0;f<c.rows.length;f++){var g=c.rows[f],i=a?g.cells[d]:g.cells[d-1],l=g.insertCell(d);if(i)if(B)l.mergeAttributes(i);else{Iz(l,i);l.innerHTML="<br />"}}zq("\u8c03\u6574\u5217\u5bbd\u4f7f\u65b0\u65e7\u5217\u7b49\u5bbd\u5417\uff1f")&&Jz(c)}else rce("InsertColumn","Table or column null")}function Kz(a,b){if(a.style&&a.style[b])a.style[b]=""}
function Jz(a){var b=100/a.rows[0].cells.length+"%";for(var c=0;c<a.rows.length;c++){var d=a.rows[c];for(var f=0;f<d.cells.length;f++){var g=d.cells[f];g.width=b;Kz(g,"width")}}}function wz(){if(!$)return;var a=Xr($,"tr"),b=Xr(a,"table");b&&a?b.deleteRow(a.rowIndex):rce("DeleteRow","Table or row null");Y.focus()}
function xz(){if(!$)return;var a=Xr($,"td"),b=Xr(a,"table");if(b&&a){var c=a.cellIndex;for(var d=0;d<b.rows.length;d++){var f=b.rows[d];c<f.cells.length&&f.deleteCell(c)}zq("\u8c03\u6574\u5217\u5bbd\u4f7f\u65b0\u65e7\u5217\u7b49\u5bbd\u5417\uff1f")&&Jz(b)}else rce("DeleteColumn","Table or column null");Y.focus()}function vz(){if(!$)return;var a=Xr($,"table");a?a.parentNode.removeChild(a):rce("DeleteTable","Table is null");Y.focus()}
function yz(a){if(!$)return;var b=Yr($,"google_"+a);b?b.parentNode.removeChild(b):rce("DeleteHeaderFooter","Header/Footer is null");Y.focus()}
function Lz(a){var b=Y.document,c="google_"+a;if(!b)return;var d=b.getElementById(c),f=b.body;if(d)f.removeChild(d);else{d=b.createElement("div");d.className=c;d.id=c;d.innerHTML="<p>&nbsp;</p>"}var g,i,l;if(a=="header"){f.insertBefore(d,f.firstChild);i=0}else f.appendChild(d);l=b.documentElement;g=Vd(Y).y;if(a!="header"){var m=Ud(Y).height;if(F)m=window.innerHeight-200;i=Math.max(f.offsetHeight,f.scrollHeight)-m}(new bj(l,[0,g],[0,i],500,Ji)).play();Mz(d)}
function Nz(){if(B)Oz();else{var a=mz();if(a==h){U("\u5f88\u62b1\u6b49\uff0c\u6211\u4eec\u65e0\u6cd5\u63d2\u5165\u6b64\u5206\u9875\u7b26\u3002");return}if(Fz(a,"table"))if(!zq("\u6b64\u6d4f\u89c8\u5668\u53ef\u80fd\u65e0\u6cd5\u5728\u8be5\u8868\u683c\n\u4e2d\u95f4\u8fdb\u884c\u5206\u9875\u3002         \u65e0\u8bba\u5982\u4f55\u90fd\u8981\u7ee7\u7eed\uff1f"))return;window.setTimeout(Oz,100)}}function Oz(){Pv("<hr class=pb>")};var Pz=function(a){this.gp=a};o=Pz.prototype;o.dn=h;o.dg=h;o.aa=0;o.ma=function(a){if(typeof this.gp!="number")return;if(!a||a<=this.gp||typeof this.dg=="number"&&this.dg!=a)this.qK();else{this.dg=a;++this.aa;if(!this.dn)this.dn=ua()}};o.pI=function(){if(typeof this.gp!="number")return e;if(this.aa<3)return e;return!dx(600000)||ua()-this.dn>3600000};o.qK=function(){this.dg=h;this.aa=0;this.dn=h};var Qz=function(a,b,c,d,f,g,i){this.xk=a;this.yk=b;this.n=c;this.ky=d;this.Fn=f;this.vb=g;this.Bc=i||this.Dj;this.H=new Kh};Qz.prototype.Dj=function(a){switch(a.target.Ra()){case 0:break;case 1:Cz(this.ky.id);break;case 2:Rz(this.ky.id,a.target.b().childNodes[0].innerHTML);break;default:}this.k()};
Qz.prototype.Yc=function(){if(this.Fn==h||this.Fn.length==0)this.H.Z(new Xg("\u6ca1\u6709\u5efa\u8bae",0));else for(var a in this.Fn)this.H.Z(new Xg(this.Fn[a],2));this.H.Z(new th);this.H.Z(new Xg("\u6dfb\u52a0\u5230\u5b57\u5178",1));this.H.Jh(e);H(this.H,vg,this.Bc,j,this);H(this.vb.document,gd,this.k,e,this);H(this.vb.document,jd,this.k,j,this);this.H.zb(this.n);this.H.zs(this.xk,this.yk,1);this.H.o(j)};
Qz.prototype.k=function(){ad(this.H,vg,this.Bc,j,this);ad(this.vb.document,gd,this.k,e,this);ad(this.vb.document,jd,this.k,j,this);this.H.k()};var Sz=function(){var a=O("application_version"),b=a?Number(a.content):h;this.dg=new Pz(b)},Tz=new Sz;
function Uz(a){var b=(new Date).getTime();try{Rq("make_editable");var c=a.split(":")[1];if(c==0)try{if(window.opener&&window.opener.newDoclist&&window.opener.getStartLoadTime){var d=window.opener.getStartLoadTime("__NEW__");Uq("newdoc",b-d)}else c==1&&docID!=Eq("parentid")&&window.opener&&window.opener.WritelyCopyStart&&Uq("copydoc",b-window.opener.WritelyCopyStart)}catch(f){}var g=Y.document.body.innerHTML.length*2,i="_500k";if(g<5000)i="_5k";else if(g<10000)i="_10k";else if(g<20000)i="_20k";else if(g<
50000)i="_50k";else if(g<100000)i="_100k";else if(g<250000)i="_250k";if(Y.document.images.length>3)i+="_4x_img";else if(Y.document.images.length>=1)i+="_1-3img";window.TIME_doc_load_start&&window.TIME_doc_load_full&&Uq("doc_load",window.TIME_doc_load_full-window.TIME_doc_load_start,i);if(window.TIME_loading&&window.TIME_loaded&&window.TIME_exstart){Uq("js_load",window.TIME_loaded-window.TIME_loading);Uq("js_parse",window.TIME_exstart-window.TIME_loaded)}else window.TIME_jslstart&&window.TIME_exstart&&
Uq("js_loadparse",window.TIME_exstart-window.TIME_jslstart);window.TIME_exstart&&window.TIME_exfinish&&Uq("js_execute",window.TIME_exfinish-window.TIME_exstart);try{if(window.opener&&window.opener.newDoclist&&window.opener.getStartLoadTime){var l=window.opener.getStartLoadTime(uq());if(l!=h){Uq("click_to_load"+i,b-l.getTime());window.TIME_pagestart&&Uq("click_to_html",window.TIME_pagestart-l.getTime());if(window.TIME_doc_load_stop)Uq("click_to_doc_readable"+i,window.TIME_doc_load_stop-l.getTime());
else window.TIME_doc_load_full&&Uq("click_to_doc_readable"+i,window.TIME_doc_load_full-l.getTime());window.TIME_doc_load_full&&Uq("click_to_doc_loaded",window.TIME_doc_load_full-l.getTime())}}}catch(f){}if(window.TIME_exstart&&window.TIME_doc_load_full)window.TIME_exstart>window.TIME_doc_load_full?Uq("js_additional_load",window.TIME_exstart-window.TIME_doc_load_full):Uq("doc_additional_load",window.TIME_doc_load_full-window.TIME_exstart);window.TIME_pagestart&&Uq("html_load"+i,b-window.TIME_pagestart);
window.TIME_cssload&&Uq("css_load",window.TIME_cssload)}catch(f){rce("recordLoadTimings",f.message)}}
function Vz(a,b){var c="";try{Wz("DesignPageHasLoaded");var d=O("loadingDiv");if(d)d.style.visibility="hidden";Xz();fq=new pz(window,"/");c="/writely.editor_";T=new Wy("wys_frame",fq);c="/writely.fieldObj_";fq.wh(T);c="/makeEditable";fq.Iv(T.Cp.id);c="/focusOnField";if(F)Y.onbeforeunload=function(){return window.onbeforeunload()};Yz();c="/initTabs";Zz();c="/AttachKeyHandlers";oz();c="/UpdateToolbarState";oy();Vr(!!b,"DesignPageHasLoaded: empty revision ID");Ux=b;c="/UpdateLastKnownInnerHTML";$x=j;
a&&ix();c="/startHeartbeat"}catch(f){rce("DesignPageHasLoaded",f,$z+c);k(f)}aA=j;Nq&&window.setTimeout(Vq,30000);Gt();bA();if(V("enable_comments")||V("enable_footnotes")){lw();Lv()}Tq("make_editable")}function cA(a){var b=new Nt;b.pn(Y);var c=Y.document.body;if(E){while(c&&(c.nodeType!=3||!c.data.match(/\S/)))c=Oy(c);c||(c=Y.document.body.insertBefore(Y.document.createTextNode(" "),Y.document.body.firstChild));b.RC(c);b.restore()}var d=dA();B&&!d&&Y.scrollTo(0,a)}var eA=h,fA=h;
function gA(a,b){if(E&&a&&a.button==2){eA=new Nt;eA.pn(Y);eA.capture()}if(b.className=="misspell")fA=window.setTimeout(function(){hA(b)},100);else if(b.className=="writely-comment")fA=window.setTimeout(function(){Rx(b)},100)}function iA(a){if(ys()=="edit"&&F)return jA(a,a.target,j)}
function jA(a,b,c){if(fA){window.clearTimeout(fA);fA=h}if(a&&a.shiftKey)return;var d=mz();if(Gz(d,"writely-toc"))return;if(!Fz(d,"table")&&!Fz(d,"img")&&!Gz(d,"google_header")&&!Gz(d,"google_footer")&&!Fz(d,"ul")&&!Fz(d,"ol")&&!Fz(d,"hr"))return;wu();if(E&&eA){var f=Az();f&&f.tagName=="DIV"&&eA.restore()}eA=h;if(b!=h&&b.className!=h&&(b.className=="misspell"||b.className=="writely-comment")){if(B){a.cancelBubble=j;a.returnValue=e}else a.preventDefault();return}var g={x:0,y:0};g.x=document.all?a.clientX:
a.pageX;g.y=document.all?a.clientY:a.pageY;if(g.x<0)return;if(B){a.cancelBubble=j;a.returnValue=e}else if(!A){a.preventDefault();g.x-=Y.document.body.scrollLeft;g.y-=F?Y.document.body.scrollTop:Y.document.documentElement.scrollTop}var i=vr(window.document.getElementById("wys_frame").offsetParent,e);g.x+=i.x;c||(g.y+=i.y);fq.sf();window.setTimeout(function(){Ez(g.x,g.y,d)},100)}var $z="Not Started, agent: "+navigator.userAgent+", isIE: "+B;
function Wz(a){var b=O("loadingDiv");if(b){var c=b.innerHTML;b.innerHTML=b.innerHTML.length>=20?c.substring(0,c.indexOf(".")):b.innerHTML+".";b.style.left=((b.offsetParent||document.body).clientWidth-b.clientWidth)/2}$z=$z+" / "+a}function qy(){var a=O("shadow_frame");if(a)return a.contentWindow;return h}function kA(a){Y=O("wys_frame").contentWindow;ex=a.passedDocIsShared;Qr=a.postbackDocPage;Vr(!!a.passedBaseRev,"Missing Rev ID in LoadWYSIWYGEdit");Ux=a.passedBaseRev;Qs=a.docTitle;sw()}
function au(){if(IS_GEARS){offline.wM("edit",undefined,undefined,j,undefined,j);return}if(V("enable_comments")||V("enable_footnotes"))nw();var a="&timestamp="+encodeURIComponent((new Date).getTime()),b=Pr+"?docID="+encodeURIComponent(docID)+"&justBody=false&revision=_latest"+a+"&editMode=true";b+="&strip=true";Wz("WYSEditor.document.location = "+b);if(E&&qb("1.9"))Y.document.designMode="off";Y.location.replace(b);Nq&&Rq("doc_load")}function lA(a){if(F)Y.document.onscroll=a;else H(Y,"scroll",a)}
function Zz(){lA(mA);if("addEventListener"in Y){Y.addEventListener("click",nA,j);Y.addEventListener("mousedown",Ir(gA),j);Y.addEventListener("contextmenu",Ir(jA),j);E&&!("contentEditable"in window.document.body)&&Y.document.addEventListener("DOMNodeRemoved",oA,j)}else{var a=frames.wys_frame.document;a.body.attachEvent("onpaste",function(){Tz.Ck(Y);if(V("enable_comments")||V("enable_footnotes")){lw();window.setTimeout(Lv,0)}});a.attachEvent("onmousedown",Ir(gA));a.attachEvent("oncontextmenu",Ir(jA))}}
function mA(){V("enable_toc")==j&&pA();fq&&fq.rh()&&fq.Wa.Og();qA()}function rA(){qA()}function qA(){if(V("enable_comments")==j||V("enable_footnotes")==j)(ew||(ew=new dw)).YG()}var sA=0;function oA(){sA!==0&&window.clearTimeout(sA);sA=window.setTimeout(tA,0)}
function tA(){sA=0;var a=Y.getSelection();try{var b=a.getRangeAt(a.rangeCount-1)}catch(c){return}var d=b.startContainer,f=b.startOffset,g=d.childNodes;if(d.tagName!="BODY"&&d.nodeType!=3&&b.collapsed){var i=Y.document.createTextNode("");f>=g.length?d.appendChild(i):d.insertBefore(i,g[f])}}function Xz(){var a=Y.document.getElementsByTagName("table");for(var b=0,c;c=a[b];b++)c.getAttribute("border")=="0"&&Kd(c,"zeroBorder")}function uA(a){fq.execute(kz,a);editUI.w.ma(kz,a);editUI.B.CM(a)}
function nA(){}function vA(a){var b=e;if(F&&a!=13)return b;var c=T.fa(),d=c?c.Zb():h;if(c&&d&&d.nodeName.toLowerCase()=="marker"){var f=Y.document.createElement("span");c.Lq(f);var g=d.innerHTML;Q(f);var i=j;if(g=="<span></span>&nbsp;")i=e;if(a==13){b=j;var l=Y.document.createElement("div"),m=Y.document.createElement("br");l.appendChild(m);if(i){be(l,d);c.pe(m)}else{ae(l,d.previousSibling);c.Hr(d.previousSibling)}}else F||(a==37||!i?c.Hr(d.previousSibling):c.pe(d))}return b}
function wA(a){var b=e,c=a==37,d=a==39,f=a==13;if(!c&&!d&&!f)return b;var g=T.Hb(),i=Tl(g.sc());Vb(i.getElementsByTagName("marker"),function(l){var m=l.previousSibling,n=Ee(m,0,l,1);if(c&&g.Q()==l||d&&g.isCollapsed()&&g.Q().nextSibling==m&&g.ta()==g.Q().length||n.Rd(g,e)){l.style.display="inline";m.style.display="inline";n.collapse(c);if((d||f)&&!l.nextSibling){l.parentNode.appendChild(Y.document.createTextNode(" "));var q=j}n.select();l.style.display="inline-block";c&&l.parentNode.insertBefore(m,
l);m.style.display="";q&&Y.document.execCommand("delete",e,j);b=!f}});return b}function xA(a){if(B)return e;if((a.which||a.charCode||a.keyCode)!=8)return e;if(cs.startOffset!=0||cs.collapsed==e)return e;var b=cs.commonAncestorContainer,c;if(b.tagName=="BODY")c=b.firstChild;else{c=b.previousSibling;while(!c&&b){b=b.parentNode;c=b.previousSibling}}if(c&&c.tagName=="DIV"&&(c.className=="google_header"||c.className=="google_footer"))return j}
function yA(a){if((a.which||a.charCode||a.keyCode)!=8)return e;if(kr($.innerHTML))return e;var b=$.parentNode;if(b&&(b.className=="google_header"||b.className=="google_footer")&&b.childNodes.length==1)return j;if($.className=="google_header"||$.className=="google_footer")return j;return e}
Sz.prototype.mo=function(a,b,c,d,f,g,i){if(window.dialogIsShowing)return;var l=String(a.newContentRevID);if(a.status=="success_collide")if("discardedChanges"in a&&Ea(a.discardedChanges).length>0){var m=Number(l.substr(l.indexOf(":")+1));By(a.discardedChanges,docID,m,c);delete a.discardedChanges}else{var n=(IS_GEARS?Nw:Mw)+" "+Na(c);zy(n,j,i)}if(a.lastSavedDesc.length>0)ky=a.lastSavedDesc;a.newTitleFromServer.length>0&&a.newTitleFromServer!=Qs&&Rs(a.newTitleFromServer);var q=window.SAVE_RESPONSE_CALLBACK;
if(q){q(a);Zx=Math.max(d,Zx)}var r=d==uy();this.dg.ma(Number(a.version));this.dg.pI()&&(new Xq(window)).reload(j);if(l&&r||a.status=="throttled"||a.status=="success_collide"){if(a.spellcheckException){U("\u7531\u4e8e\u5185\u90e8\u9519\u8bef\uff0c\u62fc\u5199\u68c0\u67e5\u5931\u8d25\u3002");lz(e)}else if(a.newContentIncludesMisspellingAdornments){yy(Ly(Vx));zA(j)}else zA(e);var t=AA(Y);Qy(a);Ux=l;Vr(!!Ux,"Missing Rev ID in UpdateRevisionInfo, location 1");yy(a.newContentFromServer);oy();"rtl"in a&&
BA(a.rtl);if(!A){var v=t-AA(Y);v!==0&&Y.scrollBy(0,-v)}}else{var x=String(a.revisionIDFromUpload);if(x){Ux=x;Vr(!!Ux,"Missing Rev ID in UpdateRevisionInfo, location 2");yy(b);if(c!=gUntitled)Qs=c;Jy(j)}if(l&&f)i?Ys(i,h):jx(2)}};
function Hy(a){if(!a)return 0;if(a){var b=[];a.pageYOffset&&b.push(a.pageYOffset);a.document.documentElement&&b.push(a.document.documentElement.scrollTop);a.document.body.scrollTop&&b.push(a.document.body.scrollTop);var c=Number.MAX_VALUE;for(var d=0;d<b.length;d++)if(typeof b[d]=="number"&&b[d]!=0&&b[d]<c)c=b[d];return c==Number.MAX_VALUE?0:c}}Sz.prototype.YA=/(<gdoc:callout [^>]*>)(<span [^>]*calloutclosed="true"[^>]*>).*(<\/span><\/gdoc:callout>)/ig;Sz.prototype.XA=/(<gdoc:callout [^>]*>)(<span [^>]*calloutclosed="true"[^>]*>).*(<\/span><\/gdoc:callout>)/ig;
Sz.prototype.WA=/(<marker [^>]*>)[^<>]*(<\/marker>)/ig;
Sz.prototype.Kd=function(){if(!Y)k(Error("can not get document contents: WYSEditor = "+Y));if(!Y.document)k(Error("can not get document contents: WYSEditor.document = "+Y.document));if(!Y.document.body)k(Error("can not get document contents: WYSEditor.document.body = "+Y.document.body));if(T){T.kf(R.cd);T.kf(R.of)}Bs(Y.document);V("fine_grained_update")&&My(Y.document.body);var a=Y.document.body.innerHTML,b=[];Y.location&&Y.location.href&&b.push(Y.location.href);window.location&&window.location.href&&
b.push(window.location.href);for(var c=0;c<b.length;c++){var d=b[c];if(d.lastIndexOf("#")!=-1)d=d.substring(0,d.lastIndexOf("#"));var f=d.replace(/&/g,"&amp;").replace(/([^\w])/g,"\\$1");a=a.replace(new RegExp("(\\shref=['\"])"+f+"#","gi"),"$1#");if(d.lastIndexOf("/")!=-1){var g=d.substring(0,d.lastIndexOf("/")+1);g=g.replace(/([^\w])/g,"\\$1");a=a.replace(new RegExp("(\\s(src|href)=['\"])"+g,"gi"),"$1")}}var i=V("enable_comments")||V("enable_footnotes");if(!E){a=a.replace(/ goog_docs_charIndex="\d+"/g,
"");if(i){a=a.replace(/ closure_hashcode_="\d+"/ig,"");a=a.replace(/<\?xml\:namespace prefix = gdoc \/>/ig,"")}}if(i){var l=h;l=B?Tz.YA:Tz.XA;a=a.replace(l,"<span>$2</span>");a=a.replace(Tz.WA,"")}a=a.replace(/<script[^<]*<\/script>/ig,"");if(T){T.ng();T.Bn(R.of)}return a};
function Rz(a,b){if(A){var c=Y.pageXOffset,d=Y.pageYOffset}var f=Y.document.getElementById(a);if(f==h)return;if(b==h)b=f.innerHTML;if("insertAdjacentText"in f){f.insertAdjacentText("beforeBegin",b);f.parentNode.removeChild(f)}else{var g=Y.document.createTextNode(b);f.parentNode.replaceChild(g,f)}A&&Y.scrollTo(c,d)}function CA(){jy=j;Ky(e,e,h,j,j,0,j)}function DA(){if(A){var a=Y.pageXOffset,b=Y.pageYOffset}uy();Ly(h);jy=e;oy();A&&Y.scrollTo(a,b)}
function hA(a){var b=a.getAttribute("suggestions");if(b!=h){var c=h;if(b.length>0)c=b.split(",");EA(a);var d=Xf(a),f=O("wys_frame"),g=Wf(f).y;(new Qz(d.x,d.y+g+a.offsetHeight,document.body,a,c,Y)).Yc()}}function EA(a){var b=Y.document.getElementById("bad_word");b!=h&&b.removeAttribute("id");a.id="bad_word"}Sz.prototype.Ck=function(a){return Zr(a)};var FA=new RegExp("<span[ ]+[^>]*?class=[\"']?misspell[\"']?[^>]*?>([^<]+)</span>","gi");
function Ly(a){if(A){var b=Y.pageXOffset,c=Y.pageYOffset}if(!jy)return a;if(a)return a.replace(FA,"$1");var d=(new Pd(Y.document)).eh("span","misspell");for(var f=0;f<d.length;f++)if(typeof d[f].insertAdjacentText!="undefined"){d[f].insertAdjacentText("beforeBegin",d[f].innerText);d[f].parentNode.removeChild(d[f])}else{var g=Y.document.createTextNode(d[f].innerHTML);d[f].parentNode.replaceChild(g,d[f])}A&&Y.scrollTo(b,c);return h}
function Mz(a){if(Y.document.createRange){var b=Y.document.createRange();b.setStart(a,0);b.setEnd(a,0);var c=He(Y);if(c){c.removeAllRanges();c.addRange(b)}}else{var b=Y.document.body.createTextRange();b.moveToElementText(a);b.select();GA(e,0)}}
function GA(a,b){var c=Ot();if(!c)return;if("moveEnd"in c&&"moveStart"in c){if(a){b>0&&c.moveEnd("character",b);c.collapse(e)}else{b>0&&c.moveStart("character",-1*b);c.collapse(j)}c.select()}else{var d=He(Y);if("collapseToEnd"in d&&"collapseToStart"in d)a?d.collapseToEnd():d.collapseToStart()}}
function HA(a){var b=Az();b=IA(b);if(!b)return e;if(Bz(b,"td")||Bz(b,"th")){var c=a?b.nextSibling:b.previousSibling;if(c&&c.nodeType!=1)c=a?b.nextSibling:b.previousSibling;if(c)Mz(c);else{var d=b.parentNode;c=a?d.nextSibling:d.previousSibling;if(c&&c.nodeType!=1)c=a?b.nextSibling:b.previousSibling;if(!c&&a){$=d;tz(e);c=d.nextSibling}if(c&&c.hasChildNodes())Mz(a?c.firstChild:c.lastChild)}return j}return e}
function Fz(a,b){if(a&&b){b=b.toUpperCase();for(var c=0;c<a.length;c++)if(a[c].tagName==b)return j}return e}function Gz(a,b){if(a&&b)for(var c=0;c<a.length;c++)if(a[c].className==b)return j;return e}
function Az(a,b){var c,d;c=typeof a=="undefined"?He(Y):a;d=typeof b=="undefined"?Ot(c):b;if(!c||!d)return h;if(B)switch(c.type){case "Text":case "None":case "Control":return d.parentElement();default:return Y.body}else try{var f=d.commonAncestorContainer;if(!d.collapsed&&d.startContainer==d.endContainer&&d.startOffset-d.endOffset<=1&&d.startContainer.hasChildNodes())f=d.startContainer.childNodes[d.startOffset];while(f.nodeType==3)f=f.parentNode;return f}catch(g){return h}}
function mz(a){try{var b;b=typeof a!="undefined"?a:Az();var c=[];while(b&&b.nodeType==1&&b.tagName!="BODY"){c.push(b);b=b.parentNode}Y.document.body&&c.push(Y.document.body);return c}catch(d){rce("GetAllNodes",d);return h}}
function JA(){var a=mz();if(Fz(a,"blockquote"))try{var b=Xr(Az(),"blockquote");b!=h&&!!(b&&ee(b))}catch(c){U(c.message)}else if(B){var d=Ot();if(d){var f=js();d.pasteHTML("<blockquote id="+f+">"+(d.htmlText||"&nbsp;")+"</blockquote>");var b=Y.document.getElementById(f);if(b&&b.parentNode.tagName=="FONT"&&b.parentNode.childNodes.length==1){var g=b.parentNode;g.parentNode.appendChild(b);g.parentNode.removeChild(g)}}}else{fq.execute(Zy);Y.document.body.lastChild.tagName=="BLOCKQUOTE"&&Y.document.body.appendChild(Y.document.createElement("BR"))}}
function zz(){var a=window.clipboardData,b=a?a.getData("Text"):h;if(b)Rt(b,h,j);else b!=""&&es("EditHtmlSelection")}
function oz(){if(!editUI||!editUI.w)return;wu();var a=fq.Xi()||T;try{var b=a.Hb().gc(),c=a.Hb().s()}catch(d){return}var f=h,g=h,i=h,l=h,m=h,n=h,q=h,r=h,t=h,v=h,x=h,C=h,J=h,D=h,L=h,ea=h,va=h,vb=h,mb=h,gb=h,de=h,vo=h,wo=h,xo=h,yo=h;if(!b)return;var Bu=KA(b,c.body);for(var zo=0;zo<Bu.length;zo++){var Tc,xb,Wa=Bu[zo];Tc=c.defaultView&&c.defaultView.getComputedStyle?c.defaultView.getComputedStyle(Wa,h):Wa.currentStyle;xb=Tc.fontWeight;f=LA(f,xb!="400"&&xb!="normal");xb=Tc.fontStyle;g=LA(g,xb=="italic");
xb=Tc.textDecoration;i=LA(i,xb=="underline");xb=Tc.textAlign;l=LA(l,xb=="justify");m=LA(m,xb=="left");n=LA(n,xb=="center");q=LA(q,xb=="right");xb=Tc.direction;t=LA(t,xb=="rtl");r=LA(r,xb!="rtl");x=LA(x,Tc.fontSize);C=LA(C,Tc.fontFamily);ea=LA(ea,Tc.color);va=LA(va,Tc.backgroundColor);var Cu=e,Du=e,Eu=e,Fu=e,Gu=e,Hu=e,Iu=e,Ju=e,Ku=e,Lu=e,Mu=e;while(Wa){if(Wa.tagName=="OL"){Cu=j;break}else if(Wa.tagName=="UL"){Du=j;break}else if(Wa.tagName=="BLOCKQUOTE"){Eu=j;break}else if(Wa.tagName=="TABLE"){Mu=j;
break}else if(Wa.tagName=="P"){Fu=j;break}else if(Wa.tagName=="H1"){Gu=j;break}else if(Wa.tagName=="H2"){Hu=j;break}else if(Wa.tagName=="H3"){Iu=j;break}else if(Wa.tagName=="H4"){Ju=j;break}else if(Wa.tagName=="H5"){Ku=j;break}else if(Wa.tagName=="H6"){Lu=j;break}Wa=Wa.parentNode}if(Wa&&Wa.tagName.match("P|H[1-6]"))v=LA(v,Wa.tagName);J=LA(J,Cu);D=LA(D,Du);L=LA(L,Eu);vb=LA(vb,Mu);mb=LA(mb,Fu);gb=LA(gb,Gu);de=LA(de,Hu);vo=LA(vo,Iu);wo=LA(wo,Ju);xo=LA(xo,Ku);yo=LA(yo,Lu)}if("collapsed"in b&&b.collapsed||
"htmlText"in b&&b.htmlText==""){if(az!==h){f=az;az=h}if(bz!==h){g=bz;bz=h}if(cz!==h){i=cz;cz=h}if(fz!==h){v=fz;fz=h}if(jz!==h){x=jz;jz=h}if(hz!==h){C=hz;hz=h}if(dz!==h){ea=dz;dz=h}}else{az=h;bz=h;cz=h;fz=h;hz=h;jz=h;dz=h}if(r&&!t){if(!l&&!n&&!q)m=j}else if(!r&&t)if(!l&&!n&&!m)q=j;editUI.w.ma(S.xg,f);editUI.w.ma(S.zg,g);editUI.w.ma(S.Bg,i);editUI.w.ma(S.ei,l);editUI.w.ma(S.fi,m);editUI.w.ma(S.di,n);editUI.w.ma(S.gi,q);editUI.w.ma(S.hi,J);editUI.w.ma(S.ki,D);editUI.w.ma(ez,v);editUI.w.ma(gz,C);editUI.w.ma(iz,
x);editUI.w.ma(S.zk,va);editUI.w.ma(S.bi,ea);if(V("isbidion")){editUI.w.ma(S.ai,t);editUI.w.ma(S.Ak,r)}editUI.B.ma("table",vb);editUI.B.ma("P",mb);editUI.B.ma("H1",gb);editUI.B.ma("H2",de);editUI.B.ma("H3",vo);editUI.B.ma("H4",wo);editUI.B.ma("H5",xo);editUI.B.ma("H6",yo);editUI.w.blur();editUI.B.blur();editUI.Xc.Dc(h);V("enable_toc")==j&&pA()}function LA(a,b){return a==h?b:a==b?b:e}var az=h,bz=h,cz=h,fz=h,jz=h,hz=h,dz=h;
function KA(a,b){var c=[],d=e;if("commonAncestorContainer"in a)if(a.collapsed){c=[a.commonAncestorContainer];d=j}else{var f=a.startContainer;if((f.nodeType==3?f.length:f.childNodes.length)==a.startOffset){if(f.hasChildNodes())f=f.firstChild;else if(f.nextSibling)f=f.nextSibling;else while(f){if(f.nextSibling){f=f.nextSibling;break}f=f.parentNode}f&&a.setStart(f,0)}var g=a.endContainer;if(0==a.endOffset){while(g){if(g.previousSibling){g=g.previousSibling;break}g=g.parentNode}if(g)a.setEnd(g,g.nodeType==
3?g.data.length:g.childNodes.length)}var i=a.commonAncestorContainer;if(i.hasChildNodes()&&"isPointInRange"in a){c.push(f);var l=i.childNodes,m=e;for(var n=0,q;q=l[n];n++)if(a.isPointInRange(q,0)){c.push(q);m=j}else if(m)break}else if(i.hasChildNodes()&&"compareBoundaryPoints"in a){var l=i.childNodes,m=e,r=b;while(r.parentNode)r=r.parentNode;var t=r.createRange();for(var n=0,q;q=l[n];n++){t.setStartBefore(q);t.setEndAfter(q);if(a.compareBoundaryPoints(Range.END_TO_START,t)==-1&&a.compareBoundaryPoints(Range.START_TO_END,
t)==1){c.push(q);m=j}else if(m)break}}else c.push(i)}else if("parentElement"in a){var i=a.parentElement();if(a.htmlText!=""&&i.hasChildNodes()){var r=b;while(r.parentNode)r=r.parentNode;var l=i.childNodes,t=r.body.createTextRange(),m=e,v=h;for(var n=0,q;q=l[n];n++)if(q.nodeType==1){t.moveToElementText(q);v&&t.compareEndPoints("StartToStart",a)==1&&c.push(v);v=h;var x=t.compareEndPoints(m?"StartToEnd":"EndToStart",a);if(m?x==-1:x==1){c.push(q);if(t.compareEndPoints("EndToEnd",a)!=-1)break;m=j}else if(m)break}else if(q.nodeType==
3)if(m)c.push(q);else v=q;v&&c.push(v);c.length==0&&c.push(i)}else{c.push(i);d=j}}if(!d&&c.length==1&&c[0].hasChildNodes()){var C=c[0].childNodes;c.pop();for(var n=0,J;J=C[n];n++)c.push(J)}c.length>40&&c.splice(16,c.length-32);for(var n=c.length-1;n>=0;n--)while(c[n]&&c[n].nodeType!=1){var D=h;try{D=c[n].data}catch(L){}if(c[n].nodeType!=3)c.splice(n,1);else if(c.length!=1&&!D)c.splice(n,1);else if(c.length!=1&&D.match(/^\s+$/))c.splice(n,1);else{var ea=e;try{c[n]=c[n].parentNode}catch(L){ea=j}if(ea||
c[n]==c[n+1])c.splice(n,1)}}c.length||(c=[b]);return c}function BA(a){if(a){Y.document.body.setAttribute("dir","rtl");Y.document.body.style.direction="rtl";Y.document.body.style.textAlign="right"}else{Y.document.body.setAttribute("dir","ltr");Y.document.body.style.direction="ltr";Y.document.body.style.textAlign=""}}
function IA(a){if(!a)return h;if(Bz(a,"body")||Bz(a,"p")||Bz(a,"div")||Bz(a,"td")||Bz(a,"pre")||Bz(a,"ol")||Bz(a,"ul")||Bz(a,"dl")||Bz(a,"th")||Bz(a,"h1")||Bz(a,"h2")||Bz(a,"h3")||Bz(a,"h4")||Bz(a,"h5")||Bz(a,"h6")||Bz(a,"blockquote")||Bz(a,"address"))return a;return IA(a.parentNode)}
function AA(a){if(!a)return 0;var b=0;if(B){var c=a.document.selection.createRange();b=c.offsetTop}else if(A)b=0;else{var d=a.getSelection().getRangeAt(0),f=a.document.createRange();f.setEnd(d.startContainer,d.startOffset);var g=0,i=d.startContainer;if(i.nodeType==1&&d.startOffset!=0)if(d.startOffset<i.childNodes.length)i=i.childNodes[d.startOffset];else{g=i.offsetHeight;while(i){g+=i.offsetTop;i=i.offsetParent}return g}while(i&&typeof i.offsetTop=="undefined")if(i.previousSibling){i=i.previousSibling;
if(i.offsetHeight)g+=i.offsetHeight;f.setStartAfter(i)}else{i=i.parentNode;f.setStartBefore(i)}while(i){g+=i.offsetTop;i=i.offsetParent}var l=f.toString().length;f.setStart(d.startContainer,d.startOffset);var m=0;i=d.startContainer;if(i.nodeType==1&&d.startOffset!=0)i=i.childNodes[d.startOffset];while(i&&typeof i.offsetTop=="undefined")if(i.nextSibling){i=i.nextSibling;f.setEndBefore(i)}else{i=i.parentNode;if(i.offsetHeight)m=i.offsetHeight;f.setEndAfter(i)}while(i){m+=i.offsetTop;i=i.offsetParent}var n=
f.toString().length;b=n===0?m:g+(m-g)*(l/(l+n));b-=Hy(a)}return b}var MA=e;function lz(a){if(a&&window.LIMITED_EDITING)return;if(a){MA=j;CA(Eq("doclangcode"))}else{MA=e;DA()}}function zA(a){if(MA)if(a)MA=e;else window.setTimeout(function(){lz(e)},3000)};var er=function(){},NA=function(a,b,c,d,f,g,i){this.it=a;this.Ua=b?1:0;this.cI=c;this.QN=d;this.cF=f;this.Xs=g;this.PB=i};NA.prototype.Te=function(){return 1==this.Ua||this.Lx()};NA.prototype.Lx=function(){return 2==this.Ua};NA.prototype.kL=function(){return this.Ua=1};NA.prototype.eL=function(){return this.Ua=2};var $t=h,OA=0,ys=function(){$t||($t=typeof EditPageTab!="undefined"?EditPageTab:W("canedit")==e?"view":tq().qd("tab")||"edit");return $t},fr=function(){return PA[ys()].cI};
var QA=["view","edit","revlist","revcomp","revbrowse","htmledit","share","publish","printpreview"],PA={view:new NA("ViewTab?docid=%DOCID%".replace("%DOCID%",encodeURIComponent(uq())),IS_GEARS||ys()=="view",e,e,j,"view",e),edit:new NA("EditTab?docid=%DOCID%".replace("%DOCID%",encodeURIComponent(uq())),IS_GEARS||"edit"==ys(),j,e,j,"edit",e),htmledit:new NA("HtmlEditTab?docid=%DOCID%".replace("%DOCID%",encodeURIComponent(uq())),IS_GEARS||ys()=="htmledit",j,e,j,"htmledit",e),revlist:new NA("RevisionsTab?docid=%DOCID%&tab=revlist".replace("%DOCID%",
encodeURIComponent(uq())),!IS_GEARS&&ys()=="revlist",e,e,j,"revisions",j),revbrowse:new NA("RevisionsTab?docid=%DOCID%&tab=revbrowse".replace("%DOCID%",encodeURIComponent(uq())),!IS_GEARS&&ys()=="revbrowser",e,e,j,"revisions",j),revcomp:new NA("RevisionsTab?docid=%DOCID%&tab=revcomp".replace("%DOCID%",encodeURIComponent(uq())),!IS_GEARS&&ys()=="revcomp",e,e,j,"revisions",j),share:new NA("ShareTab?docid=%DOCID%".replace("%DOCID%",encodeURIComponent(uq())),!IS_GEARS&&ys()=="share",e,j,e,"share",e),
publish:new NA("PublishTab?docid=%DOCID%".replace("%DOCID%",encodeURIComponent(uq())),!IS_GEARS&&ys()=="publish",e,j,e,"publish",e),printpreview:new NA("PrintPreviewTab?docid=%DOCID%".replace("%DOCID%",encodeURIComponent(uq())),!IS_GEARS&&ys()=="printpreview",e,j,j,"printpreview",e)},RA=h,SA=h,aA=e,TA=h,UA=0,VA=h,Yz=function(){if(VA)return;var a=h;if(typeof offline!="undefined"){var b=ys(),c=tq().qd("userstoinvite");if(b=="share"&&c)a="&userstoinvite="+encodeURIComponent(c);var d=tq().qd("frev"),
f=tq().qd("trev");if(b=="revcomp"&&d&&f)a="&frev="+encodeURIComponent(d)+"&trev="+encodeURIComponent(f)}var b=ys();hu(b,a);document.body.style.overflow="hidden";if("edit"==ys()){var g=O("loadingDiv");if(g){g.className="visibleStatus";g.style.left=g.offsetParent.clientWidth-g.clientWidth}}VA=j;window.onbeforeunload=Iy;window.document.addEventListener?window.document.addEventListener("keypress",WA,j):window.attachEvent("onkeydown",WA);if(navigator.userAgent.indexOf("MSIE")>-1)try{document.execCommand("BackgroundImageCache",
e,j)}catch(i){}},WA=function(a){if(!a)return},hu=function(a,b,c){if(W("canedit")==e&&a!="view"&&a!="printpreview")return;if(editUI.tl)W("isshared")?editUI.tl.u(j):editUI.tl.u(e);if(window.LIMITED_EDITING&&(a=="revlist"||a=="revbrowse"||a=="revcomp"||a=="share"||a=="publish"||a=="printpreview")){var d=O("tabLoadingSpan");Md(d,"visibleStatus","hiddenStatus");return}if(!c&&UA>0)return;if(bx()){c||(UA=100);if(UA>0){UA--;window.setTimeout(function(){hu(a,b,j)},100)}return}var f=ys();if(!c&&(f=="edit"&&
a!="edit"||f=="htmledit"&&a!="htmledit")){var d=O("tabLoadingSpan");Md(d,"hiddenStatus","visibleStatus");UA=100;or(function(){uy();hu(a,b,j)});return}UA=0;var g=new Xh(window.location),i=g.qd("tab");if(i&&i!="edit"&&a=="edit"){g.Jb.remove("tab");window.location=g;return}if(a=="edit"&&f=="view"||a=="view"&&f=="edit"||a=="edit"&&f=="htmledit"){i?g.Jb.remove("tab"):g.Jb.add("tab",a);Iy();window.location=g;return}qw();if(T){E&&T.ve(j,j);T.kd()}pA(j);$t=a;var l=PA[a],m=l.Xs;for(var n=0;n<QA.length;n++){var q=
QA[n],r=PA[q].Xs,t=XA(q);if(t)t.style.display=r==m?"":"none"}var v=O("encloser");l.cF?v.setAttribute("height","100%"):v.removeAttribute("height");if(a=="edit")O("editor-chrome").style.display="block";else O("editor-chrome").style.display="none";if(!l.Te()||l.PB)window.setTimeout(function(){YA(a,b)},0);else{var d=O("tabLoadingSpan");Md(d,"visibleStatus","hiddenStatus");l.Lx()?ZA(a):$A(a)}if((a=="edit"||a=="view")&&(V("enable_comments")||V("enable_footnotes")))document.getElementById(ys()+"_wys_sidebar")&&
aB()},vs=function(){qw();YA(ys())},YA=function(a,b){var c=O("tabLoadingSpan");Md(c,"hiddenStatus","visibleStatus");var d=O("tab_container");c.style.top=d.offsetTop+"px";c.style.left=d.offsetLeft+d.offsetWidth-c.offsetWidth+"px";RA&&bB();RA=new Kj;RA.dk(20000);H(RA,[yj,zj,Aj],cB);SA=a;RA.send(PA[a].it+(b||""));Nq&&Rq("load_tab_"+a)},cB=function(a){var b=SA;if(a.type==yj){var c=XA(b);c.innerHTML=RA.gq();PA[b].kL();$A(b);dB(b);Nq&&Tq("load_tab_"+b)}else{Nq&&Sq("load_tab_"+b);if(b!="edit"&&b!="htmledit"){hu("edit");
return}var c=XA(b);c.innerHTML='<b class="app">\u65e0\u6cd5\u8f7d\u5165\u6807\u7b7e\u3002\u8bf7\u91cd\u8bd5\u3002</b>'}bB();var d=O("tabLoadingSpan");Md(d,"visibleStatus","hiddenStatus")},eB=function(a,b,c){W("isshared")?a.u(j):a.u(e);if(c>Jq("max_email_recipients")){a.u(e);b.u(e)}else b.u(j)},fB=function(a){eB(editUI.Xc.K().j("email"),editUI.Xc.K().j("senddoc"),a)},jB=function(){if(!editUI.Xc){gB.u(j);hB.u(j);iB.u(j);editUI.Xc=hB;O("writely-button-share").tabIndex=0;editUI.tl=editUI.Xc.K().j("email");
var a=editUI.Xc.K().j("senddoc");eB(editUI.tl,a,Kq("numcollaborators")+Kq("numviewers"));H(editUI.Xc,vg,function(b){switch(b.target.Gb()){case "share":hu("share");break;case "email":or(function(){Hs(e)});break;case "senddoc":W("canedit")?Hs(j):or(function(){Hs(j)});break;case "publish":hu("publish");break;case "preview":nr("");break}});editUI.Wr=iB;O("writely-button-save").tabIndex=0;H(editUI.Wr,vg,function(){Fx(h)});editUI.Xr=gB;O("writely-button-saveclose").tabIndex=0;H(editUI.Xr,vg,function(){Fs(O("writely-button-saveclose"))})}},
$A=function(a){document.body.style.overflow=fr()||ys()=="view"?"hidden":"auto";jB();switch(a){case "edit":editUI.B=new kB(lB);editUI.w=new mB(nB);if(V("enable_find_bar"))editUI.Yb=new oB(O("editor-findbar"));Tx=j;aA?ZA(a):kA({docTitle:docTitle||"",passedBaseRev:Eq("baserev")||"",passedDocIsShared:W("isshared"),postbackDocPage:"RawDocContents"});TA=a;if(V("enable_comments")||V("enable_footnotes"))aB();break;case "share":shareUI.MA(j);var b=new Qk(SERVER_BASE,"writely");b.ts(Cq("language"));var c=O("users_to_invite");
if(c)try{b.uo(c,{groups:j,implicitGroups:j,extendedInterface:j});O("contact_picker_link").onclick=function(i){b.jr(c,i);return e}}catch(d){}var f=Number(document.getElementById("numCollaborators").innerHTML),g=Number(document.getElementById("numViewers").innerHTML);ex=f+g>0;X("isshared",ex);break;case "publish":Tq("publish");break;case "htmledit":aA?ZA(a):pB({docTitle:docTitle||"",passedBaseRev:Eq("baserev"),passedDocIsShared:W("isshared"),postbackDocPage:"RawDocContents"});TA=a;break;case "revbrowse":case "revlist":break;
case "view":editUI.B=new kB(lB);editUI.B.xH();O("editor-toolbar").style.display="none";if(V("enable_find_bar"))O("editor-findbar").style.display="none";O("editor-chrome").style.display="block";editUI.Xc.o(e);editUI.Wr.o(e);editUI.Xr.o(e);if(V("enable_comments")||V("enable_footnotes"))aB();break;case "printpreview":qB();break}PA[a].eL()},ZA=function(a){document.body.style.overflow=fr()||ys()=="view"?"hidden":"auto";switch(a){case "edit":Tx=j;rB("htmledit",a,O("wys_frame").contentWindow);TA=a;sw();
T&&T.ra();break;case "htmledit":Tx=e;rB("edit",a,O("wys_textarea"));TA=a;break;case "view":Tx=e;O("editor-chrome").style.display="block";O("editor-menubar").style.display="block";break;case "printpreview":Tx=e;Wu();break;default:Tx=e}},XA=function(a){return O(PA[a].Xs+"_tab_contents")},bB=function(){if(!RA)return;ad(RA,[yj,zj,Aj],cB);RA.abort();RA.k();RA=h;SA=h},dB=function(a){var b=a||ys()||"edit";XA(b).style.display=""},vw=function(){if(ys()=="htmledit")return sB;if($t=="edit")return Tz;return{Ck:function(){},
mo:function(){},Kd:function(){k(Error("not in editor tab"))}}},rB=function(a,b,c){try{if(TA==h)Y=c;else if(b=="htmledit"&&TA!="htmledit"){var d=Tz.Kd();Y=c;Y.value=tB(d)}else if(b=="edit"&&TA=="htmledit"){var d=sB.Kd();Y=c;Y.document.body.innerHTML=d}else Y=c;OA=0}catch(f){++OA;OA>=3&&U(Ow);rce("maybeCopyTabContents_: fromTab|toTab|errorCount = "+a+"|"+b+"|"+OA,f)}},aB=function(){var a=O(ys()+"_wys_sidebar"),b=ew||(ew=new dw);ie(a,b.fu())||a.appendChild(b.fu())},uB=function(a){var b=O("fsDiv");if(b){b.style.display=
a?"block":"";Y&&Y.focus()}},vB=function(a){var b=editUI.B.Tp;if(h==b)return;var c=O("editor-chrome"),d=O("navigation");try{if(a)c.style.display=d.style.display="none";else{d.style.display=c.style.display="";b.Za(e)}uB(a);(ew||(ew=new dw)).mh()}catch(f){rce("changeFullscreen: ",f)}};w("writely.EditPage",er);w("writely.EditPage.selectTab",hu);w("writely.EditPage.showTabContent",dB);w("writely.EditPage.showFSHint",uB);w("writely.EditPage.updateShareOptions",fB);w("DocCheckClick",Br);
w("DoneButtonClicked",Fs);w("PostToBlog",$u);w("Stack",Ur);w("DeleteFromBlog",Ex);w("BlogSettingsDlg",Ax);w("CloseButter",$s);w("ShowButter",pq);w("RenameDocument",Ps);w("reportBug",Ty);w("WebKitContextMenu",iA);w("WY_convertComment",Kx);w("CorrectSpelling",Rz);w("AddWordToDict",Cz);w("dlgChangeRow",qx);w("dlgChangeColumn",px);w("dlgChangeCell",ox);w("MoveRow",sz);w("InsertRow",tz);w("InsertColumn",uz);w("DeleteTable",vz);w("DeleteRow",wz);w("DeleteColumn",xz);w("DeleteHeaderFooter",yz);
w("PasteHtmlSnippet",zz);w("dlgAddImage",wx);w("refreshSelectedImage",xx);w("dlgInsertUpdateTable",nx);w("dlgEditHtmlSelection",vx);var gB,hB,iB,lB,nB,wB;urchinPage="/Edit";
var xB=e,BB=function(a){var b=ys();if(b!="view"&&b!="edit")return;if(!xB)return;if(!window.DocumentHasLoaded)return;if(b=="view"){Yz();yB();return}Y=O("wys_frame").contentWindow;zB(function(){var c=Y.document.documentElement.scrollTop;Uz(a);Vz(j,a);window.setTimeout(function(){cA(c)},10)});E&&window.addEventListener("load",AB,e)},AB=function(){for(var a=Y.TimeoutId||0,b=Y.setTimeout("",0);a<b;a++)Y.clearTimeout(a)},yB=function(){Y=O("viewiframe").contentWindow;lA(rA);if(V("enable_comments")||V("enable_footnotes")){lw();
Lv()}dA();bA()},dA=function(){if(document.location.hash&&document.location.hash.length>1){var a=document.location.hash.substring(1),b=Y.document.getElementById(a);if(b){Y.scrollTo(0,Wf(b).y-b.parentNode.offsetHeight);return j}}return e},zB=function(a){try{if(B){if(!Y.frameElement||!Y.location)Y=O("wys_frame").contentWindow;Y.document.body.contentEditable="true";Y.document.body.innerHTML=Y.document.body.innerHTML;Y.document.execCommand("respectvisibilityindesign",e,j)}else if(F)Y.document.body.contentEditable=
"true";else{Y.document.designMode="On";Y.document.execCommand("styleWithCSS",e,e);Y.document.execCommand("useCSS",e,j)}}catch(b){var c=u(zB,h,a);window.setTimeout(c,200);return}typeof a=="function"&&a()},bA=function(){if(window.INLINE_DOC){var a=new Kj;a.dk(30000);var b="action=meta&revision=_latest&docID="+encodeURIComponent(docID)+"&timestamp="+(new Date).getTime();H(a,[zj,Aj],function(){rce("MetaInformationUpdate",b)});a.send("RawDocContents?"+b)}};
w("WritelyUIInit",function(){var a=ys(),b=O("writely-logo"),c=Yd("img",{src:Cq("logourl"),alt:Cq("sitename"),title:Cq("sitename"),border:0});ce(c,b);nB=new Tj;nB.ja(O("editor-toolbar"));nB.ec(e);lB=new Tj;lB.ja(O("editor-menubar"));lB.ec(e);hB=Vg(O("writely-button-share"));V("enable_cosmo_sharing")&&(new ki("writely",undefined,hB.K())).hL([Eq("cosmo_id")]);iB=Vg(O("writely-button-save"));gB=Vg(O("writely-button-saveclose"));if(typeof offline!="undefined"){if(a!="view")O("writely-buttons").style.display=
"";if(a=="view"||a=="edit")lB.o(j);a=="edit"&&nB.o(j)}wB=new zf;publishUI=new Dw(e);V("enable_cosmo_sharing")||(shareUI=new Ew(userID,e));editUI=new CB;a!="view"&&a!="edit"&&wB.e(window,"load",Yz);xB=j});w("WritelyUIOnDocLoad",BB);function Cy(){this.bo=1;this.TM=4;this.ZA=32;this.jo=0.5;this.zt=0.5;this.yt=100;this.xt=1000;this.YM=4;function a(){var b=0,c=1,d=2;while(c!=d){b++;c=d;d=d<<1}return b}this.iB=a()}o=Cy.prototype;
o.Rg=function(a,b,c){if(a==b)return[[0,a]];if(typeof c=="undefined")c=j;var d=c,f=this.np(a,b),g=a.substring(0,f);a=a.substring(f);b=b.substring(f);f=this.nl(a,b);var i=a.substring(a.length-f);a=a.substring(0,a.length-f);b=b.substring(0,b.length-f);var l=this.VD(a,b,d);g&&l.unshift([0,g]);i&&l.push([0,i]);this.mp(l);return l};
o.VD=function(a,b,c){var d;if(!a)return[[1,b]];if(!b)return[[-1,a]];var f=a.length>b.length?a:b,g=a.length>b.length?b:a,i=f.indexOf(g);if(i!=-1){d=[[1,f.substring(0,i)],[0,g],[1,f.substring(i+g.length)]];if(a.length>b.length)d[0][0]=d[2][0]=-1;return d}var l=this.WD(a,b);if(l){var m=l[1],n=l[3],q=l[4],r=this.Rg(l[0],l[2],c),t=this.Rg(m,n,c);return r.concat([[0,q]],t)}if(c&&(a.length<100||b.length<100))c=e;var v;if(c){var x=this.XD(a,b);a=x[0];b=x[1];v=x[2]}d=this.YD(a,b);d||(d=[[-1,a],[1,b]]);if(c){this.SD(d,
v);this.TD(d);d.push([0,""]);var C=0,J=0,D=0,L="",ea="";while(C<d.length){switch(d[C][0]){case 1:D++;ea+=d[C][1];break;case -1:J++;L+=d[C][1];break;case 0:if(J>=1&&D>=1){var x=this.Rg(L,ea,e);d.splice(C-J-D,J+D);C=C-J-D;for(var va=x.length-1;va>=0;va--)d.splice(C,0,x[va]);C=C+x.length}D=0;J=0;L="";ea="";break}C++}d.pop()}return d};
o.XD=function(a,b){var c=[],d={};c[0]="";function f(l){var m="",n=0,q=-1,r=c.length;while(q<l.length-1){q=l.indexOf("\n",n);if(q==-1)q=l.length-1;var t=l.substring(n,q+1);n=q+1;if(d.hasOwnProperty?d.hasOwnProperty(t):d[t]!==undefined)m+=String.fromCharCode(d[t]);else{m+=String.fromCharCode(r);d[t]=r;c[r++]=t}}return m}var g=f(a),i=f(b);return[g,i,c]};o.SD=function(a,b){for(var c=0;c<a.length;c++){var d=a[c][1],f=[];for(var g=0;g<d.length;g++)f[g]=b[d.charCodeAt(g)];a[c][1]=f.join("")}};
o.YD=function(a,b){var c=(new Date).getTime()+this.bo*1000,d=a.length+b.length-1,f=this.ZA*2<d,g=[],i=[],l={},m={};l[1]=0;m[1]=0;var n,q,r,t={},v=e,x=!!t.hasOwnProperty,C=(a.length+b.length)%2;for(var J=0;J<d;J++){if(this.bo>0&&(new Date).getTime()>c)return h;g[J]={};for(var D=-J;D<=J;D+=2){n=D==-J||D!=J&&l[D-1]<l[D+1]?l[D+1]:l[D-1]+1;q=n-D;if(f){r=n+","+q;if(C&&(x?t.hasOwnProperty(r):t[r]!==undefined))v=j;C||(t[r]=J)}while(!v&&n<a.length&&q<b.length&&a.charAt(n)==b.charAt(q)){n++;q++;if(f){r=n+","+
q;if(C&&(x?t.hasOwnProperty(r):t[r]!==undefined))v=j;C||(t[r]=J)}}l[D]=n;g[J][n+","+q]=j;if(n==a.length&&q==b.length)return this.op(g,a,b);else if(v){i=i.slice(0,t[r]+1);var L=this.op(g,a.substring(0,n),b.substring(0,q));return L.concat(this.Uu(i,a.substring(n),b.substring(q)))}}if(f){i[J]={};for(var D=-J;D<=J;D+=2){n=D==-J||D!=J&&m[D-1]<m[D+1]?m[D+1]:m[D-1]+1;q=n-D;r=a.length-n+","+(b.length-q);if(!C&&(x?t.hasOwnProperty(r):t[r]!==undefined))v=j;if(C)t[r]=J;while(!v&&n<a.length&&q<b.length&&a.charAt(a.length-
n-1)==b.charAt(b.length-q-1)){n++;q++;r=a.length-n+","+(b.length-q);if(!C&&(x?t.hasOwnProperty(r):t[r]!==undefined))v=j;if(C)t[r]=J}m[D]=n;i[J][n+","+q]=j;if(v){g=g.slice(0,t[r]+1);var L=this.op(g,a.substring(0,a.length-n),b.substring(0,b.length-q));return L.concat(this.Uu(i,a.substring(a.length-n),b.substring(b.length-q)))}}}}return h};
o.op=function(a,b,c){var d=[],f=b.length,g=c.length,i=h;for(var l=a.length-2;l>=0;l--)while(1)if(a[l].hasOwnProperty?a[l].hasOwnProperty(f-1+","+g):a[l][f-1+","+g]!==undefined){f--;if(i===-1)d[0][1]=b.charAt(f)+d[0][1];else d.unshift([-1,b.charAt(f)]);i=-1;break}else if(a[l].hasOwnProperty?a[l].hasOwnProperty(f+","+(g-1)):a[l][f+","+(g-1)]!==undefined){g--;if(i===1)d[0][1]=c.charAt(g)+d[0][1];else d.unshift([1,c.charAt(g)]);i=1;break}else{f--;g--;if(i===0)d[0][1]=b.charAt(f)+d[0][1];else d.unshift([0,
b.charAt(f)]);i=0}return d};
o.Uu=function(a,b,c){var d=[],f=0,g=b.length,i=c.length,l=h;for(var m=a.length-2;m>=0;m--)while(1)if(a[m].hasOwnProperty?a[m].hasOwnProperty(g-1+","+i):a[m][g-1+","+i]!==undefined){g--;if(l===-1)d[f-1][1]+=b.charAt(b.length-g-1);else d[f++]=[-1,b.charAt(b.length-g-1)];l=-1;break}else if(a[m].hasOwnProperty?a[m].hasOwnProperty(g+","+(i-1)):a[m][g+","+(i-1)]!==undefined){i--;if(l===1)d[f-1][1]+=c.charAt(c.length-i-1);else d[f++]=[1,c.charAt(c.length-i-1)];l=1;break}else{g--;i--;if(l===0)d[f-1][1]+=
b.charAt(b.length-g-1);else d[f++]=[0,b.charAt(b.length-g-1)];l=0}return d};o.np=function(a,b){if(!a||!b||a.charCodeAt(0)!==b.charCodeAt(0))return 0;var c=0,d=Math.min(a.length,b.length),f=d,g=0;while(c<f){if(a.substring(g,f)==b.substring(g,f)){c=f;g=c}else d=f;f=Math.floor((d-c)/2+c)}return f};
o.nl=function(a,b){if(!a||!b||a.charCodeAt(a.length-1)!==b.charCodeAt(b.length-1))return 0;var c=0,d=Math.min(a.length,b.length),f=d,g=0;while(c<f){if(a.substring(a.length-f,a.length-g)==b.substring(b.length-f,b.length-g)){c=f;g=c}else d=f;f=Math.floor((d-c)/2+c)}return f};
o.WD=function(a,b){var c=a.length>b.length?a:b,d=a.length>b.length?b:a;if(c.length<10||d.length<1)return h;var f=this;function g(v,x,C){var J=v.substring(C,C+Math.floor(v.length/4)),D=-1,L="",ea,va,vb,mb;while((D=x.indexOf(J,D+1))!=-1){var gb=f.np(v.substring(C),x.substring(D)),de=f.nl(v.substring(0,C),x.substring(0,D));if(L.length<de+gb){L=x.substring(D-de,D)+x.substring(D,D+gb);ea=v.substring(0,C-de);va=v.substring(C+gb);vb=x.substring(0,D-de);mb=x.substring(D+gb)}}return L.length>=v.length/2?[ea,
va,vb,mb,L]:h}var i=g(c,d,Math.ceil(c.length/4)),l=g(c,d,Math.ceil(c.length/2)),m;if(!i&&!l)return h;else m=l?i?i[4].length>l[4].length?i:l:l:i;var n,q,r,t;if(a.length>b.length){n=m[0];q=m[1];r=m[2];t=m[3]}else{r=m[0];t=m[1];n=m[2];q=m[3]}return[n,q,r,t,m[4]]};
o.TD=function(a){var b=e,c=[],d=0,f=h,g=0,i=0,l=0;while(g<a.length){if(a[g][0]==0){c[d++]=g;i=l;l=0;f=a[g][1]}else{l+=a[g][1].length;if(f!==h&&f.length<=i&&f.length<=l){a.splice(c[d-1],0,[-1,f]);a[c[d-1]+1][0]=1;d--;d--;g=d>0?c[d-1]:-1;i=0;l=0;f=h;b=j}}g++}b&&this.mp(a);this.UD(a)};
o.UD=function(a){var b=/[^a-zA-Z0-9]/,c=/\s/,d=/[\r\n]/,f=/\n\r?\n$/,g=/^\r?\n\r?\n/;function i(L,ea){if(!L||!ea)return 5;var va=0;if(L.charAt(L.length-1).match(b)||ea.charAt(0).match(b)){va++;if(L.charAt(L.length-1).match(c)||ea.charAt(0).match(c)){va++;if(L.charAt(L.length-1).match(d)||ea.charAt(0).match(d)){va++;if(L.match(f)||ea.match(g))va++}}}return va}var l=1;while(l<a.length-1){if(a[l-1][0]==0&&a[l+1][0]==0){var m=a[l-1][1],n=a[l][1],q=a[l+1][1],r=this.nl(m,n);if(r){var t=n.substring(n.length-
r);m=m.substring(0,m.length-r);n=t+n.substring(0,n.length-r);q=t+q}var v=m,x=n,C=q,J=i(m,n)+i(n,q);while(n.charAt(0)===q.charAt(0)){m+=n.charAt(0);n=n.substring(1)+q.charAt(0);q=q.substring(1);var D=i(m,n)+i(n,q);if(D>=J){J=D;v=m;x=n;C=q}}if(a[l-1][1]!=v){if(v)a[l-1][1]=v;else{a.splice(l-1,1);l--}a[l][1]=x;if(C)a[l+1][1]=C;else{a.splice(l+1,1);l--}}}l++}};
o.mp=function(a){a.push([0,""]);var b=0,c=0,d=0,f="",g="",i;while(b<a.length)switch(a[b][0]){case 1:d++;g+=a[b][1];b++;break;case -1:c++;f+=a[b][1];b++;break;case 0:if(c!==0||d!==0){if(c!==0&&d!==0){i=this.np(g,f);if(i!==0){if(b-c-d>0&&a[b-c-d-1][0]==0)a[b-c-d-1][1]+=g.substring(0,i);else{a.splice(0,0,[0,g.substring(0,i)]);b++}g=g.substring(i);f=f.substring(i)}i=this.nl(g,f);if(i!==0){a[b][1]=g.substring(g.length-i)+a[b][1];g=g.substring(0,g.length-i);f=f.substring(0,f.length-i)}}if(c===0)a.splice(b-
c-d,c+d,[1,g]);else d===0?a.splice(b-c-d,c+d,[-1,f]):a.splice(b-c-d,c+d,[-1,f],[1,g]);b=b-c-d+(c?1:0)+(d?1:0)+1}else if(b!==0&&a[b-1][0]==0){a[b-1][1]+=a[b][1];a.splice(b,1)}else b++;d=0;c=0;f="";g="";break}a[a.length-1][1]===""&&a.pop();var l=e;b=1;while(b<a.length-1){if(a[b-1][0]==0&&a[b+1][0]==0)if(a[b][1].substring(a[b][1].length-a[b-1][1].length)==a[b-1][1]){a[b][1]=a[b-1][1]+a[b][1].substring(0,a[b][1].length-a[b-1][1].length);a[b+1][1]=a[b-1][1]+a[b+1][1];a.splice(b-1,1);l=j}else if(a[b][1].substring(0,
a[b+1][1].length)==a[b+1][1]){a[b-1][1]+=a[b+1][1];a[b][1]=a[b][1].substring(a[b+1][1].length)+a[b+1][1];a.splice(b+1,1);l=j}b++}l&&this.mp(a)};o.Vu=function(a,b){var c=0,d=0,f=0,g=0,i;for(i=0;i<a.length;i++){if(a[i][0]!==1)c+=a[i][1].length;if(a[i][0]!==-1)d+=a[i][1].length;if(c>b)break;f=c;g=d}if(a.length!=i&&a[i][0]===-1)return g;return g+(b-f)};
o.ZD=function(a){var b=[];for(var c=0;c<a.length;c++)switch(a[c][0]){case 1:b[c]="+"+encodeURI(a[c][1]);break;case -1:b[c]="-"+a[c][1].length;break;case 0:b[c]="="+a[c][1].length;break}return b.join("\t").replace(/\0/g,"%00").replace(/%20/g," ")};o.ey=function(a,b,c){c=Math.max(0,Math.min(c,a.length-b.length));return a==b?0:a.length===0?h:a.substring(c,c+b.length)==b?c:this.NI(a,b,c)};
o.NI=function(a,b,c){if(b.length>this.iB)k(new Error("Pattern too long for this browser."));var d=this.MI(b),f=a.length;f=Math.max(f,this.yt);f=Math.min(f,this.xt);var g=this;function i(va,vb){var mb=Math.abs(c-vb);return va/b.length/g.jo+mb/f/(1-g.jo)}var l=this.zt,m=a.indexOf(b,c);if(m!=-1)l=Math.min(i(0,m),l);m=a.lastIndexOf(b,c+b.length);if(m!=-1)l=Math.min(i(0,m),l);var n=1<<b.length-1;m=h;var q,r,t=Math.max(c+c,a.length),v;for(var x=0;x<b.length;x++){var C=Array(a.length);q=c;r=t;while(q<r){if(i(x,
r)<l)q=r;else t=r;r=Math.floor((t-q)/2+q)}t=r;var J=Math.max(0,c-(r-c)-1),D=Math.min(a.length-1,b.length+r);C[D]=a.charAt(D)==b.charAt(b.length-1)?(1<<x+1)-1:(1<<x)-1;for(var L=D-1;L>=J;L--){C[L]=x===0?(C[L+1]<<1|1)&d[a.charAt(L)]:(C[L+1]<<1|1)&d[a.charAt(L)]|v[L+1]<<1|1|v[L]<<1|1|v[L+1];if(C[L]&n){var ea=i(x,L);if(ea<=l){l=ea;m=L;if(L>c)J=Math.max(0,c-(L-c));else break}}}if(i(x+1,c)>l)break;v=C}return m};
o.MI=function(a){var b={};for(var c=0;c<a.length;c++)b[a.charAt(c)]=0;for(var c=0;c<a.length;c++)b[a.charAt(c)]|=1<<a.length-c-1;return b};var Nt=function(){};o=Nt.prototype;o.Qn=e;o.m=h;o.q=h;o.v=h;o.F=h;o.Pd=h;o.ik=h;o.Fp=h;o.kk="";o.Cn="";o.xl="";o.Gp="";o.xm=function(){return this.Qn};o.Q=function(){return this.m};o.ha=function(){return this.q};o.ta=function(){return this.v};o.Fa=function(){return this.F};
o.toString=function(){if(this.Qn){var a;try{a=this.m.nodeType==3?'"'+this.m.data+'"':this.m.tagName}catch(b){a="["+b+"]"}if(this.Pd)return"Cursor Object\n  startNode_: "+a+"\n  startOffset_: "+this.v+"\n  startPercent_: "+this.ik+'\n  startPrefix_: "'+this.kk+'"\n  startSuffix_: "'+this.Cn+'"';else{var c;try{c=this.q.nodeType==3?'"'+this.q.data+'"':this.q.tagName}catch(b){c="["+b+"]"}return"Cursor Object\n  startNode_: "+a+"\n  endNode_: "+c+"\n  startOffset_: "+this.v+"\n  endOffset_: "+this.F+"\n  startPercent_: "+
this.ik+"\n  endPercent_: "+this.Fp+'\n  startPrefix_: "'+this.kk+'"\n  startSuffix_: "'+this.Cn+'"\n  endPrefix_: "'+this.xl+'"\n  endSuffix_: "'+this.Gp+'"'}}else return"Invalid Cursor Object"};o.pn=function(a){this.Bp=a;if(a)if(!("nodeType"in a)&&a.document)a=a.document;else while(a.parentNode)a=a.parentNode;else rce("Error: cursor.setEditor called with: "+a);this.Ug=a};
o.capture=function(){var a=DB(this.Ug);if(a)if("getRangeAt"in a)this.DJ(a);else"createRange"in a&&this.CJ(a);else return;if(!this.m||!this.q)return;var b=this.m;while(b.parentNode)b=b.parentNode;if(b!==this.Ug)return;this.Pd=this.m==this.q&&this.v==this.F;this.oo(j);this.Pd||this.oo(e);this.Qn=j};o.RC=function(a){this.m=a;this.q=a;this.v=0;this.F=0;this.Pd=j;this.oo(j);this.Qn=j};
o.DJ=function(a){if(a.rangeCount!=0){var b=a.getRangeAt(a.rangeCount-1);this.m=b.startContainer;this.v=b.startOffset;this.q=b.endContainer;this.F=b.endOffset}};
o.CJ=function(a){var b=a.createRange();if(b.length){var c=b(0);this.m=c;this.v=0;this.q=c;this.F=0;return}var d=b.parentElement();while(d.parentNode)d=d.parentNode;var f=a.createRange().duplicate(),g=f.duplicate();g.collapse(j);var i=this.zA(d,g),l;if(g.isEqual(f))l=i;else{var m=f.duplicate();m.collapse(e);l=this.zA(d,m)}this.m=i.M;this.v=i.Ye;this.q=l.M;this.F=l.Ye};
o.zA=function(a,b){var c=b.parentElement(),d=a.body.createTextRange();d.moveToElementText(c);var f,g=a.body.createTextRange(),i=d.duplicate(),l=h,m=[];for(var n=0;n<c.childNodes.length;n++){f=c.childNodes[n];if(f.nodeType==3)m.push(f);else if(f.nodeType==1){g.moveToElementText(f);i.setEndPoint("EndToStart",g);if(i.inRange(b))break;l=f;m=[]}}if(m.length){i.setEndPoint("EndToStart",b);if(l){g.moveToElementText(l);i.setEndPoint("StartToEnd",g)}else i.setEndPoint("StartToStart",d);var q=i.text.length;
for(var r=0;r<m.length;r++){var t=m[r].data;if(t.length>=q)break;q-=t.length}return{M:m[r],Ye:q}}l=c;return{M:l,Ye:0}};
o.oo=function(a){var b=0,c="",d="",f=this.Ug,g=f.body,i=this.Bp;if(!("nodeType"in i)&&i.document)i=i.document;if(i.nodeType==9)i=i.body;if(f.createRange){var l=f.createRange();l.setStartBefore(i);a?l.setEnd(this.m,this.v):l.setEnd(this.q,this.F);c=l.toString();a?l.setStart(this.m,this.v):l.setStart(this.q,this.F);l.setEndAfter(i);d=l.toString()}else if(g.createTextRange){var m=g.createTextRange();m.moveToElementText(g);var n=this.bp(a),q=n.duplicate();n.setEndPoint("StartToStart",m);c=n.text;q.setEndPoint("EndToEnd",
m);d=q.text}else rce("Cursor called with Unsupported browser: "+navigator.userAgent);if(c.length+d.length!=0)b=c.length/(c.length+d.length);var r,t,v=a?this.m:this.q,x=v;c="";d="";if(v.nodeType==3){c=v.data.substring(0,a?this.v:this.F);d=v.data.substring(a?this.v:this.F)}else if(v.nodeType==1&&this.v!=0)if(v.childNodes.length>this.v){v=v.childNodes[this.v];x=EB(v)[0]}else{while(v.lastChild)v=v.lastChild;x=v}while(v&&c.length<16){r=EB(v);v=r[0];if(!v)break;t=r[1];c=t+c;if(v.nodeType==3)c=v.data+c;
else try{c=v.tagName.charAt(0)+c}catch(C){rce("Cursor addContextInfo_ failed","invalid prefixNode, type = "+v.nodeType+" name = "+v.nodeName)}}while(x&&d.length<16){r=FB(x);x=r[0];if(!x)break;t=r[1];d=d+t;if(x.nodeType==3)d=d+x.data;else try{d=d+x.tagName.charAt(0)}catch(C){rce("Cursor addContextInfo_ failed","invalid suffixNode, type = "+x.nodeType+" name = "+x.nodeName)}}c=c.substring(c.length-16);d=d.substring(0,16);if(a){this.ik=b;this.kk=c;this.Cn=d}else{this.Fp=b;this.xl=c;this.Gp=d}};
o.bp=function(a){var b,c,d=this.Ug.body.createTextRange(),f,g;if(a){f=this.m;g=this.v}else{f=this.q;g=this.F}if(f.nodeType==1){b=f.childNodes;if(g>=b.length){d.moveToElementText(f);d.collapse(e)}else if(g<=0){d.moveToElementText(f);d.collapse(j)}else if(b[g].nodeType==1){d.moveToElementText(b[g]);d.collapse(j)}else if(b[g-1].nodeType==1){d.moveToElementText(b[g-1]);d.collapse(e)}else{d.moveToElementText(f);d.collapse(a)}}else{while(f.nodeType!=1){c=EB(f);f=c[0];if(f.data)g+=f.data.length}d.moveToElementText(f);
f.hasChildNodes()?d.collapse(j):d.collapse(e);d.moveStart("character",g)}return d};
o.restore=function(){if(!this.xm())return;var a=this.Ug,b=a.body,c=this.HF();if(!c)return;var d=c.FD;if(c.GD!==h||d!==h)if(b.createTextRange){var f=this.bp(j),g;g=this.Pd?f:this.bp(e);var i=b.createTextRange();i.setEndPoint("StartToStart",f);i.setEndPoint("EndToStart",g);i.select()}else if(a.createRange){if("product"in navigator&&navigator.product=="Gecko"&&!("contentEditable"in window.document.body))if(!this.m.hasChildNodes()&&this.v==0&&this.m===this.q){if(this.m.previousSibling){this.m=this.m.previousSibling;
if(this.m.nodeType==3)this.v=this.m.data.length;else if(this.m.nodeType==1)this.v=this.m.childNodes.length}else this.m=this.m.parentNode;this.q=this.m;this.F=this.v}var i=a.createRange();i.setStart(this.m,this.v);i.setEnd(this.q,this.F);var l=DB(a);if(l){l.removeAllRanges();l.addRange(i)}}else rce("Unsupported browser","Neither IE nor W3")};
o.HF=function(){var a=this.Ug.body,b=new Cy;b.jo=0.4;b.zt=0.9;b.yt=1000;b.xt=10000;var c=GB(a);if(c==h)return h;var d,f=this.kk+this.Cn,g=b.ey(c,f,Math.round(Math.max(0,Math.min(c.length,this.ik*c.length-16))));if(g!==h){var i=c.substring(g,g+f.length),l=b.Rg(f,i,e);g+=b.Vu(l,this.kk.length);d=HB(a,g);this.m=d[0];this.v=d[1]}var m=h;if(!this.Pd){f=this.xl+this.Gp;m=b.ey(c,f,Math.round(Math.max(0,Math.min(c.length,this.Fp*c.length-16))));if(m!==h){var i=c.substring(m,m+f.length),l=b.Rg(f,i,e);m+=b.Vu(l,
this.xl.length);d=HB(a,m);this.q=d[0];this.F=d[1]}}if(g!==h&&m===h){this.Pd=j;this.q=this.m;this.F=this.v}else if(g===h&&m!==h){this.Pd=j;this.m=this.q;this.v=this.F}else if(g===h&&m===h){d=HB(a,Math.round(this.ik*c.length));this.m=d[0];this.v=d[1];this.Pd=j;this.q=this.m;this.F=this.v}return{GD:g,FD:m}};
var IB="goog_docs_charIndex",DB=function(a){if(a&&a.defaultView&&"getSelection"in a.defaultView)return a.defaultView.getSelection();if(a&&"selection"in a)return a.selection;return h},EB=function(a){if(a.tagName=="BODY")return[h,""];if(a.previousSibling){var b="";a=a.previousSibling;while(a.hasChildNodes()){try{b=a.tagName.charAt(0)+b}catch(c){rce("Cursor walkUp_ failed","invalid node, type = "+a.nodeType+" name = "+a.nodeName)}a=a.lastChild}return[a,b.toLowerCase()]}if(a.parentNode)return[a.parentNode,
""];return[h,""]},FB=function(a){if(a.hasChildNodes())return[a.firstChild,""];else if(a.nextSibling)return[a.nextSibling,""];var b="";while(a&&a.tagName!="BODY"){if(a.nextSibling)return[a.nextSibling,b.toLowerCase()];a=a.parentNode;try{b=b+a.tagName.charAt(0)}catch(c){rce("Cursor walkDown_ failed","invalid node, type = "+a.nodeType+" name = "+a.nodeName)}}return[h,b.toLowerCase()]},GB=function(a){var b=new Oe;try{b.Y(a.tagName.charAt(0))}catch(c){rce("Cursor mapDom_ failed","invalid node, type = "+
a.nodeType+" name = "+a.nodeName)}var d=1,f=a.firstChild||a,g=e,i=[a],l=1;while(f!=a){if(g)try{b.Y(f.tagName.charAt(0).toLowerCase());d++}catch(c){rce("Cursor mapDom_ backtrack failed","invalid node, type = "+f.nodeType+" name = "+f.nodeName)}else if(f.nodeType==3){b.Y(f.data);d+=f.data.length}else{f[IB]=d;try{b.Y(f.tagName.charAt(0));d++}catch(c){rce("Cursor walkUp_ non-backtrack failed","invalid node, type = "+f.nodeType+" name = "+f.nodeName)}}if(!g&&f.firstChild){if(B)i[l++]=f;f=f.firstChild}else if(f.nextSibling){f=
f.nextSibling;g=e}else{if(B&&i[--l]!==f.parentNode){var m=JB(a);a.replaceNode(m);if(V("enable_comments")||V("enable_footnotes"))Lv();return h}f=f.parentNode;g=j}}a[IB]=0;b.Y(a.tagName.charAt(0).toLowerCase());d++;return b.toString()},JB=function(a){var b=a.cloneNode(e);while(a.hasChildNodes()){var c=a.removeChild(a.firstChild);if(c){var d=JB(c);d&&b.appendChild(d)}}return b},KB=function(a){var b=j,c=0,d;while(a){if(IB in a)return a[IB]+c;if(b)b=e;else if(a.data)c+=a.data.length;d=EB(a);a=d[0];c+=
d[1].length;a.nodeType!=3&&c++}return 0},LB=function(a,b){var c=KB(a);if(c==b)return a;else if(a.nodeType==3)return c+a.data.length>b?a:c+a.data.length-1;else if(!a.hasChildNodes())return c;var d;for(var f=0;f<a.childNodes.length-1;f++){d=KB(a.childNodes[f+1]);if(d-1==b)return a.childNodes[f];else if(d>b)return LB(a.childNodes[f],b)}var g=LB(a.lastChild,b);return typeof g=="object"?g:g+1==b?a:g+1},HB=function(a,b){var c=LB(a,b);if(typeof c=="number")return[a,a.childNodes.length];var d;if(c.nodeType==
3){d=b-KB(c);if(d>=c.data.length)d=c.data.length-1}else d=!c.hasChildNodes()||KB(c)>=b?0:c.childNodes.length;return[c,d]},Sy=function(a,b){if(!V("enable_cursor_jump_alerts"))return;O("cursorJumpTxt").innerHTML=a+(b?b:"")};var CB=function(){this.Ci=Cq("highlightcolor");if(this.Ci<0)this.Ci=0;this.w=h;this.Yb=h;this.B=h;this.Xc=h;this.Wr=h;this.Xr=h};CB.prototype.xr=e;CB.prototype.Hl=e;CB.prototype.bL=function(a){if(!!a!=this.Hl){this.Hl=!!a;this.DM()}};CB.prototype.DM=function(){this.w&&this.w.updateStatus(this.xr,this.Hl);this.B&&this.B.updateStatus(this.xr,this.Hl);this.Xc&&this.Xc.u(!this.xr)};y(CB.prototype,"defaultCommentColor",CB.prototype.Ci);var NB=function(a){var b=new Oe;b.Y("&notifyUrl=",MB("notifyurl"));b.Y("&rev=",a);b.Y("&brev=",encodeURIComponent(uq()),":",MB("beginrev"));b.Y("&erev=",encodeURIComponent(uq()),":",MB("endrev"));b.Y("&inc=true");hu("revbrowse",b.toString())},OB=function(a,b,c,d){var f=new Oe;f.Y("&brev=",encodeURIComponent(uq()),":",MB("beginrev"));f.Y("&erev=",encodeURIComponent(uq()),":",MB("beginrev"));f.Y("&inc=",d?"true":"false");a!="none"&&f.Y("&frev=",a);b!="none"&&f.Y("&trev=",b);hu("revcomp",f.toString())},
PB=function(a){var b=document.body.getElementsByTagName("input");if(b)for(var c=0,d;d=b[c];c++)d.name.indexOf("list_cb")==0&&a(d)},QB=function(){var a=0;PB(function(b){b.checked&&a++});return a},RB=function(){var a=[];PB(function(b){b.checked&&a.push(b.value)});return a},SB=function(a){if(QB()!=2)U(a);else{var b=RB();OB(b[0],b[1],"revcomp",j)}},TB=function(a,b){if(zq(b)){var c=uq();iq("promoterevision",{docid:c,revision:a},function(){window.location.href=sr(c,"","","","")})}},UB=function(a,b){if(zq(b)){ps();
iq("publish_selective",{msg:"_none",cc:e,docid:uq(),revision:a},us)}},MB=function(a){return O("revisions_"+a).value};w("writely.Revisions",function(){});w("writely.Revisions.showRevision",NB);w("writely.Revisions.compareSelected",SB);w("writely.Revisions.makeCurrent",TB);w("writely.Revisions.publish",UB);var VB=function(){},sB=new VB;function pB(a){Y=O("wys_textarea");Qr=a.postbackDocPage;ex=a.passedDocIsShared;Tx=e;Qs=a.docTitle;Vr(!!a.passedBaseRev,"Missing Rev ID in LoadHTMLEdit");Ux=a.passedBaseRev;hq(new Xh(Qr),{docID:docID,footerWithRevision:j,revision:"_latest"},WB,"loadHTML_"+docID)}VB.prototype.mo=function(){};function XB(){}
function YB(a){if(a.keyCode==37||a.keyCode==39||a.keyCode==38||a.keyCode==40)return j;var b=String.fromCharCode(a.which||a.charCode||a.keyCode).toLowerCase();if(a&&a.ctrlKey){if(b=="s"){Fx(h);Rr(a);return}return}St();return j}
function WB(a,b){try{if(a==h||b)return;var c=a.responseText.split("***endRevision21312***");c.length!=2&&rce("LoadHTMLDocContentsCallback, split count is: "+c.length);var d=c[0],f=c[1];Vr(!!f,"LoadHTMLDocContentsCallback: empty revision ID returned from server");ZB(Y,d);Ux=f;if(B){Y.attachEvent("onkeydown",YB);Y.attachEvent("onclick",XB)}else{Y.addEventListener("keypress",YB,j);Y.addEventListener("click",XB,j)}aA=j}catch(g){Tr("Exception in LoadHTMLDocContentsCallback",g)}ix()}VB.prototype.Ck=function(){return e};
function ZB(a,b){a.value=tB(b);oy();a.focus();ix();$x=j}VB.prototype.Kd=function(){var a=Y?Y.value:h;if(typeof a!="string")k(Error("can not get document contents: WYSEditor = "+Y));return tB(a)};function tB(a){try{a=a.replace(/^\s+?( *\S)/,"$1");a=a.replace(/\s+$/,"");a+="\n";var b=new Ci;a=b.Il(a,4500)}catch(c){rce("error pretty printing for edit HTML",c)}return a};var kB=function(a){this.B=a;this.B.u(j);this.B.o(j);if(E){this.B.ec(j);Jg(this.B.b(),"menubar");var b=this.B.Qa();this.iy=this.B.xb();this.iy.e(b,kd,function(){Od(this.b(),"writely-menubar-focused",j)});this.iy.e(b,"blur",function(){Od(this.b(),"writely-menubar-focused",e)})}this.Sn=e;var c=this.B.j("tools-menu").K();this.gM=c.j("m-revisions");this.Sr=c.j("m-respell");this.Ks=c.j("m-spell");this.iE=c.j("m-donespell");this.Ls=c.j("m-spell-lang");var d=this.Ls.K(),f=Eq("doclangcode"),g=d.j("m-lang-"+
f);g&&g.Za(j);this.Sr.o(e);c=this.B.j("view-menu").K();this.El=c.j("m-fixedwidth-page");this.Mm=c.j("m-normal-page");this.wd=e;this.Tp=c.j("m-fullscreen");if(V("enable_comments")){this.lA=c.j("m-show-comments");this.gf=e}if(V("enable_footnotes")){this.Js=c.j("m-show-footnotes");this.hf=j}this.Gi=this.B.j("edit-menu").K();this.hE=this.Gi.j("m-docstyles");this.jv=this.Gi.j("m-editcss");this.jv.o(V("enable_css_editing"));this.mM=this.Gi.j("m-+undo");this.XJ=this.Gi.j("m-+redo");this.Wy=this.Gi.j("m-pastehtmlsnippet");
c=this.B.j("file-menu").K();this.vK=c.j("m-revisions");this.OJ=c.j("m-print");this.bz=c.j("m-printsetting");if(V("enable_printpreview"))this.PJ=c.j("m-printpreview");this.jE=c.j("m-download");this.UI=c.j("m-new");this.pD=c.j("m-copydoc");this.PD=c.j("m-delete");this.iv=c.j("m-edit");this.iv.o(e);this.rm=this.B.j("insert-menu").K();this.BI=this.rm.j("m-link");this.FJ=this.rm.j("m-picture");this.fD=this.rm.j("m-comment");this.wH=this.B.j("help-menu").K();this.UL=this.B.j("table-menu").K();this.Lv=this.B.j("format-menu").K();
this.sg=this.Lv.j("m-textStyle").K();this.AJ=this.sg.j("m-P");this.vH=this.sg.j("m-H6");this.uH=this.sg.j("m-H5");this.tH=this.sg.j("m-H4");this.sH=this.sg.j("m-H3");this.rH=this.sg.j("m-H2");this.qH=this.sg.j("m-H1");this.uC=this.Lv.j("m-w-BLOCKQUOTE");this.C=new zf(this);this.C.e(this.B,vg,this.gj);if(V("enable_britannica")){var i=Cq("language"),l=this.B.j("tools-menu").K();if(i=="en"||i=="en_US"){this.du=l.j("m-britannica").K();this.C.e(this.du,"show",$B)}this.Fz=l.j("m-google-search").K();this.C.e(this.Fz,
"show",$B)}this.sM()};kB.prototype.C=h;kB.prototype.B=h;
kB.prototype.gj=function(a){var b=a.target.Gb();if(b.substring(0,2)=="m-")b=b.substring(2);switch(b){case "newdoc":case "newpres":case "newtrix":case "newtemp":lr(b);break;case "copydoc":window.WritelyCopyStart=(new Date).getTime();this.Sn?Ms(docID,e):Fx(function(){Ms(docID,j)});break;case "save":Fx(h);break;case "revisions":hu("revlist");break;case "requestaccess":break;case "edit":hu("edit");break;case "rename":Ps();break;case "delete":Fx(function(){Zs()});break;case "pdf":case "rtf":case "txt":case "oo":case "doc":Ts(b);
break;case "html":Us();break;case "printsetting":Xs();break;case "printpreview":hu("printpreview");break;case "print":mr();break;case "printhtml":nr("&hgd=1&spi=1",j);break;case "preview":nr("&hgd=1",j);break;case S.Cg:case S.Ag:case "w-Cut":case "w-Copy":case Yy:fq.execute(b);break;case "pastehtmlsnippet":zz();break;case Xy:fq.execute(b);break;case "findreplace":Hx();break;case "htmledit":V("enable_edit_html_dialog")?or(function(){fq.openDialog(wd.Bk)}):hu("htmledit");break;case "show-comments":this.gf=
!this.gf;this.gf?Fv().ul("comment"):Fv().Wu("comment");this.lA.Za(this.gf);break;case "show-footnotes":this.hf=!this.hf;this.hf?Fv().ul("footnote"):Fv().Wu("footnote");this.Js.Za(this.hf);break;case "fixedwidth-page":if(this.wd==j)this.El.Za(j);else{this.wd=j;var c=new tc;c.h("docid",docID);c.h("fullWidthEditor",e);c.h("makeDefault",j);iq("set_full_width_editor",c,this.qu.bind(this))}break;case "normal-page":if(this.wd==e)this.Mm.Za(j);else{this.wd=e;var c=new tc;c.h("docid",docID);c.h("fullWidthEditor",
j);c.h("makeDefault",j);iq("set_full_width_editor",c,this.qu.bind(this))}break;case "fullscreen":vB(j);break;case "picture":wx(j);break;case "link":sx(mz());break;case "table":nx(j);break;case "comment":if(V("enable_comments")){var d=new eq.bl.Et;(Ov||(Ov=new Nv)).qo(d)}else Nx();break;case "footnote":var f=new jw;(Ov||(Ov=new Nv)).qo(f,j);Fv().ul("footnote");this.hf=j;this.Js.Za(j);break;case "specialchars":mx("wys_frame","insertchar");break;case S.ho:fq.execute(b);break;case "pagebreak":Nz();break;
case "header":Lz("header");break;case "footer":Lz("footer");break;case "toc":es("TocSettings");break;case "bookmark":ux();break;case "htmlsnippet":vx();break;case "P":case "H1":case "H2":case "H3":case "H4":case "H5":case "H6":fq.execute(S.ci,b);break;case "docstyles":Ws();break;case "editcss":V("enable_css_editing")&&or(function(){es("CSSEdit")});break;case S.ii:case S.gi:case S.di:case S.fi:case S.ei:case S.lo:case S.Ek:case S.Dk:fq.execute(b);break;case Zy:JA();break;case S.ai:case S.Ak:fq.execute(b);
break;case "respell":case "spell":uA(j);break;case "donespell":uA(e);break;case "wcount":Vs();break;case "dictionary":case "thesaurus":case "encyclopedia":var g=Cq("language");if(V("enable_britannica")&&(g=="en"||g=="en_US"))aC(b);break;case "websearch":case "imagesearch":V("enable_britannica")&&aC(b);break;case "mod-table":nx(e);break;case "mod-row":qx();break;case "mod-column":px();break;case "mod-cell":ox();break;case "mv-row-up":sz(j);break;case "mv-row-down":sz(e);break;case "insert-row-up":tz(j);
break;case "insert-row-down":tz(e);break;case "insert-col-left":uz(j);break;case "insert-col-right":uz(e);break;case "del-table":vz();break;case "del-row":wz();break;case "del-col":xz();break;case "help":window.open(Cq("helpurl"));break;case "help-group":window.open(bC);break;case "help-video":window.open(cC);break;case "help-shortcuts":window.open(dC);break;default:if(b.indexOf("lang-")==0){var i=b.substring(5),l="m-lang-"+Eq("doclangcode"),m=this.Ls.K().j(l);m&&m.Za(e);X("doclangcode",i);iq("setdoclang",
{docid:docID,code:i})}}};kB.prototype.blur=function(){this.B.Dc(h)};var eC=["m-mod-table","m-mod-row","m-mod-column","m-mod-cell","m-mv-row-up","m-mv-row-down","m-insert-row-up","m-insert-row-down","m-insert-col-left","m-insert-col-right","m-del-table","m-del-row","m-del-col"],dC="http://docs.google.com/support/bin/answer.py?answer=66280&hl="+Cq("language"),bC="http://www.google.com/support/forum/p/Google+Docs?hl="+Cq("language"),cC="http://www.youtube.com/watch?v=eRqUE6IHTEA&hl="+Cq("language");
o=kB.prototype;o.ma=function(a,b){if(!this.B.J())return;var c;switch(a){case "P":case "H1":case "H2":case "H3":case "H4":case "H5":case "H6":c=this.B.j("format-menu").K();c.j("m-textStyle").K().j("m-"+a).Za(b);break;case "table":c=this.B.j("table-menu").K();for(var d=0,f;f=eC[d];d++)c.j(f).u(b);break}};o.CM=function(a){this.iE.u(a);this.Ks.o(!a);this.Sr.o(a)};
o.updateStatus=function(a,b){this.Ks.u(!a&&!b);this.Sr.u(!a&&!b);this.Ls.u(!a&&!b);var c=this.B.j("tools-menu").K();if(V("enable_britannica")){var d=Cq("language"),f=d=="en"||d=="en_US"?c.j("m-britannica").K():h;fC(f,c.j("m-google-search").K(),!a)}this.hE.u(!a);V("enable_css_editing")&&this.jv.u(!a);this.vK.u(!a);this.gM.u(!a);this.OJ.u(!a);this.bz.u(!a);V("enable_printpreview")&&this.PJ.u(!a);this.jE.u(!a);this.UI.u(!a);this.pD.u(!a);this.PD.u(!a);this.FJ.u(!a);this.Mm.u(!a);this.El.u(!a);this.wH.u(!a);
this.UL.u(!b);this.uC.u(!b);this.rm.u(!b);this.mM.u(!b);this.XJ.u(!b);this.Wy&&this.Wy.u(!b)};o.qh=function(a){var b=j;switch(a){case kz:b=this.Ks.J();break;case "w-link":b=this.BI.J();break;case $y:b=this.fD.J();break;case "P":b=this.AJ.J();break;case "H1":b=this.qH.J();break;case "H2":b=this.rH.J();break;case "H3":b=this.sH.J();break;case "H4":b=this.tH.J();break;case "H5":b=this.uH.J();break;case "H6":b=this.vH.J();break}return b};
o.xH=function(){var a=this.B.j("edit-menu");a.o(e);a=this.B.j("insert-menu");a.o(e);a=this.B.j("format-menu");a.o(e);a=this.B.j("tools-menu");a.o(e);a=this.B.j("table-menu");a.o(e);a=this.B.j("file-menu").K();a.j("m-save").o(e);a.j("m-rename").o(e);a.j("m-revisions").o(e);a.j("m-delete").o(e);W("canedit")&&this.iv.o(j);this.Tp&&this.Tp.o(e);this.Sn=j};
o.qu=function(a){this.Mm.Za(!this.wd);this.El.Za(this.wd);if(a.responseText){var b=a.responseText.replace("while(true);","");if(b.replace(/\s/g,"")!=""){b=ej(b);b.stylesheet&&X("stylesheet",b.stylesheet);b.styles&&X("styles",b.styles)}}X("fullwidtheditor",!this.wd);if(this.Sn)IS_GEARS?offline.wM("view",undefined,undefined,j,undefined,j):au();else Fx(function(){au()});if(V("enable_footnotes")||V("enable_comments")){mw();this.Sn&&window.setTimeout(Lv,0)}};
o.sM=function(){this.wd=!W("fullwidtheditor");this.Mm.Za(!this.wd);this.El.Za(this.wd);if(V("enable_comments")){this.gf=W("show_comments");this.lA.Za(this.gf);this.gf=this.gf}if(V("enable_footnotes")){this.hf=j;this.Js.Za(this.hf);this.hf&&Fv().ul("footnote")}this.bz.u(W("canedit"))};var mB=function(a){this.w=a;this.w.u(j);this.w.o(j);if(E){this.w.ec(j);Jg(this.w.b(),"menubar");var b=this.w.Qa();this.pk=this.w.xb();this.pk.e(b,kd,function(){Od(this.b(),"writely-toolbar-focused",j)});this.pk.e(b,"blur",function(){Od(this.b(),"writely-toolbar-focused",e)})}this.QH(this.w.j(ez));this.Rp={};this.NH(this.w.j(gz));this.OH(this.w.j(iz));this.C=new zf(this);this.C.e(this.w,vg,this.gj);this.C.e(this.w.j(ez),vg,this.QG)},gC={8:1,10:2,12:3,14:4,18:5,24:6,36:7},hC={1:"8.0",2:"10.0",3:"12.0",
4:"14.0",5:"18.0",6:"24.0",7:"36.0"};mB.prototype.C=h;mB.prototype.w=h;o=mB.prototype;o.Rp=h;
o.ma=function(a,b){if(!this.w.J())return;var c=this.w.j(a);if(!c)return;switch(a){case gz:if(b){b=b.split(",")[0].toLowerCase();c.va(b)}else c.va("");break;case ez:b?c.va(b):c.va("");iC(c,b);break;case iz:if(b){if(b.indexOf("px")!=-1){b=parseInt(b,10);b=b*0.75;b=gC[Math.round(b)]}else if(b.indexOf("pt")!=-1){b=parseInt(b,10);b=gC[b]}else{b=parseInt(b,10);b=Math.min(b,7);b=Math.max(b,1)}c.va(b)}else c.va("");break;case S.zk:case S.bi:if(b=="transparent")b="#ffffff";c.va(b);break;case S.ai:var d=!!b;
Od(this.w.b(),"goog-edit-rtl-mode",d);c.Za(d);break;default:c.Za(!!b);break}};o.updateStatus=function(a,b){this.w.j(kz).u(!b&&!a);this.w.j(S.Cg).u(!b);this.w.j(S.Ag).u(!b);this.w.j(S.ki).u(!b);this.w.j(S.hi).u(!b);this.w.j("w-link").u(!b);this.w.j(S.ko).u(!b);this.w.j(S.io).u(!b)};o.qh=function(a){var b=this.w.j(a);if(b)return b.J();return j};
o.gj=function(a){var b=a.target.Gb(),c=a.target.Ra();switch(b){case ez:c=="removeFormat"?fq.execute(S.ii,c):fq.execute(S.ci,c);break;case iz:this.WB(c);break;case gz:var d=this.Rp[c];d&&this.XB(d);break;case kz:var f=a.target.je();uA(f);break;case S.xg:case S.zg:case S.Bg:fq.execute(b,a.target.je());break;default:fq.execute(b,c);break}};
o.QH=function(a){var b={P:"\u6b63\u5e38\u6bb5\u843d\u6587\u672c",H1:"\u6807\u9898 1\uff08\u6700\u5927\uff09",H2:"\u6807\u9898 2",H3:"\u6807\u9898 3",H4:"\u6807\u9898 4",H5:"\u6807\u9898 5",H6:"\u6807\u9898 6\uff08\u6700\u5c0f\uff09"},c={P:"Ctrl+0",H1:"Ctrl+1",H2:"Ctrl+2",H3:"Ctrl+3",H4:"Ctrl+4",H5:"Ctrl+5",H6:"Ctrl+6"};if(a){var d=new Mj([a.g.f("div",{"class":"writely-menubar-shortcut"},"Ctrl+Space"),a.g.f("div",{"class":"writely-toolbar-menu-icon goog-edit-removeFormat"}),a.g.f("div",{"class":"writely-toolbar-menu-item"},
"Clear Formatting")],"removeFormat",a.g);a.Z(d);a.Z(new th);for(var f in b){var g=f,d=new Mj([a.g.f("div",{"class":"writely-menubar-shortcut"},c[f]),a.g.f("div",{"class":"writely-toolbar-menu-item"},b[f])],g,a.g);d.Oh(g);a.Z(d)}}};o.QG=function(a){var b=a.currentTarget.Ra();iC(a.currentTarget,b)};
function iC(a,b){if(b)switch(b){case "H1":a.Rb("\u6807\u9898 1");break;case "H2":a.Rb("\u6807\u9898 2");break;case "H3":a.Rb("\u6807\u9898 3");break;case "H4":a.Rb("\u6807\u9898 4");break;case "H5":a.Rb("\u6807\u9898 5");break;case "H6":a.Rb("\u6807\u9898 6");break;case "P":a.Rb("\u6b63\u5e38");break;case "removeFormat":a.Rb("\u6837\u5f0f");break;default:a.Rb("\u6837\u5f0f");break}else a.Rb("\u6837\u5f0f")}o=mB.prototype;
o.WB=function(a){if(T.Nx()){var b=hC[a],c=Eq("fontsize");if(b&&b!=c){X("fontsize",b);var d=new tc;d.h("size",b);d.h("docid",docID);iq("save_doc_settings",d,this.jJ.bind(this,c))}}fq.execute(S.fo,a)};o.jJ=function(a,b,c){if(c||!b||ws(b))X("fontsize",a)};o.XB=function(a){if(T.Nx()){var b=Eq("fontname");if(a!=b){X("fontname",a);var c=new tc;c.h("face",a);c.h("docid",docID);iq("save_doc_settings",c,this.iJ.bind(this,b))}}fq.execute(S.eo,a)};o.iJ=function(a,b,c){if(c||!b||ws(b))X("fontname",a)};
o.NH=function(a){if(a){this.Pt(a,SITE_LANG_FONTS);this.Pt(a,SITE_DEFAULT_FONTS)}};
o.Pt=function(a,b){if(!a||!b)return;for(var c in b){if(!c)continue;var d=b[c].split(",")[0].toLowerCase();if(c=="Wingdings"&&(F||E))continue;var f;if(c=="Wingdings"){var g=a.g.f("span",{style:"font-family:"+b[c]},decodeURIComponent("%C3%981*J%26"));g=a.g.f("div",h,c," (",g,")");f=new Mj(g,d,a.g);f.ah=function(){return"Wingdings"}}else f=new Mj(a.g.f("span",{style:"font-family:"+b[c]},c),d,a.g);f.Oh(d);a.Z(f);this.Rp[d]=b[c]}};o.OH=function(a){if(a)for(var b in gC)a.Z(new Mj(b+"pt",gC[b],a.g))};
o.Yp=function(a){return this.w.j(a).je()};o.ls=function(a,b){this.w.j(a).Za(b)};o.blur=function(){this.w.Dc(h)};var oB=function(a){this.Yb=new Tj;this.Yb.ja(a);this.Yb.ec(j);this.Yb.o(e);this.Yb.u(j);this.Yb.b().tabIndex=0;Jg(this.Yb.b(),"findbar");var b=this.Yb.Qa();this.pk=this.Yb.xb();this.pk.e(b,kd,function(){Od(this.b(),"writely-findbar-focused",j)});this.pk.e(b,"blur",function(){Od(this.b(),"writely-findbar-focused",e)});this.C=new zf(this);this.C.e(this.Yb,vg,this.gj);var c=new Vo(O("findtext"));H(c,"input",this.Dy,e,this);H(window,"unload",function(){H(c,"input",this.Dy,e,this)})};o=oB.prototype;
o.Dy=function(){this.Uc=0;this.Bq()};o.C=h;o.Yb=h;o.Uc=0;o.mf=0;o.yj="";o.ma=function(a){if(!this.Yb.J())return;var b=this.Zv(a);if(!b)return;switch(a){case "findoptions":var c=b.K(),d=c.Xv(),f="",g="";for(var i=0;i<d.length;i++)if(c.j(d[i]).je()){f+=g+d[i];g=","}b.va(f);break;default:break}};o.Zv=function(a){return this.Yb.j(a)};
o.gj=function(a){this.Bq();var b=a.target.Gb(),c=a.target.Ra();switch(b){case "findclose":O("editor-findbar").style.display="none";break;case "findoptions":this.ma(b,c);break;case "findnext":this.Cl(j,e);break;case "replace":this.Cl(e,e);break;case "replaceall":this.Cl(e,j);break;default:break}};o.jA=function(a,b){if(a){O("findnotfound").innerHTML=b;O("findnotfound").style.visibility="visible"}else this.Bq()};o.Bq=function(){O("findnotfound").style.visibility="hidden"};
o.KL=function(a){this.jA(a,"\u6ca1\u6709\u627e\u5230\u5339\u914d\u9879\u3002")};o.kA=function(a){this.jA(a,"\u5df2\u5230\u8fbe\u7f51\u9875\u672b\u7aef\uff0c\u4ece\u9876\u7aef\u7ee7\u7eed")};
o.Cl=function(a,b){var c=O("findtext").value;if(!c){U("\u8bf7\u8f93\u5165\u8981\u641c\u7d22\u7684\u6587\u672c\u3002");O("findtext").focus();return}var d=this.Zv("findoptions").K(),f=d.j("m-matchcase").je(),g=d.j("m-matchword").je(),i=d.j("m-regexp").je(),l="";if(b)l="g";l+=f?"":"i";var m=c;i||(m=m.replace(/([^a-zA-Z0-9])/g,"\\$1"));if(g)m="\\b"+m+"\\b";var n=new RegExp(m,l),q=0,r=j;this.mf=this.Uc;if(a){if(this.yj=="replace"){this.Uc++;this.mf=this.Uc}r=this.Zg(Y.document.body,n,this.kn);if(!r){this.kA(j);
this.Uc=0;this.mf=0;r=this.Zg(Y.document.body,n,this.kn)}this.Uc++;this.yj="find"}else if(b){var t=O("replacetext").value,q=this.Jj(Y.document.body,n,t,b,0);r=q>0;this.yj="replaceAll"}else{if(this.yj=="find"&&this.Uc>0){this.Uc--;this.mf=this.Uc}r=this.Zg(Y.document.body,n,this.nK);if(r){this.mf=this.Uc;r=this.Zg(Y.document.body,n,this.kn);if(!r){this.Uc=0;this.mf=0;r=this.Zg(Y.document.body,n,this.kn);r&&this.kA(j)}r=j}this.yj="replace"}if(!r){this.XN=0;this.KL(j)}T.ra()};
o.Zg=function(a,b,c){for(var d=0;d<a.childNodes.length;d++){var f=a.childNodes[d];if(f.nodeType==3){var g=this.tE(b,f,c);if(g)return j}var g=this.Zg(f,b,c);if(g)return j}return e};o.tE=function(a,b,c){var d=b.nodeValue,f=0,g=0;while(this.mf>=0){var i=d.search(a);if(i>=0){var l=d.match(a)[0].length;f+=i+l;this.mf--;d=d.substring(i+l);g=l}else return e}f-=g;c(b,f,g);return j};
o.kn=function(a,b,c){var d=a.nextSibling;if(d==h)d=a.previousSibling;if(d==h)d=a.parentNode;d!=h&&Y.scrollTo(0,Wf(d).y-100);Ee(a,b,a,b+c).select()};o.nK=function(a,b,c){var d=O("replacetext").value,f=a.nodeValue,g=f.substring(0,b)+d+f.substring(b+c);a.nodeValue=g};o.Jj=function(a,b,c,d,f){for(var g=0;g<a.childNodes.length;g++){var i=a.childNodes[g];if(i.nodeType==3){var l=i.nodeValue.replace(b,c);if(i.nodeValue!=l){f++;i.nodeValue=l;i.nodeValue.replace(b,c);if(!d)return f}}f=this.Jj(i,b,c,d,f)}return f};var tw=function(){xd.call(this)};z(tw,xd);tw.prototype.ac=function(){return"WritelyShortcuts"};var jC="0123456789";tw.prototype.vq=function(a){if(!kb||!a.ctrlKey)return e;var b=a.which||a.charCode||a.keyCode,c=String.fromCharCode(b).toLowerCase();if(!c)if(b==13){a.which="m";c="m"}if(jC.indexOf(c)!=-1)return this.Uw(a);return e};
tw.prototype.ij=function(a,b,c){if(c)return this.Uw(a);var d=e;switch(a.keyCode){case 13:case 37:case 39:if(V("enable_comments")||V("enable_footnotes"))if(B?wA(a.keyCode):vA(a.keyCode))d=j;break;case 9:wu();d=HA(!a.shiftKey);break;case 8:wu();d=yA(a)||xA(a);break;case 27:vB(e);editUI.B.B.le()&&editUI.B.B.b().focus();d=j;break;case 33:case 34:B&&a.target.tagName=="BODY"&&frames.wys_frame.document.documentElement.setActive();break}d&&a.stopPropagation();return d};
tw.prototype.Uw=function(a){var b=h,c=e,d=a.which||a.charCode||a.keyCode;if(E)d=a.charCode;if(B||F)switch(d){case 191:d=a.shiftKey?63:47;break;case 188:d=44;break;case 190:d=46;break}var f=String.fromCharCode(d).toLowerCase();if(kb&&a.metaKey&&jC.indexOf(f)!=-1)return e;if(a.shiftKey){f=f.toUpperCase();if(f==" ")f="nbsp"}switch(f){case "b":b=S.xg;break;case "i":b=S.zg;break;case "u":b=S.Bg;break;case ",":b=S.Dk;break;case ".":b=S.Ek;break;case "l":b=S.fi;break;case "e":b=S.di;break;case "r":b=S.gi;
break;case "j":b=S.ei;break;case "f":if(V("enable_find_bar")){O("editor-findbar").style.display="block";O("findtext").focus();c=j}break;case "F":vB(j);c=j;break;case "g":if(V("enable_find_bar")){editUI.Yb.Cl(j,e);c=j}break;case "h":Hx();c=j;break;case "m":if(editUI.B.qh($y))V("enable_comments")?eq.bl.SM.ON():Nx();c=j;break;case "k":editUI.B.qh("w-link")&&sx(mz());c=j;break;case "K":uA(j);c=j;break;case "p":mr();c=j;break;case "s":Fx(h);c=j;break;case "1":this.Uf("H1","H1");c=j;break;case "2":this.Uf("H2",
"H2");c=j;break;case "3":this.Uf("H3","H3");c=j;break;case "4":this.Uf("H4","H4");c=j;break;case "5":this.Uf("H5","H5");c=j;break;case "6":this.Uf("H6","H6");c=j;break;case "7":b=S.hi;break;case "L":case "8":b=S.ki;break;case "9":var g=mz();if(Fz(g,"ul")||Fz(g,"ol")){es("ChangeList");c=j}break;case "0":this.Uf("P","P");c=j;break;case " ":b=S.ii;break;case "?":case "/":window.open(dC);c=j;break;case "C":Vs();c=j;break;case "nbsp":Pv("&nbsp;");c=j;break}if(b){editUI.B.qh(b)&&editUI.w.qh(b)&&this.p.execCommand(b);
c=j}if(c){a.stopPropagation();return j}return e};tw.prototype.Uf=function(a,b){editUI.B.qh(a)&&this.p.execCommand(S.ci,b)};var kC="WritelyTableOfContents",lC=h,Yu=function(a,b){var c=[],d=[],f=9;do{var g=mC(f);if(g&&g.length>0){d.push(f);c=c.concat(g)}}while(--f);c=c.sort(function(J,D){return D.position-J.position});if(!c.length){U("\u4e0d\u4f7f\u7528\u201c\u6807\u9898\u201d\u6bb5\u843d\u6837\u5f0f\u7684\u5728\u7ebf\u6587\u6863\u65e0\u6cd5\u751f\u6210\u5728\u7ebf\u6587\u6863\u8868\u3002");return e}var i=d.length-1,l=0,m={};do{m[d[i]]=l++}while(i--);var n=0,q=['<ol class="writely-toc-',a,'">'];i=c.length-1;do{var r=m[c[i].AI];
while(n!=r)if(n<r){q.push('<ol style="margin-left:0" class="writely-toc-subheading writely-toc-',b,'">');n++}else{q.push("</ol>");n--}q.push('<li><a target="_self" href="#',c[i].id,'">',Ea(c[i].EH),"</a>")}while(i--);while(n>=0){q.push("</ol>");n--}q=q.join("");var t=a+"+"+b,v=Xu();if(v){v.innerHTML=q;v.setAttribute("toctype",t)}else{Pv('<div class="writely-toc" id="'+kC+'" toctype="'+t+'">'+q+"</div>");v=Xu()}var x=v.parentNode;do{/^h\d$/i.test(x.tagName)&&x.parentNode.insertBefore(v,x)}while(x=
x.parentNode);if(B){var C=v.getElementsByTagName("a");i=C.length-1;do{(""+C[i].getAttribute("href")).indexOf("#")!=0&&C[i].setAttribute("href","#"+(""+C[i].getAttribute("href")).split("#")[1])}while(i--)}St();T.ra();pA();return j},nC=function(){var a=Xu();if(a){a.parentNode.removeChild(a);St();T.ra();Y.focus()}},oC=function(a){if(Y.document.getElementsByName&&Y.document.getElementsByName(a).length||Y.document.getElementById(a)){var b=(""+Math.random()).replace("0.","");return oC(a+"_"+b)}return a},
pC=function(a){var b=a.replace(/[^a-zA-Z0-9]+/g,"_");b.length||(b="_");if(b.length>30)b=b.substr(0,30);b=oC(b);return b},qC=function(a,b){b||(b=a.getElementsByTagName("a"));var c=b.length-1;if(c==-1)return;do{var d=b[c];if(d.getAttribute("name"))if(d.innerHTML.length){var f=Y.document.createElement("span");f.innerHTML=d.innerHTML;a.replaceChild(f,d)}else d.parentNode==a&&a.removeChild(d)}while(c--)},mC=function(a){var b=Y.document.body.getElementsByTagName("h"+a),c=b.length-1;if(c==-1)return[];var d=
[];do{var f=b[c],g=f.getElementsByTagName("a"),i=f.innerText||f.textContent;if(!i||i.replace(/[\s]+/g,"")=="")continue;var l=document.createElement("a"),m;m=!g.length||!g[0].getAttribute("name")||!g[0].getAttribute("name").length?pC(i):pC(g[0].getAttribute("name"));l.setAttribute("name",m);l.id=m;qC(f,g);var n=rC(f);d[d.length]={EH:n,AI:a,position:f.offsetTop,id:m};var q=document.createElement("span");q.appendChild(l);f.innerHTML=q.innerHTML+f.innerHTML;if(B)f.innerHTML=f.innerHTML.replace(/\<a id\=[a-z_0-9]+\>/i,
'<a name="'+m+'" id="'+m+'">')}while(c--);return d},rC=function(a){var b=new We(a),c=h,d=Wb(b,function(g){if(g.nodeType==3)return!c||!ie(c,g.parentNode);if(Nd(g,"writely-comment")||Nd(g,"writely-callout"))c=g;return e}),f=[];Vb(d,function(g){f.push(g.data)});return f.join("")},Xu=function(){if(Y&&Y.document)return Y.document.getElementById(kC);return h},pA=function(a){var b=Xu();if(!a&&b&&Gz(mz(),"writely-toc")){if(!lC){lC=Xd("div",{"class":"toc-tooltip"},Xd("a",{href:"#",onclick:sC},"\u7acb\u5373\u66f4\u65b0"),
" \uff08\u6e05\u9664\u7f16\u8f91\uff09"," | ",Xd("a",{href:"#",onclick:tC},"\u5c5e\u6027")," | ",Xd("a",{href:"#",onclick:uC},"\u5220\u9664"));document.body.appendChild(lC)}var c=Wf(O("wys_frame")),d=Xf(b),f=$f(b);if(d.y+f.height<0){lC.style.display="none";return}var g=$f(lC),i;i=W("rtl")==j?c.x+d.x:c.x+d.x+(f.width-g.width);var l=c.y+d.y-g.height;if(B){i-=1;l-=1}else if(E){i+=1;l+=1}else if(F){i+=2;l+=2}l=Math.max(l,c.y);Uf(lC,i,l);lC.style.display=""}else if(lC)lC.style.display="none"},sC=function(){var a=
Xu(),b=(a?a.getAttribute("toctype"):"none+none").split("+");Yu(b[0]||"none",b[1]||"none");return e},tC=function(){es("TocSettings");return e},uC=function(){nC();pA();return e};var qB=function(){if(!vC){var a=O("printpreview-toolbar");vC=new Tj;vC.ja(a);vC.ec(e);vC.o(j);vC.u(j);H(vC,vg,wC)}},vC=h,wC=function(a){var b=a.target.Gb();b=b.replace(/^printpreview\-/,"");switch(b){case "close":hu(W("canedit")?"edit":"view");break;case "print":mr();break;case "settings":Xs();break}},Wu=function(){var a=O("printpreview-frame");a&&a.contentWindow.location.reload(j)};var xC=h,$B=function(){var a=xC=yC(),b=e;if(a)b=j;else a="\u5b57\u8bcd";var c="\u67e5\u627e\u201c"+(a+"\u201d\u7684\u5b9a\u4e49..."),d="\u67e5\u627e\u201c"+(a+"\u201d\u7684\u540c\u4e49\u8bcd..."),f="\u5728\u767e\u79d1\u5168\u4e66\u4e2d\u67e5\u627e\u201c"+(a+"\u201d..."),g="\u5728\u7f51\u7edc\u4e2d\u641c\u7d22\u201c"+(a+"\u201d..."),i="\u5728\u7f51\u7edc\u4e2d\u641c\u7d22\u201c"+(a+"\u201d\u56fe\u50cf..."),l=editUI.B.du,m=Cq("language");if(m=="en"||m=="en_US"){l.j("m-dictionary").Rb(c);l.j("m-thesaurus").Rb(d);
l.j("m-encyclopedia").Rb(f)}var n=editUI.B.Fz;n.j("m-websearch").Rb(g);n.j("m-imagesearch").Rb(i);fC(l,n,b&&!window.LIMITED_EDITING)},fC=function(a,b,c){var d=Cq("language");if(d=="en"||d=="en_US")a.u(c);b.u(c)},aC=function(a){switch(a){case "dictionary":case "thesaurus":case "encyclopedia":zC(a);break;case "websearch":case "imagesearch":AC(a);break}},AC=function(a){var b=encodeURIComponent(xC);window.open((a=="websearch"?"http://www.google.com/search?hl=en&q=%1":"http://images.google.com/images?hl=en&q=%1").replace("%1",
b),"GoogleWebSearchWindow")},zC=function(a){es("Britannica",{PK:a,PM:xC})},yC=function(){var a=h;try{var b=Ot(),a=Pt(b,e);if(a==h||a.length==0)return h;a=a.replace(/^[\W]+|[\W]+$/g,"");if(a.length>50)a=a.substring(0,50)}catch(c){alert(c);return h}return a};var BC=Np.prototype.Uo;Np.prototype.Uo=function(){var a=this.Hd;if(CC(a)){DC(this,a);return}u(BC,this)();EC(a)&&FC(this)};
var CC=function(a){if(a.tagName=="A"){var b=mz(a);if(Gz(b,"writely-toc"))return j}return e},DC=function(a,b){a.Sm=function(){};var c=b.innerText||b.textContent,d=a.g.f("span",{id:Rp,style:"color: black"},""),f=a.g.f("span",{id:Tp},"\u8f6c\u5230\u94fe\u63a5\uff1a");a.Zo(Qp,a.g.createTextNode(Sa(c,48)).data,j,d).onclick=function(){GC(a,b)};var g=a.Cu(f,d);P(a.Du(),g)},EC=function(a){if(a.tagName!="A")return e;if(a.hash&&a.hash.length>1){var b=a.search.match(/id\=([^\&]+)/i);if((b?b[1]:h)==docID)return j}return e},
FC=function(a){document.getElementById(Qp).onclick=function(){GC(a,this);return e};return j},GC=function(a,b){var c=b.href.substring(b.href.indexOf("#")+1);(Y.document.getElementById(c)||Y.document.anchors[c]).scrollIntoView(j);document.location.hash=c;a.Og()};var HC={aB:["\u516c\u5143\u524d","\u516c\u5143"],$A:["\u516c\u5143\u524d","\u516c\u5143"],At:["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708"],gB:["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708"],pB:["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708",
"\u5341\u4e8c\u6708"],mB:["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708"],sB:["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708"],It:["\u661f\u671f\u65e5","\u661f\u671f\u4e00","\u661f\u671f\u4e8c","\u661f\u671f\u4e09","\u661f\u671f\u56db","\u661f\u671f\u4e94","\u661f\u671f\u516d"],Bt:["\u5468\u65e5",
"\u5468\u4e00","\u5468\u4e8c","\u5468\u4e09","\u5468\u56db","\u5468\u4e94","\u5468\u516d"],jB:["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],nB:["1\u5b63","2\u5b63","3\u5b63","4\u5b63"],kB:["\u7b2c1\u5b63\u5ea6","\u7b2c2\u5b63\u5ea6","\u7b2c3\u5b63\u5ea6","\u7b2c4\u5b63\u5ea6"],UA:["\u4e0a\u5348","\u4e0b\u5348"],rt:["yyyy\u5e74M\u6708d\u65e5EEEE","yyyy\u5e74M\u6708d\u65e5","yyyy-M-d","yy-M-d"],Dt:["ahh\u65f6mm\u5206ss\u79d2v","ahh\u65f6mm\u5206ss\u79d2z","ahh:mm:ss","ah:mm"],UM:6,
dN:[5,6],VM:5};HC.qB=HC.At;HC.uB=HC.It;HC.tB=HC.Bt;HC.rB=HC.jB;oj(HC,"zh_CN");
 var TIME_exfinish = new Date().getTime();
